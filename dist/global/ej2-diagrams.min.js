var ej=function(t){"use strict";function e(t,e){var i=e;return i.unshift(void 0),new(Function.prototype.bind.apply(t,i))}function i(t){var e,i=new Uint16Array(5);(window.msCrypto||window.crypto).getRandomValues(i);var n="ej2"+y(i),o=function(i){i.source===window&&"string"==typeof i.data&&i.data.length<=32&&i.data===n&&(t(),e())};return window.addEventListener("message",o,!1),window.postMessage(n,"*"),e=function(){window.removeEventListener("message",o),t=o=n=void 0}}function n(t,e){for(var i=e,n=t.split("."),o=0;o<n.length&&!c(i);o++)i=i[n[o]];return i}function o(t,e,i){var n,o,r=t.split("."),s=i||{},a=s,l=r.length;for(n=0;n<l;n++)o=r[n],n+1===l?a[o]=void 0===e?{}:e:h(a[o])&&(a[o]={}),a=a[o];return s}function r(t,e){delete t[e]}function s(t){var e={};return!h(t)&&t.constructor===e.constructor}function a(t,e){if(!h(e))for(var i=t,n=e,o=0,r=Object.keys(e);o<r.length;o++){var a=r[o];h(i.deepMerge)||-1===i.deepMerge.indexOf(a)||!s(n[a])&&!Array.isArray(n[a])?i[a]=n[a]:l(i[a],i[a],n[a],!0)}}function l(t,e,i,n){var o=t||{},r=arguments.length;n&&(r-=1);for(var a=arguments,h=1;h<r;h++)!function(t){if(!a[t])return"continue";var e=a[t];Object.keys(e).forEach(function(t){var i,r=o[t],a=e[t];n&&(s(a)||Array.isArray(a))?s(a)?(i=r||{},o[t]=l({},i,a,n)):(i=r||[],o[t]=l([],i,a,n)):o[t]=a})}(h);return o}function h(t){return void 0===t||null===t}function c(t){return void 0===t}function d(t){return t+"_"+ra++}function p(t,e){var i;return function(){var n=this,o=arguments,r=function(){return i=null,t.apply(n,o)};clearTimeout(i),i=setTimeout(r,e)}}function u(t,e){var i=t;return i===e||!(i===document||!i)&&u(i.parentNode,e)}function g(t){try{throw new Error(t)}catch(t){throw t.message+"\n"+t.stack}}function m(t){var e=t+"";return"auto"===e||-1!==e.indexOf("%")||-1!==e.indexOf("px")?e:e+"px"}function f(t,e){var i="string"==typeof t?document.querySelector(t):t;if(i[oa])for(var n=0,o=i[oa];n<o.length;n++){var r=o[n];if(r instanceof e)return r}return null}function v(){if("undefined"!=typeof window){var t=new Uint16Array(5);return(window.msCrypto||window.crypto).getRandomValues(t)}}function y(t){for(var e="",i=0;i<5;i++)e+=(i?",":"")+t[i];return e}function b(t,e){var i=ca.test(t)?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return void 0===e?i:(i.innerHTML=e.innerHTML?e.innerHTML:"",void 0!==e.className&&(i.className=e.className),void 0!==e.id&&(i.id=e.id),void 0!==e.styles&&i.setAttribute("style",e.styles),void 0!==e.attrs&&k(i,e.attrs),i)}function w(t,e){for(var i=C(e),n=0,o=t;n<o.length;n++)for(var r=o[n],s=0,a=i;s<a.length;s++){var l=a[s];r.classList.contains(l)||r.classList.add(l)}return t}function x(t,e){for(var i=C(e),n=0,o=t;n<o.length;n++){var r=o[n];if(""!==r.className)for(var s=0,a=i;s<a.length;s++){var l=a[s];r.classList.remove(l)}}return t}function C(t){var e=[];return"string"==typeof t?e.push(t):e=t,e}function S(t){var e=t;return""===e.style.visibility&&e.offsetWidth>0}function E(t,e){for(var i=document.createDocumentFragment(),n=0,o=t;n<o.length;n++){var r=o[n];i.appendChild(r)}return e.insertBefore(i,e.firstElementChild),t}function P(t,e){for(var i=document.createDocumentFragment(),n=0,o=t;n<o.length;n++){var r=o[n];i.appendChild(r)}return e.appendChild(i),t}function L(t){return t.parentNode.removeChild(t)}function T(t){var e=t.parentNode;ha.clearEvents(t),e.removeChild(t)}function k(t,e){for(var i=t,n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];i.setAttribute(r,e[r])}return i}function O(t,e){return void 0===e&&(e=document),e.querySelector(t)}function A(t,e){return void 0===e&&(e=document),e.querySelectorAll(t)}function M(t,e){var i=t;if("function"==typeof i.closest)return i.closest(e);for(;i&&1===i.nodeType;){if(R(i,e))return i;i=i.parentNode}return null}function I(t,e){void 0!==e&&Object.keys(e).forEach(function(i){t.style[i]=e[i]})}function D(t,e,i){w([t],e),x([t],i)}function R(t,e){var i=t.matches||t.msMatchesSelector||t.webkitMatchesSelector;return i?i.call(t,e):-1!==[].indexOf.call(document.querySelectorAll(e),t)}function N(t,i,n,o){return t.properties.hasOwnProperty(i)&&t.properties[i]instanceof o||(t.properties[i]=e(o,[t,i,n])),t.properties[i]}function B(t,i,n,o,r,s){for(var a=[],l=n.length,h=0;h<l;h++){var c=o;if(s&&(c=o(n[h])),r){var d=e(c,[t,i,{},!0]);d.setProperties(n[h],!0),a.push(d)}else a.push(e(c,[t,i,n[h],!0]))}return a}function H(t,e){return function(){return this.properties.hasOwnProperty(e)||(this.properties[e]=t),this.properties[e]}}function z(t,e){return function(i){if(this.properties[e]!==i){var n=this.properties.hasOwnProperty(e)?this.properties[e]:t;this.saveChanges(e,i,n),this.properties[e]=i}}}function j(t,e,i){return function(){return N(this,e,t,i)}}function F(t,e,i){return function(n){N(this,e,t,i).setProperties(n)}}function V(t,e,i){return function(){var n=i({});return this.properties.hasOwnProperty(e)?this.properties[e]:N(this,e,t,n)}}function _(t,e,i){return function(n){var o=i(n);N(this,e,t,o).setProperties(n)}}function W(t,e,i){return function(){if(!this.properties.hasOwnProperty(e)){var n=B(this,e,t,i,!1);this.properties[e]=n}return this.properties[e]}}function U(t,e,i){return function(n){var o=B(this,e,t,i,!1),r=B(this,e,n,i,!0);this.saveChanges(e,r,o),this.properties[e]=r}}function q(t,e,i){return function(n){var o=this.properties.hasOwnProperty(e)?this.properties[e]:t,r=B(this,e,n,i,!0,!0);this.saveChanges(e,r,o),this.properties[e]=r}}function X(t,e,i){return function(){var n=i({});if(!this.properties.hasOwnProperty(e)){var o=B(this,e,t,n,!1);this.properties[e]=o}return this.properties[e]}}function Y(t){return function(e,i){var n={set:z(t,i),get:H(t,i),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),tt(e,i,"prop",t)}}function G(t,e){return function(i,n){var o={set:F(t,n,e),get:j(t,n,e),enumerable:!0,configurable:!0};Object.defineProperty(i,n,o),tt(i,n,"complexProp",t,e)}}function Z(t){return function(e,i){var n={set:_({},i,t),get:V({},i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),tt(e,i,"complexProp",{},t)}}function K(t,e){return function(i,n){var o={set:U(t,n,e),get:W(t,n,e),enumerable:!0,configurable:!0};Object.defineProperty(i,n,o),tt(i,n,"colProp",t,e)}}function Q(t){return function(e,i){var n={set:q([],i,t),get:X([],i,t),enumerable:!0,configurable:!0};Object.defineProperty(e,i,n),tt(e,i,"colProp",{},t)}}function J(){return function(t,e){var i={set:function(t){var i=this.properties[e];if(i!==t){var n=et(this,e);!1===c(i)&&n.context.removeEventListener(n.prefix,i),n.context.addEventListener(n.prefix,t),this.properties[e]=t}},get:H(void 0,e),enumerable:!0,configurable:!0};Object.defineProperty(t,e,i),tt(t,e,"event")}}function $(t){}function tt(t,e,i,n,o){c(t.propList)&&(t.propList={props:[],complexProps:[],colProps:[],events:[],propNames:[],complexPropNames:[],colPropNames:[],eventNames:[]}),t.propList[i+"s"].push({propertyName:e,defaultValue:n,type:o}),t.propList[i+"Names"].push(e)}function et(t,e){if(!1===t.hasOwnProperty("parentObj"))return{context:t,prefix:e};var i=n("propName",t);return i&&(e=i+"-"+e),et(n("parentObj",t),e)}function it(t,e,i){var n=nt(e);return!1===n.rippleFlag||void 0===n.rippleFlag&&!ba?Function:(t.setAttribute("data-ripple","true"),ha.add(t,"mousedown",ot,{parent:t,rippleOptions:n}),ha.add(t,"mouseup",rt,{parent:t,rippleOptions:n,done:i}),ha.add(t,"mouseleave",st,{parent:t,rippleOptions:n}),ma.isPointer&&ha.add(t,"transitionend",st,{parent:t,rippleOptions:n}),function(){t.removeAttribute("data-ripple"),ha.remove(t,"mousedown",ot),ha.remove(t,"mouseup",rt),ha.remove(t,"mouseleave",st),ha.remove(t,"transitionend",st)})}function nt(t){return{selector:t&&t.selector?t.selector:null,ignore:t&&t.ignore?t.ignore:null,rippleFlag:t&&t.rippleFlag,isCenterRipple:t&&t.isCenterRipple,duration:t&&t.duration?t.duration:350}}function ot(t){var e=t.target,i=this.rippleOptions.selector,n=i?M(e,i):e;if(!(!n||this.rippleOptions&&M(e,this.rippleOptions.ignore))){var o=n.getBoundingClientRect(),r=t.pageX-document.body.scrollLeft,s=t.pageY-(!document.body.scrollTop&&document.documentElement?document.documentElement.scrollTop:document.body.scrollTop),a=Math.max(Math.abs(r-o.left),Math.abs(r-o.right)),l=Math.max(Math.abs(s-o.top),Math.abs(s-o.bottom)),h=Math.sqrt(a*a+l*l),c=2*h+"px",d=r-o.left-h,p=s-o.top-h;this.rippleOptions&&this.rippleOptions.isCenterRipple&&(d=0,p=0,c="100%"),n.classList.add("e-ripple");var u=b("div",{className:"e-ripple-element",styles:"width: "+c+";height: "+c+";left: "+d+"px;top: "+p+"px;transition-duration: "+this.rippleOptions.duration.toString()+"ms;"});n.appendChild(u),window.getComputedStyle(u).getPropertyValue("opacity"),u.style.transform="scale(1)",n!==this.parent&&ha.add(n,"mouseleave",st,{parent:this.parent,rippleOptions:this.rippleOptions})}}function rt(t){at(t,this)}function st(t){at(t,this)}function at(t,e){var i=e.rippleOptions.duration,n=t.target,o=e.rippleOptions.selector,r=o?M(n,o):n;if(r&&(!r||-1!==r.className.indexOf("e-ripple"))){var s=A(".e-ripple-element",r),a=s[s.length-1];a&&(a.style.opacity="0.5"),e.parent!==r&&ha.remove(r,"mouseleave",st),setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a),r.getElementsByClassName("e-ripple-element").length||r.classList.remove("e-ripple"),e.done&&e.done(t)},i)}}function lt(t,e){var i=ga.getDependables(Va,t,!0)[Ua[0]],o=ga.getDependables(Va,t)[Ua[1]],r=n("defaultNumberingSystem",i),s=n("symbols-numberSystem-"+r,i),a=ga.getSymbolPattern(e||"decimal",r,i,!1);return l(s,ga.getFormatData(a,!0,"",!0),{dateSeparator:ga.getDateSeparator(o)})}function ht(t,e){var i='var str="'+ct(t,"data",e)+'"; return str;';return new Function("data",i).bind(e)}function ct(t,e,i){var n=0,o=[];return t.replace(ml,"").replace(Pl,"'$1'").replace(Ll,function(t,r,s,a){var l=r.match(Cl);if(l){var h=l[1];if(yl.test(r))r='";} '+r.replace(l[1],h.replace(El,function(t){return t=t.trim(),dt(t,!fl.test(t)&&-1===o.indexOf(t),e,o)}))+'{ \n str = str + "';else if(vl.test(r))r='"; '+r.replace(l[1],h.replace(El,function(t){return t=t.trim(),dt(t,!fl.test(t)&&-1===o.indexOf(t),e,o)}))+'{ \n str = str + "';else if(wl.test(r)){var c=l[1].split(" of ");r='"; '+r.replace(l[1],function(t){return o.push(c[0]),o.push(c[0]+"Index"),"var i"+(n+=1)+"=0; i"+n+" < "+dt(c[1],!0,e,o)+".length; i"+n+"++"})+"{ \n "+c[0]+"= "+dt(c[1],!0,e,o)+"[i"+n+"]; \n var "+c[0]+"Index=i"+n+'; \n str = str + "'}else{var d=r.split("("),p=i&&i.hasOwnProperty(d[0])?"this.":"global";r='" + '+("global"===(p=/\./.test(d[0])?"":p)?"":p)+r.replace(h,dt(l[1].replace(",",e+"."),"global"!==p,e,o))+'+"'}}else r=bl.test(r)?'"; '+r.replace(bl,'} else { \n str = str + "'):r.match(xl)?r.replace(xl,'"; \n } \n str = str + "'):'"+'+dt(r,-1===o.indexOf(r),e,o)+'+"';return r})}function dt(t,e,i,n){return e&&!Sl.test(t)&&-1===n.indexOf(t.split(".")[0])?i+"."+t:t}function pt(t,e){var i=Ol.compile(t,e);return function(t,e,n){var o=i(t,e,n);if("string"==typeof o){if(kl.test(o))return(r=b("svg",{innerHTML:o})).childNodes;var r=b(Tl.test(o)?"table":"div",{innerHTML:o});return r.childNodes}return o}}function ut(t){var e=[],i=gt(t);if(i.length>0)for(var n=0;n<i.length;n++){var o=i[n],r="";switch((r=o[0]).toLowerCase()){case"m":e.push({command:r,x:o[1],y:o[2]});break;case"l":case"t":e.push({command:r,x:o[1],y:o[2]});break;case"h":e.push({command:r,x:o[1]});break;case"v":e.push({command:r,y:o[1]});break;case"z":e.push({command:r});break;case"c":e.push({command:r,x1:o[1],y1:o[2],x2:o[3],y2:o[4],x:o[5],y:o[6]});break;case"s":e.push({command:r,x2:o[1],y2:o[2],x:o[3],y:o[4]});break;case"q":e.push({command:r,x1:o[1],y1:o[2],x:o[3],y:o[4]});break;case"a":var s=o[4],a=o[5];e.push({command:r,r1:o[1],r2:o[2],angle:o[3],largeArc:s,sweep:a,x:o[6],y:o[7]})}}return e}function gt(t){var e=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi,i=[],n=[],o={};e.lastIndex=0;var r=!1;for(o=e.exec(t);o;)"e"===o[1]?r=!0:o[1]?("zm"===o[1].toLowerCase()?(i.length&&n.push(i),n.push(["Z"]),i=[o[1].substring(1,2)]):(i.length&&n.push(i),i=[o[1]]),r=!1):(i.length||(i=[]),r||i.push(Number(o[2])),r=!1),o=e.exec(t);return i.length&&n.push(i),n}function mt(t,e,i){var n,o,r="",s=[{x:0+t,y:0},{x:0+i-t,y:0},{x:0+i,y:0+t},{x:0+i,y:0+e-t},{x:0+i-t,y:0+e},{x:0+t,y:0+e},{x:0,y:0+e-t},{x:0,y:0+t}],a=[{x:0+i,y:0},{x:0+i,y:0+e},{x:0,y:0+e},{x:0,y:0}],l=0;r="M"+s[0].x+" "+s[0].y;var h;for(h=0;h<s.length;h+=2)r+="L"+(n=s[h+1]).x+" "+n.y,o=s[h+2]||s[0],r+="Q"+a[l].x+" "+a[l].y+" "+o.x+" "+o.y,l++;return r}function ft(t){var e,i="";i="M"+t[0].x+" "+t[0].y;var n;for(n=1;n<t.length;n++)i+="L"+(e=t[n]).x+" "+e.y;return i+="Z"}function vt(t){var e,i,n,o,r,s,a,l,h,c,d=[];for(a=0,l=0,c=0,h=t.length;c<h;++c){var p=t[c],u="";u=p.command,"y1"in p&&(o=p.y1),"y2"in p&&(s=p.y2),"x1"in p&&(n=p.x1),"x2"in p&&(r=p.x2),"x"in p&&(a=p.x),"y"in p&&(l=p.y);var g=d[d.length-1];switch(u){case"M":d.push({command:"M",x:a,y:l});break;case"L":d.push({command:"L",x0:e,y0:i,x:a,y:l});break;case"H":d.push({command:"L",x0:e,y0:i,x:a,y:i});break;case"V":d.push({command:"L",x0:e,y0:i,x:e,y:l});break;case"C":d.push({command:"C",x0:e,y0:i,x1:n,y1:o,x2:r,y2:s,x:a,y:l});break;case"S":if(g){var m=void 0,f={x:2*e-(m="C"===g.command||"S"===g.command?{x:g.x2,y:g.y2}:{x:e,y:i}).x,y:2*i-m.y};d.push({command:"C",x0:e,y0:i,x1:f.x,y1:f.y,x2:r,y2:s,x:a,y:l})}break;case"Q":d.push({command:"Q",x0:e,y0:i,x1:n,y1:o,x:a,y:l});break;case"T":if(g){var m=void 0,f={x:2*e-(m="Q"===g.command?{x:g.x1,y:g.y1}:{x:e,y:i}).x,y:2*i-m.y};d.push({command:"Q",x0:e,y0:i,x1:f.x,y1:f.y,x:a,y:l})}break;case"A":var v=p;v.command="A",d.push(v);break;case"Z":case"z":d.push({command:"Z"}),a=e,l=i}e=a,i=l}return d}function yt(t,e,i,n,o,r,s,a){var l,h,c,d,p,u,g,m,f;for(p=0,u=0,m=0,g=t.length;m<g;++m){var v=t[m],y=v.command;"x"in v&&(p=v.x),"y"in v&&(u=v.y),"y1"in v&&(h=v.y1),"y2"in v&&(d=v.y2),"x1"in v&&(l=v.x1),"x2"in v&&(c=v.x2),n?(void 0!==p&&(p=wt(p,e,o,s)),void 0!==u&&(u=wt(u,i,r,a)),void 0!==l&&(l=wt(l,e,o,s)),void 0!==h&&(h=wt(h,i,r,a)),void 0!==c&&(c=wt(c,e,o,s)),void 0!==d&&(d=wt(d,i,r,a))):(void 0!==p&&(p=Number((p+e).toFixed(2))),void 0!==u&&(u=Number((u+i).toFixed(2))),void 0!==l&&(l=Number((l+e).toFixed(2))),void 0!==h&&(h=Number((h+i).toFixed(2))),void 0!==c&&(c=Number((c+e).toFixed(2))),void 0!==d&&(d=Number((d+i).toFixed(2)))),(f=bt(v,y,{x:p,y:u,x1:l,y1:h,x2:c,y2:d,r1:v.r1,r2:v.r2},n,e,i))&&(t[m]=f)}return Ct(t)}function bt(t,e,i,n,o,r){switch(e){case"M":case"L":t.x=i.x,t.y=i.y;break;case"H":t.x=i.x;break;case"V":t.y=i.y;break;case"C":t.x=i.x,t.y=i.y,t.x1=i.x1,t.y1=i.y1,t.x2=i.x2,t.y2=i.y2;break;case"S":t.x=i.x,t.y=i.y,t.x2=i.x2,t.y2=i.y2;break;case"Q":t.x=i.x,t.y=i.y,t.x1=i.x1,t.y1=i.y1;break;case"T":t.x=i.x,t.y=i.y;break;case"A":var s=i.r1,a=i.r2;n&&(i.r1=s*=o,i.r2=a*=r),t.x=i.x,t.y=i.y,t.r1=i.r1,t.r2=i.r2;break;case"z":case"Z":t={command:"Z"}}return t}function wt(t,e,i,n){return t!==i?t=n!==i?t*e-(Number(i)*e-Number(i))+(n-Number(i)):Number(t)*e-(Number(i)*e-Number(i)):n!==i&&(t=n),Number(t.toFixed(2))}function xt(t){var e,i,n,o,r,s,a,l,h,c;for(a=0,l=0,c=0,h=t.length;c<h;++c){var d=t[c],p=d.command;if(/[MLHVCSQTA]/.test(p))"x"in d&&(d.x=a=d.x),"y"in d&&(d.y=l=d.y);else{"x1"in d&&(d.x1=n=a+d.x1),"x2"in d&&(d.x2=r=a+d.x2),"y1"in d&&(d.y1=o=l+d.y1),"y2"in d&&(d.y2=s=l+d.y2),"x"in d&&(d.x=a+=d.x),"y"in d&&(d.y=l+=d.y);var u=void 0;switch(p){case"m":case"M":u={command:"M",x:a,y:l};break;case"l":case"L":u={command:"L",x:a,y:l};break;case"h":case"H":u={command:"H",x:a};break;case"v":case"V":u={command:"V",y:l};break;case"c":case"C":u={command:"C",x:a,y:l,x1:n,y1:o,x2:r,y2:s};break;case"s":case"S":u={command:"S",x:a,y:l,x2:r,y2:s};break;case"q":case"Q":u={command:"Q",x:a,y:l,x1:n,y1:o};break;case"t":case"T":u={command:"T",x:a,y:l};break;case"a":case"A":(u={command:"A",x:a,y:l}).r1=d.r1,u.r2=d.r2,u.angle=d.angle,u.largeArc=d.largeArc,u.sweep=d.sweep;break;case"z":case"Z":u={command:"Z"},a=e,l=i,u=t[c]}u&&(t[c]=u)}"M"!==p&&"m"!==p||(e=a,i=l)}return t}function Ct(t){var e,i="";for(e=0;e<t.length;e++)i+=0===e?St(t[e]):" "+St(t[e]);return i}function St(t){var e="";switch(t.command){case"Z":case"z":e=t.command;break;case"M":case"m":case"L":case"l":e=t.command+" "+t.x+" "+t.y;break;case"C":case"c":e=t.command+" "+t.x1+" "+t.y1+" "+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"Q":case"q":e=t.command+" "+t.x1+" "+t.y1+" "+t.x+" "+t.y;break;case"A":case"a":var i=t.command,n=t.angle,o=t.largeArc?"1":"0",r=t.sweep?"1":"0";e=i+" "+t.r1+" "+t.r2+" "+n+" "+o+" "+r+" "+t.x+" "+t.y;break;case"H":case"h":e=t.command+" "+t.x;break;case"V":case"v":e=t.command+" "+t.y;break;case"S":case"s":e=t.command+" "+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"T":case"t":e=t.command+" "+t.x+" "+t.y}return e}function Et(){return new Nl(1,0,0,1,0,0,t.MatrixTypes.Identity)}function Pt(t,e){var i=It(t,e.x,e.y);return{x:Math.round(100*i.x)/100,y:Math.round(100*i.y)/100}}function Lt(t,e){for(var i=[],n=0,o=e;n<o.length;n++){var r=o[n];i.push(Pt(t,r))}return i}function Tt(t,e,i,n){Dt(t,Mt(.017453292519943295*(e%=360),i||0,n||0))}function kt(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0),Dt(t,At(e,i,n,o))}function Ot(e,i,n){return e.type&t.MatrixTypes.Identity?(e.type=t.MatrixTypes.Translation,void Rt(e,1,0,0,1,i,n)):e.type&t.MatrixTypes.Unknown?(e.offsetX+=i,void(e.offsetY+=n)):(e.offsetX+=i,e.offsetY+=n,void(e.type|=t.MatrixTypes.Translation))}function At(e,i,n,o){var r=Et();return r.type=n||o?t.MatrixTypes.Scaling|t.MatrixTypes.Translation:t.MatrixTypes.Scaling,Rt(r,e,0,0,i,n-e*n,o-i*o),r}function Mt(e,i,n){var o=Et(),r=Math.sin(e),s=Math.cos(e),a=i*(1-s)+n*r,l=n*(1-s)-i*r;return o.type=t.MatrixTypes.Unknown,Rt(o,s,r,-r,s,a,l),o}function It(e,i,n){switch(e.type){case t.MatrixTypes.Identity:break;case t.MatrixTypes.Translation:i+=e.offsetX,n+=e.offsetY;break;case t.MatrixTypes.Scaling:i*=e.m11,n*=e.m22;break;case t.MatrixTypes.Translation|t.MatrixTypes.Scaling:i*=e.m11,i+=e.offsetX,n*=e.m22,n+=e.offsetY;break;default:var o=n*e.m21+e.offsetX,r=i*e.m12+e.offsetY;i*=e.m11,i+=o,n*=e.m22,n+=r}return{x:i,y:n}}function Dt(e,i){var n=e.type,o=i.type;if(o!==t.MatrixTypes.Identity){if(n===t.MatrixTypes.Identity)return Nt(e,i),void(e.type=i.type);if(o===t.MatrixTypes.Translation)return e.offsetX+=i.offsetX,e.offsetY+=i.offsetY,void(n!==t.MatrixTypes.Unknown&&(e.type|=t.MatrixTypes.Translation));if(n!==t.MatrixTypes.Translation){var r=n<<4|o;switch(r){case 34:return e.m11*=i.m11,void(e.m22*=i.m22);case 35:return e.m11*=i.m11,e.m22*=i.m22,e.offsetX=i.offsetX,e.offsetY=i.offsetY,void(e.type=t.MatrixTypes.Translation|t.MatrixTypes.Scaling);case 36:break;default:switch(r){case 50:return e.m11*=i.m11,e.m22*=i.m22,e.offsetX*=i.m11,void(e.offsetY*=i.m22);case 51:return e.m11*=i.m11,e.m22*=i.m22,e.offsetX=i.m11*e.offsetX+i.offsetX,void(e.offsetY=i.m22*e.offsetY+i.offsetY);case 52:break;default:switch(r){case 66:case 67:case 68:break;default:return}}}var s=Et();return Rt(s,e.m11*i.m11+e.m12*i.m21,e.m11*i.m12+e.m12*i.m22,e.m21*i.m11+e.m22*i.m21,e.m21*i.m12+e.m22*i.m22,e.offsetX*i.m11+e.offsetY*i.m21+i.offsetX,e.offsetX*i.m12+e.offsetY*i.m22+i.offsetY),s.m21||s.m12?s.type=t.MatrixTypes.Unknown:((s.m11&&1!==s.m11||s.m22&&1!==s.m22)&&(s.type=t.MatrixTypes.Scaling),(s.offsetX||s.offsetY)&&(s.type|=t.MatrixTypes.Translation),(s.type&(t.MatrixTypes.Translation|t.MatrixTypes.Scaling))===t.MatrixTypes.Identity&&(s.type=t.MatrixTypes.Identity),s.type=t.MatrixTypes.Scaling|t.MatrixTypes.Translation),Nt(e,s),void(e.type=s.type)}var a=e.offsetX,l=e.offsetY;if(e.offsetX=a*i.m11+l*i.m21+i.offsetX,e.offsetY=a*i.m12+l*i.m22+i.offsetY,o===t.MatrixTypes.Unknown)return void(e.type=t.MatrixTypes.Unknown);e.type=t.MatrixTypes.Translation|t.MatrixTypes.Scaling}}function Rt(t,e,i,n,o,r,s){t.m11=e,t.m12=i,t.m21=n,t.m22=o,t.offsetX=r,t.offsetY=s}function Nt(t,e){t.m11=e.m11,t.m12=e.m12,t.m21=e.m21,t.m22=e.m22,t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.type=e.type}function Bt(t){return mh[t.toString()]}function Ht(t){return Lh[t.toString()]}function zt(t,e){return"Custom"===t?e.pathData:Th[t]}function jt(t){var e;switch(t.shape){case"Minus":e="M0,50 L100,50";break;case"Plus":e="M0,-50 L0,50 M-50,0 L50,0";break;case"ArrowUp":e="M0,100 L50,0 L100,100 Z";break;case"ArrowDown":e="M0,0 L50,100 L100,0 Z";break;case"Path":e=t.pathData}return e}function Ft(t){return kh[t.toString()]}function Vt(t,e){var i=!1,n={left:0,top:0},o=t;if(!t||!e)return n;for(h(e.offsetParent)&&"fixed"===e.style.position&&(i=!0);(e.offsetParent||i)&&t&&e.offsetParent!==t;)n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;for(t=o;(e.offsetParent||i)&&t&&e.offsetParent!==t;)n.left-=t.scrollLeft,n.top-=t.scrollTop,t=t.parentElement;return n}function _t(t,e,i,n,o){if(Hl=o,Ih=!!n,!t)return{left:0,top:0};e||(e="left"),i||(i="top"),jl=t.ownerDocument,zl=t;var r={left:0,top:0};return qt(e.toLowerCase(),i.toLowerCase(),r)}function Wt(t,e){e.left=t}function Ut(t,e){e.top=t}function qt(t,e,i){switch(Bl=zl.getBoundingClientRect(),e+t){case"topcenter":Wt($t(),i),Ut(Kt(),i);break;case"topright":Wt(Jt(),i),Ut(Kt(),i);break;case"centercenter":Wt($t(),i),Ut(Zt(),i);break;case"centerright":Wt(Jt(),i),Ut(Zt(),i);break;case"centerleft":Wt(Qt(),i),Ut(Zt(),i);break;case"bottomcenter":Wt($t(),i),Ut(Gt(),i);break;case"bottomright":Wt(Jt(),i),Ut(Gt(),i);break;case"bottomleft":Wt(Qt(),i),Ut(Gt(),i);break;default:case"topleft":Wt(Qt(),i),Ut(Kt(),i)}return i}function Xt(){return jl.documentElement.scrollTop||jl.body.scrollTop}function Yt(){return jl.documentElement.scrollLeft||jl.body.scrollLeft}function Gt(){return Ih?Bl.bottom:Bl.bottom+Xt()}function Zt(){return Kt()+Bl.height/2}function Kt(){return Ih?Bl.top:Bl.top+Xt()}function Qt(){return Bl.left+Yt()}function Jt(){return Bl.right+Yt()-(Hl?Hl.width:0)}function $t(){return Qt()+Bl.width/2}function te(t,e,i,n){if(void 0===e&&(e=null),void 0===i&&(i={X:!1,Y:!1}),!i.Y&&!i.X)return{left:0,top:0};var o=t.getBoundingClientRect();if(Vl=e,Fl=t.ownerDocument,n||(n=_t(t,"left","top")),i.X){var r=Vl?ce():xe(),s=me(),a=fe(),l=s-n.left,h=n.left+o.width-a;o.width>r?n.left=l>0&&h<=0?a-o.width:h>0&&l<=0?s:l>h?a-o.width:s:l>0?n.left+=l:h>0&&(n.left-=h)}if(i.Y){var c=Vl?de():we(),d=ge(),p=ve(),u=d-n.top,g=n.top+o.height-p;o.height>c?n.top=u>0&&g<=0?p-o.height:g>0&&u<=0?d:u>g?p-o.height:d:u>0?n.top+=u:g>0&&(n.top-=g)}return n}function ee(t,e,i,n){void 0===e&&(e=null);var o=_t(t,"left","top");i&&(o.left=i),n&&(o.top=n);var r=[];Vl=e,Fl=t.ownerDocument;var s=t.getBoundingClientRect(),a=o.top,l=o.left,h=o.left+s.width,c=he(a,o.top+s.height),d=se(l,h);return c.topSide&&r.push("top"),d.rightSide&&r.push("right"),d.leftSide&&r.push("left"),c.bottomSide&&r.push("bottom"),r}function ie(t,e,i,n,o,r,s,a,l){if(void 0===s&&(s=null),void 0===a&&(a={X:!0,Y:!0}),e&&t&&o&&r&&(a.X||a.Y)){var h={TL:null,TR:null,BL:null,BR:null},c={TL:null,TR:null,BL:null,BR:null},d=t.getBoundingClientRect(),p={posX:o,posY:r,offsetX:i,offsetY:n,position:{left:0,top:0}};Vl=s,Fl=e.ownerDocument,oe(e,h,p,l,d),re(c,p,d),a.X&&ae(e,c,h,p,d,!0),a.Y&&h.TL.top>-1&&le(e,c,h,p,d,!0),ne(t,p,d)}}function ne(t,e,i){var n=0,o=0;if(null!=t.offsetParent&&("absolute"===getComputedStyle(t.offsetParent).position||"relative"===getComputedStyle(t.offsetParent).position)){var r=_t(t.offsetParent,"left","top",!1,i);n=r.left,o=r.top}t.style.top=e.position.top+e.offsetY-o+"px",t.style.left=e.position.left+e.offsetX-n+"px"}function oe(t,e,i,n,o){i.position=_t(t,i.posX,i.posY,n,o),e.TL=_t(t,"left","top",n,o),e.TR=_t(t,"right","top",n,o),e.BR=_t(t,"left","bottom",n,o),e.BL=_t(t,"right","bottom",n,o)}function re(t,e,i){t.TL={top:e.position.top+e.offsetY,left:e.position.left+e.offsetX},t.TR={top:t.TL.top,left:t.TL.left+i.width},t.BL={top:t.TL.top+i.height,left:t.TL.left},t.BR={top:t.TL.top+i.height,left:t.TL.left+i.width}}function se(t,e){var i=!1,n=!1;return t-be()<me()&&(i=!0),e>fe()&&(n=!0),{leftSide:i,rightSide:n}}function ae(t,e,i,n,o,r){var s=se(e.TL.left,e.TR.left);i.TL.left-be()<=me()&&(s.leftSide=!1),i.TR.left>=fe()&&(s.rightSide=!1),(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&("right"===n.posX?n.posX="left":n.posX="right",n.offsetX=n.offsetX+o.width,n.offsetX=-1*n.offsetX,n.position=_t(t,n.posX,n.posY,!1),re(e,n,o),r&&ae(t,e,i,n,o,!1))}function le(t,e,i,n,o,r){var s=he(e.TL.top,e.BL.top);i.TL.top-ye()<=ge()&&(s.topSide=!1),i.BL.top>=ve()&&(s.bottomSide=!1),(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&("top"===n.posY?n.posY="bottom":n.posY="top",n.offsetY=n.offsetY+o.height,n.offsetY=-1*n.offsetY,n.position=_t(t,n.posX,n.posY,!1,o),re(e,n,o),r&&le(t,e,i,n,o,!1))}function he(t,e){var i=!1,n=!1;return t-ye()<ge()&&(i=!0),e>ve()&&(n=!0),{topSide:i,bottomSide:n}}function ce(){return Vl.getBoundingClientRect().width}function de(){return Vl.getBoundingClientRect().height}function pe(){return Vl.getBoundingClientRect().left}function ue(){return Vl.getBoundingClientRect().top}function ge(){return Vl?ue():0}function me(){return Vl?pe():0}function fe(){return Vl?be()+pe()+ce():be()+xe()}function ve(){return Vl?ye()+ue()+de():ye()+we()}function ye(){return Fl.documentElement.scrollTop||Fl.body.scrollTop}function be(){return Fl.documentElement.scrollLeft||Fl.body.scrollLeft}function we(){return window.innerHeight}function xe(){return window.innerWidth}function Ce(t,e){for(var i=getComputedStyle(t),n=[],o=/(auto|scroll)/,r=t.parentElement;r&&"HTML"!==r.tagName;){var s=getComputedStyle(r);"absolute"===i.position&&"static"===s.position||!o.test(s.overflow+s.overflowY+s.overflowX)||n.push(r),r=r.parentElement}return e||n.push(document),n}function Se(t){for(var e=t.parentElement,i=[];e&&"BODY"!==e.tagName;){var n=document.defaultView.getComputedStyle(e,null).getPropertyValue("z-index"),o=document.defaultView.getComputedStyle(e,null).getPropertyValue("position");"auto"!==n&&"static"!==o&&i.push(n),e=e.parentElement}for(var r=[],s=0;s<document.body.children.length;s++)if(!t.isEqualNode(document.body.children[s])){var n=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),o=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");"auto"!==n&&"static"!==o&&r.push(n)}r.push("999");var a=[];if(!h(t.parentElement)&&"BODY"!==t.parentElement.tagName)for(var l=[].slice.call(t.parentElement.children),s=0;s<l.length;s++){var n=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("z-index"),o=document.defaultView.getComputedStyle(l[s],null).getPropertyValue("position");"auto"!==n&&"static"!==o&&a.push(n)}var c=i.concat(r,a);return Math.max.apply(Math,c)+1}function Ee(t,e,i,r,s,a){if(r.tagName===e){for(var l=n("ej2_instances",r),h=t("input",{attrs:{type:i}}),c=["change","cssClass","label","labelPosition"],d=t(e,{className:s,attrs:{role:a,"aria-checked":"false"}}),p=0,u=r.attributes.length;p<u;p++)-1===c.indexOf(r.attributes[p].nodeName)&&h.setAttribute(r.attributes[p].nodeName,r.attributes[p].nodeValue);r.parentNode.insertBefore(h,r),L(r),(r=h).parentNode.insertBefore(d,r),d.appendChild(r),o("ej2_instances",l,r)}return r}function Pe(t){for(var e,i=t.childNodes,n=0;n<i.length;n++)if(3===(e=i[n]).nodeType)return e;return null}function Le(t,e,i){"INPUT"===i?(e.parentNode.insertBefore(t.element,e),L(e),t.element.checked=!1,["name","value","disabled"].forEach(function(e){t.element.removeAttribute(e)})):(t.element.id&&e.setAttribute("id",t.element.id),["role","aria-checked","class"].forEach(function(t){e.removeAttribute(t)}),e.innerHTML="")}function Te(t,e,i,n,o){n=Ee(t.createElement,e,"checkbox",n,i,o),t.element=n,"checkbox"!==t.element.getAttribute("type")&&t.element.setAttribute("type","checkbox"),t.element.id||(t.element.id=d("e-"+o))}function ke(t,e){void 0===t&&(t=!1),void 0===e&&(e={});var i=b("div",{className:"e-checkbox-wrapper e-css"});if(e.cssClass&&w([i],e.cssClass.split(" ")),e.enableRtl&&i.classList.add("e-rtl"),t){var n=b("span",{className:"e-ripple-container"});it(n,{isCenterRipple:!0,duration:400}),i.appendChild(n)}var o=b("span",{className:"e-frame e-icons"});if(e.checked&&o.classList.add("e-check"),i.appendChild(o),e.label){var r=b("span",{className:"e-label",innerHTML:e.label});i.appendChild(r)}return i}function Oe(t,e){if(e){var i=document.createEvent("MouseEvents");i.initEvent(t.type,!1,!0),e.dispatchEvent(i)}}function Ae(t){var e,i=Ze(t.target);if(h(t.cssClass)||i.wrap.classList.add(t.cssClass),h(t.template)&&h(ac)){var n=h(t.type)?Be(i.wrap):t.type;e=Ue(h(t.width)?void 0:t.width,n),He(n,i.wrap,e),h(t.label)||Me(i.inner_wrap,t.label)}else{var o=h(t.template)?ac:t.template;i.wrap.classList.add(Sc),We(i.wrap,o,lc)}i.wrap.classList.add(uc),i=null}function Me(t,e){var i=document.createElement("div");return i.classList.add(Cc),i.textContent=e,t.appendChild(i),i}function Ie(t,e){var i=Xe();sc[i]={timeOut:0,type:"Material",radius:e},Ge(t,i),Je(e,t)}function De(t,e,i){var n={};sc[e].timeOut=0,n[e]=qe(e,i,0,0),Ke({uniqueID:e,container:t,globalInfo:n,timeOutVar:0})}function Re(t,e){var i=Xe();sc[i]={timeOut:0,type:"Fabric",radius:e},Ye(t,i,mc),oi(e,t,mc)}function Ne(t,e){var i=Xe();sc[i]={timeOut:0,type:"HighContrast",radius:e},Ye(t,i,vc),oi(e,t,vc)}function Be(t){return window.getComputedStyle(t,":after").getPropertyValue("content").replace(/['"]+/g,"")}function He(t,e,i){var n=e.querySelector("."+bc),o=n.querySelector("svg");switch(h(o)||n.removeChild(o),t){case"Material":Ie(n,i);break;case"Fabric":Re(n,i);break;case"Bootstrap":ze(n,i);break;case"HighContrast":Ne(n,i)}}function ze(t,e){var i=Xe();sc[i]={timeOut:0,type:"Bootstrap",radius:e},je(t,i),Fe(t,e)}function je(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("id",e),i.setAttribute("class",fc),i.setAttribute("viewBox","0 0 64 64"),t.insertBefore(i,t.firstChild);for(var n=0;n<=7;n++){var o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttribute("class",wc+"_"+n),o.setAttribute("r","2"),o.setAttribute("transform","translate(32,32)"),i.appendChild(o)}}function Fe(t,e){var i=t.querySelector("svg.e-spin-bootstrap");i.style.width=i.style.height=e+"px";for(var n=90,o=0;o<=7;o++){var r=ri(0,0,24,n),s=i.querySelector("."+wc+"_"+o);s.setAttribute("cx",r.x+""),s.setAttribute("cy",r.y+""),n=n>=360?0:n,n+=45}}function Ve(t,e){function i(t){n.push(t),t===r&&1!==a||(t<=o&&t>1&&!s?t=parseFloat((t-.2).toFixed(2)):1===t?(t=7,t=parseFloat((t+.2).toFixed(2)),s=!0):t<8&&s?8===(t=parseFloat((t+.2).toFixed(2)))&&(s=!1):t<=8&&!s&&(t=parseFloat((t-.2).toFixed(2))),++a,i(t))}var n=[],o=t,r=e,s=!1,a=1;return i(o),n}function _e(t){for(var e=t.querySelector("svg.e-spin-bootstrap").getAttribute("id"),i=1;i<=8;i++)!function(t,e,i,n,o){function r(e){sc[o].isAnimate&&(++s,t.setAttribute("r",e+""),s>=n.length&&(s=0),sc[o].timeOut=setTimeout(r.bind(null,n[s]),18))}var s=0;r(e)}(t.getElementsByClassName("e-path-circle_"+(8===i?0:i))[0],i,0,Ve(i,i),e)}function We(t,e,i){h(i)||t.classList.add(i),t.querySelector(".e-spinner-inner").innerHTML=e}function Ue(t,e){var i="Material"===e?hc:"Fabric"===e?cc:dc;return t=t?parseFloat(t+""):i,"Bootstrap"===e?t:t/2}function qe(t,e,i,n){return{radius:e,count:i,previousId:n}}function Xe(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function Ye(t,e,i){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("id",e),n.setAttribute("class",i);var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("class",wc);var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",xc),t.insertBefore(n,t.firstChild),n.appendChild(o),n.appendChild(r)}function Ge(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("class",gc),i.setAttribute("id",e);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",wc),t.insertBefore(i,t.firstChild),i.appendChild(n)}function Ze(t){var e=document.createElement("div");e.classList.add(yc);var i=document.createElement("div");return i.classList.add(bc),t.appendChild(e),e.appendChild(i),{wrap:e,inner_wrap:i}}function Ke(t){Qe(1,149,ni,1333,t.globalInfo[t.uniqueID].count,75,t),t.globalInfo[t.uniqueID].count=++t.globalInfo[t.uniqueID].count%4}function Qe(t,e,i,n,o,r,s){function a(e){var o=Math.max(0,Math.min((new Date).getTime()-d,n));l(i(o,t,p,n),e.container),c===e.globalInfo[e.uniqueID].previousId&&o<n?sc[e.uniqueID].timeOut=setTimeout(a.bind(null,e),1):Ke(e)}function l(t,e){if(!h(e.querySelector("svg.e-spin-material"))&&!h(e.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))){var i=e.querySelector("svg.e-spin-material").querySelector("path.e-path-circle");i.setAttribute("stroke-dashoffset",ii(u,g,t,r)+""),i.setAttribute("transform","rotate("+m+" "+u/2+" "+u/2+")")}}var c=++s.globalInfo[s.uniqueID].previousId,d=(new Date).getTime(),p=e-t,u=$e(2*s.globalInfo[s.uniqueID].radius+""),g=ei(u),m=-90*(s.globalInfo[s.uniqueID].count||0);a(s)}function Je(t,e){var i=2*t,n=e.querySelector("svg.e-spin-material"),o=n.querySelector("path.e-path-circle"),r=ei(i),s=i/2+"px";n.setAttribute("viewBox","0 0 "+i+" "+i),n.style.width=n.style.height=i+"px",n.style.transformOrigin=s+" "+s+" "+s,o.setAttribute("stroke-width",r+""),o.setAttribute("d",ti(i,r)),o.setAttribute("stroke-dasharray",(i-r)*Math.PI*.75+""),o.setAttribute("stroke-dashoffset",ii(i,r,1,75)+"")}function $e(t){return parseFloat(t)}function ti(t,e){var i=t/2,n=e/2;return"M"+i+","+n+"A"+(i-n)+","+(i-n)+" 0 1 1 "+n+","+i}function ei(t){return.1*t}function ii(t,e,i,n){return(t-e)*Math.PI*(3*n/100-i/100)}function ni(t,e,i,n){var o=(t/=n)*t,r=o*t;return e+i*(6*r*o+-15*o*o+10*r)}function oi(t,e,i){var n=t,o=t,r=2*t,s=e.querySelector("."+i),a=s.querySelector(".e-path-circle"),l=s.querySelector(".e-path-arc"),h=r/2+"px";a.setAttribute("d",ai(n,o,t)),l.setAttribute("d",si(n,o,t,315,45)),s.setAttribute("viewBox","0 0 "+r+" "+r),s.style.transformOrigin=h+" "+h+" "+h,s.style.width=s.style.height=r+"px"}function ri(t,e,i,n){var o=(n-90)*Math.PI/180;return{x:t+i*Math.cos(o),y:e+i*Math.sin(o)}}function si(t,e,i,n,o){var r=ri(t,e,i,o),s=ri(t,e,i,n);return["M",r.x,r.y,"A",i,i,0,0,0,s.x,s.y].join(" ")}function ai(t,e,i){return["M",t,e,"m",-i,0,"a",i,i,0,1,0,2*i,0,"a",i,i,0,1,0,2*-i,0].join(" ")}function li(t){hi(t,!1),t=null}function hi(t,e){var i=t.classList.contains(yc)?t:t.querySelector("."+yc),n=i.querySelector("."+bc);if(e?!i.classList.contains(Sc)&&!i.classList.contains(uc):!i.classList.contains(Sc)&&!i.classList.contains(pc)){var o=i.querySelector("svg");if(h(o))return;var r=o.getAttribute("id");switch(sc[r].isAnimate=!e,sc[r].type){case"Material":e?clearTimeout(sc[r].timeOut):De(n,r,sc[r].radius);break;case"Bootstrap":e?clearTimeout(sc[r].timeOut):_e(n)}}e?D(i,[uc],[pc]):D(i,[pc],[uc]),t=null}function ci(t){hi(t,!0),t=null}function di(t){var e=new rc;e=mi(t.tooltip,e);var i=new rc(e);return i.beforeCollision=ui,i.beforeOpen=pi,i.cssClass="e-diagram-tooltip",i.opensOn="custom",i.appendTo("#"+t.element.id),i.close(),i}function pi(t){""!==this.content&&void 0!==this.content||(t.element.style.display="none")}function ui(t){t.collidedPosition&&t.collidedPosition!==this.position&&(t.element.style.display="none")}function gi(t,e){var i,n=t.tooltipObject;return i=e?e.tooltip:t.tooltip,mi(i,n),n}function mi(t,e){return t.content?(e.content=t.content,e.position=t.position,e.showTipPointer=t.showTipPointer,e.width=t.width,e.height=t.height,t.animation?e.animation=t.animation:e.animation={close:{effect:"None"}}):e.close(),e}function fi(t,e){var i,n;return n="Straight"!==t.type&&t.sourceWrapper?t.sourceWrapper.corners.center:vi(t),i=bi(t,n,t.targetPoint,e),Zi(t,i[0],!1),Zi(t,i[i.length-1],!0),i}function vi(t){var e;if(t.sourcePortWrapper){var i=t.sourcePortWrapper,n=t.sourceWrapper,o={x:i.offsetX,y:i.offsetY};Sn(o,n.corners,n.bounds,!1);e=o}else if(t.sourceID&&t.sourceWrapper)if(t.targetWrapper){var r=t.sourceWrapper.corners.center,s=t.targetWrapper.corners.center;e=Gi(t,t.sourceWrapper,r,s,!1)}else e=t.sourcePoint;else e=t.sourcePoint;return e}function yi(t,e,i){"LeftToRight"===i?(t.direction=t.direction?t.direction:"Right",e.direction=e.direction?e.direction:"Left"):"RightToLeft"===i?(t.direction=t.direction?t.direction:"Left",e.direction=e.direction?e.direction:"Right"):"TopToBottom"===i?(t.direction=t.direction?t.direction:"Bottom",e.direction=e.direction?e.direction:"Top"):"BottomToTop"===i&&(t.direction=t.direction?t.direction:"Top",e.direction=e.direction?e.direction:"Bottom")}function bi(t,e,i,n){var o=t.sourceWrapper,r=t.targetWrapper,s=t.sourcePortWrapper,a=t.targetPortWrapper,l=[],h={corners:void 0,point:e,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}},c={corners:void 0,point:i,direction:void 0,margin:{left:5,right:5,bottom:5,top:5}};if(void 0!==o&&void 0!==r&&(h.corners=o.corners,c.corners=r.corners),void 0!==s){var d={x:s.offsetX,y:s.offsetY};h.direction=Sn(d,h.corners,o.bounds,!1)}if(void 0!==a){var p={x:a.offsetX,y:a.offsetY};c.direction=Sn(p,c.corners,r.bounds,!1)}return void 0!==o&&void 0!==r?(void 0!==h.direction&&void 0!==c.direction||(n?yi(h,c,n):h.corners.topCenter.y>c.corners.bottomCenter.y&&Math.abs(h.corners.topCenter.y-c.corners.bottomCenter.y)>h.margin.top+h.margin.bottom?(h.direction=h.direction?h.direction:"Top",c.direction=c.direction?c.direction:"Bottom"):h.corners.bottomCenter.y<c.corners.topCenter.y&&Math.abs(h.corners.bottomCenter.y-c.corners.topCenter.y)>h.margin.bottom+h.margin.top?(h.direction=h.direction?h.direction:"Bottom",c.direction=c.direction?c.direction:"Top"):h.corners.middleRight.x<c.corners.middleLeft.x&&Math.abs(h.corners.middleRight.x-c.corners.middleLeft.x)>h.margin.right+h.margin.left?(h.direction=h.direction?h.direction:"Right",c.direction=c.direction?c.direction:"Left"):h.corners.middleLeft.x>c.corners.middleRight.x&&Math.abs(h.corners.middleLeft.x-c.corners.middleRight.x)>h.margin.left+h.margin.right?(h.direction=h.direction?h.direction:"Left",c.direction=c.direction?c.direction:"Right"):o.id!==r.id&&!h.corners.equals(h.corners,c.corners)&&c.corners.containsPoint(h.corners.topCenter,h.margin.top)?(h.direction=h.direction?h.direction:"Bottom",c.direction=c.direction?c.direction:"Top"):(h.direction=h.direction?h.direction:"Top",c.direction=c.direction?c.direction:"Bottom")),Di(t,h.direction,c.direction,h.point,c.point)):(Bi(t),(t.sourceWrapper||t.targetWrapper)&&Oi(t,h,c),"Straight"===t.type||"Bezier"===t.type?l=Ri(t,h,c):"Orthogonal"===t.type&&t.segments&&t.segments.length>0&&null!==t.segments[0].length&&null!==t.segments[0].direction?l=Li(t,h,c,o,r,s,a):(h.direction||(h.direction=c.direction?void 0!==t.targetPortWrapper?c.direction:Pn(c.direction):Dl.direction(h.point,c.point)),t.segments[0].points=l=un(t,h,c)),l)}function wi(t,e){var i,n,o;return t.direction=e.direction,e.points=[],e.points.push(t.point),o="Left"===e.direction||"Top"===e.direction?-e.length:e.length,n="Left"===e.direction||"Right"===e.direction?0:90,i=Yi(t.point,o,n),e.points.push(i),i}function xi(t,e,i){var n,o,r;if(e.corners=t.sourceWrapper?t.sourceWrapper.corners:void 0,t.sourcePortWrapper&&(r=Sn({x:t.sourcePortWrapper.offsetX,y:t.sourcePortWrapper.offsetY},e.corners,t.sourceWrapper.bounds,!1),!e.corners||"Bottom"!==e.direction&&"Top"!==e.direction?!e.corners||"Left"!==e.direction&&"Right"!==e.direction||i.point.y>e.corners.topCenter.y&&i.point.y<e.corners.bottomCenter.y&&(o=e.point.x>i.point.x?"Left":"Right"):i.point.x>e.corners.middleLeft.x&&i.point.x<e.corners.middleRight.x&&(o=e.point.y>i.point.y?"Top":"Bottom")),t.sourcePortWrapper&&r===Pn(o)){var s;("Left"===r||"Right"===r)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.center.y&&i.point.y>=e.corners.topCenter.y&&i.point.y<=e.corners.center.y?(e.direction="Top",s=e.point.y-e.corners.topCenter.y+20):("Left"===r||"Right"===r)&&e.point.y>e.corners.center.y&&e.point.y<=e.corners.bottomCenter.y&&i.point.y>e.corners.center.y&&i.point.y<=e.corners.bottomCenter.y?(e.direction="Bottom",s=e.corners.bottomCenter.y-e.point.y+20):("Top"===r||"Bottom"===r)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.center.x&&i.point.x>=e.corners.middleLeft.x&&i.point.x<=e.corners.center.x?(e.direction="Left",s=e.point.x-e.corners.middleLeft.x+20):("Top"===r||"Bottom"===r)&&e.point.x<=e.corners.middleRight.x&&e.point.x>e.corners.center.x&&i.point.x<=e.corners.middleRight.x&&i.point.x<e.corners.center.x&&(e.direction="Right",s=e.corners.middleRight.x-e.point.x+20),e.direction&&s&&(n=un(t,e,i,s,!0))}else e.direction=o||Ni(e.direction,e.point,i.point),n=pn(e,i);return n}function Ci(t,e,i){var n;i.corners=t.targetWrapper.corners,_i(t.targetWrapper,e,i,t);var o=Ni(i.direction,e.point,i.point);return e.direction!==i.direction||"Left"!==e.direction&&"Right"!==e.direction?(e.direction=o,n=pn(e,i)):(e.direction=o,n=un(t,e,i,t.targetWrapper.width/2+20),e.point=n[1],_i(t.targetWrapper,e,i,t),n=un(t,e,i)),n}function Si(t,e,i){var n;i.corners=t.targetWrapper.corners;var o,r;"Left"!==e.direction&&"Right"!==e.direction?i.corners.center.y!==e.point.y||i.corners.middleLeft.x<=e.point.x&&e.point.x<=i.corners.middleRight.x?i.corners.center.y===e.point.y&&"Bottom"===t.segments[t.segments.length-2].direction||i.corners.center.y>e.point.y&&e.point.y>=i.corners.topCenter.y?(o="Top",r=e.point.y-i.corners.topCenter.y+20):i.corners.center.y===e.point.y&&"Top"===t.segments[t.segments.length-2].direction||i.corners.center.y<e.point.y&&e.point.y<=i.corners.bottomCenter.y?(o="Bottom",r=i.corners.bottomCenter.y-e.point.y+20):void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&e.corners.topCenter.y<=e.point.y&&e.point.y<=e.corners.bottomCenter.y&&(o=e.direction,r=e.point.y>i.point.y?e.point.y-e.corners.topCenter.y+20:e.corners.bottomCenter.y-e.point.y+20):(o="Top",r=i.corners.height/2+20):i.corners.center.x!==e.point.x||i.corners.topCenter.y<e.point.y&&e.point.y<=i.corners.bottomCenter.y?i.corners.center.x===e.point.x&&"Right"===t.segments[t.segments.length-2].direction||i.corners.center.x>e.point.x&&e.point.x>=i.corners.middleLeft.x?(o="Left",r=e.point.x-i.corners.middleLeft.x+20):i.corners.center.x===e.point.x&&"Left"===t.segments[t.segments.length-2].direction||i.corners.center.x<=e.point.x&&e.point.x<=i.corners.middleRight.x?(o="Right",r=i.corners.middleRight.x-e.point.x+20):void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&e.corners.middleLeft.x<=e.point.x&&e.point.x<=e.corners.middleRight.x&&(o=e.direction,r=e.point.x>i.point.x?e.point.x-e.corners.middleLeft.x+20:e.corners.middleRight.x-e.point.x+20):(o="Left",r=i.corners.width/2+20);var s="Left"===o||"Top"===o?-r:r,a="Left"===o||"Right"===o?0:90;n=e.point,e.point=Yi(e.point,s,a),e.direction=Dl.direction(e.point,i.point),void 0===t.sourcePortWrapper||void 0===t.targetPortWrapper||e.corners.center.x!==i.corners.center.x&&e.corners.center.y!==i.corners.center.y||(e.direction=i.direction);var l=un(t,e,i);return l.splice(0,0,n),l}function Ei(t,e,i,n){var o=!1;switch(i.direction){case"Left":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&"Right"===n&&e.point.x>i.point.x&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y||("Bottom"===n&&e.point.y>i.point.y||"Top"===n&&e.point.y<i.point.y)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x?(e.direction="Right"===n?e.point.y>i.point.y?"Top":"Bottom":e.point.x<i.point.x?"Right":"Left",o=!0):e.point.x>i.point.x&&(e.point.y>i.point.y||e.point.y<i.point.y)&&!(i.corners.topCenter.y>e.point.y&&i.corners.bottomCenter.y<e.point.y)?e.direction="Left":e.point.x<i.point.x&&e.point.y>i.point.y||e.point.x>i.point.x&&e.point.y<=i.point.y&&i.corners.topCenter.y<e.point.y&&i.corners.center.y>=e.point.y?e.direction="Top":e.point.x<i.point.x&&e.point.y<i.point.y||e.point.x>i.point.x&&e.point.y>i.point.y&&i.corners.bottomCenter.y<e.point.y&&i.corners.center.y>e.point.y?e.direction="Bottom":e.point.y===i.point.y&&e.point.x<i.point.x&&(e.direction="Right");break;case"Right":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&("Bottom"===n&&e.point.y>i.point.y||"Top"===n&&e.point.y<i.point.y)&&e.point.x>i.point.x&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x?(e.direction=e.point.x>i.point.x?"Left":"Right",o=!0):void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&"Left"===n&&e.point.x<i.point.x&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y?(e.direction=e.point.y>i.point.y?"Top":"Bottom",o=!0):e.point.x<i.point.x&&i.corners.topCenter.y<=e.point.y&&i.corners.bottomCenter.y>=e.point.y&&e.point.y===i.point.y?e.direction="Top":e.point.y>i.point.y&&e.point.x>i.point.x?e.direction="Top":e.point.y<i.point.y&&e.point.x>i.point.x?e.direction="Bottom":e.point.x<i.point.x&&(e.point.y>i.point.y||e.point.y<i.point.y)?e.direction="Right":e.point.y===i.point.y&&e.point.x>i.point.x&&(e.direction="Left");break;case"Top":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&"Bottom"===n&&e.point.y>i.point.y&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x||("Right"===n&&e.point.x>i.point.x||"Left"===n&&i.point.y>e.point.y&&i.point.x>e.point.x)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y?(e.direction="Bottom"===n?e.point.x>i.point.x?"Left":"Right":e.point.y<i.point.y?"Bottom":"Top",o=!0):e.point.x===i.point.x&&e.point.y<i.point.y?e.direction="Bottom":e.point.y>i.point.y&&e.point.x>i.corners.middleLeft.x&&e.point.x<i.corners.middleRight.x?e.direction="Left":e.point.y>=i.point.y?e.direction="Top":e.point.y<i.point.y&&e.point.x>i.point.x?e.direction="Left":e.point.y<i.point.y&&e.point.x<i.point.x&&(e.direction="Right");break;case"Bottom":void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&(("Right"===n||"Left"===n&&i.point.x>e.point.x)&&e.point.y>i.point.y&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y||"Top"===n&&e.point.y<i.point.y&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x)?(e.direction="Right"===n||"Left"===n?e.point.y>i.point.y?"Top":"Bottom":e.point.x>i.point.x?"Left":"Right",o=!0):e.point.y<i.point.y&&e.point.x>i.corners.middleLeft.x&&i.corners.middleRight.x>e.point.x?e.point.y<i.point.y&&e.point.x>i.corners.middleLeft.x&&i.corners.center.x>=e.point.x?e.direction="Left":e.point.y<i.point.y&&e.point.x<i.corners.middleRight.x&&i.corners.center.x<e.point.x&&(e.direction="Right"):e.point.y>i.point.y&&e.point.x>i.point.x?e.direction="Left":e.point.y>i.point.y&&e.point.x<i.point.x?e.direction="Right":e.point.y<=i.point.y&&(e.point.x>i.point.x||i.point.x>e.point.x)&&(e.direction="Bottom")}return o}function Pi(t,e,i){var n;i.corners=t.targetWrapper.corners;var o;void 0!==t.sourcePortWrapper&&(o=Sn({x:t.sourcePortWrapper.offsetX,y:t.sourcePortWrapper.offsetY},e.corners,t.sourceWrapper.bounds,!1));var r=Ei(t,e,i,o);return void 0!==t.sourcePortWrapper&&void 0!==t.targetPortWrapper&&i.direction===Pn(o)&&(("Left"===i.direction&&e.point.x>i.point.x||"Right"===i.direction&&e.point.x<i.point.x)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y||"Bottom"===i.direction&&e.point.y<i.point.y&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x)?n=Si(t,e,i):e.direction===i.direction?n=un(t,e,i):("Left"===i.direction&&e.point.x>i.point.x||"Right"===i.direction&&e.point.x<i.point.x)&&("Top"===e.direction||"Bottom"===e.direction)&&e.point.y<=i.point.y&&i.corners.topCenter.y<=e.point.y&&i.corners.bottomCenter.y>=e.point.y||"Top"===i.direction&&e.point.y>i.point.y||"Bottom"===i.direction&&e.point.y<i.point.y&&i.corners.middleLeft.x<=e.point.x&&i.corners.middleRight.x>=e.point.x?n=Si(t,e,i):void 0!==t.sourceWrapper&&void 0!==t.targetWrapper&&void 0!==t.targetPortWrapper&&("Left"===e.direction||"Right"===e.direction)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y&&("Top"===i.direction||"Bottom"===i.direction)&&i.corners.center.x===e.corners.center.x?(e.direction="Top"===i.direction?"Bottom":"Top",n=un(t,e,i,"Top"===i.direction?e.corners.bottomCenter.y-e.point.y+20:e.point.y-e.corners.topCenter.y+20)):void 0!==t.sourceWrapper&&void 0!==t.targetWrapper&&void 0!==t.targetPortWrapper&&("Top"===e.direction||"Bottom"===e.direction)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x&&("Left"===i.direction||"Right"===i.direction)&&i.corners.center.y===e.corners.center.y?(e.direction="Left"===i.direction?"Right":"Left",n=un(t,e,i,"Left"===i.direction?e.corners.middleRight.x-e.point.x+20:e.point.x-e.corners.middleLeft.x+20)):n=r?un(t,e,i,"Left"===e.direction||"Right"===e.direction?"Left"===e.direction?e.point.x-e.corners.middleLeft.x+20:e.corners.middleRight.x-e.point.x+20:"Top"===e.direction?e.point.y-e.corners.topCenter.y+20:e.corners.bottomCenter.y-e.point.y+20):pn(e,i),n}function Li(t,e,i,n,o,r,s){var a,l,h,c=[];Bi(t);var d;if(t.segments.length>0){for(var p=0;p<t.segments.length;p++){var u=t.segments[p];if(0===p&&void 0!==t.sourcePortWrapper&&(h=Sn({x:r.offsetX,y:r.offsetY},n.corners,n.bounds,!1),u.direction===Pn(h)&&(u.direction=h)),p>0&&t.segments[p-1].direction===u.direction)p=Hi(t,p,e);else{var g=t.segments[p-1];e.point=u.direction?wi(e,u):g.points[g.points.length-1]}if(p===t.segments.length-1)if(s||o?t.targetWrapper&&void 0===t.targetPortWrapper?(ji(t,e),l=Ci(t,e,i)):l=Pi(t,e,i):l=xi(t,e,i),ki(l,t,e),u.points=[],l.length>=2)for(a=0;a<l.length;a++)u.points.push(l[a]);else d=p;if(r&&0===p){var m=Ti(t,r,n);m&&(e.point=m)}}void 0!==d&&(d===t.segments.length-1&&(t.segments[d-1].direction=null,t.segments[d-1].length=null),t.segments.splice(d,1)),c=Vi(t,c)}return c}function Ti(t,e,i){var n,o=Sn({x:e.offsetX,y:e.offsetY},i.corners,i.bounds,!1),r=t.segments[0];return r.direction!==o&&(Xi(r,o,i.corners,r.points[0],r.points[r.points.length-1],!1),n=r.points[r.points.length-1],r.direction=Dl.direction(r.points[r.points.length-2],r.points[r.points.length-1])),n}function ki(t,e,i){var n,o=e.segments[e.segments.length-2],r=o.points[o.points.length-1];("Top"!==o.direction&&"Bottom"!==o.direction||r.x!==t[1].x)&&("Left"!==o.direction&&"Right"!==o.direction||r.y!==t[1].y)||(o.points[o.points.length-1]=t[1],n=Dl.direction(o.points[0],o.points[o.points.length-1]),void 0!==e.sourceWrapper&&void 0===e.sourcePortWrapper&&n===Pn(o.direction)&&("Left"===o.direction||"Right"===o.direction?o.points[0].x="Right"===o.direction?o.points[0].x-e.sourceWrapper.corners.width:o.points[0].x+e.sourceWrapper.corners.width:o.points[0].y="Bottom"===o.direction?o.points[0].y-e.sourceWrapper.corners.height:o.points[0].y+e.sourceWrapper.corners.height),o.direction=n,o.length=Dl.distancePoints(o.points[0],o.points[o.points.length-1]),t.splice(0,1))}function Oi(t,e,i){var n=t.sourcePortWrapper,o=t.targetPortWrapper,r=t.sourceWrapper,s=e.point,a={left:0,right:0,top:0,bottom:0},l={x:0,y:0},h="Top";if(r?(s=i.point,a=e.margin):(r=t.targetWrapper,a=i.margin),"Orthogonal"===t.type)if(t.segments&&t.segments.length>0&&t.sourceWrapper&&t.segments[0].direction)e.direction=t.segments[0].direction,l=Gi(t,r,l=qi(r.corners,e.direction),$i(e.direction,l,r),!1);else{var c={corners:null,direction:null,point:null,margin:null};_i(r,{corners:null,direction:null,point:s,margin:a},c,t),l=c.point,h=c.direction}else{var d=void 0;t.segments&&t.segments.length>1&&(d=r===t.sourceWrapper?t.segments[0].point:t.segments[t.segments.length-2].point),l=Gi(t,r,r.bounds.center,t.segments&&t.segments.length>1?d:s,r===t.targetWrapper)}r===t.sourceWrapper?(e.direction=e.direction||h,e.point=l,t.sourcePortWrapper&&(e.point={x:n.offsetX,y:n.offsetY})):(i.direction=i.direction||h,i.point=l,t.targetPortWrapper&&(i.point={x:o.offsetX,y:o.offsetY}))}function Ai(t,e){for(var i=Mi(t),n=Mi(e),o=0;o<i.length-1;o++)for(var r=i[o],s=0;s<n.length-1;s++)if(Po(r,n[s]).enabled)return!0;return!1}function Mi(t){var e=[],i=Lo(t,t.corners);i.push(i[0]);for(var n=0;n<i.length-1;n++)e.push(Ii(i[n],i[n+1]));return e}function Ii(t,e){return{X1:t.x,Y1:t.y,X2:e.x,Y2:e.y}}function Di(t,e,i,n,o){var r,s=t.sourceWrapper,a=t.targetWrapper,l=t.sourcePortWrapper,h=t.targetPortWrapper,c=[],d=s.corners,p=a.corners,u=(p.center,{corners:d,point:n,direction:e,margin:{left:5,right:5,bottom:5,top:5}}),g={corners:p,point:o,direction:i,margin:{left:5,right:5,bottom:5,top:5}},m=!1;if(t.sourceWrapper&&t.targetWrapper&&(m=Ai(t.sourceWrapper,t.targetWrapper)),void 0!==l)switch(u.point={x:l.offsetX,y:l.offsetY},u.direction){case"Bottom":case"Top":u.point.y=u.point.y;break;case"Left":case"Right":u.point.x=u.point.x}else"Orthogonal"===t.type?(t.segments&&t.segments.length>0&&t.segments[0].direction&&(u.direction=t.segments[0].direction),u.point=qi(u.corners,u.direction),r=$i(u.direction,u.point,s),u.point=Gi(t,s,u.point,r,!1)):u.point=s.corners.center;if(void 0!==h)switch(g.point={x:h.offsetX,y:h.offsetY},g.direction){case"Bottom":case"Top":g.point.y=g.point.y;break;case"Left":case"Right":g.point.x=g.point.x}else"Orthogonal"===t.type?(g.point=qi(g.corners,g.direction),r=$i(g.direction,g.point,a),g.point=Gi(t,a,g.point,r,!0)):g.point=a.corners.center;if("Orthogonal"!==t.type){var f=void 0,v=void 0;if(Bi(t),void 0===t.sourcePortWrapper){u.point=u.corners.center,t.segments&&t.segments.length>0&&(v=t.segments[0],f=Dl.isEmptyPoint(v.point)?void 0:v);var y=void 0!==f?f.point:g.point;if("Bezier"===t.type&&t.segments.length>0&&t.segments[0].vector1.angle&&t.segments[0].vector1.distance){w=Math.max(u.corners.width,u.corners.height);y=Dl.transform(u.point,t.segments[0].vector1.angle,w/2)}u.point=m?t.sourceWrapper.bounds.center:Gi(t,s,u.point,y,!1)}if(void 0===t.targetPortWrapper){g.point=g.corners.center,t.segments&&t.segments.length>1&&(v=t.segments[t.segments.length-2],f=Dl.isEmptyPoint(v.point)?void 0:v);var b=f?f.point:u.point;if("Bezier"===t.type&&t.segments.length>0&&t.segments[t.segments.length-1].vector2.angle&&t.segments[t.segments.length-1].vector2.distance){var w=Math.max(u.corners.width,u.corners.height);b=Dl.transform(g.point,t.segments[0].vector2.angle,w/2)}g.point=m?t.targetWrapper.bounds.center:Gi(t,a,b,g.point,!0)}c=Ri(t,u,g)}else if("Orthogonal"===t.type&&t.segments&&t.segments.length>0&&null!==t.segments[0].direction)c=Fi(t,u,g,l,h,s,a);else{if(!t.segments[0]){f=new Vc(t,"segments",{type:"Orthogonal"},!0);t.segments.push(f)}t.segments[0].points=c=Wi(t,u,g)}return c}function Ri(t,e,i){var n=[];if(t.segments&&t.segments.length>0){var o=void 0,r=[],s=e.point;for(o=0;o<t.segments.length;o++){var a=t.segments[o];if((r=[]).push(s),o!==t.segments.length-1?(r.push(a.point),s=a.point):r.push(i.point),t.segments[o].points=r,t.segments.length>1&&Dl.equals(a.points[0],a.points[1])&&t.segments.splice(o,1),a)for(var l=0;l<a.points.length;l++)(l>0||0===o)&&n.push(a.points[l])}}return n}function Ni(t,e,i){return"Top"===t||"Bottom"===t?i.x>e.x?"Right":"Left":i.y>e.y?"Bottom":"Top"}function Bi(t){if("Straight"===t.type||"Bezier"===t.type){if(0===t.segments.length||t.segments.length>0&&!Dl.isEmptyPoint(t.segments[t.segments.length-1].point)){e=void 0;e="Bezier"===t.type?new Fc(t,"segments",{type:"Bezier"},!0):new jc(t,"segments",{type:"Straight"},!0),t.segments.push(e)}}else if(0===t.segments.length||t.segments[t.segments.length-1].direction){var e=new Vc(t,"segments",{type:"Orthogonal"},!0);t.segments.push(e)}}function Hi(t,e,i){var n=t.segments[e],o="Left"===n.direction||"Top"===n.direction?-n.length:n.length,r="Left"===n.direction||"Right"===n.direction?0:90,s=Yi(i.point,o,r);return t.segments[e-1].length+=n.length,t.segments[e-1].points[1]=i.point=s,t.segments.splice(e,1),--e}function zi(t,e,i){var n,o;t.sourcePortWrapper&&(o=Sn({x:t.sourcePortWrapper.offsetX,y:t.sourcePortWrapper.offsetY},e.corners,t.sourceWrapper.bounds,!1)),_i(t.targetWrapper,e,i,t);var r=Ni(i.direction,e.point,i.point);if(void 0===t.sourcePortWrapper||e.direction!==i.direction||("Top"!==e.direction&&"Bottom"!==e.direction||e.corners.center.x!==i.corners.center.x)&&("Left"!==e.direction&&"Right"!==e.direction||e.corners.center.y!==i.corners.center.y))if(i.point.x>=e.corners.middleLeft.x&&i.point.x<=e.corners.middleRight.x&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y)e.direction=i.point.y>e.point.y?"Bottom":"Top",n=un(t,e,i,"Top"===e.direction?e.point.y-e.corners.topCenter.y+20:e.corners.bottomCenter.y-e.point.y+20);else if(t.sourcePortWrapper&&o===Pn(r)){var s;("Left"===o||"Right"===o)&&e.point.y>=e.corners.topCenter.y&&e.point.y<=e.corners.bottomCenter.y?(e.direction=i.point.y>e.point.y?"Bottom":"Top",s=e.corners.height/2+20):("Top"===o||"Bottom"===o)&&e.point.x>=e.corners.middleLeft.x&&e.point.x<=e.corners.middleRight.x&&(e.direction=i.point.x>e.point.x?"Right":"Left",s=e.corners.width/2+20),e.direction&&s?n=un(t,e,i,s,!0):(e.direction=r,n=pn(e,i))}else!t.sourcePortWrapper||o!==i.direction||"Top"!==o&&"Bottom"!==o||e.corners.center.x!==i.corners.center.x?(e.direction=r,n=pn(e,i)):(e.direction=i.point.y>e.point.y?"Bottom":"Top",n=un(t,e,i,"Bottom"===e.direction?e.corners.bottomCenter.y-e.point.y+20:e.point.y-e.corners.topCenter.y+20));else e.direction=r,n="Top"===r||"Bottom"===r?un(t,e,i,t.sourceWrapper.height/2+20):un(t,e,i,t.sourceWrapper.width/2+20),e.point=n[1],"Left"===r||"Right"===r?(i.direction=r,i.point="Left"===r?i.corners.middleLeft:i.corners.middleRight):_i(t.targetWrapper,e,i,t),n=un(t,e,i);return n}function ji(t,e){if(void 0!==t.targetWrapper&&void 0===t.targetPortWrapper&&t.targetWrapper.corners.containsPoint(e.point)){var i=t.targetWrapper,n=t.segments[t.segments.length-2],o=n.points[n.points.length-1],r=Pn(n.direction);"Bottom"===r?o.y<i.corners.bottomCenter.y&&(n.points[n.points.length-1].y=i.corners.bottomCenter.y+20,n.length=Dl.distancePoints(n.points[0],n.points[n.points.length-1])):"Top"===r?o.y>i.corners.topCenter.y&&(n.points[n.points.length-1].y=i.corners.topCenter.y-20,n.length=Dl.distancePoints(n.points[0],n.points[n.points.length-1])):"Left"===r?o.x>i.corners.middleLeft.x&&(n.points[n.points.length-1].x=i.corners.middleLeft.x-20,n.length=Dl.distancePoints(n.points[0],n.points[n.points.length-1])):"Right"===r&&o.x<i.corners.middleRight.x&&(n.points[n.points.length-1].x=i.corners.middleRight.x+20,n.length=Dl.distancePoints(n.points[0],n.points[n.points.length-1])),e.point=n.points[n.points.length-1]}}function Fi(t,e,i,n,o,r,s){var a,l,h,c,d=[];Bi(t);for(var p=0;p<t.segments.length;p++){if(l=t.segments[p],n&&e.direction===Pn(l.direction)&&(l.direction=e.direction),p>0&&t.segments[p-1].direction===l.direction)p=Hi(t,p,e);else if(l.direction)e.point=wi(e,t.segments[p]);else{var u=t.segments[p-1];e.point=u.points[u.points.length-1]}if(p===t.segments.length-1)if(ji(t,e),a=void 0===o?zi(t,e,i):Pi(t,e,i),ki(a,t,e),l.points=[],a.length>=2)for(h=0;h<a.length;h++)l.points.push(a[h]);else c=p;if(void 0!==c&&(c===t.segments.length-1&&(t.segments[c-1].direction=null,t.segments[c-1].length=null),t.segments.splice(c,1)),n&&0===p){var g=Ti(t,n,r);g&&(e.point=g)}}return Vi(t,d)}function Vi(t,e){for(var i=0;i<t.segments.length;i++)for(var n=t.segments[i],o=0;o<n.points.length;o++)(o>0||0===i)&&e.push(n.points[o]);return e}function _i(t,e,i,n){var o,r={x:0,y:0},s=t.corners,a=e.margin,l=e.point;if(s.bottomCenter.y+a.bottom<l.y)o="Bottom",r=s.bottomCenter;else if(s.topCenter.y-a.top>l.y)o="Top",r=s.topCenter;else if(s.middleLeft.x-a.left>l.x)o="Left",r=s.middleLeft;else if(s.middleRight.x+a.right<l.x)o="Right",r=s.middleRight;else{var h=Math.abs(l.y-s.topCenter.y),c=Math.abs(l.x-s.middleRight.x),d=Math.abs(l.y-s.bottomCenter.y),p=Math.abs(l.x-s.middleLeft.x),u=Number.MAX_VALUE;u=h,o="Top",r=s.topCenter,u>c&&(u=c,o="Right",r=s.middleRight),u>d&&(u=d,o="Bottom",r=s.bottomCenter),u>p&&(o="Left",r=s.middleLeft)}i.point=r,i.direction=o;var g=$i(i.direction,i.point,t);i.point=Gi(n,t,i.point,g,t===n.targetWrapper)}function Wi(t,e,i,n){var o,r=!1;return(r=xn(e.direction,i.direction))&&Cn(e,i),"Right"===e.direction&&"Left"===i.direction?o=tn(t,e,i,r):"Right"===e.direction&&"Right"===i.direction?o=en(t,e,i):"Right"===e.direction&&"Top"===i.direction?o=nn(t,e,i,r):"Right"===e.direction&&"Bottom"===i.direction?o=on(t,e,i,r):"Bottom"===e.direction&&"Top"===i.direction?o=rn(e,i):"Bottom"===e.direction&&"Bottom"===i.direction?(e.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},o=an(t,e,i)):"Bottom"===e.direction&&"Left"===i.direction?o=sn(t,e,i,r):"Left"===e.direction&&"Left"===i.direction?o=hn(t,e,i):"Left"===e.direction&&"Top"===i.direction?o=ln(t,e,i,r):"Top"===e.direction&&"Top"===i.direction&&(o=cn(t,e,i)),r&&Cn(e,i),dn(t,o,e,i,n)}function Ui(t,e){var i={x:e.x,y:t.y},n=(Dl.findLength(t,i),Dl.findLength(i,e)),o=Dl.findLength(e,t),r=Math.asin(n/o);return r=180*r/Math.PI,t.x<e.x?t.y>e.y&&(r=360-r):r=t.y<e.y?180-r:180+r,r}function qi(t,e){var i;switch(e){case"Left":i=t.middleLeft;break;case"Top":i=t.topCenter;break;case"Right":i=t.middleRight;break;case"Bottom":i=t.bottomCenter}return i}function Xi(t,e,i,n,o,r){var s,a,l=[];l.push(n);n.y===o.y&&("Left"===e&&o.x<n.x||"Right"===e&&o.x>n.x)||n.x===o.x&&("Top"===e&&o.y<n.y||"Bottom"===e&&o.y>n.y)||("Top"===e||"Bottom"===e?"Top"===e&&o.y<n.y&&o.y>n.y-13||"Bottom"===e&&o.y>n.y&&o.y<n.y+13?(a="Top"===e?i.top-13:i.bottom+13,l.push({x:n.x,y:a}),l.push({x:n.x+(o.x-n.x)/2,y:a}),l.push({x:n.x+(o.x-n.x)/2,y:o.y})):Math.abs(n.x-o.x)>13&&("Top"===e&&o.y<n.y||"Bottom"===e&&o.y>n.y)?l.push({x:n.x,y:o.y}):(a="Top"===e?i.top-13:i.bottom+13,s=o.x<n.x?i.left-13:i.right+13,l.push({x:n.x,y:a}),l.push({x:o.x,y:a})):"Left"===e&&o.x<n.x&&o.x>n.x-13||"right"===e&&o.x>n.x&&o.x<n.x+13?(s="Left"===e?i.left-13:i.right+13,l.push({x:s,y:n.y}),l.push({x:s,y:n.y+(o.y-n.y)/2}),l.push({x:o.x,y:n.y+(o.y-n.y)/2})):Math.abs(n.y-o.y)>13&&("Left"===e&&o.x<n.x||"Right"===e&&o.x>n.x)?l.push({x:o.x,y:n.y}):(s="Left"===e?i.left-13:i.right+13,l.push({x:s,y:n.y}),l.push({x:s,y:o.y})),r&&(l.push(t.points[0]),l.reverse()),t.points=l)}function Yi(t,e,i){return Dl.transform(t,i,e)}function Gi(t,e,i,n,o){i={x:i.x,y:i.y},n={x:n.x,y:n.y};var r,s,a=Dl.findAngle(n,i),l=o?t.targetWrapper:t.sourceWrapper,h=o||"Orthogonal"===t.type?i:n;Dl.transform(i,a,Math.max(l.actualSize.height/2,l.actualSize.width/2));if(r=l,"Orthogonal"===t.type){var c=Math.abs(r.bounds.height-r.actualSize.height)/2+5;i.x===n.x&&(i.y<n.y?i.y-=c:i.y+=c),c=Math.abs(r.bounds.width-r.actualSize.width)/2+5,i.y===n.y&&(i.x<n.x?i.x-=c:i.x+=c)}else{o?Dl.findAngle(i,n):Dl.findAngle(n,i);if(o){var d=Dl.findAngle(i,n);n=Dl.transform({x:n.x,y:n.y},d,Math.max(l.actualSize.width,l.actualSize.height))}else{var p=Dl.findAngle(n,i);i=Dl.transform({x:i.x,y:i.y},p,Math.max(l.actualSize.width,l.actualSize.height))}}l instanceof sh&&l.data?(s=r.getPoints(),r.data.split("m").length-1+(r.data.split("M").length-1)==1&&(s[s.length]=s[0])):(s=Lo(l,l.corners))[s.length]=s[0];s.length;return Ki({X1:i.x,Y1:i.y,X2:n.x,Y2:n.y},s,!0,h)||(o?n:i)}function Zi(t,e,i){return e.x=Math.round(100*e.x)/100,e.y=Math.round(100*e.y)/100,i?t.targetPoint=e:t.sourcePoint=e,e}function Ki(t,e,i,n){var o,r=e.length,s={X1:e[0].x,Y1:e[0].y,X2:e[1].x,Y2:e[1].y},a=Qi(t,s);if(a&&(o=Dl.distancePoints(a,n)),isNaN(o)||o>0)for(var l=1;l<r-1;l++){var h=Qi(t,s={X1:e[l].x,Y1:e[l].y,X2:e[l+1].x,Y2:e[l+1].y});if(h){var c=Dl.distancePoints(h,n);if((isNaN(o)||o>c)&&(o=c,a=h),o>=0&&o<=1)break}}return a}function Qi(t,e){var i,n,o,r,s,a,l,h,c,d,p,u,g,m,f,v=t.X1,y=t.Y1,b=t.X2,w=t.Y2,x=e.X1,C=e.Y1,S=e.X2,E=e.Y2;return i=w-y,o=v-b,s=b*y-v*w,p=i*x+o*C+s,u=i*S+o*E+s,0!==p&&0!==u&&Ji(p,u)?null:(n=E-C,r=x-S,a=S*C-x*E,c=n*v+r*y+a,d=n*b+r*w+a,0!==c&&0!==d&&Ji(c,d)?null:0===(g=i*r-n*o)?null:(m=g<0?-g/2:g/2,m=0,f=o*a-r*s,l=f<0?(f-m)/g:(f+m)/g,f=n*s-i*a,h=f<0?(f-m)/g:(f+m)/g,{x:l,y:h}))}function Ji(t,e){return t*e>=0}function $i(t,e,i){var n;switch(t){case"Bottom":n={x:e.x,y:e.y-Math.max(i.actualSize.width,i.actualSize.height)};break;case"Top":n={x:e.x,y:e.y+Math.max(i.actualSize.width,i.actualSize.height)};break;case"Right":n={y:e.y,x:e.x-Math.max(i.actualSize.width,i.actualSize.height)};break;case"Left":n={y:e.y,x:e.x+Math.max(i.actualSize.width,i.actualSize.height)}}return n}function tn(e,i,n,o){var r=e.sourcePortWrapper,s=(e.targetPortWrapper,Math.round(Math.abs(i.point.y-n.point.y))),a=(Math.round(Math.abs(i.point.x-n.point.x)),{x:Math.max(i.point.x,i.corners.right),y:i.point.y}),l={x:Math.min(n.point.x,n.corners.left),y:n.point.y},h=10;if(o){var c=void 0;c=l,l=a,a=c}return i.corners.bottomCenter.y+h<n.corners.topCenter.y-h||i.corners.topCenter.y-h>n.corners.bottomCenter.y+h||(h=0),i.margin={left:h,right:h,top:h,bottom:h},n.margin={left:h,right:h,top:h,bottom:h},0===s&&(i.corners.middleRight.x<n.corners.middleLeft.x||o&&i.corners.middleRight.x<n.corners.middleLeft.x)?t.NoOfSegments.One:i.corners.middleRight.x+i.margin.right<n.corners.middleLeft.x-n.margin.left?t.NoOfSegments.Three:e.sourceWrapper!==e.targetWrapper&&(i.corners.containsPoint(l)||n.corners.containsPoint(a))?t.NoOfSegments.Three:i.corners.bottomCenter.y<=n.corners.topCenter.y?t.NoOfSegments.Five:i.corners.topCenter.y>=n.corners.topCenter.y?t.NoOfSegments.Five:void 0!==r&&r.offsetY<=n.corners.topCenter.y||void 0===r&&i.corners.middleRight.y<=n.corners.topCenter.y?t.NoOfSegments.Five:(void 0!==r&&r.offsetY>=n.corners.bottomCenter.y||void 0===r&&(i.corners.middleRight.y,n.corners.bottomCenter.y),t.NoOfSegments.Five)}function en(e,i,n){var o=e.sourcePortWrapper,r=e.targetPortWrapper,s=i.point.x-n.point.x,a=i.point.y-n.point.y;return n.margin={left:10,right:10,top:10,bottom:10},i.margin={left:10,right:10,top:10,bottom:10},i.corners.middleRight.x>=n.corners.middleRight.x?void 0!==o&&(o.offsetY<n.corners.topCenter.y||o.offsetY>n.corners.bottomCenter.y)||void 0===o&&i.corners.middleRight.y<n.corners.topCenter.y?t.NoOfSegments.Three:void 0!==o&&o.offsetY>n.corners.bottomCenter.y+n.margin.bottom&&i.corners.topCenter.y>n.corners.bottomCenter.y||void 0===o&&i.corners.middleRight.y>n.corners.bottomCenter.y?t.NoOfSegments.Three:void 0!==o&&o.offsetY<n.corners.topCenter.y&&i.corners.bottomCenter.y>n.corners.topCenter.y||void 0===o&&i.corners.middleRight.y>n.corners.bottomCenter.y?t.NoOfSegments.Three:i.corners.middleRight.x<n.corners.middleLeft.x||n.corners.middleRight.x<i.corners.middleLeft.x?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three:void 0!==r&&i.corners.bottomCenter.y<r.offsetY||void 0===r&&i.corners.bottomCenter.y<n.corners.middleRight.y?t.NoOfSegments.Three:void 0!==r&&i.corners.topCenter.y>r.offsetY||void 0===r&&i.corners.topCenter.y>n.corners.middleRight.y?t.NoOfSegments.Three:void 0!==r&&(void 0!==o&&o.offsetX<n.corners.middleLeft.x&&o.offsetX!==r.offsetX&&o.offsetY!==r.offsetY&&Math.abs(i.corners.middleRight.x-n.corners.middleLeft.x)<=20||void 0===o&&i.corners.middleRight.x<n.corners.middleLeft.x&&i.corners.center.x!==n.corners.center.x&&i.corners.center.y!==n.corners.center.y)?t.NoOfSegments.Three:i.corners.middleRight.x<n.corners.middleLeft.x?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three}function nn(e,i,n,o){var r=e.targetPortWrapper,s=e.sourcePortWrapper,a={x:Math.max(i.point.x,i.corners.right),y:i.point.y},l={x:n.point.x,y:Math.min(n.point.y,n.corners.top)};if(n.margin={left:5,right:5,top:5,bottom:5},i.margin={top:5,bottom:5,left:5,right:5},o){var h=void 0;h=s,s=r,r=h}return void 0!==s&&s.offsetY<n.corners.topCenter.y-n.margin.top||void 0===s&&i.corners.bottomCenter.y<n.corners.topCenter.y-n.margin.top?i.corners.bottomCenter.y<n.corners.topCenter.y?void 0!==r&&i.corners.middleRight.x+i.margin.right<r.offsetX||void 0===r&&i.corners.middleRight.x+i.margin.right<n.corners.topCenter.x?t.NoOfSegments.Two:t.NoOfSegments.Four:void 0!==r&&i.corners.middleLeft.x>r.offsetX||void 0===r&&i.corners.middleLeft.x>n.corners.topCenter.x?t.NoOfSegments.Four:t.NoOfSegments.Two:void 0!==s&&Math.abs(i.corners.middleRight.x-n.corners.middleLeft.x)<=25&&Math.abs(s.offsetY-n.corners.topCenter.y)<=25?t.NoOfSegments.Two:void 0!==r&&Math.abs(r.offsetX-i.corners.topCenter.x)>=25&&i.corners.middleRight.y<r.offsetY?t.NoOfSegments.Two:i.corners.middleRight.x<n.corners.middleLeft.x?t.NoOfSegments.Four:e.sourceWrapper!==e.targetWrapper&&(i.corners.containsPoint(l)||n.corners.containsPoint(a))?t.NoOfSegments.Two:t.NoOfSegments.Four}function on(e,i,n,o){i.margin={left:10,right:10,top:10,bottom:10},n.margin={left:10,right:10,top:10,bottom:10};var r=e.sourcePortWrapper,s=e.targetPortWrapper;Math.max(i.point.x,i.corners.right),i.point.y,n.point.x,Math.max(n.point.y,n.corners.bottom);if(o){var a=void 0;a=r,r=s,s=a}return void 0!==r&&r.offsetY>n.corners.bottomCenter.y+n.margin.bottom||void 0===r&&i.corners.middleRight.y>n.corners.bottomCenter.y+n.margin.bottom?i.corners.topCenter.y>n.corners.bottomCenter.y?void 0!==s&&i.corners.middleRight.x+i.margin.right<s.offsetX||void 0===s&&i.corners.middleRight.x+i.margin.right<n.corners.bottomCenter.x?t.NoOfSegments.Two:t.NoOfSegments.Four:void 0!==s&&i.corners.middleLeft.x>s.offsetX||void 0===s&&i.corners.middleLeft.x>n.corners.bottomCenter.x?t.NoOfSegments.Four:t.NoOfSegments.Two:void 0!==r&&Math.abs(i.corners.middleRight.x-n.corners.middleLeft.x)<=25&&Math.abs(r.offsetY-n.corners.bottomCenter.y)<=25?t.NoOfSegments.Two:(i.corners.middleRight.x,n.corners.middleLeft.x,t.NoOfSegments.Four)}function rn(e,i){var n=e.point.x-i.point.x,o=(e.point.y,i.point.y,e.point.x,Math.max(e.point.y,e.corners.bottom),i.point.x,Math.min(i.point.y,i.corners.top),10);return e.corners.middleRight.x+o<i.corners.middleLeft.x-o||e.corners.middleLeft.x-o>i.corners.middleRight.x+o||(o=0),e.margin={left:o,right:o,top:o,bottom:o},i.margin={left:o,right:o,top:o,bottom:o},0===n&&e.corners.bottomCenter.y<i.corners.topCenter.y?t.NoOfSegments.One:e.corners.bottomCenter.y+e.margin.bottom<i.corners.topCenter.y-i.margin.top?t.NoOfSegments.Three:e.corners.middleRight.x+e.margin.right<i.corners.middleLeft.x-i.margin.left?t.NoOfSegments.Five:(e.corners.middleLeft.x,e.margin.left,i.corners.middleRight.x,i.margin.right,t.NoOfSegments.Five)}function sn(e,i,n,o){var r=e.sourcePortWrapper,s=e.targetPortWrapper;i.point.x,Math.max(i.point.y,i.corners.bottom),Math.min(n.point.x,n.corners.left),n.point.y;if(o){var a=void 0;a=r,r=s,s=a}return void 0!==r&&r.offsetX<n.corners.middleLeft.x-n.margin.left||void 0===r&&i.corners.bottomCenter.x<n.corners.bottomLeft.x-n.margin.left?i.corners.middleRight.x<n.corners.middleLeft.x?void 0!==s&&i.corners.bottomCenter.y+i.margin.bottom<s.offsetY||void 0===s&&i.corners.bottomCenter.y+i.margin.bottom<n.corners.middleLeft.y?t.NoOfSegments.Two:t.NoOfSegments.Four:void 0!==s&&i.corners.topCenter.y>s.offsetY||void 0===s&&i.corners.topCenter.y>n.corners.middleLeft.y?t.NoOfSegments.Four:t.NoOfSegments.Two:void 0!==s&&Math.abs(i.corners.middleRight.x-n.corners.middleLeft.x)<=25&&Math.abs(s.offsetY-i.corners.bottomCenter.y)<=25?t.NoOfSegments.Two:t.NoOfSegments.Four}function an(e,i,n){var o=e.sourcePortWrapper,r=e.targetPortWrapper,s=Math.round(Math.abs(i.point.x-n.point.x)),a=Math.round(Math.abs(n.point.y-n.point.y));return i.corners.bottomCenter.y<n.corners.bottomCenter.y?void 0!==o&&o.offsetX<n.corners.middleLeft.x-n.margin.left||void 0===o&&i.corners.bottomCenter.x<n.corners.middleLeft.x-n.margin.left?t.NoOfSegments.Three:void 0!==o&&o.offsetX>n.corners.middleRight.x+n.margin.right||void 0===o&&i.corners.bottomCenter.x>n.corners.middleRight.x+n.margin.right?t.NoOfSegments.Three:i.corners.bottomCenter.y<n.corners.topCenter.y?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three:void 0!==r&&i.corners.middleLeft.x>r.offsetX||void 0===r&&i.corners.middleLeft.x>n.corners.middleLeft.x?t.NoOfSegments.Three:void 0!==r&&i.corners.middleRight.x<r.offsetX||void 0===r&&i.corners.middleRight.x<n.corners.middleRight.x?t.NoOfSegments.Three:i.corners.topCenter.y>n.corners.bottomCenter.y?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three}function ln(e,i,n,o){var r=e.sourcePortWrapper,s=e.targetPortWrapper,a={x:Math.min(i.point.x,i.corners.left),y:i.point.y},l={x:n.point.x,y:Math.min(n.point.y,n.corners.top)};if(o){var h=void 0;h=r,r=s,s=h}return void 0!==r&&r.offsetY<n.corners.topCenter.y-n.margin.top||void 0===r&&(i.corners.bottomCenter.y<n.corners.topCenter.y-n.margin.top||i.corners.middleLeft.y<n.corners.topCenter.y-n.margin.top)?i.corners.bottomCenter.y<n.corners.topCenter.y?void 0!==s&&i.corners.middleLeft.x-i.margin.left>s.offsetX||void 0===s&&i.corners.middleLeft.x-i.margin.left>n.corners.topCenter.x?t.NoOfSegments.Two:t.NoOfSegments.Four:void 0!==s&&i.corners.middleRight.x<s.offsetX||void 0===s&&i.corners.middleRight.x<n.corners.topCenter.x?t.NoOfSegments.Four:t.NoOfSegments.Two:void 0!==r&&Math.abs(i.corners.middleLeft.x-n.corners.middleRight.x)<=25&&Math.abs(r.offsetY-n.corners.topCenter.y)<=25?t.NoOfSegments.Two:e.sourceWrapper!==e.targetWrapper&&(i.corners.containsPoint(l)||n.corners.containsPoint(a))?t.NoOfSegments.Two:(i.corners.middleLeft.x,n.corners.middleRight.x,t.NoOfSegments.Four)}function hn(e,i,n){var o=e.sourcePortWrapper,r=e.targetPortWrapper;i.margin={left:10,right:10,top:10,bottom:10},n.margin={left:10,right:10,top:10,bottom:10};var s=Math.round(Math.abs(i.point.x-n.point.x)),a=Math.round(Math.abs(i.point.y-n.point.y));return i.corners.middleLeft.x<n.corners.middleLeft.x?void 0!==r&&i.corners.bottomCenter.y+i.margin.bottom<r.offsetY||void 0===r&&i.corners.bottomCenter.y+i.margin.bottom<n.corners.middleLeft.y?t.NoOfSegments.Three:void 0!==r&&i.corners.topCenter.y-i.margin.top>r.offsetY||void 0===r&&i.corners.topCenter.y-i.margin.top>n.corners.middleLeft.y?t.NoOfSegments.Three:i.corners.middleRight.x<n.corners.middleLeft.x||n.corners.middleRight.x<i.corners.middleLeft.x?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three:void 0!==o&&o.offsetY<n.corners.topCenter.y-n.margin.top||void 0===o&&i.corners.middleLeft.y<n.corners.topCenter.y?t.NoOfSegments.Three:void 0!==o&&o.offsetY>n.corners.bottomCenter.y+n.margin.bottom||void 0===o&&i.corners.middleLeft.y>n.corners.bottomCenter.y+n.margin.bottom?t.NoOfSegments.Three:i.corners.middleLeft.x>n.corners.middleRight.x?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three}function cn(e,i,n){var o=e.sourcePortWrapper,r=e.targetPortWrapper,s=Math.round(Math.abs(i.point.x-n.point.x)),a=Math.round(Math.abs(i.point.y-n.point.y));i.margin={left:10,right:10,top:10,bottom:10};return n.margin={left:10,right:10,top:10,bottom:10},i.corners.topCenter.y<n.corners.topCenter.y?void 0!==r&&i.corners.middleLeft.x>r.offsetX||void 0===r&&i.corners.middleLeft.x>n.corners.middleLeft.x?t.NoOfSegments.Three:void 0!==r&&i.corners.middleRight.x<r.offsetX||void 0===r&&i.corners.middleRight.x<n.corners.middleRight.x?t.NoOfSegments.Three:i.corners.bottomCenter.y<n.corners.topCenter.y?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three:void 0!==o&&o.offsetX>n.corners.middleRight.x||void 0===o&&i.corners.middleLeft.x>n.corners.middleRight.x?t.NoOfSegments.Three:void 0!==o&&o.offsetX<n.corners.middleLeft.x||void 0===o&&i.corners.bottomRight.x<n.corners.middleLeft.x?t.NoOfSegments.Three:i.corners.topCenter.y>n.corners.bottomCenter.y?t.NoOfSegments.Five:0===s||0===a?t.NoOfSegments.One:t.NoOfSegments.Three}function dn(e,i,n,o,r){var s,a=e.sourceWrapper,l=e.targetWrapper,h=e.targetPortWrapper,c=a.corners,d=l.corners;if(void 0!==l&&void 0===h){var p=$i(o.direction,o.point,l);o.point=Gi(e,l,o.point,p,!0)}var u=20;if(!(n.direction===o.direction&&i!==t.NoOfSegments.Five||n.direction!==Pn(o.direction)&&i!==t.NoOfSegments.Three))switch(n.direction){case"Left":c.middleLeft.x>d.middleRight.x&&(u=Math.min(u,(c.middleLeft.x-d.middleRight.x)/2));break;case"Right":c.middleRight.x<d.middleLeft.x&&(u=Math.min(u,(d.middleLeft.x-c.middleRight.x)/2));break;case"Top":c.topCenter.y>d.bottomCenter.y&&(u=Math.min(u,(c.topCenter.y-d.bottomCenter.y)/2));break;case"Bottom":c.bottomCenter.y<d.topCenter.y&&(u=Math.min(u,(d.topCenter.y-c.bottomCenter.y)/2))}switch(n.direction){case"Left":n.point.x>c.middleLeft.x&&(u=n.point.x-c.middleLeft.x>u?n.point.x-c.middleLeft.x+u:u);break;case"Right":n.point.x<c.middleRight.x&&(u=c.middleRight.x-n.point.x>u?c.middleRight.x-n.point.x+u:u);break;case"Top":n.point.y>c.topCenter.y&&(u=n.point.y-c.topCenter.y>u?n.point.y-c.topCenter.y+u:u);break;case"Bottom":n.point.y<c.bottomCenter.y&&(u=c.bottomCenter.y-n.point.y>u?c.bottomCenter.y-n.point.y+u:u)}if(r&&(u=Math.max(u,r)),i===t.NoOfSegments.One&&(s=[n.point,o.point]),i===t.NoOfSegments.Two&&(s=pn(n,o)),i===t.NoOfSegments.Three&&(s=un(e,n,o,u)),i===t.NoOfSegments.Four){s=mn(n,o,void 0,s,u)}return i===t.NoOfSegments.Five&&(s=gn(n,o,u)),s}function pn(t,e){var i;switch(t.direction){case"Left":case"Right":var n={x:e.point.x,y:t.point.y};i=Dl.equals(t.point,n)||Dl.equals(e.point,n)?[t.point,e.point]:[t.point,n,e.point];break;case"Top":case"Bottom":var o={x:t.point.x,y:e.point.y};i=Dl.equals(t.point,o)||Dl.equals(e.point,o)?[t.point,e.point]:[t.point,o,e.point]}return i}function un(t,e,i,n,o){n||(n=20);var r,s,a,l=t.sourcePortWrapper,h=i.point.x-e.point.x,c=i.point.y-e.point.y;if(!o&&(Math.abs(h)<.001||Math.abs(c)<.001)&&void 0===i.direction)return[e.point,i.point];if(void 0===t.targetWrapper&&Math.abs(h)<=31&&Math.abs(c)<=31){if("Left"===e.direction||"Right"===e.direction?Math.abs(c)<12&&(e.direction=e.point.y>i.point.y?"Top":"Bottom"):Math.abs(h)<12&&(e.direction=e.point.x>i.point.x?"Left":"Right"),Math.abs(h)>12||Math.abs(c)>12)return pn(e,i);n+=5}return"Left"===e.direction||"Right"===e.direction?("Right"===e.direction?(void 0!==i.direction&&"Right"===i.direction&&(n=Math.max(e.point.x,i.point.x)-e.point.x+n),e.point.x>i.point.x&&void 0===l&&(n=-n)):(void 0!==i.direction&&"Left"===i.direction&&(n=e.point.x-Math.min(e.point.x,i.point.x)+n),(e.point.x>i.point.x||void 0!==l||"Left"===e.direction)&&(n=-n)),a=i.point.y-e.point.y,r=Yi(e.point,n,0),0!==(a=i.point.y-r.y)&&(s=Yi(r,i.point.y-r.y,90))):"Top"!==e.direction&&"Bottom"!==e.direction||("Bottom"===e.direction?void 0!==i.direction&&"Bottom"===i.direction&&(n=Math.max(e.point.y,i.point.y)-e.point.y+n):(void 0!==i.direction&&"Top"===i.direction&&(n=e.point.y-Math.min(e.point.y,i.point.y)+n),(e.point.y>i.point.y||void 0!==l||"Top"===e.direction)&&(n=-n)),a=i.point.x-e.point.x,r=(e.direction,Yi(e.point,n,90)),0!==(a=i.point.x-r.x)&&(s=Yi(r,i.point.x-r.x,0))),0===a?[e.point,i.point]:[e.point,r,s,i.point]}function gn(t,e,i){void 0===i&&(i=20);var n,o,r=i,s=t.corners.middleLeft.x-t.margin.left,a=t.corners.middleRight.x+t.margin.right,l=t.corners.bottomCenter.y+t.margin.bottom,h=t.corners.topCenter.y-t.margin.top,c=e.corners.middleLeft.x-e.margin.left,d=e.corners.middleRight.x+e.margin.right,p=e.corners.bottomCenter.y+e.margin.bottom,u=e.corners.topCenter.y-e.margin.top;switch(t.direction){case"Left":(h>u&&h<p||l<p&&l>u)&&s>c&&s<=d&&i>=20&&(r=t.point.x-e.corners.middleLeft.x+r),o=Yi(t.point,r,180);break;case"Top":(s>c&&s<d||a<d&&a>c)&&h>u&&h<=p&&i>=20&&(r=t.point.y-e.corners.topCenter.y+r),o=Yi(t.point,r,270);break;case"Right":(h>u&&h<p||l<p&&l>u)&&a<d&&a>=c&&i>=20&&(r=e.corners.middleRight.x-t.point.x+r),o=Yi(t.point,r,0);break;case"Bottom":(s>c&&s<d||a<d&&a>c)&&l<p&&l>=u&&i>=20&&(r=e.corners.bottomCenter.y-t.point.y+r),o=Yi(t.point,r,90)}if(n=[t.point,o],"Top"===t.direction||"Bottom"===t.direction){g=t.direction;t.direction=o.x>e.point.x?"Left":"Right",t.point=o,n=mn(t,e,g,n)}else{var g=t.direction;t.direction=o.y>e.point.y?"Top":"Bottom",t.point=o,n=mn(t,e,g,n)}return n}function mn(t,e,i,n,o){void 0===o&&(o=20);var r;switch(void 0===i?(t.margin={left:2,right:2,top:2,bottom:2},e.margin={left:0,right:5,top:0,bottom:5}):"Bottom"===t.direction?e.corners.top>t.corners.bottom&&e.corners.top-t.corners.bottom<20&&(o=(e.corners.top-t.corners.bottom)/2):"Top"===t.direction?e.corners.bottom<t.corners.top&&t.corners.top-e.corners.bottom<20&&(o=(t.corners.top-e.corners.bottom)/2):"Right"===t.direction?e.corners.left>t.corners.right&&e.corners.left-t.corners.right<20&&(o=(e.corners.left-t.corners.right)/2):"Left"===t.direction&&e.corners.right<t.corners.left&&t.corners.left-e.corners.right<20&&(o=(t.corners.left-e.corners.right)/2),t.direction){case"Left":o=yn(t,e,i,o),r=Yi(t.point,o,180);break;case"Right":o=bn(t,e,o,i),r=Yi(t.point,o,0);break;case"Top":o=vn(t,e,i,o),r=Yi(t.point,o,270);break;case"Bottom":o=wn(t,e,o,i),r=Yi(t.point,o,90)}return void 0!==n?n.push(r):n=[t.point,r],"Top"===t.direction||"Bottom"===t.direction?fn(r,"horizontal",t,e,n):"Right"!==t.direction&&"Left"!==t.direction||fn(r,"vertical",t,e,n),n}function fn(t,e,i,n,o){var r,s,a;"horizontal"===e?(i.margin={left:0,right:10,top:0,bottom:10},n.margin={left:0,right:10,top:0,bottom:10}):"vertical"===e&&(i.margin={left:10,right:0,top:10,bottom:0},n.margin={left:10,right:0,top:10,bottom:0});var l=20;if("horizontal"===e){switch(n.direction){case"Left":if(i.corners.right+i.margin.right<n.corners.left-n.margin.left&&(n.corners.left-i.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){h=Math.min(Math.abs(n.corners.left-i.corners.right)/2,20);l=i.corners.right-t.x+h}else l="Top"===i.direction&&t.y>n.point.y||"Bottom"===i.direction&&t.y<n.point.y?Math.min(n.corners.left,t.x)-t.x-20:t.x>=i.corners.left-i.margin.left&&t.x<=i.corners.right+i.margin.right?Math.min(n.corners.left,i.corners.left)-t.x-20:n.corners.left-t.x-20;break;case"Right":if(i.corners.left-i.margin.left>n.corners.right+n.margin.right&&(i.corners.left-n.corners.right>l||i.corners.top-i.margin.top<=n.point.y&&i.corners.bottom+i.margin.bottom>=n.point.y)){h=Math.min(Math.abs(i.corners.left-n.corners.right)/2,20);l=i.corners.left-t.x-h}else l="Top"===i.direction&&t.y>n.point.y||"Bottom"===i.direction&&t.y<n.point.y?Math.max(n.corners.right,t.x)-t.x+20:t.x>=i.corners.left-i.margin.left&&t.x<=i.corners.right+i.margin.right?Math.max(n.corners.right,i.corners.right)-t.x+20:n.corners.right-t.x+20}s=Yi(r=Yi(t,l,0),n.point.y-t.y,90),a=n.point}else if("vertical"===e){switch(n.direction){case"Top":if(i.corners.bottom+i.margin.bottom<n.corners.top-n.margin.top&&(n.corners.top-i.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){h=Math.min(Math.abs(n.corners.top-i.corners.bottom)/2,20);l=i.corners.bottom-t.y+h}else l="Left"===i.direction&&t.x>n.point.x||"Right"===i.direction&&t.x<n.point.x?Math.min(n.corners.top,t.y)-t.y-20:t.y>=i.corners.top-i.margin.top&&t.y<=i.corners.bottom+i.margin.bottom?Math.min(n.corners.top,i.corners.top)-t.y-20:n.corners.top-t.y-20;break;case"Bottom":if(i.corners.top-i.margin.top>n.corners.bottom+n.margin.bottom&&(i.corners.top-n.corners.bottom>l||i.corners.left-i.margin.left<=n.point.x&&i.corners.right+i.margin.right>=n.point.x)){var h=Math.min(Math.abs(i.corners.top-n.corners.bottom)/2,20);l=i.corners.top-t.y-h}else l="Left"===i.direction&&t.x>n.point.x||"Right"===i.direction&&t.x<n.point.x?Math.max(n.corners.bottom,t.y)-t.y+20:t.y>=i.corners.top-i.margin.top&&t.y<=i.corners.bottom+i.margin.bottom?Math.max(n.corners.bottom,i.corners.bottom)-t.y+20:n.corners.bottom-t.y+20}s=Yi(r=Yi(t,l,90),n.point.x-t.x,0),a=n.point}o.push(r),o.push(s),o.push(a)}function vn(t,e,i,n){return t.corners.top-t.margin.top>e.corners.top+e.margin.top&&t.corners.top-t.margin.top<=e.corners.bottom+e.margin.bottom?("Right"===e.direction&&t.point.x<e.point.x?n+=t.corners.top-e.corners.top:"Left"===e.direction&&t.point.x>e.point.x&&(n+=t.corners.top-e.corners.top),n+=t.point.y-t.corners.top):void 0!==i&&"Left"!==i&&"Right"===e.direction&&t.point.x<e.point.x?n+=Math.abs(t.point.y-e.corners.bottom):void 0!==i&&"Right"!==i&&"Left"===e.direction&&e.point.x<t.point.x?n+=Math.abs(t.point.y-e.corners.bottom):n+=t.point.y-t.corners.top,n}function yn(t,e,i,n){return t.corners.left-t.margin.left>e.corners.left-e.margin.left&&t.corners.left-t.margin.left<=e.corners.right+e.margin.right?("Bottom"===e.direction&&t.point.y<e.point.y?n+=t.corners.left-e.corners.left:"Top"===e.direction&&t.point.y>e.point.y&&(n+=t.corners.left-e.corners.left),n+=t.point.x-t.corners.left):void 0!==i&&"Top"!==i&&"Bottom"===e.direction&&t.point.y<e.point.y?n+=Math.abs(t.point.x-e.corners.right):void 0!==i&&"Bottom"!==i&&"Top"===e.direction&&e.point.y<t.point.y?n+=Math.abs(t.point.x-e.corners.right):n+=t.point.x-t.corners.left,n}function bn(t,e,i,n){return t.corners.right+t.margin.right<e.corners.right+e.margin.right&&t.corners.right+t.margin.right>=e.corners.left-e.margin.left?("Bottom"===e.direction&&t.point.y<e.point.y?i+=e.corners.right-t.corners.right:"Top"===e.direction&&t.point.y>e.point.y&&(i+=e.corners.right-t.corners.right),i+=t.corners.right-t.point.x):void 0!==n&&"Top"!==n&&"Bottom"===e.direction&&t.point.y<e.point.y?i+=Math.abs(t.point.x-e.corners.right):void 0!==n&&"Bottom"!==n&&"Top"===e.direction&&e.point.y<t.point.y?i+=Math.abs(t.point.x-e.corners.right):i+=t.corners.right-t.point.x,i}function wn(t,e,i,n){return t.corners.bottom+t.margin.bottom<e.corners.bottom+e.margin.bottom&&t.corners.bottom+t.margin.bottom>=e.corners.top-e.margin.top?("Right"===e.direction&&t.point.x<e.point.x?i+=e.corners.bottom-t.corners.bottom:"Left"===e.direction&&t.point.x>e.point.x&&(i+=e.corners.bottom-t.corners.bottom),i+=t.corners.bottom-t.point.y):void 0!==n&&"Left"!==n&&"Right"===e.direction&&t.point.x<e.point.x?i+=Math.abs(t.point.y-e.corners.bottom):void 0!==n&&"Right"!==n&&"Left"===e.direction&&e.point.x<t.point.x?i+=Math.abs(t.point.y-e.corners.bottom):i+=t.corners.bottom-t.point.y,i}function xn(t,e){var i=!1;switch(t){case"Left":switch(e){case"Right":case"Bottom":i=!0}break;case"Top":switch(e){case"Left":case"Right":case"Bottom":i=!0}break;case"Bottom":switch(e){case"Right":i=!0}}return i}function Cn(t,e){var i=t.direction;t.direction=e.direction,e.direction=i;var n=t.point;t.point=e.point,e.point=n;var o=t.corners;t.corners=e.corners,e.corners=o}function Sn(t,e,i,n){var o=void 0===e?i:e,r=o.topLeft,s=o.topRight,a=o.bottomRight,l=o.bottomLeft,h=o.center,c=Ui(h,t),d=Ui(h,a),p=Ui(h,l),u=Ui(h,r),g=Ui(h,s);return c>u&&c<g?"Top":c>=d&&c<p?"Bottom":c>=p&&c<=u?"Left":"Right"}function En(t){var e;return e=t.wrapper.children[0].bounds,"None"!==t.sourceDecorator.shape&&e.uniteRect(t.wrapper.children[1].bounds),"None"!==t.targetDecorator.shape&&e.uniteRect(t.wrapper.children[2].bounds),e}function Pn(t){switch(t){case"Top":return"Bottom";case"Bottom":return"Top";case"Left":return"Right";case"Right":return"Left"}return"auto"}function Ln(t,e,i){var n=t.center,o=i?45:180/(2+2/(t.height/t.width)),r=o,s=180-o,a=s+2*o,l=360-o,h=Ui(e,n);return h>r&&h<s?"top":h>s&&h<a?"right":h>a&&h<l?"bottom":"left"}function Tn(t){return!t.distance&&!t.angle}function kn(t,e,i){var n=60,o={x:0,y:0};switch(i||(i=Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?t.x<e.x?"right":"left":t.y<e.y?"bottom":"top"),i){case"bottom":case"top":n=Math.min(.45*Math.abs(t.y-e.y),n),o={x:t.x,y:t.y+("bottom"===i?n:-n)};break;case"right":case"left":n=Math.min(.45*Math.abs(t.x-e.x),n),o={x:t.x+("right"===i?n:-n),y:t.y}}return o}function On(t,e,i,n,o){var r=0,s=0,a=0,l=0,h=Number((o.distance(e,t)+o.distance(i,e)+o.distance(n,i))/3);if(0!==h)for(var c=0;c<=h;c++){var d=c/h,p=(1-d)*(1-d)*(1-d)*t.x+3*d*(1-d)*(1-d)*e.x+3*d*d*(1-d)*i.x+d*d*d*n.x,u=(1-d)*(1-d)*(1-d)*t.y+3*d*(1-d)*(1-d)*e.y+3*d*d*(1-d)*i.y+d*d*d*n.y;0===c?(r=a=p,s=l=u):(r=Math.min(p,r),s=Math.min(u,s),a=Math.max(p,a),l=Math.max(u,l))}return{x:r,y:s,width:a-r,height:l-s,left:r,top:s,right:r+(a-r),bottom:s+(l-s),center:{x:(r+(a-r))/2,y:(s+(l-s))/2}}}function An(t,e,i,n,o,r,s){var a={x:0,y:0},l=r/s,h=(1-l)*(1-l)*(1-l)*e.x+3*l*(1-l)*(1-l)*i.x+3*l*l*(1-l)*n.x+l*l*l*o.x;a.x=h;var c=(1-l)*(1-l)*(1-l)*e.y+3*l*(1-l)*(1-l)*i.y+3*l*l*(1-l)*n.y+l*l*l*o.y;return a.y=c,a}function Mn(e){if(e){return e instanceof _c?e.constraints&t.ConnectorConstraints.Select:e.constraints&t.NodeConstraints.Select}return 1}function In(e){if(e){return e instanceof _c?e.constraints&t.ConnectorConstraints.Drag:e instanceof Xc?1:e.constraints&t.NodeConstraints.Drag}return 1}function Dn(e,i){return e instanceof _c?e.constraints&t.ConnectorConstraints.PointerEvents:e.constraints&t.NodeConstraints.PointerEvents}function Rn(e){return e instanceof _c?e.constraints&t.ConnectorConstraints.Delete:e.constraints&t.NodeConstraints.Delete}function Nn(e,i){return e.constraints&t.ConnectorConstraints.Bridging?e.constraints&t.ConnectorConstraints.Bridging:e.constraints&t.ConnectorConstraints.InheritBridging?i.constraints&t.DiagramConstraints.Bridging:0}function Bn(e){return e.constraints&t.ConnectorConstraints.DragSourceEnd}function Hn(e){return e.constraints&t.ConnectorConstraints.DragTargetEnd}function zn(e){return e.constraints&t.ConnectorConstraints.DragSegmentThumb}function jn(e){return e.constraints&t.NodeConstraints.Rotate}function Fn(e){return e.constraints&t.NodeConstraints.Shadow}function Vn(e){return e instanceof fd&&e.constraints&t.NodeConstraints.InConnect?e.constraints&t.NodeConstraints.InConnect:0}function _n(e){return e instanceof fd&&e.constraints&t.NodeConstraints.OutConnect?e.constraints&t.NodeConstraints.OutConnect:0}function Wn(e,i){var n=0;return e&&("SouthEast"===i?n=e.constraints&t.NodeConstraints.ResizeSouthEast:"East"===i?n=e.constraints&t.NodeConstraints.ResizeEast:"NorthEast"===i?n=e.constraints&t.NodeConstraints.ResizeNorthEast:"South"===i?n=e.constraints&t.NodeConstraints.ResizeSouth:"North"===i?n=e.constraints&t.NodeConstraints.ResizeNorth:"SouthWest"===i?n=e.constraints&t.NodeConstraints.ResizeSouthWest:"West"===i?n=e.constraints&t.NodeConstraints.ResizeWest:"NorthWest"===i&&(n=e.constraints&t.NodeConstraints.ResizeNorthWest)),n}function Un(e){return e instanceof _c?e.constraints&t.ConnectorConstraints.AllowDrop:e.constraints&t.NodeConstraints.AllowDrop}function qn(e,i){var n=0;return e instanceof _c?e.constraints&t.ConnectorConstraints.Tooltip?n=e.constraints&t.ConnectorConstraints.Tooltip:e.constraints&t.ConnectorConstraints.InheritTooltip&&(n=i.constraints&t.DiagramConstraints.Tooltip):e.constraints&t.NodeConstraints.Tooltip?n=e.constraints&t.NodeConstraints.Tooltip:e.constraints&t.NodeConstraints.InheritTooltip&&(n=i.constraints&t.DiagramConstraints.Tooltip),n}function Xn(e){return e.tool&t.DiagramTools.SingleSelect}function Yn(e){return e.tool&t.DiagramTools.MultipleSelect}function Gn(e){return e.tool&t.DiagramTools.ZoomPan}function Zn(e){return e.tool&t.DiagramTools.ContinuousDraw}function Kn(e){return e.tool&t.DiagramTools.DrawOnce}function Qn(e){return e.tool&t.DiagramTools.SingleSelect||e.tool&t.DiagramTools.MultipleSelect}function Jn(e){return e.constraints&t.DiagramConstraints.Zoom}function $n(e){return e.constraints&t.DiagramConstraints.Pan}function to(e){return e.constraints&t.DiagramConstraints.UserInteraction}function eo(e){return e.constraints&t.DiagramConstraints.ApiUpdate}function io(e){return e.constraints&t.DiagramConstraints.PanX}function no(e){return e.constraints&t.DiagramConstraints.PanY}function oo(e){return eo(e)||e.diagramActions&t.DiagramAction.ToolAction}function ro(e,i){var n=0;return n=i instanceof _c?t.ConnectorConstraints.ReadOnly:t.NodeConstraints.ReadOnly,"Text"===i.shape.type?i.constraints&t.NodeConstraints.ReadOnly:i.constraints&n?e.constraints&t.AnnotationConstraints.InheritReadOnly?1:0:e.constraints&t.AnnotationConstraints.ReadOnly?1:0}function so(e,i){return e.constraints&t.PortConstraints.Draw}function ao(e,i){return e.constraints&t.PortConstraints.Drag}function lo(t){var e=uo(t),i=Rr("div",{id:t.element.id+"_overlapRuler",style:"height:"+e.height+"px;width:"+e.width+"px;position:absolute;left:0;top:0",class:"e-ruler-overlap"});t.element.insertBefore(i,t.element.firstChild)}function ho(t,e){var i=document.getElementById(t.element.id+(e?"_hRuler":"_vRuler")),n=uo(t),o=go(t),r=e?"margin-left:"+n.width+"px;":"margin-top:"+n.height+"px;";if(!i){var s="height:"+(e?n.height:o.height+100)+"px;overflow:hidden;width:"+(e?o.width+100:n.width)+"px;position:absolute;font-size:11px;"+r;i=Rr("div",{id:t.element.id+(e?"_hRuler":"_vRuler"),style:s})}t.element.insertBefore(i,t.element.firstChild);var a=e?t.rulerSettings.horizontalRuler:t.rulerSettings.verticalRuler,l=new bd(a);l.orientation=e?"Horizontal":"Vertical",l.length=(e?o.width:o.height)+a.segmentWidth,l.appendTo("#"+t.element.id+(e?"_hRuler":"_vRuler")),e?t.hRuler=l:t.vRuler=l;var h=document.getElementById(t.element.id+(e?"_hRuler":"_vRuler"));e?t.hRuler.element=h:t.vRuler.element=h}function co(t){var e=-t.scroller.horizontalOffset,i=-t.scroller.verticalOffset;t&&t.rulerSettings.showRulers?(t.hRuler.length=0,t.vRuler.length=0,void 0!==e&&t.hRuler.element&&vo(t,t.hRuler,e,!0),void 0!==i&&t.vRuler.element&&vo(t,t.vRuler,i,!1)):po(t)}function po(t){Fr(t.element.id+"_hRuler"),Fr(t.element.id+"_vRuler"),Fr(t.element.id+"_overlapRuler")}function uo(t){var e=0,i=0;return t.rulerSettings.showRulers&&(e=t.rulerSettings.horizontalRuler.thickness,i=t.rulerSettings.verticalRuler.thickness),new Al(i,e)}function go(t){var e=uo(t),i=t.scroller.viewPortHeight,n=t.scroller.viewPortWidth;return n<t.element.clientWidth-e.width&&(n=t.element.clientWidth-e.width),i<t.element.clientHeight-e.height&&(i=t.element.clientHeight-e.height),t.hRuler&&t.hRuler.length&&(n=t.hRuler.length),t.vRuler&&t.vRuler.length&&(i=t.vRuler.length),new Al(n,i)}function mo(){var t,e,i=document.getElementsByClassName("e-d-ruler-marker");if(i&&i.length>0)for(e=i.length-1;e>=0;e--)(t=i[e])&&t.parentNode.removeChild(t)}function fo(t,e){t.rulerSettings.showRulers&&(t.hRuler.drawRulerMarker(t.hRuler.element,e,t.scroller.horizontalOffset),t.vRuler.drawRulerMarker(t.vRuler.element,e,t.scroller.verticalOffset))}function vo(t,e,i,n){var o=uo(t),r=go(t),s=n?t.rulerSettings.horizontalRuler:t.rulerSettings.verticalRuler;bo(t,r,n),yo(t,r,n),e.offset=i,e.scale=t.scroller.currentZoom,e.length=r.width+100,e.arrangeTick=as(s.arrangeTick),e.dataBind();var a=n?t.hRuler.element:t.vRuler.element;n?a.style.marginLeft=o.width-e.hRulerOffset+"px":a.style.marginTop=o.height-e.vRulerOffset+"px"}function yo(t,e,i){var n=document.getElementById(t.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space")),o=i?t.hRuler:t.vRuler;n&&t&&e&&(n.style.width=(i?e.width+2*o.segmentWidth:o.thickness)+"px",n.style.height=(i?o.thickness:e.height+2*o.segmentWidth)+"px")}function bo(t,e,i){var n=document.getElementById(t.element.id+(i?"_hRuler":"_vRuler")),o=i?t.hRuler:t.vRuler;n&&t&&e&&(n.style.width=(i?e.width+o.segmentWidth:o.thickness)+"px",n.style.height=(i?o.thickness:e.height+o.segmentWidth)+"px",(n=document.getElementById(t.element.id+"_overlapRuler"))&&(i?n.style.height=o.thickness+"px":n.style.width=o.thickness+"px"))}function wo(t,e){for(var i=[],n=0;n<e.length;n++){var o=e[n];t.containsRect(o.wrapper.bounds)&&i.push(o)}return i}function xo(t){var e;return t&&(t.type?e="Connector":t.shape&&!t.type&&(e="Node")),e}function Co(t,e,i){var n;n=Dl.findLength(e,t)>Dl.findLength(i,t)?i:e;var o=Dl.findAngle(e,i),r=Dl.findAngle(n,t),s=Dl.findLength(n,t),a=r+2*(o-r);return{x:n.x+s*Math.cos(a*Math.PI/180),y:n.y+s*Math.sin(a*Math.PI/180)}}function So(t){var e=[];if("Bezier"===t.type)for(var i=0,n=0;n<t.segments.length;n++)for(var o=t.segments[n],r=Dl.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,s=Dl.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2,a=Number((t.distance(r,o.points[0])+t.distance(s,r)+t.distance(o.points[1],s))/1.5),l=0;l<a-1;l+=10)e[i]=An(t,o.points[0],Dl.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,Dl.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2,o.points[1],l,a),i++;return e}function Eo(t,e){var i;i="Bezier"===t.type?So(t):t.intermediatePoints;for(var n=0;n<i.length-1;n++){var o=i[n],r=i[n+1],s=Rl.toBounds([o,r]);if(s.Inflate(t.hitPadding),s.containsPoint(e)){var a=Co(e,o,r),l=Po({X1:o.x,X2:r.x,Y1:o.y,Y2:r.y},{X1:e.x,X2:a.x,Y1:e.y,Y2:a.y});if(l.enabled){var h=Dl.findLength(e,l.intersectPt);if(Math.abs(h)<t.hitPadding)return!0}else{var c=Rl.toBounds([e,e]);if(c.Inflate(3),c.containsPoint(o)||c.containsPoint(r))return!0}if(Dl.equals(e,a))return!0}}return!1}function Po(t,e){var i={x:0,y:0},n=t,o=e,r=(o.Y2-o.Y1)*(n.X2-n.X1)-(o.X2-o.X1)*(n.Y2-n.Y1),s=(o.X2-o.X1)*(n.Y1-o.Y1)-(o.Y2-o.Y1)*(n.X1-o.X1),a=(n.X2-n.X1)*(n.Y1-o.Y1)-(n.Y2-n.Y1)*(n.X1-o.X1);if(0===r)return{enabled:!1,intersectPt:i};var l=s/r,h=a/r;return l>=0&&l<=1&&h>=0&&h<=1?(i.x=n.X1+l*(n.X2-n.X1),i.y=n.Y1+l*(n.Y2-n.Y1),{enabled:!0,intersectPt:i}):{enabled:!1,intersectPt:i}}function Lo(t,e){var i=[],n=e.topLeft,o=e.topRight,r=e.bottomRight,s=e.bottomLeft;if(0!==t.rotateAngle||0!==t.parentTransform){var a=Et();Tt(a,t.rotateAngle+t.parentTransform,t.offsetX,t.offsetY),n=Pt(a,n),o=Pt(a,o),r=Pt(a,r),s=Pt(a,s)}return i.push(n),i.push(o),i.push(r),i.push(s),i}function To(e,i,n){var o,r=n instanceof fd?n.constraints&t.NodeConstraints.InheritTooltip:n.constraints&t.ConnectorConstraints.InheritTooltip,s=n instanceof fd?n.constraints&t.NodeConstraints.Tooltip:n.constraints&t.ConnectorConstraints.Tooltip;o=ko(n,i,e,"Mouse"===(!r&&s?n.tooltip.relativeMode:e.tooltip.relativeMode));var a=uo(e);return{x:o.x+a.width,y:o.y+a.height}}function ko(t,e,i,n){var o={},r=(i.scroller.transform.scale,document.getElementById(i.element.id)),s=t.wrapper.outerBounds,a=r.getBoundingClientRect();i.scroller.horizontalOffset,i.scroller.verticalOffset;switch(i.tooltipObject.position){case"BottomCenter":o=Oo(e,s.bottomCenter,i,n,a.width/2,a.height);break;case"BottomLeft":case"LeftBottom":o=Oo(e,s.bottomLeft,i,n,0,a.height);break;case"BottomRight":case"RightBottom":o=Oo(e,s.bottomRight,i,n,a.width,a.height);break;case"LeftCenter":o=Oo(e,s.middleLeft,i,n,0,a.height/2);break;case"LeftTop":case"TopLeft":o=Oo(e,s.topLeft,i,n,0,0);break;case"RightCenter":o=Oo(e,s.middleRight,i,n,a.width,a.height/2);break;case"RightTop":case"TopRight":o=Oo(e,s.topRight,i,n,a.width,0);break;case"TopCenter":o=Oo(e,s.topCenter,i,n,a.width/2,0)}return o}function Oo(t,e,i,n,o,r){var s={},a=i.scroller.transform.scale,l=i.scroller.horizontalOffset,h=i.scroller.verticalOffset;return s.x=(n?t.x:e.x)*a+l-o,s.y=(n?t.y:e.y)*a+h-r,s}function Ao(t){var e,i=0,n=0;for(i=0;i<t.length;i++){var o=Xr(t[i].wrapper);for(n=i;n<t.length;n++){var r=Xr(t[n].wrapper);o.center.x>r.center.x&&(e=t[i],t[i]=t[n],t[n]=e)}}return t}function Mo(t,e,i){var n,o,r;o=Io(t,e,i),n=Dl.findAngle(t[o.index],t[o.index+1]);var s=Do(e);return r=Dl.transform(o.point,n+45,s),o.point=r,o.angle=n,o}function Io(t,e,i){for(var n,o,r,s,a,l=0,h=e.offset,c=[],d=0;d<t.length-1;d++)l+=Dl.distancePoints(t[d],t[d+1]),c.push(l);r=h*l;for(var p=0;p<c.length;p++){if(c[p]>=r)return o=Dl.findAngle(t[p],t[p+1]),n=Dl.transform(t[p],o,r-(s||0)),a=p,{point:n,index:a};s=c[p]}return{point:n,index:a}}function Do(t){var e=void 0===t.content?10:0,i=0;switch(t.alignment){case"Center":i=0;break;case"Before":i=-(0+e);break;case"After":i=0+e}return i}function Ro(t,e,i){e%=360;var n,o;switch(t.alignment){case"Before":e>=45&&e<=135?(o="right",n=.5===t.offset?"center":"top"):e>=225&&e<=315?(o="left",n=.5===t.offset?"center":"bottom"):e>45&&e<225?(n="top",o=.5===t.offset?"center":"right"):(n="bottom",o=.5===t.offset?"center":"left");break;case"After":e>=45&&e<=135?(o="left",n=.5===t.offset?"center":"top"):e>=225&&e<=315?(o="right",n=.5===t.offset?"center":"bottom"):e>45&&e<225?(n="bottom",o=.5===t.offset?"center":"right"):(n="top",o=.5===t.offset?"center":"left");break;case"Center":o="center",n="center"}if(0===t.offset||1===t.offset){switch(No(i[0],i[1])){case"left":o=0===t.offset?"right":"left";break;case"right":o=0===t.offset?"left":"right";break;case"bottom":n=0===t.offset?"top":"bottom";break;case"top":n=0===t.offset?"bottom":"top"}}return{hAlign:o,vAlign:n}}function No(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?t.x<e.x?"right":"left":t.y<e.y?"bottom":"top"}function Bo(t){var e=Yr(t,t.getCustomProperty);return JSON.stringify(e)}function Ho(t,e){e.clear(),e.protectPropertyChange(!0);for(var i=e.dataSourceSettings.doBinding,n=e.setNodeTemplate,o=e.getDescription,r=e.getCustomProperty,s={},a=0,l=e.commandManager.commands;a<l.length;a++){var h=l[a];s[h.name]={execute:h.execute,canExecute:h.canExecute}}var c=e.rulerSettings.horizontalRuler.arrangeTick,d=e.rulerSettings.verticalRuler.arrangeTick,p=e.layout.getLayoutInfo,u=e.layout.getBranch,g=e.getNodeDefaults,m=e.getConnectorDefaults,f=JSON.parse(t);e.contextMenuSettings=f.contextMenuSettings,e.constraints=f.constraints,e.tool=f.tool,e.bridgeDirection=f.bridgeDirection,e.pageSettings=f.pageSettings,e.drawingObject=f.drawingObject,e.tooltip=f.tooltip,e.addInfo=f.addInfo,e.getDescription=o,e.scrollSettings=f.scrollSettings,e.commandManager=f.commandManager,e.layers=f.layers,e.rulerSettings.horizontalRuler.arrangeTick=c,e.rulerSettings.verticalRuler.arrangeTick=d;for(var v=0,y=e.commandManager.commands;v<y.length;v++){var b=y[v];s[b.name]&&(b.execute=s[b.name].execute,b.canExecute=s[b.name].canExecute)}e.backgroundColor=f.backgroundColor,e.basicElements=f.basicElements,e.connectors=f.connectors,e.dataSourceSettings=f.dataSourceSettings,e.dataSourceSettings.doBinding=i,e.height=f.height,e.setNodeTemplate=n,e.getConnectorDefaults=m,e.getNodeDefaults=g,e.getCustomProperty=r,e.mode=f.mode,e.nodes=f.nodes,e.rulerSettings=f.rulerSettings,e.snapSettings=f.snapSettings,e.width=f.width,e.layout=f.layout,e.layout.getLayoutInfo=as(p),e.layout.getBranch=as(u),e.diagramActions=0,e.isLoading=!0,e.protectPropertyChange(!1);for(var w,x=0;x<e.views.length;x++)(w=e.views[e.views[x]]).refresh(),w instanceof Ep&&e.element.classList.add("e-diagram");var C=zo(f.selectedItems.nodes,e.nodes),S=zo(f.selectedItems.connectors,e.connectors),E=[];return E=E.concat(C).concat(S),e.select(E),f}function zo(t,e){for(var i=[],n=0;n<t.length;n++)for(var o=0,r=e;o<r.length;o++){var s=r[o];s.id===t[n].id&&i.push(s)}return i}function jo(t,e){for(var i=e.style,n=e,o=0,r=Object.keys(t);o<r.length;o++)switch(r[o]){case"fill":i.fill=t.fill,i instanceof eh&&(i.fill="transparent");break;case"textOverflow":i.textOverflow=t.textOverflow;break;case"opacity":i.opacity=t.opacity;break;case"strokeColor":i.strokeColor=t.strokeColor;break;case"strokeDashArray":i.strokeDashArray=t.strokeDashArray;break;case"strokeWidth":i.strokeWidth=t.strokeWidth;break;case"bold":i.bold=t.bold;break;case"color":i.color=t.color;break;case"textWrapping":i.textWrapping=t.textWrapping;break;case"fontFamily":i.fontFamily=t.fontFamily;break;case"fontSize":i.fontSize=t.fontSize;break;case"italic":i.italic=t.italic;break;case"textAlign":i.textAlign=t.textAlign;break;case"whiteSpace":i.whiteSpace=t.whiteSpace;break;case"textDecoration":i.textDecoration=t.textDecoration;break;case"gradient":i.gradient=t.gradient}e instanceof ch&&n.refreshTextElement()}function Fo(t,e,i){for(var n=e,o=n.hyperlink,r=0,s=Object.keys(t);r<s.length;r++)switch(s[r]){case"color":n.style.color=o.color=t.color;break;case"content":n.content=o.content=t.content||o.link;break;case"link":var a=i.style;n.style.color=t.link?o.color:a.color,n.style.textDecoration=t.link?o.textDecoration:i.style.textDecoration,n.content=t.link?o.content||t.link:i.content,o.link=t.link;break;case"textDecoration":n.style.textDecoration=o.textDecoration=t.textDecoration}}function Vo(t,e,i){t.width=e.width,t.height=e.height,t.minHeight=e.minHeight,t.maxHeight=e.maxHeight,t.minWidth=e.minWidth,t.maxWidth=e.maxWidth,t.horizontalAlignment=e.wrapper.children[0].horizontalAlignment,t.verticalAlignment=e.wrapper.children[0].verticalAlignment,t.relativeMode=e.wrapper.children[0].relativeMode,t.visible=e.wrapper.children[0].visible,e.shape instanceof Text&&(t.margin=e.shape.margin),t.id=e.wrapper.children[0].id,t.style=e.style;for(var n=0,o=i.views;n<o.length;n++){var r=o[n];Fr(e.id+"_groupElement",r),Fr(e.id+"_content_groupElement",r),Fr(e.id+"_content_html_element",r)}e.wrapper.children.splice(0,1),e.wrapper.children.splice(0,0,t)}function _o(t,e,i,n){var o=new Wl;switch(t.shape.type){case"Path":var r=new sh;r.data=e.shape.data,Vo(o=r,e,n);break;case"Image":var s=new ph;s.source=e.shape.source,s.imageAlign=e.shape.align,s.imageScale=e.shape.scale,Vo(o=s,e,n);break;case"Text":Vo(o=new ch,e,n);break;case"Basic":var a=void 0;a="Rectangle"===e.shape.shape?new Wl:new sh,"Polygon"===e.shape.shape?a.data=ft(e.shape.points):a.data=Bt(e.shape.shape),Vo(o,e,n),"Rectangle"===e.shape.shape&&(a.cornerRadius=e.shape.cornerRadius),o=a;break;case"Flow":var l=new sh;l.data=Ft(e.shape.shape),Vo(o=l,e,n);break;case"Native":var h=new lh(t.id,n.element.id);h.content=e.shape.content,h.scale=e.shape.scale,Vo(o=h,e,n);break;case"HTML":var c=new Gc(t.id,n.element.id);c.content=e.shape.content,Vo(o=c,e,n)}void 0===t.shape.type||t.shape.type===i.shape.type?Wo(t,e):(o.width=e.wrapper.children[0].width,o.height=e.wrapper.children[0].height,e.shape instanceof Text&&(o.margin=e.shape.margin),o.style=e.style,e.wrapper.children[0]=o)}function Wo(t,e){if(Object.keys(t.shape).length>0)if("Path"===e.shape.type&&void 0!==t.shape.data)e.wrapper.children[0].data=t.shape.data;else if("Text"===e.shape.type&&void 0!==t.shape.content)e.wrapper.children[0].content=t.shape.content;else if("Image"===e.shape.type&&void 0!==t.shape.source)e.wrapper.children[0].source=t.shape.source;else if("Native"===e.shape.type){var i=document.getElementById(e.wrapper.children[0].id+"_groupElement");void 0!==t.shape.content&&i&&(i.removeChild(i.children[0]),e.wrapper.children[0].content=t.shape.content,i.appendChild(Vr(e.wrapper.children[0],!1))),e.wrapper.children[0].scale=t.shape.scale?t.shape.scale:e.wrapper.children[0].scale}else if("HTML"===e.shape.type){var n=document.getElementById(e.wrapper.children[0].id+"_html_element");n&&(n.removeChild(n.children[0]),e.wrapper.children[0].content=t.shape.content,n.appendChild(Vr(e.wrapper.children[0],!0)))}else if("Flow"===e.shape.type&&void 0!==t.shape.shape){e.shape.shape=t.shape.shape;var o=Ft((r=e.shape.shape).toString());e.wrapper.children[0].data=o}else if(void 0!==t.shape.cornerRadius)e.wrapper.children[0].cornerRadius=t.shape.cornerRadius;else if(void 0!==t.shape.shape){e.shape.shape=t.shape.shape;var r=e.shape.shape,s=Bt(r.toString());e.wrapper.children[0].data=s}}function Uo(t,e){var i=t.indexOf(e);i>=0&&t.splice(i,1)}function qo(t,e){var i,n,o;if(t.intermediatePoints=e,t.updateSegmentElement(t,e,t.wrapper.children[0]),t.sourcePoint,n=t.sourceDecorator,"Bezier"===t.type){var r=t.segments[0],s=t.segments[t.segments.length-1];i=[Dl.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,Dl.isEmptyPoint(r.point1)?r.bezierPoint1:r.point1]}else i=t.intermediatePoints;e=t.clipDecorators(t,e);var a=t.wrapper.children[1];t.updateDecoratorElement(a,e[0],i[1],n),t.targetPoint,o=t.targetDecorator,a=t.wrapper.children[2],t.updateDecoratorElement(a,e[e.length-1],i[i.length-2],o),t.updateShapeElement(t)}function Xo(t,e,i){var n,o=t.wrapper,r=o.bounds,s=e.offset,a=e.size/i.scale,l=e.margin,h=o.offsetX-o.actualSize.width*o.pivot.x,c=o.offsetY-o.actualSize.height*o.pivot.y;if(n={x:0,y:0},t.nodes.length>0){switch(e.side){case"Top":n.x+=h+r.width*s,n.y+=c-a;break;case"Bottom":n.x+=h+s*r.width,n.y+=c+o.actualSize.height+a;break;case"Left":n.x+=h-a,n.y+=c+s*r.height;break;case"Right":n.x+=h+o.actualSize.width+a,n.y+=c+s*r.height}n.x+=l.left-l.right+a/2*("Center"===e.horizontalAlignment?0:"Right"===e.horizontalAlignment?-1:1),n.y+=l.top-l.bottom+a/2*("Center"===e.verticalAlignment?0:"Top"===e.verticalAlignment?-1:1)}else if(t.connectors.length>0){var d=t.connectors[0],p={offset:s},u=Io(d.intermediatePoints,p,r),g=u.index;n=u.point;var m=Mo(d.intermediatePoints,p,r),f=(d.intermediatePoints,m.angle);Tt(v=Et(),-f,d.intermediatePoints[g].x,d.intermediatePoints[g].y),(n=Pt(v,n)).x+=l.left-l.right+a/2*("Center"===e.horizontalAlignment?0:"Right"===e.horizontalAlignment?-1:1),n.y+=l.top-l.bottom+a/2*("Center"===e.verticalAlignment?0:"Top"===e.verticalAlignment?-1:1),Tt(v=Et(),f,d.intermediatePoints[g].x,d.intermediatePoints[g].y),n=Pt(v,n)}if(0!==o.rotateAngle||0!==o.parentTransform){var v=Et();Tt(v,o.rotateAngle+o.parentTransform,o.offsetX,o.offsetY),n=Pt(v,n)}return n}function Yo(e,i,n){return!!(t.SelectorConstraints[i]&e&&t.ThumbsConstraints[i]&n)}function Go(e,i){return!!(t.SelectorConstraints[i]&e)}function Zo(t,e){return t.visibility&e}function Ko(t,e){var i;if("Text"===t.shape.type)i=t.shape;else{var n=e.split("_");e=n[n.length-1];for(var o=0;o<t.annotations.length;o++)e===t.annotations[o].id&&(i=t.annotations[o])}return i}function Qo(t,e){for(var i=0;i<t.ports.length;i++)if(t.ports[i].id===e)return i.toString();return null}function Jo(t,e){var i;for(i=0;i<t.length;i++)if(e===t[i].id)return!0;return!1}function $o(t,e,i,n){if(void 0!==t.width&&void 0!==t.height&&(t.width*=e,t.height*=i),t instanceof oh){var o=Et(),r=n.width||n.actualSize.width,s=n.height||n.actualSize.height;if(void 0!==r&&void 0!==s){var a=n.offsetX-r*n.pivot.x,l=n.offsetY-s*n.pivot.y,h={x:a+r*n.pivot.x,y:l+s*n.pivot.y};h=rs(n.rotateAngle,n.offsetX,n.offsetY,h),Tt(o,-n.rotateAngle,h.x,h.y),kt(o,e,i,h.x,h.y),Tt(o,n.rotateAngle,h.x,h.y);for(var c=0,d=t.children;c<d.length;c++){var p=d[c];if(void 0!==p.width&&void 0!==p.height){var u=Pt(o,{x:p.offsetX,y:p.offsetY});p.offsetX=u.x,p.offsetY=u.y,$o(p,e,i,n)}}}}}function tr(t,e,i){if(0===i.length)i.push(t);else if(1===i.length)i[0][e]>t[e]?i.splice(0,0,t):i.push(t);else if(i.length>1){for(var n=0,o=i.length-1,r=Math.floor((n+o)/2);r!==n;)i[r][e]<t[e]?(n=r,r=Math.floor((n+o)/2)):i[r][e]>t[e]&&(o=r,r=Math.floor((n+o)/2));i[o][e]<t[e]?i.push(t):i[n][e]>t[e]?i.splice(n,0,t):i[n][e]<t[e]&&i[o][e]>t[e]&&i.splice(o,0,t)}}function er(t){var e=document.getElementById(t.diagramId),i="ej2_instances",n=e[i][0].nodes;void 0===n&&(n=ir(e[i][0]));for(var o=0;n&&o<n.length;o++)if(n[o].id===t.nodeId)return n[o];return e[i][0].enterObject&&e[i][0].enterObject===t.nodeId?e[i][0].enterObject:null}function ir(t){for(var e=[],i=0;i<t.palettes.length;i++)for(var n=t.palettes[i].symbols,o=0;o<n.length;o++)n[o]instanceof fd&&e.push(n[o]);return e}function nr(t){var e,i,n=[];window.measureElement.style.visibility="visible";var o=or(window.measureElement.children[2])[0];o.setAttributeNS(null,"d",t.data);var r=fr(t,t.absoluteBounds,t);o.setAttributeNS(null,"d",r);var s=o.getTotalLength();for(i=0;i<=s;i+=10)e=o.getPointAtLength(i),n.push({x:e.x,y:e.y});return window.measureElement.style.visibility="hidden",n}function or(t){var e,i=[];if("msie"===ma.info.name||"edge"===ma.info.name)for(var n=0;n<t.childNodes.length;n++)1===(e=t.childNodes[n]).nodeType&&i.push(e);else i=t.children;return i}function rr(t,e){for(var i=[],n=0,o=e;n<o.length;n++){var r=o[n],s={x:t.offsetX-t.actualSize.width*t.pivot.x+r.x,y:t.offsetY-t.actualSize.height*t.pivot.y+r.y},a=void 0,l=t.rotateAngle+t.parentTransform;l&&Tt(a=Et(),l,t.offsetX,t.offsetY),a&&(s=Pt(a,s)),i.push(s)}return i}function sr(t){if(t){window.measureElement.style.visibility="visible";var e=or(window.measureElement.children[2])[0];e.setAttribute("d",t);var i=e.getBBox(),n=new Rl(i.x,i.y,i.width,i.height);return window.measureElement.style.visibility="hidden",n}return new Rl(0,0,0,0)}function ar(t,e){var i={fill:t.style.fill,stroke:t.style.strokeColor,angle:t.rotateAngle+t.parentTransform,pivotX:t.pivot.x,pivotY:t.pivot.y,strokeWidth:t.style.strokeWidth,dashArray:t.style.strokeDashArray,opacity:t.style.opacity,shadow:t.shadow,gradient:t.style.gradient,visible:t.visible,id:t.id,description:t.description,width:e||t.actualSize.width,height:t.actualSize.height,x:t.offsetX-t.actualSize.width*t.pivot.x+.5,y:t.offsetY-t.actualSize.height*t.pivot.y+.5};return i.fontSize=t.style.fontSize,i.fontFamily=t.style.fontFamily,i.textOverflow=t.style.textOverflow,i.textDecoration=t.style.textDecoration,i.doWrap=t.doWrap,i.whiteSpace=ns(t.style.whiteSpace,t.style.textWrapping),i.content=t.content,i.breakWord=$r(t.style.textWrapping),i.textAlign=Jr(t.style.textAlign),i.color=t.style.color,i.italic=t.style.italic,i.bold=t.style.bold,i.dashArray="",i.strokeWidth=0,i.fill="",i}function lr(t,e){var i,n,o=[],r=0,s=e||t.content;if("nowrap"!==t.whiteSpace&&"pre"!==t.whiteSpace)if("breakall"===t.breakWord)for(i="",i+=s[0],r=0;r<s.length;r++)if((n=ts(i,t))>=t.width&&i.length>0)o[o.length]={text:i,x:0,dy:0,width:n},i="";else{(i+=s[r+1]||"").indexOf("\n")>-1&&(i=i.replace("\n",""));var a=ts(i,t);Math.ceil(a)+2>=t.width&&i.length>0&&(o[o.length]={text:i,x:0,dy:0,width:a},i=""),r===s.length-1&&i.length>0&&(o[o.length]={text:i,x:0,dy:0,width:a},i="")}else o=hr(t,e);else o[o.length]={text:s,x:0,dy:0,width:ts(s,t)};return o}function hr(t,e){var i,n,o,r,s=[],a="",l=0,h=0,c="nowrap"!==t.whiteSpace,d=(e||t.content).split("\n");for(l=0;l<d.length;l++)for(i=d[l].split(" "),h=0;h<i.length;h++){var p=ts(n=(a+=((0!==h||1===i.length)&&c&&a.length>0?" ":"")+i[h])+(i[h+1]||""),t);Math.floor(p)>t.width-2&&a.length>0?(s[s.length]={text:a,x:0,dy:0,width:n===a?p:a===r?o:ts(a,t)},a=""):h===i.length-1&&(s[s.length]={text:a,x:0,dy:0,width:p},a=""),r=n,o=p}return s}function cr(t,e){var i,n,o={x:0,width:0},r=0;for(r=0;r<e.length;r++)n=i=e[r].width,i="left"===t.textAlign?0:"center"===t.textAlign?i>t.width&&("Ellipsis"===t.textOverflow||"Clip"===t.textOverflow)?0:-i/2:"right"===t.textAlign?-i:e.length>1?0:-i/2,e[r].dy=t.fontSize,e[r].x=i,o?(o.x=Math.min(o.x,i),o.width=Math.max(o.width,n)):o={x:i,width:n};return o}function dr(t,e,i,n,o){var r=new Al,s=document.createElement("Span");return s.setAttribute("style","display:inline-block ; line-height: normal"),t.bold&&(s.style.fontWeight="bold"),t.italic&&(s.style.fontStyle="italic"),void 0!==i&&(s.style.width=i.toString()+"px"),void 0!==n&&(s.style.height=n.toString()+"px"),void 0!==o&&(s.style.maxWidth=o.toString()+"px"),s.style.fontFamily=t.fontFamily,s.style.fontSize=t.fontSize+"px",s.style.color=t.color,s.textContent=e,s.style.whiteSpace=ns(t.whiteSpace,t.textWrapping),s.style.wordBreak=void 0!==o?"break-word":$r(t.textWrapping),document.body.appendChild(s),r.width=s.offsetWidth,r.height=s.offsetHeight,document.body.removeChild(s),r}function pr(t,e,i,n,o){var r,s,a=new Al(0,0),l=ar(t,n);return t.childNodes=r=lr(l,o),t.wrapBounds=s=cr(l,r),a.width=s.width,a.height=r.length*t.style.fontSize,a}function ur(t,e){window.measureElement.style.visibility="visible";var i=window.measureElement.children[1];i.setAttribute("src",t);var n=i.getBoundingClientRect(),o=n.width,r=n.height;return e=new Al(o,r),window.measureElement.style.visibility="hidden",e}function gr(t){window.measureElement.style.visibility="visible";var e=window.measureElement.children[2];e.appendChild(t);var i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),o=i;return o.x=i.left-n.left,o.y=i.top-n.top,e.removeChild(t),window.measureElement.style.visibility="hidden",o}function mr(t){window.measureElement.style.visibility="visible";var e=window.measureElement.children[2];e.appendChild(t);var i=e.getBoundingClientRect();return e.removeChild(t),window.measureElement.style.visibility="hidden",i}function fr(t,e,i){var n,o=0,r=0,s=!1,a="",l=[];return 0===(n=e).x&&0===n.y||(o=0-Number(n.x),r=0-Number(n.y)),t.actualSize.width===n.width&&t.actualSize.height===n.height||(o=t.actualSize.width/Number(n.width?n.width:1),r=t.actualSize.height/Number(n.height?n.height:1),s=!0),l=ut(t.data),l=xt(l),a=yt(l,o,r,s,n.x,n.y,0,0),s=!1,a}function vr(t){var e;return e=yr(t).getElementsByClassName("e-diagram-layer"),e[0]}function yr(t){return document.getElementById(t)}function br(t){var e;return e=yr(t).getElementsByClassName("e-adorner-layer"),e[0]}function wr(t){return br(t).getElementById(t+"_SelectorElement")}function xr(t){return br(t).getElementById(t+"_diagramAdorner")}function Cr(t){return vr(t).getElementById(t+"_diagramLayer")}function Sr(t){var e;return e=yr(t).getElementsByClassName("e-ports-expand-layer"),e[0]}function Er(t){var e;return e=yr(t).getElementsByClassName("e-native-layer"),e[0]}function Pr(t){var e;return e=yr(t).getElementsByClassName("e-grid-layer"),e[0]}function Lr(t){return yr(t).getElementsByClassName("e-background-layer")[0].parentNode}function Tr(t){var e;return e=yr(t).getElementsByClassName("e-background-image-layer"),e[0]}function kr(t){var e;return e=yr(t).getElementsByClassName("e-background-layer"),e[0]}function Or(t){return Pr(t).getElementById(t+"_gridline")}function Ar(t){return Sr(t).getElementById(t+"_diagramExpander")}function Mr(t){return Sr(t).getElementById(t+"_diagramPorts")}function Ir(t){return Er(t).getElementById(t+"_nativeLayer")}function Dr(t){var e;return e=yr(t).getElementsByClassName("e-html-layer"),e[0]}function Rr(t,e){var i=document.createElement(t);return Wr(i,e),i}function Nr(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg",t);return _r(i,e),i}function Br(t,e,i){for(var n=t;n&&(i?n.id!==e:!Hr(n,e));)n=n.parentNode;return n}function Hr(t,e){return(" "+("object"==typeof t.className?t.className.animVal:t.className)+" ").indexOf(" "+e+" ")>-1}function zr(){var t=document.createElement("div");t.style.visibility="hidden",t.style.width="100px",document.body.appendChild(t);var e=t.getBoundingClientRect().width;t.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%",t.appendChild(i);var n=i.getBoundingClientRect().width;return t.parentNode.removeChild(t),e-n}function jr(t,e,i){t=[];for(var n=0,o=i.length;n<o;n++)t.push({pageX:i[n].clientX,pageY:i[n].clientY,pointerId:null});return t}function Fr(t,e){var i=document.getElementById(e),n=e&&i?document.getElementById(e).querySelector("#"+t):document.getElementById(t);n&&n.parentNode.removeChild(n)}function Vr(t,e){var i;i=e?Rr("div",{style:"height: 100%; width: 100%"}):document.createElementNS("http://www.w3.org/2000/svg","g");var n,o=er(t);if("string"==typeof t.content)for(var r=void 0,s=0,a=(r=pt(t.content))(o);s<a.length;s++)n=a[s],i.appendChild(n);else i.appendChild(t.content);return i.cloneNode(!0)}function _r(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++)t.setAttribute(i[n],e[i[n]])}function Wr(t,e){for(var i=Object.keys(e),n=0;n<i.length;n++)t.setAttribute(i[n],e[i[n]])}function Ur(){if(window.measureElement)window.measureElement.usageCount+=1;else{var t=b("div",{id:"measureElement",styles:"visibility:hidden"}),e=document.createElement("Span");e.setAttribute("style","display:inline-block ; line-height: normal"),t.appendChild(e);var i=void 0;i=document.createElement("img"),t.appendChild(i);var n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("xlink","http://www.w3.org/1999/xlink"),t.appendChild(n);var o=document.createElementNS("http://www.w3.org/2000/svg","path");n.appendChild(o);document.createTextNode("");var r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),n.appendChild(r),window.measureElement=t,window.measureElement.usageCount=1,document.body.appendChild(t)}}function qr(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",i="",n=0;n<5;n++){if("crypto"in window&&"getRandomValues"in crypto){var o=new Uint16Array(1);t=(window.msCrypto||window.crypto).getRandomValues(o)[0]%(e.length-1)}else t=Math.floor(Math.random()*e.length);i+=e.substring(t,t+1)}return i}function Xr(t){new Rl;var e=new Rl,i=t.offsetY-t.actualSize.height*t.pivot.y,n=t.offsetY+t.actualSize.height*(1-t.pivot.y),o=t.offsetX-t.actualSize.width*t.pivot.x,r=t.offsetX+t.actualSize.width*(1-t.pivot.x),s={x:o,y:i},a={x:r,y:i},l={x:o,y:n},h={x:r,y:n};if(e=Rl.toBounds([s,a,l,h]),t.corners=e,0!==t.rotateAngle||0!==t.parentTransform){var c=Et();Tt(c,t.rotateAngle+t.parentTransform,t.offsetX,t.offsetY),s=Pt(c,s),a=Pt(c,a),l=Pt(c,l),h=Pt(c,h)}return Rl.toBounds([s,a,l,h])}function Yr(t,e,i){var n={},o="properties";if(t){i=t.propName;var r=t[o]||t,s=[];s=s.concat(Object.keys(r));var a=[];if(i){var l=as(e);a=l?l(i):[],s=s.concat(a)}for(var h=Gr(i),c=0,d=s=s.concat(h);c<d.length;c++){var p=d[c];"wrapper"!==p?!(!t[p]||!t.hasOwnProperty("observers"))||(t[p]instanceof Array?n[p]=Zr(-1===h.indexOf(p)&&t[o]?t[o][p]:t[p],e,p):t[p]instanceof Array==!1&&t[p]instanceof HTMLElement?n[p]=t[p].cloneNode(!0).innerHtml:t[p]instanceof Array==!1&&t[p]instanceof Object?n[p]=Yr(-1===h.indexOf(p)&&t[o]?t[o][p]:t[p]):n[p]=t[p]):t[p]&&(n[p]={actualSize:{width:t[p].actualSize.width,height:t[p].actualSize.height},offsetX:t[p].offsetX,offsetY:t[p].offsetY})}}return n}function Gr(t){switch(t){case"nodes":return["inEdges","outEdges","parentId","processId"];case"connectors":return["parentId"]}return[]}function Zr(t,e,i){var n;if(t){n=[];for(var o=0;o<t.length;o++)t[o]instanceof Array?n.push(t[o]):t[o]instanceof Object?n.push(Yr(t[o],e,i)):n.push(t[o])}return n}function Kr(t,e){if(t){e||(e={properties:{}});for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];if(t[o]instanceof Array){var r=Qr(t[o],e.properties[o]);e.properties[o]&&e.properties[o].length||(e[o]=r)}else if(t[o]instanceof Array==!1&&t[o]instanceof HTMLElement)e[o]=t[o].cloneNode(!0).innerHtml;else if(t[o]instanceof Array==!1&&t[o]instanceof Object){var s=Kr(t[o],e.properties[o]);s.properties&&!Object.keys(s.properties).length&&delete s.properties,e[o]=s}else e[o]=void 0!==e.properties[o]?e[o]:t[o]}}return e}function Qr(t,e){var i=[],n=!1;e||(e=[]),e.length||(n=!0);for(var o=0;o<t.length;o++)if(t[o]instanceof Array){Qr(t[o],e[o]);n&&i.push(Qr)}else if(t[o]instanceof Object){var r=Kr(t[o],e[o]);n&&i.push(r)}else i.push(t[o]);return i}function Jr(t){var e="";switch(t){case"Center":e="center";break;case"Left":e="left";break;case"Right":e="right"}return e}function $r(t){var e="";switch(t){case"Wrap":e="breakall";break;case"NoWrap":e="keepall";break;case"WrapWithOverflow":e="normal";break;case"LineThrough":e="line-through"}return e}function ts(t,e){window.measureElement.style.visibility="visible";var i=or(window.measureElement.children[2])[1];i.textContent=t,i.setAttribute("style","font-size:"+e.fontSize+"px; font-family:"+e.fontFamily+";font-weight:"+(e.bold?"bold":"normal"));var n=i.getBBox().width;return window.measureElement.style.visibility="hidden",n}function es(t,e){return(t+e)/2}function is(t,e){var i=0,n=0,o=0,r=0,s="";n=t.length;var a=0;do{r>0&&(i=o),o=Math.floor(es(i,n)),r=ts(s+=t.substr(i,o),e)}while(r<=e.width);for(s=s.substr(0,i),a=i;a<n;a++)if(s+=t[a],(r=ts(s,e))>=e.width){t=t.substr(0,s.length-1);break}return"Ellipsis"===e.textOverflow?(t=t.substr(0,t.length-3),t+="..."):t=t.substr(0,t.length),t}function ns(t,e){if("NoWrap"===e&&"PreserveAll"===t)return"pre";var i="";switch(t){case"CollapseAll":i="nowrap";break;case"CollapseSpace":i="pre-line";break;case"PreserveAll":i="pre-wrap"}return i}function os(t,e){var i=Et();Tt(i,e,0,0);var n=Pt(i,{x:0,y:0}),o=Pt(i,{x:t.width,y:0}),r=Pt(i,{x:0,y:t.height}),s=Pt(i,{x:t.width,y:t.height}),a=Math.min(n.x,o.x,r.x,s.x),l=Math.min(n.y,o.y,r.y,s.y),h=Math.max(n.x,o.x,r.x,s.x),c=Math.max(n.y,o.y,r.y,s.y);return new Al(h-a,c-l)}function rs(t,e,i,n){if(0!==t){var o=Et();return Tt(o,t,e,i),Pt(o,n)}return n}function ss(t,e){return{x:t.x+e.desiredSize.width*e.pivot.x,y:t.y+e.desiredSize.height*e.pivot.y}}function as(t){return void 0!==t&&"string"==typeof t&&(t=n(t,window)),t}function ls(e,i,n,o,r,s,a){o.selectedItems.connectors[0];if(s&&s.length>1&&r&&r.length>1)return"PinchZoom";if(o.currentSymbol)return"Drag";if("PortDraw"===o.eventHandler.action&&(o.tool&=~t.DiagramTools.DrawOnce),(Kn(o)||Zn(o))&&o.drawingObject)return"Draw";if(us(o)&&(g=o.selectedItems).wrapper&&Go(g.constraints,"UserHandle"))for(var l=0,h=g.userHandles;l<h.length;l++){var c=h[l];if(c.visible&&ps(n,u=Xo(g,c,o.scroller.transform),c.size/2))return c.name}if(Gn(o)&&!e)return"Pan";if(us(o)){var d=o.selectedItems.wrapper,p=d.bounds,u=new Rl(p.x,p.y,p.width,p.height),g=o.selectedItems;if(gs(o)){var m=o.selectedItems.connectors[0],f=10/o.scrollSettings.currentZoom,v=10/o.scrollSettings.currentZoom;if(Go(g.constraints,"ResizeAll")){if(Go(g.constraints,"ConnectorSourceThumb")&&Bn(m)&&ps(n,m.sourcePoint,f))return"ConnectorSourceEnd";if(Go(g.constraints,"ConnectorTargetThumb")&&Hn(m)&&ps(n,m.targetPoint,v))return"ConnectorTargetEnd";if(S=hs(m,g,n,o))return S}}else{var y=10/o.scroller.currentZoom,b=Et();Tt(b,d.rotateAngle+d.parentTransform,d.offsetX,d.offsetY);var w=d.offsetX-d.pivot.x*d.actualSize.width,x=d.offsetY-d.pivot.y*d.actualSize.height,C={x:w+d.actualSize.width/2,y:x-30/o.scroller.currentZoom};if(C=Pt(b,C),Go(g.constraints,"Rotate")&&ps(n,C,y)&&o.selectedItems.thumbsConstraints&t.ThumbsConstraints.Rotate)return"Rotate";if(u.Inflate(y),u.containsPoint(n)&&(S=ds(o,d,n,b,w,x)))return S}}if(a instanceof bh&&!Gn(o)){var S=cs(o,a);if("None"!==S)return S}if(null!==e){if(!(e instanceof fd||e instanceof _c))return"Select";if(i&&i.id){var E=i.id.split(e.id)[1];if(E&&E.match("^_icon"))return"LayoutAnimation"}if(In(e)&&i instanceof ch&&i.hyperlink.link)return"Hyperlink";if(!In(e)||!ms(o,e,!1))return e&&Gn(o)&&!Qn(o)?"Pan":"Select";if(e instanceof _c&&!ps(n,e.sourcePoint,e.hitPadding)&&!ps(n,e.targetPoint,e.hitPadding)||!(e instanceof _c))return"Drag"}return"Select"}function hs(t,e,i,n){var o=10/n.scrollSettings.currentZoom,r=10/n.scrollSettings.currentZoom;if("Bezier"===t.type)for(s=0;s<t.segments.length;s++){a=t.segments[s];if(ps(i,Dl.isEmptyPoint(a.point1)?a.bezierPoint1:a.point1,r))return"BezierSourceThumb";if(ps(i,Dl.isEmptyPoint(a.point2)?a.bezierPoint2:a.point2,o))return"BezierTargetThumb"}if(n.connectorEditingToolModule&&zn(t))if("Straight"===t.type||"Bezier"===t.type)for(s=0;s<t.segments.length;s++){a=void 0;if(a=t.segments[s],ps(i,a.point,10))return"SegmentEnd"}else for(var s=0;s<t.segments.length;s++){var a=void 0,l={x:0,y:0};a=t.segments[s];for(var h=0;h<a.points.length-1;h++)if(Dl.distancePoints(a.points[h],a.points[h+1])>=50&&(l.x=(a.points[h].x+a.points[h+1].x)/2,l.y=(a.points[h].y+a.points[h+1].y)/2,ps(i,l,30)))return"OrthoThumb"}return null}function cs(e,i,n,o){if(ao(i,e)&&(Zo(i,t.PortVisibility.Hover)||Zo(i,t.PortVisibility.Visible))){if(i.constraints&t.PortConstraints.Drag)return"PortDrag"}else if(so(i,e)&&(Zo(i,t.PortVisibility.Hover)||Zo(i,t.PortVisibility.Visible))&&i.constraints&t.PortConstraints.Draw){e.drawingObject={};var r={type:"Orthogonal",sourcePortID:i.id};return e.drawingObject=r,e.tool|=t.DiagramTools.DrawOnce,e.currentDrawingObject=r,"PortDraw"}return"None"}function ds(t,e,i,n,o,r){t.selectedItems.nodes[0];var s=40/t.scroller.currentZoom,a=10/t.scroller.currentZoom,l=t.selectedItems;if(e.actualSize.width>=s&&e.actualSize.height>=s){if(Yo(l.constraints,"ResizeSouthEast",l.thumbsConstraints)&&ps(i,Pt(n,{x:o+e.actualSize.width,y:r+e.actualSize.height}),a))return"ResizeSouthEast";if(Yo(l.constraints,"ResizeSouthWest",l.thumbsConstraints)&&ps(i,Pt(n,{x:o,y:r+e.actualSize.height}),a))return"ResizeSouthWest";if(Yo(l.constraints,"ResizeNorthEast",l.thumbsConstraints)&&ps(i,Pt(n,{x:o+e.actualSize.width,y:r}),a))return"ResizeNorthEast";if(Yo(l.constraints,"ResizeNorthWest",l.thumbsConstraints)&&ps(i,Pt(n,{x:o,y:r}),a))return"ResizeNorthWest"}return Yo(l.constraints,"ResizeEast",l.thumbsConstraints)&&ps(i,Pt(n,{x:o+e.actualSize.width,y:r+e.actualSize.height/2}),a)?"ResizeEast":Yo(l.constraints,"ResizeWest",l.thumbsConstraints)&&ps(i,Pt(n,{x:o,y:r+e.actualSize.height/2}),a)?"ResizeWest":Yo(l.constraints,"ResizeSouth",l.thumbsConstraints)&&ps(i,Pt(n,{x:o+e.actualSize.width/2,y:r+e.actualSize.height}),a)?"ResizeSouth":Yo(l.constraints,"ResizeNorth",l.thumbsConstraints)&&ps(i,Pt(n,{x:o+e.actualSize.width/2,y:r}),a)?"ResizeNorth":null}function ps(t,e,i){return t.x>=e.x-i&&t.x<=e.x+i&&t.y>=e.y-i&&t.y<=e.y+i}function us(t){return t.selectedItems.nodes.length>0||t.selectedItems.connectors.length>0}function gs(t){return 1===t.selectedItems.connectors.length&&!t.selectedItems.nodes.length}function ms(t,e,i){if(void 0===i&&(i=!0),e instanceof Xc)return!0;if(e instanceof fd)for(;e;){if(-1!==t.selectedItems.nodes.indexOf(e))return!0;if(i)break;e=t.nameTable[e.parentId]}else if(e instanceof _c&&-1!==t.selectedItems.connectors.indexOf(e))return!0;return!1}function fs(t,e){if(e+=360,e%=360,-1===t.indexOf("Resize"))return Ud[t];var i=Ud[t];return e>=0&&e<25||e>=160&&e<=205||e>=340&&e<=360?i:e>=25&&e<=70||e>=205&&e<=250?"n-resize"===i||"s-resize"===i?"ne-resize":"nw-resize"===i||"se-resize"===i?"n-resize":"e-resize"===i||"w-resize"===i?"nw-resize":"e-resize":e>=70&&e<=115||e>=250&&e<=295?"n-resize"===i||"s-resize"===i?"e-resize":"nw-resize"===i||"se-resize"===i?"ne-resize":"e-resize"===i||"w-resize"===i?"n-resize":"nw-resize":e>=115&&e<=155||e>=295&&e<=340?"n-resize"===i||"s-resize"===i?"nw-resize":"nw-resize"===i||"se-resize"===i?"e-resize":"e-resize"===i||"w-resize"===i?"ne-resize":Ud[t]:"n-resize"}function vs(t,e){var i={};if(h(t)||"string"==typeof t||"number"==typeof t||!h(t.isHeader))return t;for(var o=0,r=Object.keys(e);o<r.length;o++){var s=e[r[o]],a=h(s)||"string"!=typeof s?void 0:n(s,t);h(a)||(i[s]=a)}return i}function ys(){if(k(this.element,{role:"textbox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-live":"assertive","aria-valuenow":""}),this.mask){for(var t=this.mask.split("]"),e=0;e<t.length;e++)if("\\"===t[e][t[e].length-1]){t[e]=t[e]+"]";for(var i=t[e].split("["),n=0;n<i.length;n++)"\\"===i[n][i[n].length-1]&&(i[n]=i[n]+"["),Ts.call(this,i[n])}else if((i=t[e].split("[")).length>1)for(var o=!1,n=0;n<i.length;n++)"\\"===i[n]?(this.customRegExpCollec.push("["),this.hiddenMask+=i[n]+"["):""===i[n]?o=!0:""!==i[n]&&o||n===i.length-1?(this.customRegExpCollec.push("["+i[n]+"]"),this.hiddenMask+=this.promptChar,o=!1):Ts.call(this,i[n]);else Ts.call(this,i[0]);if(this.escapeMaskValue=this.hiddenMask,this.promptMask=this.hiddenMask.replace(/[09?LCAa#&]/g,this.promptChar),!h(this.customCharacters))for(e=0;e<this.promptMask.length;e++)h(this.customCharacters[this.promptMask[e]])||(this.promptMask=this.promptMask.replace(new RegExp(this.promptMask[e],"g"),this.promptChar));var r=0;if(this.hiddenMask.match(new RegExp(/\\/)))for(e=0;e<this.hiddenMask.length;e++){n=0;e>=2&&(n=e),n-=r=this.hiddenMask.length-this.promptMask.length,e>0&&"\\"!==this.hiddenMask[e-1]&&(">"===this.hiddenMask[e]||"<"===this.hiddenMask[e]||"|"===this.hiddenMask[e])&&(this.promptMask=this.promptMask.substring(0,n)+this.promptMask.substring(e+1-r,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,n)+this.escapeMaskValue.substring(e+1-r,this.escapeMaskValue.length)),"\\"===this.hiddenMask[e]&&(this.promptMask=this.promptMask.substring(0,n)+this.hiddenMask[e+1]+this.promptMask.substring(e+2-r,this.promptMask.length),this.escapeMaskValue=this.escapeMaskValue.substring(0,n)+this.escapeMaskValue[e+1]+this.escapeMaskValue.substring(e+2-r,this.escapeMaskValue.length))}else this.promptMask=this.promptMask.replace(/[>|<]/g,""),this.escapeMaskValue=this.hiddenMask.replace(/[>|<]/g,"");k(this.element,{"aria-invalid":"false"})}}function bs(){Zs.call(this,this.promptMask),Gs.call(this,this.value)}function ws(){ha.add(this.element,"keydown",Rs,this),ha.add(this.element,"keypress",Hs,this),ha.add(this.element,"keyup",js,this),ha.add(this.element,"input",Ds,this),ha.add(this.element,"focus",ks,this),ha.add(this.element,"blur",Os,this),ha.add(this.element,"paste",As,this),ha.add(this.element,"cut",Ms,this),ha.add(this.element,"drop",Is,this),this.enabled&&Cs.call(this)}function xs(){ha.remove(this.element,"keydown",Rs),ha.remove(this.element,"keypress",Hs),ha.remove(this.element,"keyup",js),ha.remove(this.element,"input",Ds),ha.remove(this.element,"focus",ks),ha.remove(this.element,"blur",Os),ha.remove(this.element,"paste",As),ha.remove(this.element,"cut",Ms)}function Cs(){this.showClearButton&&ha.add(this.inputObj.clearButton,"mousedown touchstart",Ss,this)}function Ss(t){t.preventDefault(),this.inputObj.clearButton.classList.contains("e-clear-icon-hide")||Es.call(this,t)}function Es(t){var e=this.element.value;Zs.call(this,this.promptMask),this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),zs.call(this,t,e),this.element.setSelectionRange(0,0)}function Ps(t){return t.value}function Ls(t,e){var i="",n=0,o=!1,r=h(e)?h(t)||h(this)?e:t.value:e;if(r!==this.promptMask)for(var s=0;s<this.customRegExpCollec.length;s++)o&&(o=!1),">"!==this.customRegExpCollec[n]&&"<"!==this.customRegExpCollec[n]&&"|"!==this.customRegExpCollec[n]&&"\\"!==this.customRegExpCollec[n]||(--s,o=!0),o||r[s]===this.promptChar||h(this.customRegExpCollec[n])||h(this.regExpCollec[this.customRegExpCollec[n]])&&!(this.customRegExpCollec[n].length>2&&"["===this.customRegExpCollec[n][0]&&"]"===this.customRegExpCollec[n][this.customRegExpCollec[n].length-1])&&(h(this.customCharacters)||h(this.customCharacters[this.customRegExpCollec[n]]))||""===r||(i+=r[s]),++n;return(null===this.mask||""===this.mask&&void 0!==this.value)&&(i=r),i}function Ts(t){for(var e=0;e<t.length;e++)this.hiddenMask+=t[e],"\\"!==t[e]&&this.customRegExpCollec.push(t[e])}function ks(t){var e=this;this.promptMask.length>0?this.focusEventArgs={selectionStart:0,selectionEnd:this.promptMask.length}:this.focusEventArgs={selectionStart:0,selectionEnd:this.element.value.length};var i={};if(a(i,this.focusEventArgs),this.trigger("focus",i),this.focusEventArgs=i,this.mask)if(this.isFocus=!0,""===this.element.value?Zs.call(this,this.promptMask):Zs.call(this,this.element.value),ma.isDevice||"11.0"!==ma.info.version){var n=ma.isDevice&&ma.isIos?450:0;setTimeout(function(){e.element.setSelectionRange(e.focusEventArgs.selectionStart,e.focusEventArgs.selectionEnd)},n)}else this.element.setSelectionRange(this.focusEventArgs.selectionStart,this.focusEventArgs.selectionEnd)}function Os(t){if(this.mask&&(this.isFocus=!1,this.placeholder&&this.element.value===this.promptMask&&"Always"!==this.floatLabelType)){Zs.call(this,"");var e=this.element.parentNode.querySelector(".e-float-text");"Auto"===this.floatLabelType&&!h(e)&&e.classList.contains(Uu)&&x([e],Uu)}}function As(t){var e=this;if(this.mask){var i=this.element.selectionStart,n=this.element.selectionEnd,o=this.element.value;Zs.call(this,""),this._callPasteHandler=!0,setTimeout(function(){var r=e.element.value.replace(/ /g,"");e.redoCollec.length>0&&e.redoCollec[0].value===e.element.value&&(r=Ls.call(e,e.element)),Zs.call(e,o),e.element.selectionStart=i,e.element.selectionEnd=n;var s=0;e.maskKeyPress=!0;do{_s.call(e,r[s],!1,null),++s}while(s<r.length);if(e.maskKeyPress=!1,e._callPasteHandler=!1,e.element.value===o){var a=0;e.maskKeyPress=!0;do{_s.call(e,r[a],!1,null),++a}while(a<r.length);e.maskKeyPress=!1}else zs.call(e,t,o)},1)}}function Ms(t){var e=this;if(this.mask){var i=this.element.value,n=this.element.selectionStart,o=this.element.selectionEnd;this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd});var r=this.element.value.substring(0,n)+this.promptMask.substring(n,o)+this.element.value.substring(o);setTimeout(function(){Zs.call(e,r),e.element.selectionStart=e.element.selectionEnd=n,e.element.value!==i&&zs.call(e,t,null)},0)}}function Is(t){t.preventDefault()}function Ds(t){if(l(t,{ctrlKey:!1,keyCode:229}),this.mask){if(""===this.element.value&&this.redoCollec.unshift({value:this.promptMask,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this._callPasteHandler||Bs.call(this,t),this.element.value.length>this.promptMask.length){var e=this.element.selectionStart,i=this.element.value.length-this.promptMask.length,n=this.element.value.substring(e-i,e);this.maskKeyPress=!1;var o=0;do{_s.call(this,n[o],t.ctrlKey,t),++o}while(o<n.length);this.element.value!==this.preEleVal&&zs.call(this,t,null)}var r=Ls.call(this,this.element);this.prevValue=r,this.value=r,""===r&&(Zs.call(this,this.promptMask),this.element.setSelectionRange(0,0))}}function Rs(t){if(this.mask){229!==t.keyCode&&(!t.ctrlKey||89!==t.keyCode&&90!==t.keyCode||t.preventDefault(),Bs.call(this,t));var e=this.element.value;if(t.ctrlKey&&(89===t.keyCode||90===t.keyCode)){var i=void 0;90===t.keyCode&&this.undoCollec.length>0&&e!==this.undoCollec[this.undoCollec.length-1].value?(i=this.undoCollec[this.undoCollec.length-1],this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),Zs.call(this,i.value),this.element.selectionStart=i.startIndex,this.element.selectionEnd=i.endIndex,this.undoCollec.splice(this.undoCollec.length-1,1)):89===t.keyCode&&this.redoCollec.length>0&&e!==this.redoCollec[0].value&&(i=this.redoCollec[0],this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),Zs.call(this,i.value),this.element.selectionStart=i.startIndex,this.element.selectionEnd=i.endIndex,this.redoCollec.splice(0,1))}}}function Ns(){var t,e=this.element.selectionStart,i=this.element.selectionEnd;this.redoCollec.length>0?(t=this.redoCollec[0],Zs.call(this,t.value),t.startIndex-e==1?(this.element.selectionStart=t.startIndex,this.element.selectionEnd=t.endIndex):(this.element.selectionStart=e+1,this.element.selectionEnd=i+1)):(Zs.call(this,this.promptMask),this.element.selectionStart=this.element.selectionEnd=e)}function Bs(t){var e,i=!1,n=!1;this.element.value.length<this.promptMask.length&&(i=!0,Ns.call(this),e=this.element.value);var o=this.element.selectionStart,r=this.element.selectionEnd,s=this.element.selectionStart,a=this.element.selectionEnd,l=this.hiddenMask.replace(/[>|\\<]/g,""),c=l[s-1];this.element.parentNode;if(i||8===t.keyCode||46===t.keyCode){this.undoCollec.push({value:this.element.value,startIndex:this.element.selectionStart,endIndex:a});var d=!1,p=this.element.value;if(s>0||(8===t.keyCode||46===t.keyCode)&&s<this.element.value.length&&this.element.selectionEnd-s!==this.element.value.length){var u=s;s!==a?(s=a,46===t.keyCode&&(d=!0)):46===t.keyCode?++u:--u;for(var g=s;8===t.keyCode||i||d?g>u:g<u;8===t.keyCode||i||d?g--:g++)for(var m=s;8===t.keyCode||i||d?m>0:m<this.element.value.length;8===t.keyCode||i||d?m--:m++){var f=void 0;(8===t.keyCode||d)&&(o!==r&&o!==s||o===r)||i?(c=l[m-1],f=s-1):(c=l[m],f=s,++s);var v=this.element.value[f];if(h(this.regExpCollec[c])&&!h(this.customCharacters)&&h(this.customCharacters[c])&&this.hiddenMask[f]!==this.promptChar&&"["!==this.customRegExpCollec[f][0]&&"]"!==this.customRegExpCollec[f][this.customRegExpCollec[f].length-1]||this.promptMask[f]!==this.promptChar&&h(this.customCharacters))this.element.selectionStart=this.element.selectionEnd=f,t.preventDefault(),46!==t.keyCode||d||++this.element.selectionStart;else{var y=this.element.value,b=this.promptChar,w=y.substring(0,f)+b+y.substring(s,y.length);Zs.call(this,w),t.preventDefault(),this.element.selectionStart=this.element.selectionEnd=f,n=!0}if(s=this.element.selectionStart,!n&&8===t.keyCode||d||!n&&46!==t.keyCode?f=s-1:(f=s,n=!1),v=this.element.value[f],o!==r&&this.element.selectionStart===o||this.promptMask[f]===this.promptChar||v!==this.promptMask[f]&&this.promptMask[f]!==this.promptChar&&!h(this.customCharacters))break}}0===this.element.selectionStart&&this.element.selectionEnd===this.element.value.length&&(Zs.call(this,this.promptMask),t.preventDefault(),this.element.selectionStart=this.element.selectionEnd=s),this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),this.element.value!==p&&zs.call(this,t,e)}}function Hs(t){if(this.mask){var e=this.element.value;if(!t.ctrlKey||t.ctrlKey&&"KeyA"!==t.code&&"KeyY"!==t.code&&"KeyZ"!==t.code&&"KeyX"!==t.code&&"KeyC"!==t.code&&"KeyV"!==t.code){this.maskKeyPress=!0;var i=t.key;"Spacebar"===i&&(i=String.fromCharCode(t.keyCode)),i?i&&1===i.length&&(_s.call(this,i,t.ctrlKey,t),t.preventDefault()):(this.isIosInvalid=!0,_s.call(this,String.fromCharCode(t.keyCode),t.ctrlKey,t),t.preventDefault(),this.isIosInvalid=!1)}this.element.value!==e&&zs.call(this,t,e)}}function zs(t,e){if(!h(this.changeEventArgs)&&!this.isInitial){var i={};this.changeEventArgs={value:this.element.value,maskedValue:this.element.value,isInteraction:!1},this.mask&&(this.changeEventArgs.value=Ls.call(this,this.element)),h(t)||(this.changeEventArgs.isInteraction=!0,this.changeEventArgs.event=t),a(i,this.changeEventArgs),this.trigger("change",i)}this.preEleVal=this.element.value,k(this.element,{"aria-valuenow":this.element.value})}function js(t){if(this.mask){var e=void 0;if(this.maskKeyPress||229!==t.keyCode)Xs.call(this);else{var i=void 0;if(1===this.element.value.length&&(this.element.value=this.element.value+this.promptMask,this.element.setSelectionRange(1,1)),this.element.value.length>this.promptMask.length){var n=this.element.selectionStart,o=this.element.value.length-this.promptMask.length,r=this.element.value.substring(n-o,n);if(this.undoCollec.length>0){e=this.undoCollec[this.undoCollec.length-1];var s=this.element.selectionStart;i=e.value;var a=e.value.substring(s-o,s);e=this.redoCollec[0],r=r.trim();var l=ma.isAndroid&&""===r;l||a===r||e.value.substring(s-o,s)===r?l&&Us.call(this,t,s-1,this.element.selectionEnd-1,r,t.ctrlKey,!1):_s.call(this,r,t.ctrlKey,t)}else i=this.promptMask,_s.call(this,r,t.ctrlKey,t);this.maskKeyPress=!1,zs.call(this,t,i)}}var h=Ls.call(this,this.element);(0!==this.element.selectionStart||this.promptMask!==this.element.value||""!==h||""===h&&this.value!==h)&&(this.prevValue=h,this.value=h)}else zs.call(this,t),this.value=this.element.value;if(0===this.element.selectionStart&&0===this.element.selectionEnd){var c=this.element;setTimeout(function(){c.setSelectionRange(0,0)},0)}}function Fs(t){if(t.length>1&&this.promptMask.length+t.length<this.element.value.length){var e=this.redoCollec[0].value.substring(0,this.redoCollec[0].startIndex)+t+this.redoCollec[0].value.substring(this.redoCollec[0].startIndex,this.redoCollec[0].value.length);Zs.call(this,e),this.element.selectionStart=this.element.selectionEnd=this.redoCollec[0].startIndex+t.length}this.element.selectionStart=this.element.selectionStart-t.length,this.element.selectionEnd=this.element.selectionEnd-t.length}function Vs(t){this.maskKeyPress||Fs.call(this,t)}function _s(t,e,i){if(Vs.call(this,t),!h(this)&&!h(t))for(var n,o,r=this.element.selectionStart,s=r,a=(this.element.selectionEnd,!1),l=this.element.value,c=!1,d=!1,p=0;p<t.length;p++){var u=t[p];if(r=this.element.selectionStart,this.element.selectionEnd,this.maskKeyPress||s!==r||(r+=p),!this.maskKeyPress||r<this.promptMask.length){for(m=r;m<this.promptMask.length;m++)n=this.escapeMaskValue[r],"\\"===this.hiddenMask[r]&&this.hiddenMask[r+1]===t&&(d=!0),(h(this.regExpCollec[n])&&(h(this.customCharacters)||!h(this.customCharacters)&&h(this.customCharacters[n]))&&this.hiddenMask[r]!==this.promptChar&&"["!==this.customRegExpCollec[r][0]&&"]"!==this.customRegExpCollec[r][this.customRegExpCollec[r].length-1]||this.promptMask[r]!==this.promptChar&&h(this.customCharacters)||this.promptChar===n&&this.escapeMaskValue===this.mask)&&(this.element.selectionStart=this.element.selectionEnd=r+1,r=this.element.selectionStart,n=this.hiddenMask[r]);if(h(this.customCharacters)||h(this.customCharacters[n]))!h(this.regExpCollec[n])&&u.match(new RegExp(this.regExpCollec[n]))&&this.promptMask[r]===this.promptChar?a=!0:this.promptMask[r]===this.promptChar&&"["===this.customRegExpCollec[r][0]&&"]"===this.customRegExpCollec[r][this.customRegExpCollec[r].length-1]&&u.match(new RegExp(this.customRegExpCollec[r]))&&(a=!0);else for(var g=this.customCharacters[n].split(","),m=0;m<g.length;m++)if(u.match(new RegExp("["+g[m]+"]"))){a=!0;break}if((!this.maskKeyPress||r<this.hiddenMask.length)&&a){if(0===p)if(this.maskKeyPress)this.undoCollec.push({value:l,startIndex:r,endIndex:r});else{var f=this.element.selectionStart,v=this.element.selectionEnd;this.redoCollec.length>0?(o=this.redoCollec[0].value,Zs.call(this,o),this.undoCollec.push(this.redoCollec[0])):(this.undoCollec.push({value:this.promptMask,startIndex:r,endIndex:r}),o=this.promptMask,Zs.call(this,o)),this.element.selectionStart=f,this.element.selectionEnd=v}r=this.element.selectionStart,Ws.call(this,i,r,u,o,d),c=!0,p===t.length-1&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd}),a=!1}else r=this.element.selectionStart,Us.call(this,i,r,s,t,e,c);p!==t.length-1||a||(!ma.isAndroid||ma.isAndroid&&r<this.promptMask.length)&&this.redoCollec.unshift({value:this.element.value,startIndex:this.element.selectionStart,endIndex:this.element.selectionEnd})}else 1!==t.length||e||h(i)||qs.call(this)}}function Ws(t,e,i,n,o){if(this.hiddenMask.length>this.promptMask.length&&(i=Ys.call(this,i,this.element.value)),!o){var r=this.element.value,s=r.substring(0,e)+i+r.substring(e+1,r.length);Zs.call(this,s),this.element.selectionStart=this.element.selectionEnd=e+1}}function Us(t,e,i,n,o,r){if(!this.maskKeyPress){var s=this.element.value;e>=this.promptMask.length?Zs.call(this,s.substring(0,e)):(i===e?Zs.call(this,s.substring(0,e)+s.substring(e+1,s.length)):this.promptMask.length===this.element.value.length?Zs.call(this,s.substring(0,e)+s.substring(e,s.length)):Zs.call(this,s.substring(0,i)+s.substring(i+1,s.length)),this.element.selectionStart=this.element.selectionEnd=r||this.element.value[i]!==this.promptChar?e:i),this.element.value,qs.call(this)}1!==n.length||o||h(t)||qs.call(this)}function qs(){var t=this,e=this.element.parentNode,i=200;e.classList.contains(_u)||e.classList.contains(Wu)?w([e],Vu):w([this.element],Vu),!0===this.isIosInvalid&&(i=400),k(this.element,{"aria-invalid":"true"}),setTimeout(function(){t.maskKeyPress||Xs.call(t)},i)}function Xs(){x([this.element.parentNode],Vu),x([this.element],Vu),k(this.element,{"aria-invalid":"false"})}function Ys(t,e){var i,n,o=e,r=0;for(n=0;n<this.hiddenMask.length;n++)if("\\"===this.hiddenMask[n]&&(i=o.substring(0,n)+"\\"+o.substring(n,o.length)),">"!==this.hiddenMask[n]&&"<"!==this.hiddenMask[n]&&"|"!==this.hiddenMask[n]||(this.hiddenMask[n]!==o[n]&&(i=o.substring(0,n)+this.hiddenMask[n]+o.substring(n,o.length)),++r),i){if(i[n]===this.promptChar&&n>this.element.selectionStart||this.element.value.indexOf(this.promptChar)<0&&this.element.selectionStart+r===n){r=0;break}o=i}for(;n>=0&&i;){if(0===n||"\\"!==i[n-1]){this.element.value;if(">"===i[n]){t=t.toUpperCase();break}if("<"===i[n]){t=t.toLowerCase();break}if("|"===i[n])break}--n}return t}function Gs(t){if(this.mask&&void 0!==t&&(void 0===this.prevValue||this.prevValue!==t)){if(this.maskKeyPress=!0,Zs.call(this,this.promptMask),""!==t&&(this.element.selectionStart=0,this.element.selectionEnd=0),null!==t)for(var e=0;e<t.length;e++)_s.call(this,t[e],!1,null);var i=Ls.call(this,this.element);this.prevValue=i,this.value=i,zs.call(this,null,null),this.maskKeyPress=!1;var n=this.element.parentNode.querySelector(".e-float-text");this.element.value===this.promptMask&&"Auto"===this.floatLabelType&&this.placeholder&&!h(n)&&n.classList.contains(Uu)&&!this.isFocus&&(x([n],Uu),w([n],qu),Zs.call(this,""))}(null===this.mask||""===this.mask&&void 0!==this.value)&&Zs.call(this,this.value)}function Zs(t,e){!this.isFocus&&"Auto"===this.floatLabelType&&this.placeholder&&h(this.value)&&(t="");var i=Ls.call(this,e||this.element,t);null===i||""===i?(lu.setValue(t,e||this.element,this.floatLabelType,!1),this.showClearButton&&this.inputObj.clearButton.classList.add("e-clear-icon-hide")):lu.setValue(t,e||this.element,this.floatLabelType,this.showClearButton)}function Ks(t,e){for(var i=l({},t),n=0,o=Object.keys(i);n<o.length;n++){var s=o[n];e.indexOf(s)<0&&r(i,s)}return i}function Qs(t){return Im[t.toString()]}function Js(t){return Dm[t.toString()]}function $s(t){return Rm[t.toString()]}function ta(t){return Nm[t.toString()]}function ea(t){return Bm[t.toString()]}function ia(t){var e=t.offsetX-t.actualSize.width*t.pivot.x,i=t.offsetY-t.actualSize.height*t.pivot.y;return new Rl(e,i,t.actualSize.width,t.actualSize.height)}function na(t,e){for(var i=0;i<e.length;i++)if(e[i].id===t)return!0;return!1}var oa="ej2_instances",ra=0,sa=/^(.*?):[ \t]*([^\r\n]*)$/gm,aa="GET",la=function(){function t(t,e,i,n){this.mode=!0,this.emitError=!0,this.options={},"string"==typeof t?(this.url=t,this.type=e?e.toUpperCase():aa,this.mode=!!h(i)||i):"object"==typeof t&&(this.options=t,a(this,this.options)),this.type=this.type?this.type.toUpperCase():aa,this.contentType=void 0!==this.contentType?this.contentType:n}return t.prototype.send=function(t){var e=this;this.data=h(t)?this.data:t;var i={cancel:!1};return new Promise(function(t,n){e.httpRequest=new XMLHttpRequest,e.httpRequest.onreadystatechange=function(){e.stateChange(t,n)},h(e.onLoad)||(e.httpRequest.onload=e.onLoad),h(e.onProgress)||(e.httpRequest.onprogress=e.onProgress),h(e.onAbort)||(e.httpRequest.onabort=e.onAbort),h(e.onError)||(e.httpRequest.onerror=e.onError),h(e.onUploadProgress)||(e.httpRequest.upload.onprogress=e.onUploadProgress),e.httpRequest.open(e.type,e.url,e.mode),h(e.data)||null===e.contentType||e.httpRequest.setRequestHeader("Content-Type",e.contentType||"application/json; charset=utf-8"),e.beforeSend&&e.beforeSend(i),i.cancel||e.httpRequest.send(h(e.data)?null:e.data)})},t.prototype.successHandler=function(t){return this.onSuccess&&this.onSuccess(t,this),t},t.prototype.failureHandler=function(t){return this.onFailure&&this.onFailure(this.httpRequest),t},t.prototype.stateChange=function(t,e){var i=this.httpRequest.responseText;if(this.dataType&&"json"===this.dataType.toLowerCase())if(""===i)i=void 0;else try{i=JSON.parse(i)}catch(t){}4===this.httpRequest.readyState&&(this.httpRequest.status>=200&&this.httpRequest.status<=299||304===this.httpRequest.status?t(this.successHandler(i)):this.emitError?e(new Error(this.failureHandler(this.httpRequest.statusText))):t())},t.prototype.getResponseHeader=function(t){var e,i;e={};for(var n=sa.exec(this.httpRequest.getAllResponseHeaders());n;)e[n[1].toLowerCase()]=n[2],n=sa.exec(this.httpRequest.getAllResponseHeaders());return i=e[t.toLowerCase()],h(i)?null:i},t}(),ha=function(){function t(){}return t.addOrGetEventData=function(t){return"__eventList"in t?t.__eventList.events:(t.__eventList={},t.__eventList.events=[])},t.add=function(e,i,n,o,r){var s,a=t.addOrGetEventData(e);s=r?p(n,r):n,o&&(s=s.bind(o));for(var l=i.split(" "),h=0;h<l.length;h++)a.push({name:l[h],listener:n,debounce:s}),e.addEventListener(l[h],s);return s},t.remove=function(e,i,n){for(var o=t.addOrGetEventData(e),r=i.split(" "),s=0;s<r.length;s++)!function(t){var i,s=-1;o&&0!==o.length&&o.some(function(e,o){return e.name===r[t]&&e.listener===n&&(s=o,i=e.debounce,!0)}),-1!==s&&o.splice(s,1),i&&e.removeEventListener(r[t],i)}(s)},t.clearEvents=function(e){var i,n;n=l([],n,i=t.addOrGetEventData(e));for(var o=0;o<n.length;o++)e.removeEventListener(n[o].name,n[o].debounce),i.shift()},t.trigger=function(e,i,n){for(var o=0,r=t.addOrGetEventData(e);o<r.length;o++){var s=r[o];s.name===i&&s.debounce.call(this,n)}},t}(),ca=/^svg|^path|^g/,da=function(){function t(t){this.ranArray=[],this.boundedEvents={},h(t)||(this.context=t)}return t.prototype.on=function(t,e,i,n){if(!h(e)){var o=i||this.context;if(this.notExist(t))return void(this.boundedEvents[t]=[{handler:e,context:o}]);h(n)?this.isHandlerPresent(this.boundedEvents[t],e)||this.boundedEvents[t].push({handler:e,context:o}):-1===this.ranArray.indexOf(n)&&(this.ranArray.push(n),this.boundedEvents[t].push({handler:e,context:o,id:n}))}},t.prototype.off=function(t,e,i){if(!this.notExist(t)){var o=n(t,this.boundedEvents);if(e)for(var r=0;r<o.length;r++){if(i){o.splice(r,1);var s=this.ranArray.indexOf(i);-1!==s&&this.ranArray.splice(s,1);break}if(e===o[r].handler){o.splice(r,1);break}}else delete this.boundedEvents[t]}},t.prototype.notify=function(t,e){if(!this.notExist(t)){e&&(e.name=t);for(var i=0,o=n(t,this.boundedEvents).slice(0);i<o.length;i++){var r=o[i];r.handler.call(r.context,e)}}},t.prototype.destroy=function(){this.boundedEvents=this.context=void 0},t.prototype.notExist=function(t){return!1===this.boundedEvents.hasOwnProperty(t)},t.prototype.isHandlerPresent=function(t,e){for(var i=0,n=t;i<n.length;i++)if(n[i].handler===e)return!0;return!1},t}(),pa=function(){function t(t,e){this.isProtectedOnChange=!0,this.properties={},this.changedProperties={},this.oldProperties={},this.refreshing=!1,this.finalUpdate=function(){},this.childChangedProperties={},this.modelObserver=new da(this),c(e)||(this.element="string"==typeof e?document.querySelector(e):e,h(this.element)||(this.isProtectedOnChange=!1,this.addInstance())),c(t)||this.setProperties(t,!0),this.isDestroyed=!1}return t.prototype.setProperties=function(t,e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!!e,a(this,t),!0!==e&&(a(this.changedProperties,t),this.dataBind()),this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.isProtectedOnChange=i},t.callChildDataBind=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];if(e[o]instanceof Array)for(var r=0,s=e[o];r<s.length;r++){var a=s[r];void 0!==a.dataBind&&a.dataBind()}else e[o].dataBind()}},t.prototype.clearChanges=function(){this.finalUpdate(),this.changedProperties={},this.oldProperties={},this.childChangedProperties={}},t.prototype.dataBind=function(){if(t.callChildDataBind(this.childChangedProperties,this),Object.getOwnPropertyNames(this.changedProperties).length){var e=this.isProtectedOnChange,i=this.changedProperties,n=this.oldProperties;this.clearChanges(),this.isProtectedOnChange=!0,this.onPropertyChanged(i,n),this.isProtectedOnChange=e}},t.prototype.saveChanges=function(t,e,n){this.isProtectedOnChange||(this.oldProperties[t]=n,this.changedProperties[t]=e,this.finalUpdate(),this.finalUpdate=i(this.dataBind.bind(this)))},t.prototype.addEventListener=function(t,e){this.modelObserver.on(t,e)},t.prototype.removeEventListener=function(t,e){this.modelObserver.off(t,e)},t.prototype.trigger=function(t,e){if(!0!==this.isDestroyed){var i=this.isProtectedOnChange;this.isProtectedOnChange=!1,this.modelObserver.notify(t,e),this.isProtectedOnChange=i}},t.prototype.addInstance=function(){var t="e-"+this.getModuleName().toLowerCase();w([this.element],["e-control",t]),h(this.element.ej2_instances)?o("ej2_instances",[this],this.element):this.element.ej2_instances.push(this)},t.prototype.destroy=function(){var t=this;this.element.ej2_instances=this.element.ej2_instances.filter(function(e){return e!==t}),x([this.element],["e-"+this.getModuleName()]),0===this.element.ej2_instances.length&&x([this.element],["e-control"]),this.clearChanges(),this.modelObserver.destroy(),this.isDestroyed=!0},t}(),ua={OPERA:/(opera|opr)(?:.*version|)[ \/]([\w.]+)/i,EDGE:/(edge)(?:.*version|)[ \/]([\w.]+)/i,CHROME:/(chrome|crios)[ \/]([\w.]+)/i,PANTHOMEJS:/(phantomjs)[ \/]([\w.]+)/i,SAFARI:/(safari)[ \/]([\w.]+)/i,WEBKIT:/(webkit)[ \/]([\w.]+)/i,MSIE:/(msie|trident) ([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i};"undefined"!=typeof window&&(window.browserDetails=window.browserDetails||{});var ga,ma=function(){function t(){}return t.extractBrowserDetail=function(){for(var e={culture:{}},i=[],n=0,o=Object.keys(ua);n<o.length;n++){var r=o[n];if(i=t.userAgent.match(ua[r])){if(e.name="opr"===i[1].toLowerCase()?"opera":i[1].toLowerCase(),e.name="crios"===i[1].toLowerCase()?"chrome":e.name,e.version=i[2],e.culture.name=e.culture.language=navigator.language,t.userAgent.match(/Trident\/7\./)){e.name="msie";break}var s=t.userAgent.match(/(version)[ \/]([\w.]+)/i);"safari"===e.name&&s&&(e.version=s[2]);break}}return e},t.getEvent=function(e){var i={start:{isPointer:"pointerdown",isTouch:"touchstart",isDevice:"mousedown"},move:{isPointer:"pointermove",isTouch:"touchmove",isDevice:"mousemove"},end:{isPointer:"pointerup",isTouch:"touchend",isDevice:"mouseup"},cancel:{isPointer:"pointercancel",isTouch:"touchcancel",isDevice:"mouseleave"}};return t.isPointer?i[e].isPointer:t.isTouch?i[e].isTouch+(t.isDevice?"":" "+i[e].isDevice):i[e].isDevice},t.getTouchStartEvent=function(){return t.getEvent("start")},t.getTouchEndEvent=function(){return t.getEvent("end")},t.getTouchMoveEvent=function(){return t.getEvent("move")},t.getTouchCancelEvent=function(){return t.getEvent("cancel")},t.getValue=function(e,i){var n=window.browserDetails;return void 0===n[e]?n[e]=i.test(t.userAgent):n[e]},Object.defineProperty(t,"userAgent",{get:function(){return t.uA},set:function(e){t.uA=e,window.browserDetails={}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"info",{get:function(){return c(window.browserDetails.info)?window.browserDetails.info=t.extractBrowserDetail():window.browserDetails.info},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIE",{get:function(){return t.getValue("isIE",/msie|trident/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isTouch",{get:function(){return c(window.browserDetails.isTouch)?window.browserDetails.isTouch="ontouchstart"in window:window.browserDetails.isTouch},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isPointer",{get:function(){return c(window.browserDetails.isPointer)?window.browserDetails.isPointer="pointerEnabled"in window.navigator:window.browserDetails.isPointer},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMSPointer",{get:function(){return c(window.browserDetails.isMSPointer)?window.browserDetails.isMSPointer="msPointerEnabled"in window.navigator:window.browserDetails.isMSPointer},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDevice",{get:function(){return t.getValue("isDevice",/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIos",{get:function(){return t.getValue("isIos",/(ipad|iphone|ipod touch)/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIos7",{get:function(){return t.getValue("isIos7",/(ipad|iphone|ipod touch);.*os 7_\d|(ipad|iphone|ipod touch);.*os 8_\d/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isAndroid",{get:function(){return t.getValue("isAndroid",/android/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWebView",{get:function(){return c(window.browserDetails.isWebView)?(window.browserDetails.isWebView=!(c(window.cordova)&&c(window.PhoneGap)&&c(window.phonegap)&&"object"!==window.forge),window.browserDetails.isWebView):window.browserDetails.isWebView},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWindows",{get:function(){return t.getValue("isWindows",/trident|windows phone|edge/i)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchStartEvent",{get:function(){return c(window.browserDetails.touchStartEvent)?window.browserDetails.touchStartEvent=t.getTouchStartEvent():window.browserDetails.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchMoveEvent",{get:function(){return c(window.browserDetails.touchMoveEvent)?window.browserDetails.touchMoveEvent=t.getTouchMoveEvent():window.browserDetails.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchEndEvent",{get:function(){return c(window.browserDetails.touchEndEvent)?window.browserDetails.touchEndEvent=t.getTouchEndEvent():window.browserDetails.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t,"touchCancelEvent",{get:function(){return c(window.browserDetails.touchCancelEvent)?window.browserDetails.touchCancelEvent=t.getTouchCancelEvent():window.browserDetails.touchCancelEvent},enumerable:!0,configurable:!0}),t.uA="undefined"!=typeof navigator?navigator.userAgent:"",t}(),fa=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),va=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},ya=function(t){function e(e){var i=t.call(this,e,void 0)||this;return i.easing={ease:"cubic-bezier(0.250, 0.100, 0.250, 1.000)",linear:"cubic-bezier(0.250, 0.250, 0.750, 0.750)",easeIn:"cubic-bezier(0.420, 0.000, 1.000, 1.000)",easeOut:"cubic-bezier(0.000, 0.000, 0.580, 1.000)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",elasticInOut:"cubic-bezier(0.5,-0.58,0.38,1.81)",elasticIn:"cubic-bezier(0.17,0.67,0.59,1.81)",elasticOut:"cubic-bezier(0.7,-0.75,0.99,1.01)"},i}return fa(e,t),i=e,e.prototype.animate=function(t,e){e=e||{};var n=this.getModel(e);if("string"==typeof t)for(var o=0,r=Array.prototype.slice.call(A(t,document));o<r.length;o++){var s=r[o];n.element=s,i.delayAnimation(n)}else n.element=t,i.delayAnimation(n)},e.stop=function(t,e){t.style.animation="",t.removeAttribute("e-animate");var i=t.getAttribute("e-animation-id");if(i){var n=parseInt(i,10);cancelAnimationFrame(n),t.removeAttribute("e-animation-id")}e&&e.end&&e.end.call(this,e)},e.delayAnimation=function(t){t.delay?setTimeout(function(){i.applyAnimation(t)},t.delay):i.applyAnimation(t)},e.applyAnimation=function(t){var e=this;t.timeStamp=0;var i=0,n=0,o=0,r=0,s=t.duration;t.element.setAttribute("e-animate","true");var a=function(l){try{if(l){r=0===r?l:r,t.timeStamp=l+t.timeStamp-r,r=l,!i&&t.begin&&t.begin.call(e,t),i+=1;var h=t.timeStamp/i;t.timeStamp<s&&t.timeStamp+h<s&&t.element.getAttribute("e-animate")?(t.element.style.animation=t.name+" "+t.duration+"ms "+t.timingFunction,t.progress&&t.progress.call(e,t),requestAnimationFrame(a)):(cancelAnimationFrame(n),t.element.removeAttribute("e-animation-id"),t.element.removeAttribute("e-animate"),t.element.style.animation="",t.end&&t.end.call(e,t))}else o=performance.now(),n=requestAnimationFrame(a),t.element.setAttribute("e-animation-id",n.toString())}catch(i){cancelAnimationFrame(n),t.element.removeAttribute("e-animation-id"),t.fail&&t.fail.call(e,i)}};a()},e.prototype.getModel=function(t){return{name:t.name||this.name,delay:t.delay||this.delay,duration:void 0!==t.duration?t.duration:this.duration,begin:t.begin||this.begin,end:t.end||this.end,fail:t.fail||this.fail,progress:t.progress||this.progress,timingFunction:this.easing[t.timingFunction]?this.easing[t.timingFunction]:t.timingFunction||this.easing[this.timingFunction]}},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"animation"},e.prototype.destroy=function(){},va([Y("FadeIn")],e.prototype,"name",void 0),va([Y(400)],e.prototype,"duration",void 0),va([Y("ease")],e.prototype,"timingFunction",void 0),va([Y(0)],e.prototype,"delay",void 0),va([J()],e.prototype,"progress",void 0),va([J()],e.prototype,"begin",void 0),va([J()],e.prototype,"end",void 0),va([J()],e.prototype,"fail",void 0),e=i=va([$],e);var i}(pa),ba=!1,wa=function(){function t(t){this.loadedModules=[],this.parent=t}return t.prototype.inject=function(t,i){var n=t.length;if(0===n)return void this.clean();this.loadedModules.length&&this.clearUnusedModule(t);for(var r=0;r<n;r++)for(var s=t[r],a=0,l=i;a<l.length;a++){var h=l[a],c=s.member;if(h.prototype.getModuleName()===s.member&&!this.isModuleLoaded(c)){var d=e(h,s.args),p=this.getMemberName(c);s.isProperty?o(p,h,this.parent):o(p,d,this.parent);var u=s;u.member=p,this.loadedModules.push(u)}}},t.prototype.clean=function(){for(var t=0,e=this.loadedModules;t<e.length;t++){var i=e[t];i.isProperty||n(i.member,this.parent).destroy()}this.loadedModules=[]},t.prototype.clearUnusedModule=function(t){for(var e=this,i=t.map(function(t){return e.getMemberName(t.member)}),o=0,s=this.loadedModules.filter(function(t){return-1===i.indexOf(t.member)});o<s.length;o++){var a=s[o];a.isProperty||n(a.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(a),1),r(this.parent,a.member)}},t.prototype.getMemberName=function(t){return t[0].toLowerCase()+t.substring(1)+"Module"},t.prototype.isModuleLoaded=function(t){for(var e=0,i=this.loadedModules;e<i.length;e++)if(i[e].member===this.getMemberName(t))return!0;return!1},t}(),xa=function(){function t(t,e,i,o){this.properties={},this.changedProperties={},this.childChangedProperties={},this.oldProperties={},this.finalUpdate=function(){},this.callChildDataBind=n("callChildDataBind",pa),this.parentObj=t,this.controlParent=this.parentObj.controlParent||this.parentObj,this.propName=e,this.setProperties(i,!0),this.isParentArray=o}return t.prototype.updateChange=function(t,e){!0===t?this.parentObj.childChangedProperties[e]=t:delete this.parentObj.childChangedProperties[e],this.parentObj.updateChange&&this.parentObj.updateChange(t,this.parentObj.propName)},t.prototype.updateTimeOut=function(){if(this.parentObj.updateTimeOut)this.parentObj.finalUpdate(),this.parentObj.updateTimeOut();else{var t=setTimeout(this.parentObj.dataBind.bind(this.parentObj)),e=function(){clearTimeout(t)};this.finalUpdate=e}},t.prototype.clearChanges=function(){this.finalUpdate(),this.updateChange(!1,this.propName),this.oldProperties={},this.changedProperties={}},t.prototype.setProperties=function(t,e){!0===e?(a(this,t),this.updateChange(!1,this.propName),this.clearChanges()):a(this,t)},t.prototype.dataBind=function(){if(this.callChildDataBind(this.childChangedProperties,this),this.isParentArray){var t=this.parentObj[this.propName].indexOf(this);Object.keys(this.changedProperties).length&&(o(this.propName+"."+t,this.changedProperties,this.parentObj.changedProperties),o(this.propName+"."+t,this.oldProperties,this.parentObj.oldProperties))}else this.parentObj.changedProperties[this.propName]=this.changedProperties,this.parentObj.oldProperties[this.propName]=this.oldProperties;this.clearChanges()},t.prototype.saveChanges=function(t,e,i){this.controlParent.isProtectedOnChange||(this.oldProperties[t]=i,this.changedProperties[t]=e,this.updateChange(!0,this.propName),this.finalUpdate(),this.updateTimeOut())},t}(),Ca={latn:{_digits:"0123456789",_type:"numeric"}},Sa={decimal:".",group:",",percentSign:"%",plusSign:"+",minusSign:"-",infinity:"∞",nan:"NaN",exponential:"E"},Ea=[0,1,2,3,4,5,6,7,8,9],Pa=function(){function t(){}return t.getMainObject=function(t,e){return n("main."+e,t)},t.getNumberingSystem=function(t){return n("supplemental.numberingSystems",t)||this.numberingSystems},t.reverseObject=function(t,e){for(var i={},n=0,o=e||Object.keys(t);n<o.length;n++){var r=o[n];i.hasOwnProperty(t[r])||(i[t[r]]=r)}return i},t.getSymbolRegex=function(t){var e=t.map(function(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}).join("|");return new RegExp(e,"g")},t.getSymbolMatch=function(t){for(var e={},i=0,n=Object.keys(Sa);i<n.length;i++){var o=n[i];e[t[o]]=Sa[o]}return e},t.constructRegex=function(t){for(var e=t.length,i="",n=0;n<e;n++)i+=n!==e-1?t[n]+"|":t[n];return i},t.convertValueParts=function(t,e,i){return t.replace(e,function(t){return i[t]})},t.getDefaultNumberingSystem=function(t){var e={};return e.obj=n("numbers",t),e.nSystem=n("defaultNumberingSystem",e.obj),e},t.getCurrentNumericOptions=function(t,e,i){var o={},r=this.getDefaultNumberingSystem(t);if(!c(r.nSystem)){var s=n(r.nSystem+"._digits",e);c(s)||(o.numericPair=this.reverseObject(s,Ea),o.numberParseRegex=new RegExp(this.constructRegex(s),"g"),o.numericRegex="["+s[0]+"-"+s[9]+"]",i&&(o.numericRegex=s[0]+"-"+s[9],o.symbolNumberSystem=n("symbols-numberSystem-"+r.nSystem,r.obj),o.symbolMatch=this.getSymbolMatch(o.symbolNumberSystem),o.numberSystem=r.nSystem))}return o},t.getNumberMapper=function(t,e,i){var o={mapper:{}},r=this.getDefaultNumberingSystem(t);if(!c(r.nSystem)){o.numberSystem=r.nSystem,o.numberSymbols=n("symbols-numberSystem-"+r.nSystem,r.obj),o.timeSeparator=n("timeSeparator",o.numberSymbols);var s=n(r.nSystem+"._digits",e);if(!c(s))for(var a=0,l=Ea;a<l.length;a++){var h=l[a];o.mapper[h]=s[h]}}return o},t.nPair="numericPair",t.nRegex="numericRegex",t.numberingSystems=Ca,t}(),La={ms:"minimumSignificantDigits",ls:"maximumSignificantDigits",mf:"minimumFractionDigits",lf:"maximumFractionDigits"},Ta=["infinity","nan","group","decimal","exponential"],ka=function(){function t(){}return t.numberFormatter=function(t,e,i){var n,o=this,r=l({},e),s={},a={},h=ga.getDependables(i,t,!0);a.numberMapper=Pa.getNumberMapper(h.parserObject,Pa.getNumberingSystem(i),!0),a.currencySymbol=ga.getCurrencySymbol(h.numericObject,r.currency||Wa),a.percentSymbol=a.numberMapper.numberSymbols.percentSign,a.minusSymbol=a.numberMapper.numberSymbols.minusSign;var d=a.numberMapper.numberSymbols;if(e.format&&!ga.formatRegex.test(e.format))s=ga.customFormat(e.format,a,h.numericObject);else{l(r,ga.getProperNumericSkeleton(e.format||"N")),r.isCurrency="currency"===r.type,r.isPercent="percent"===r.type,n=ga.getSymbolPattern(r.type,a.numberMapper.numberSystem,h.numericObject,r.isAccount),r.groupOne=this.checkValueRange(r.maximumSignificantDigits,r.minimumSignificantDigits,!0),this.checkValueRange(r.maximumFractionDigits,r.minimumFractionDigits,!1,!0),c(r.fractionDigits)||(r.minimumFractionDigits=r.maximumFractionDigits=r.fractionDigits),c(r.useGrouping)&&(r.useGrouping=!0),r.isCurrency&&(n=n.replace(/\u00A4/g,ga.defaultCurrency));var p=n.split(";");if(s.nData=ga.getFormatData(p[1]||"-"+p[0],!0,a.currencySymbol),s.pData=ga.getFormatData(p[0],!1,a.currencySymbol),r.useGrouping&&(r.groupSeparator=d[Ta[2]],r.groupData=this.getGroupingDetails(p[0])),c(r.minimumFractionDigits)&&(r.minimumFractionDigits=s.nData.minimumFraction),c(r.maximumFractionDigits)){var u=s.nData.maximumFraction;r.maximumFractionDigits=c(u)&&r.isPercent?0:u}var g=r.minimumFractionDigits,m=r.maximumFractionDigits;c(g)||c(m)||g>m&&(r.maximumFractionDigits=g)}return l(s.nData,r),l(s.pData,r),function(t){return isNaN(t)?d[Ta[1]]:isFinite(t)?o.intNumberFormatter(t,s,a):d[Ta[0]]}},t.getGroupingDetails=function(t){var e={},i=t.match(ga.negativeDataRegex);if(i&&i[4]){var n=i[4],o=n.lastIndexOf(",");if(-1!==o){var r=n.split(".")[0];e.primary=r.length-o-1;var s=n.lastIndexOf(",",o-1);-1!==s&&(e.secondary=o-1-s)}}return e},t.checkValueRange=function(t,e,i,n){var o=n?"f":"s",r=0,s=La["l"+o],a=La["m"+o];if(c(t)||(this.checkRange(t,s,n),r++),c(e)||(this.checkRange(e,a,n),r++),2===r){if(!(t<e))return!0;g(a+"specified must be less than the"+s)}else i&&1===r&&g("Both"+a+"and"+a+"must be present");return!1},t.checkRange=function(t,e,i){var n=i?[0,20]:[1,21];(t<n[0]||t>n[1])&&g(e+"value must be within the range"+n[0]+"to"+n[1])},t.intNumberFormatter=function(t,e,i){var n;if(!c(e.nData.type)){t<0?(t*=-1,n=e.nData):n=0===t?e.zeroData||e.pData:e.pData;var o="";return n.isPercent&&(t*=100),n.groupOne?o=this.processSignificantDigits(t,n.minimumSignificantDigits,n.maximumSignificantDigits):(o=this.processFraction(t,n.minimumFractionDigits,n.maximumFractionDigits),n.minimumIntegerDigits&&(o=this.processMinimumIntegers(o,n.minimumIntegerDigits))),"scientific"===n.type&&(o=(o=t.toExponential(n.maximumFractionDigits)).replace("e",i.numberMapper.numberSymbols[Ta[4]])),o=o.replace(".",i.numberMapper.numberSymbols[Ta[3]]),n.useGrouping&&(o=this.groupNumbers(o,n.groupData.primary,n.groupSeparator||",",i.numberMapper.numberSymbols[Ta[3]]||".",n.groupData.secondary)),o=Pa.convertValueParts(o,ga.latnParseRegex,i.numberMapper.mapper),"N/A"===n.nlead?n.nlead:n.nlead+o+n.nend}},t.processSignificantDigits=function(t,e,i){var n=t+"";return n.length<e?t.toPrecision(e):(n=t.toPrecision(i),+n+"")},t.groupNumbers=function(t,e,i,n,o){for(var r=!h(o)&&0!==o,s=t.split(n),a=s[0],l=a.length,c="";l>e;)c=a.slice(l-e,l)+(c.length?i+c:""),l-=e,r&&(e=o,r=!1);return s[0]=a.slice(0,l)+(c.length?i:"")+c,s.join(n)},t.processFraction=function(t,e,i){var n=(t+"").split(".")[1],o=n?n.length:0;if(e&&o<e){var r="";if(0!==o){r+=t;for(var s=0;s<e-o;s++)r+="0";return r}return r=t.toFixed(e),t.toFixed(e)}return!h(i)&&(o>i||0===i)?t.toFixed(i):t+""},t.processMinimumIntegers=function(t,e){var i=t.split("."),n=i[0],o=n.length;if(o<e){for(var r=0;r<e-o;r++)n="0"+n;i[0]=n}return i.join(".")},t}();!function(t){function e(e,i,o){var r,s=o||"date";if(-1!==t.basicPatterns.indexOf(e)){if(r=n(s+"Formats."+e,i),"dateTime"===s){var a=n("dateFormats."+e,i),l=n("timeFormats."+e,i);r=r.replace("{1}",a).replace("{0}",l)}}else r=n("dateTimeFormats.availableFormats."+e,i);return r}function i(e,i,o){var r={};return r.parserObject=Pa.getMainObject(e,i)||t.defaultObject,o?r.numericObject=n("numbers",r.parserObject):r.dateObject=n("dates.calendars.gregorian",r.parserObject),r}function o(t,e,i,o){return n(t+"Formats-numberSystem-"+e+(o?".accounting":".standard"),i)||(o?n(t+"Formats-numberSystem-"+e+".standard",i):"")}function r(e){var i=e.match(t.formatRegex),n={},o=i[1].toUpperCase();return n.isAccount="A"===o,n.type=t.patternMatcher[o],e.length>1&&(n.fractionDigits=parseInt(i[2],10)),n}function s(e,i,n,o){var r=o?{}:{nlead:"",nend:""},s=e.match(t.customRegex);if(s){o||(r.nlead=a(s[1],n),r.nend=a(s[10],n),r.groupPattern=s[4]);var l=s[7];if(l&&i){var c=l.match(x);h(c)?r.minimumFraction=0:r.minimumFraction=c.length,r.maximumFraction=l.length-1}}return r}function a(e,i){return e?e.replace(t.defaultCurrency,i):""}function c(t,e){return n("currencies."+e+".symbol",t)||"$"}function d(t,e,i){for(var n={},o=t.split(";"),r=["pData","nData","zeroData"],s=0;s<o.length;s++)n[r[s]]=p(o[s],e,i);return h(n.nData)&&(n.nData=l({},n.pData),n.nData.nlead=h(e)?"-"+n.nData.nlead:e.minusSymbol+n.nData.nlead),n}function p(e,i,n){var r={type:"decimal",minimumFractionDigits:0,maximumFractionDigits:0},s=e.match(t.customRegex);(h(s)||""===s[5]&&"N/A"!==e)&&(r.type=void 0),r.nlead=s[1],r.nend=s[10];var a=s[6];r.useGrouping=-1!==a.indexOf(","),a=a.replace(/,/g,"");var c=s[7];if(-1!==a.indexOf("0")&&(r.minimumIntegerDigits=a.length-a.indexOf("0")),h(c)||(r.minimumFractionDigits=c.lastIndexOf("0"),r.maximumFractionDigits=c.lastIndexOf("#"),-1===r.minimumFractionDigits&&(r.minimumFractionDigits=0),(-1===r.maximumFractionDigits||r.maximumFractionDigits<r.minimumFractionDigits)&&(r.maximumFractionDigits=r.minimumFractionDigits)),h(i)?l(r,u([r.nlead,r.nend],"%","%")):(l(r,u([r.nlead,r.nend],"$",i.currencySymbol)),r.isCurrency||l(r,u([r.nlead,r.nend],"%",i.percentSymbol))),!h(n)){var d=o(r.type,i.numberMapper.numberSystem,n,!1);r.useGrouping&&(r.groupSeparator=i.numberMapper.numberSymbols[C[2]],r.groupData=ka.getGroupingDetails(d.split(";")[0])),r.nlead=r.nlead.replace(/\'/g,""),r.nend=r.nend.replace(/\'/g,"")}return r}function u(t,e,i){for(var n={nlead:t[0],nend:t[1]},o=0;o<2;o++){var r=t[o],s=r.indexOf(e);if(-1!==s&&(s<r.indexOf("'")||s>r.lastIndexOf("'"))){n[T[o]]=r.substr(0,s)+i+r.substr(s+1),n[T[e]]=!0,n.type=n.isCurrency?"currency":"percent";break}}return n}function g(t){var e=(n("dateFormats.short",t)||"").match(/[d‏M‏]([^d‏M])[d‏M‏]/i);return e?e[1]:"/"}function m(t,o,r,s){var a=i(r,t),l=o.format||e(o.skeleton,a.dateObject,o.type);if(s){if(-1!==(l=l.replace(S,function(t){return E[t]})).indexOf("z")){var h=l.match(/z/g).length,c=void 0,d={timeZone:{}};d.numMapper=Pa.getNumberMapper(a.parserObject,Pa.getNumberingSystem(r)),d.timeZone=n("dates.timeZoneNames",a.parserObject);var p=(new Date).getTimezoneOffset(),u=h<4?"+H;-H":d.timeZone.hourFormat;u=u.replace(/:/g,d.numMapper.timeSeparator),0===p?c=d.timeZone.gmtZeroFormat:(c=Da.getTimeZoneValue(p,u),c=d.timeZone.gmtFormat.replace(/\{0\}/,c)),l=l.replace(/[z]+/,'"'+c+'"')}l=l.replace(/ $/,"")}return l}function f(e,n,a){var h,d=i(a,e,!0),p={custom:!0},u={},g=(n.format||"").match(t.currencyFormatRegex);if(g){var m={};m.numberMapper=Pa.getNumberMapper(d.parserObject,Pa.getNumberingSystem(a),!0);var f=c(d.numericObject,n.currency||Wa),w=o("currency",m.numberMapper.numberSystem,d.numericObject,/a/i.test(n.format)),x=(w=w.replace(/\u00A4/g,f)).split(";");u.hasNegativePattern=x.length>1,u.nData=s(x[1]||"-"+x[0],!0,f),u.pData=s(x[0],!1,f),g[2]||n.minimumFractionDigits||n.maximumFractionDigits||(h=s(w.split(";")[0],!0,"",!0).minimumFraction)}var C;if(t.formatRegex.test(n.format)||!n.format){if(l(p,r(n.format||"N")),p.custom=!1,C="###0",p.fractionDigits||n.minimumFractionDigits||n.maximumFractionDigits||h){p.fractionDigits&&(n.minimumFractionDigits=n.maximumFractionDigits=p.fractionDigits),C=v(C,h||p.fractionDigits||n.minimumFractionDigits||0,n.maximumFractionDigits||0)}if(n.minimumIntegerDigits&&(C=y(C,n.minimumIntegerDigits)),n.useGrouping&&(C=b(C)),"currency"===p.type){var S=C;C=u.pData.nlead+S+u.pData.nend,u.hasNegativePattern&&(C+=";"+u.nData.nlead+S+u.nData.nend)}"percent"===p.type&&(C+=" %")}else C=n.format.replace(/\'/g,'"');return C}function v(t,e,i){t+=".";for(var n=0;n<e;n++)t+="0";if(e<i)for(var o=i-e,r=0;r<o;r++)t+="#";return t}function y(t,e){for(var i=t.split("."),n="",o=0;o<e;o++)n+="0";return i[1]?n+"."+i[1]:n}function b(t){var e=t.split("."),i=e[0],n=3-i.length%3;t="";for(var o=(i=(n&&1===n?"#":2===n?"##":"")+i).length-1;o>0;o-=3)t=","+i[o-2]+i[o-1]+i[o]+t;return t=t.slice(1),e[1]?t+"."+e[1]:t}function w(t,e){var i=P,o=n("supplemental.weekData.firstDay",e),r=t;return/en-/.test(r)&&(r=r.slice(3)),r=r.slice(0,2).toUpperCase()+r.substr(2),o&&(i=o[r]||P),L[i]}t.negativeDataRegex=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,t.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,t.latnParseRegex=/0|1|2|3|4|5|6|7|8|9/g;var x=/[0-9]/g;t.defaultCurrency="$";var C=["infinity","nan","group","decimal"],S=/G|M|L|H|c|'| a|yy|y|EEEE|E/g,E={G:"",M:"m",L:"m",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"},P="sun",L={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6};t.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i,t.currencyFormatRegex=/(^[ca]{1})([0-1]?[0-9]|20)?$/i,t.curWithoutNumberRegex=/(c|a)$/gi;var T={$:"isCurrency","%":"isPercent","-":"isNegative",0:"nlead",1:"nend"};t.dateParseRegex=/([a-z])\1*|'([^']|'')+'|''|./gi,t.basicPatterns=["short","medium","long","full"],t.defaultObject={dates:{calendars:{gregorian:{months:{"stand-alone":{abbreviated:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},narrow:{1:"J",2:"F",3:"M",4:"A",5:"M",6:"J",7:"J",8:"A",9:"S",10:"O",11:"N",12:"D"},wide:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}}},days:{"stand-alone":{abbreviated:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},narrow:{sun:"S",mon:"M",tue:"T",wed:"W",thu:"T",fri:"F",sat:"S"},short:{sun:"Su",mon:"Mo",tue:"Tu",wed:"We",thu:"Th",fri:"Fr",sat:"Sa"},wide:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"}}},dayPeriods:{format:{wide:{am:"AM",pm:"PM"}}},eras:{eraNames:{0:"Before Christ","0-alt-variant":"Before Common Era",1:"Anno Domini","1-alt-variant":"Common Era"},eraAbbr:{0:"BC","0-alt-variant":"BCE",1:"AD","1-alt-variant":"CE"},eraNarrow:{0:"B","0-alt-variant":"BCE",1:"A","1-alt-variant":"CE"}},dateFormats:{full:"EEEE, MMMM d, y",long:"MMMM d, y",medium:"MMM d, y",short:"M/d/yy"},timeFormats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats:{full:"{1} 'at' {0}",long:"{1} 'at' {0}",medium:"{1}, {0}",short:"{1}, {0}",availableFormats:{d:"d",E:"ccc",Ed:"d E",Ehm:"E h:mm a",EHm:"E HH:mm",Ehms:"E h:mm:ss a",EHms:"E HH:mm:ss",Gy:"y G",GyMMM:"MMM y G",GyMMMd:"MMM d, y G",GyMMMEd:"E, MMM d, y G",h:"h a",H:"HH",hm:"h:mm a",Hm:"HH:mm",hms:"h:mm:ss a",Hms:"HH:mm:ss",hmsv:"h:mm:ss a v",Hmsv:"HH:mm:ss v",hmv:"h:mm a v",Hmv:"HH:mm v",M:"L",Md:"M/d",MEd:"E, M/d",MMM:"LLL",MMMd:"MMM d",MMMEd:"E, MMM d",MMMMd:"MMMM d",ms:"mm:ss",y:"y",yM:"M/y",yMd:"M/d/y",yMEd:"E, M/d/y",yMMM:"MMM y",yMMMd:"MMM d, y",yMMMEd:"E, MMM d, y",yMMMM:"MMMM y"}}}},timeZoneNames:{hourFormat:"+HH:mm;-HH:mm",gmtFormat:"GMT{0}",gmtZeroFormat:"GMT"}},numbers:{currencies:{USD:{displayName:"US Dollar",symbol:"$","symbol-alt-narrow":"$"},EUR:{displayName:"Euro",symbol:"€","symbol-alt-narrow":"€"},GBP:{displayName:"British Pound","symbol-alt-narrow":"£"}},defaultNumberingSystem:"latn",minimumGroupingDigits:"1","symbols-numberSystem-latn":{decimal:".",group:",",list:";",percentSign:"%",plusSign:"+",minusSign:"-",exponential:"E",superscriptingExponent:"×",perMille:"‰",infinity:"∞",nan:"NaN",timeSeparator:":"},"decimalFormats-numberSystem-latn":{standard:"#,##0.###"},"percentFormats-numberSystem-latn":{standard:"#,##0%"},"currencyFormats-numberSystem-latn":{standard:"¤#,##0.00",accounting:"¤#,##0.00;(¤#,##0.00)"},"scientificFormats-numberSystem-latn":{standard:"#E0"}}},t.monthIndex={3:"abbreviated",4:"wide",5:"narrow",1:"abbreviated"},t.month="months",t.days="days",t.patternMatcher={C:"currency",P:"percent",N:"decimal",A:"currency",E:"scientific"},t.getResultantPattern=e,t.getDependables=i,t.getSymbolPattern=o,t.getProperNumericSkeleton=r,t.getFormatData=s,t.getCurrencySymbol=c,t.customFormat=d,t.isCurrencyPercent=u,t.getDateSeparator=g,t.getActualDateTimeFormat=m,t.getActualNumberFormat=f,t.getWeekData=w}(ga||(ga={}));var Oa,Aa=["sun","mon","tue","wed","thu","fri","sat"],Ma={m:"getMinutes",h:"getHours",H:"getHours",s:"getSeconds",d:"getDate"},Ia={M:"month",d:"day",E:"weekday",c:"weekday",y:"year",m:"minute",h:"hour",H:"hour",s:"second",L:"month",a:"designator",z:"timeZone",Z:"timeZone",G:"era"},Da=function(){function t(){}return t.dateFormat=function(t,e,i){var o=this,r=ga.getDependables(i,t),s={},a=e.format||ga.getResultantPattern(e.skeleton,r.dateObject,e.type);if(s.dateSeperator=ga.getDateSeparator(r.dateObject),c(a))g("Format options or type given must be invalid");else{s.pattern=a,s.numMapper=Pa.getNumberMapper(r.parserObject,Pa.getNumberingSystem(i));for(var l=0,h=a.match(/\/MMMMM|MMMM|MMM|a|LLL|EEEEE|EEEE|E|K|ccc|G+|z+/gi)||[];l<h.length;l++){var d=h[l],p=d.length,u=d[0];switch("K"===u&&(u="h"),u){case"E":case"c":s.weekday=r.dateObject[ga.days]["stand-alone"][ga.monthIndex[p]];break;case"M":case"L":s.month=r.dateObject[ga.month]["stand-alone"][ga.monthIndex[p]];break;case"a":s.designator=n("dayPeriods.format.wide",r.dateObject);break;case"G":var m=p<=3?"eraAbbr":4===p?"eraNames":"eraNarrow";s.era=n("eras."+m,r.dateObject);break;case"z":s.timeZone=n("dates.timeZoneNames",r.parserObject)}}}return function(t){return isNaN(t.getDate())?null:o.intDateFormatter(t,s)}},t.intDateFormatter=function(t,e){for(var i="",n=0,o=e.pattern.match(ga.dateParseRegex);n<o.length;n++){var r=o[n],s=r.length,a=r[0];"K"===a&&(a="h");var l=void 0,h=void 0,c=void 0,d="";switch(a){case"M":case"L":l=t.getMonth()+1,s>2?i+=e.month[l]:h=!0;break;case"E":case"c":i+=e.weekday[Aa[t.getDay()]];break;case"H":case"h":case"m":case"s":case"d":h=!0,l=t[Ma[a]](),"h"===a&&(l=l%12||12);break;case"y":c=!0,d+=t.getFullYear(),2===s&&(d=d.substr(d.length-2));break;case"a":var p=t.getHours()<12?"am":"pm";i+=e.designator[p];break;case"G":var u=t.getFullYear()<0?0:1;i+=e.era[u];break;case"'":i+="''"===r?"'":r.replace(/\'/g,"");break;case"z":var g=t.getTimezoneOffset(),m=s<4?"+H;-H":e.timeZone.hourFormat;m=m.replace(/:/g,e.numMapper.timeSeparator),0===g?i+=e.timeZone.gmtZeroFormat:(c=!0,d=this.getTimeZoneValue(g,m)),d=e.timeZone.gmtFormat.replace(/\{0\}/,d);break;case":":i+=e.numMapper.numberSymbols.timeSeparator;break;case"/":i+=e.dateSeperator;break;default:i+=r}h&&(c=!0,d=this.checkTwodigitNumber(l,s)),c&&(i+=Pa.convertValueParts(d,ga.latnParseRegex,e.numMapper.mapper))}return i},t.checkTwodigitNumber=function(t,e){var i=t+"";return 2===e&&2!==i.length?"0"+i:i},t.getTimeZoneValue=function(t,e){var i=this,n=e.split(";")[t>0?1:0],o=Math.abs(t);return n=n.replace(/HH?|mm/g,function(t){var e=t.length,n=-1!==t.indexOf("H");return i.checkTwodigitNumber(Math.floor(n?o/60:o%60),e)})},t}(),Ra=/^[0-9]*$/,Na={minute:"setMinutes",hour:"setHours",second:"setSeconds",day:"setDate",month:"setMonth"},Ba=function(){function t(){}return t.dateParser=function(t,e,i){var o,r=this,s=ga.getDependables(i,t),a=Pa.getCurrentNumericOptions(s.parserObject,Pa.getNumberingSystem(i)),l={},d=e.format||ga.getResultantPattern(e.skeleton,s.dateObject,e.type),p="";if(c(d))g("Format options or type given must be invalid");else{l={pattern:d,evalposition:{}};for(var u=d.match(ga.dateParseRegex)||[],m=u.length,f=0,v=0,y=!1,b=a.numericRegex,w=0;w<m;w++){var x=u[w],C=x.length,S="K"===x[0]?"h":x[0],E=void 0,P=void 0,L=Ia[S],T=2===C?"":"?";switch(y&&(f=v,y=!1),S){case"E":case"c":var k=Pa.reverseObject(s.dateObject[ga.days]["stand-alone"][ga.monthIndex[C]]);p+="("+Object.keys(k).join("|")+")";break;case"M":case"L":case"d":case"m":case"s":case"h":case"H":P=!0,("M"===S||"L"===S)&&C>2?(l[L]=Pa.reverseObject(s.dateObject.months["stand-alone"][ga.monthIndex[C]]),p+="("+Object.keys(l[L]).join("|")+")"):(E=!0,p+="("+b+b+T+")"),"h"===S&&(l.hour12=!0);break;case"y":P=E=!0,p+=2===C?"("+b+b+")":"("+b+"{"+C+",})";break;case"a":P=!0,l[L]=Pa.reverseObject(n("dayPeriods.format.wide",s.dateObject)),p+="("+Object.keys(l[L]).join("|")+")";break;case"G":P=!0;var O=C<=3?"eraAbbr":4===C?"eraNames":"eraNarrow";l[L]=Pa.reverseObject(n("eras."+O,s.dateObject)),p+="("+Object.keys(l[L]).join("|")+"?)";break;case"z":P=0!==(new Date).getTimezoneOffset(),l[L]=n("dates.timeZoneNames",s.parserObject);var A=l[L],M=(o=C<4)?"+H;-H":A.hourFormat;p+="("+this.parseTimeZoneRegx(M,A,b)+")?",y=!0,v=o?6:12;break;case"'":p+="("+x.replace(/\'/g,"")+")?";break;default:p+="([\\D])"}P&&(l.evalposition[L]={isNumber:E,pos:w+1+f,hourOnly:o}),w!==m-1||h(p)||(l.parserRegex=new RegExp("^"+p+"$"))}}return function(t){var e=r.internalDateParse(t,l,a);return h(e)||!Object.keys(e).length?null:r.getDateObject(e)}},t.getDateObject=function(t,e){var i=e||new Date;i.setMilliseconds(0);var n=["hour","minute","second","month","day"],o=t.year,r=t.designator,s=t.timeZone;c(o)||((o+"").length<=2&&(o+=100*Math.floor(i.getFullYear()/100)),i.setFullYear(o));for(var a=0,l=n;a<l.length;a++){var h=l[a],d=t[h];if(!c(d))if("month"===h){if((d-=1)<0||d>11)return new Date("invalid");var p=i.getDate();i.setDate(1),i[Na[h]](d);var u=new Date(i.getFullYear(),d+1,0).getDate();i.setDate(p<u?p:u)}else{if("day"===h){var g=new Date(i.getFullYear(),i.getMonth()+1,0).getDate();if(d<1||d>g)return null}i[Na[h]](d)}}if(!c(r)){var m=i.getHours();"pm"===r?i.setHours(m+(12===m?0:12)):12===m&&i.setHours(0)}if(!c(s)){var f=s-i.getTimezoneOffset();0!==f&&i.setMinutes(i.getMinutes()+f)}return i},t.internalDateParse=function(t,e,i){var n=t.match(e.parserRegex),o={hour:0,minute:0,second:0};i.numericRegex;if(h(n))return null;for(var r=0,s=Object.keys(e.evalposition);r<s.length;r++){var a=s[r],l=e.evalposition[a],d=n[l.pos];if(l.isNumber)o[a]=this.internalNumberParser(d,i);else if("timeZone"!==a||c(d))o[a]=e[a][d];else{var p=l.pos,u=void 0,g=n[p+1],m=!c(g);l.hourOnly?u=60*this.getZoneValue(m,g,n[p+4],i):(u=60*this.getZoneValue(m,g,n[p+7],i),u+=this.getZoneValue(m,n[p+4],n[p+10],i)),h(u)||(o[a]=u)}}return e.hour12&&(o.hour12=!0),o},t.internalNumberParser=function(t,e){return t=Pa.convertValueParts(t,e.numberParseRegex,e.numericPair),Ra.test(t)?+t:null},t.parseTimeZoneRegx=function(t,e,i){var n,o,r=e.gmtFormat,s="("+i+")("+i+")";return n=t.replace("+","\\+"),n=-1!==t.indexOf("HH")?n.replace(/HH|mm/g,"("+s+")"):n.replace(/H|m/g,"("+s+"?)"),o=n.split(";").map(function(t){return r.replace("{0}",t)}),n=o.join("|")+"|"+e.gmtZeroFormat},t.getZoneValue=function(t,e,i,n){var o=t?e:i;if(!o)return 0;var r=this.internalNumberParser(o,n);return t?-r:r},t}(),Ha=["minusSign","infinity"],za=function(){function t(){}return t.numberParser=function(t,e,i){var n,o=this,r=ga.getDependables(i,t,!0),s={custom:!0};ga.formatRegex.test(e.format)||!e.format?(l(s,ga.getProperNumericSkeleton(e.format||"N")),s.custom=!1):l(s,ga.customFormat(e.format,null,null)),n=Pa.getCurrentNumericOptions(r.parserObject,Pa.getNumberingSystem(i),!0),s.symbolRegex=Pa.getSymbolRegex(Object.keys(n.symbolMatch)),s.infinity=n.symbolNumberSystem[Ha[1]];var a=ga.getSymbolPattern(s.type,n.numberSystem,r.numericObject,s.isAccount);if(a){var h=(a=a.replace(/\u00A4/g,ga.defaultCurrency)).split(";");s.nData=ga.getFormatData(h[1]||"-"+h[0],!0,""),s.pData=ga.getFormatData(h[0],!0,"")}return function(t){return o.getParsedNumber(t,s,n)}},t.getParsedNumber=function(t,e,i){var n,o,r,s,a,l;if(-1!==t.indexOf(e.infinity))return 1/0;t=Pa.convertValueParts(t,e.symbolRegex,i.symbolMatch),0===(t=Pa.convertValueParts(t,i.numberParseRegex,i.numericPair)).indexOf(".")&&(t="0"+t);var c=t.match(/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)([Ee][+-]?[0-9]+)?([^0-9]*)$/);if(h(c))return NaN;s=c[1],r=c[2];var d=c[5];return a=c[6],n=e.custom?s===e.nData.nlead&&a===e.nData.nend:-1!==s.indexOf(e.nData.nlead)&&-1!==a.indexOf(e.nData.nend),o=n?e.nData.isPercent:e.pData.isPercent,r=r.replace(/,/g,""),d&&(r+=d),l=+r,("percent"===e.type||o)&&(l/=100),(e.custom||e.fractionDigits)&&(l=parseFloat(l.toFixed(e.custom?n?e.nData.maximumFractionDigits:e.pData.maximumFractionDigits:e.fractionDigits))),n&&(l*=-1),l},t}(),ja=new da,Fa=!1,Va={},_a="en-US",Wa="USD",Ua=["numericObject","dateObject"],qa=function(){function t(t){t&&(this.culture=t)}return t.prototype.getDateFormat=function(t){return Da.dateFormat(this.getCulture(),t||{type:"date",skeleton:"short"},Va)},t.prototype.getNumberFormat=function(t){return t&&!t.currency&&(t.currency=Wa),ka.numberFormatter(this.getCulture(),t||{},Va)},t.prototype.getDateParser=function(t){return Ba.dateParser(this.getCulture(),t||{skeleton:"short",type:"date"},Va)},t.prototype.getNumberParser=function(t){return za.numberParser(this.getCulture(),t||{format:"N"},Va)},t.prototype.formatNumber=function(t,e){return this.getNumberFormat(e)(t)},t.prototype.formatDate=function(t,e){return this.getDateFormat(e)(t)},t.prototype.parseDate=function(t,e){return this.getDateParser(e)(t)},t.prototype.parseNumber=function(t,e){return this.getNumberParser(e)(t)},t.prototype.getDatePattern=function(t,e){return ga.getActualDateTimeFormat(this.getCulture(),t,Va,e)},t.prototype.getNumberPattern=function(t){return ga.getActualNumberFormat(this.getCulture(),t,Va)},t.prototype.getFirstDayOfWeek=function(){return ga.getWeekData(this.getCulture(),Va)},t.prototype.getCulture=function(){return this.culture||_a},t}(),Xa=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ya=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ga=0,Za=0,Ka=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.randomId=v(),n.needsID=!1,n.createElement=b,h(n.enableRtl)&&n.setProperties({enableRtl:Fa},!0),h(n.locale)&&n.setProperties({locale:_a},!0),n.moduleLoader=new wa(n),n.localObserver=new da(n),n.detectFunction=new Function("args","var prop = Object.keys(args); if(prop.length){this[prop[0]] = args[prop[0]];}"),ja.on("notifyExternalChange",n.detectFunction,n,n.randomId),c(i)||n.appendTo(),n}return Xa(e,t),e.prototype.requiredModules=function(){return[]},e.prototype.destroy=function(){this.isDestroyed||(this.enablePersistence&&this.setPersistData(),this.localObserver.destroy(),this.refreshing||(this.trigger("destroyed",{cancel:!1}),t.prototype.destroy.call(this),this.moduleLoader.clean(),ja.off("notifyExternalChange",this.detectFunction,this.randomId)))},e.prototype.refresh=function(){this.refreshing=!0,this.moduleLoader.clean(),this.destroy(),this.clearChanges(),this.localObserver=new da(this),this.preRender(),this.injectModules(),this.render(),this.refreshing=!1},e.prototype.appendTo=function(e){if(h(e)||"string"!=typeof e?h(e)||(this.element=e):this.element=document.querySelector(e),!h(this.element)){this.isProtectedOnChange=!1,this.needsID&&!this.element.id&&(this.element.id=this.getUniqueID(this.getModuleName())),this.enablePersistence&&(this.mergePersistData(),window.addEventListener("unload",this.setPersistData.bind(this)));var i=n("ej2_instances",this.element);i&&-1!==i.indexOf(this)||t.prototype.addInstance.call(this),this.preRender(),this.injectModules(),this.render(),this.trigger("created")}},e.prototype.dataBind=function(){this.injectModules(),t.prototype.dataBind.call(this)},e.prototype.on=function(t,e,i){if("string"==typeof t)this.localObserver.on(t,e,i);else for(var n=0,o=t;n<o.length;n++){var r=o[n];this.localObserver.on(r.event,r.handler,r.context)}},e.prototype.off=function(t,e){if("string"==typeof t)this.localObserver.off(t,e);else for(var i=0,n=t;i<n.length;i++){var o=n[i];this.localObserver.off(o.event,o.handler)}},e.prototype.notify=function(t,e){!0!==this.isDestroyed&&this.localObserver.notify(t,e)},e.prototype.getInjectedModules=function(){return this.injectedModules},e.Inject=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var i=0;i<t.length;i++)-1===this.prototype.injectedModules.indexOf(t[i])&&this.prototype.injectedModules.push(t[i])},e.prototype.injectModules=function(){this.injectedModules&&this.injectedModules.length&&this.moduleLoader.inject(this.requiredModules(),this.injectedModules)},e.prototype.mergePersistData=function(){var t=window.localStorage.getItem(this.getModuleName()+this.element.id);h(t)||""===t||this.setProperties(JSON.parse(t),!0)},e.prototype.setPersistData=function(){this.isDestroyed||window.localStorage.setItem(this.getModuleName()+this.element.id,this.getPersistData())},e.prototype.clearTemplate=function(t){},e.prototype.getUniqueID=function(t){return this.isHistoryChanged()&&(Ga=0),Oa=this.pageID(location.href),Za=history.length,t+"_"+Oa+"_"+Ga++},e.prototype.pageID=function(t){var e=0;if(0===t.length)return e;for(var i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return Math.abs(e)},e.prototype.isHistoryChanged=function(){return Oa!==this.pageID(location.href)||Za!==history.length},e.prototype.addOnPersist=function(t){for(var e=this,i={},r=0,s=t;r<s.length;r++){var a=s[r],l=void 0;c(l=n(a,this))||o(a,this.getActualProperties(l),i)}return JSON.stringify(i,function(t,i){return e.getActualProperties(i)})},e.prototype.getActualProperties=function(t){return t instanceof xa?n("properties",t):t},e.prototype.ignoreOnPersist=function(t){return JSON.stringify(this.iterateJsonProperties(this.properties,t))},e.prototype.iterateJsonProperties=function(t,e){for(var i={},n=this,o=0,r=Object.keys(t);o<r.length;o++)!function(o){if(-1===e.indexOf(o)){var r=t[o];if("object"!=typeof r||r instanceof Array)i[o]=r;else{var s=e.filter(function(t){return new RegExp(o+".").test(t)}).map(function(t){return t.replace(o+".","")});i[o]=n.iterateJsonProperties(n.getActualProperties(r),s)}}}(r[o]);return i},Ya([Y(!1)],e.prototype,"enablePersistence",void 0),Ya([Y()],e.prototype,"enableRtl",void 0),Ya([Y()],e.prototype,"locale",void 0),e=Ya([$],e)}(pa);!function(){"undefined"!=typeof window&&window.addEventListener("popstate",function(){Ga=0})}();var Qa=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ja=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},$a={left:0,top:0,bottom:0,right:0},tl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qa(e,t),Ja([Y(0)],e.prototype,"left",void 0),Ja([Y(0)],e.prototype,"top",void 0),e}(xa),el=function(t){function e(e,n){var o=t.call(this,n,e)||this;return o.dragLimit=i.getDefaultPosition(),o.borderWidth=i.getDefaultPosition(),o.padding=i.getDefaultPosition(),o.diffX=0,o.diffY=0,o.droppables={},o.bind(),o}return Qa(e,t),i=e,e.prototype.bind=function(){this.toggleEvents(),ma.isIE&&w([this.element],"e-block-touch"),this.droppables[this.scope]={}},e.getDefaultPosition=function(){return l({},$a)},e.prototype.toggleEvents=function(t){var e;c(this.handle)||(e=O(this.handle,this.element)),t?ha.remove(e||this.element,ma.touchStartEvent,this.initialize):ha.add(e||this.element,ma.touchStartEvent,this.initialize,this)},e.prototype.initialize=function(t){if(this.target=t.currentTarget,!this.abort||h(M(t.target,this.abort))){this.preventDefault&&!c(t.changedTouches)&&t.preventDefault(),this.element.setAttribute("aria-grabbed","true");var e=this.getCoordinates(t);if(this.initialPosition={x:e.pageX,y:e.pageY},!this.clone){var i=this.element.getBoundingClientRect();this.relativeXPosition=e.pageX-i.left,this.relativeYPosition=e.pageY-i.top}ha.add(document,ma.touchMoveEvent,this.intDragStart,this),ha.add(document,ma.touchEndEvent,this.intDestroy,this),this.toggleEvents(!0),document.body.classList.add("e-prevent-select"),ha.trigger(document.documentElement,ma.touchStartEvent,t)}},e.prototype.intDragStart=function(t){var e=!c(t.changedTouches);if(!e||1===t.changedTouches.length){e&&t.preventDefault();var i,n=this.getCoordinates(t),o=getComputedStyle(this.element);this.margin={left:parseInt(o.marginLeft,10),top:parseInt(o.marginTop,10),right:parseInt(o.marginRight,10),bottom:parseInt(o.marginBottom,10)};var r=this.element;if(this.clone&&this.dragTarget){var s=M(t.target,this.dragTarget);h(s)||(r=s)}this.offset=this.calculateParentPosition(r),this.position=this.getMousePosition(t);var a=this.initialPosition.x-n.pageX,l=this.initialPosition.y-n.pageY;if(Math.sqrt(a*a+l*l)>=this.distance){var d=this.getHelperElement(t);if(!d||h(d))return;var p=this.helperElement=d;if(this.parentClientRect=this.calculateParentPosition(p.offsetParent),this.dragStart){var u=this.getProperTargetElement(t);this.trigger("dragStart",{event:t,element:r,target:u})}this.dragArea?this.setDragArea():(this.dragLimit={left:0,right:0,bottom:0,top:0},this.borderWidth={top:0,left:0}),i={left:this.position.left-this.parentClientRect.left,top:this.position.top-this.parentClientRect.top},this.clone&&!this.enableTailMode&&(this.diffX=this.position.left-this.offset.left,this.diffY=this.position.top-this.offset.top);var g=this.getProcessedPositionValue({top:i.top-this.diffY+"px",left:i.left-this.diffX+"px"});I(p,this.getDragPosition({position:"absolute",left:g.left,top:g.top})),ha.remove(document,ma.touchMoveEvent,this.intDragStart),ha.remove(document,ma.touchEndEvent,this.intDestroy),S(p)?(ha.add(document,ma.touchMoveEvent,this.intDrag,this),ha.add(document,ma.touchEndEvent,this.intDragStop,this),this.setGlobalDroppables(!1,this.element,p)):(this.toggleEvents(),document.body.classList.remove("e-prevent-select"))}}},e.prototype.elementInViewport=function(t){for(this.top=t.offsetTop,this.left=t.offsetLeft,this.width=t.offsetWidth,this.height=t.offsetHeight;t.offsetParent;)t=t.offsetParent,this.top+=t.offsetTop,this.left+=t.offsetLeft;return this.top>=window.pageYOffset&&this.left>=window.pageXOffset&&this.top+this.height<=window.pageYOffset+window.innerHeight&&this.left+this.width<=window.pageXOffset+window.innerWidth},e.prototype.getProcessedPositionValue=function(t){return this.queryPositionInfo?this.queryPositionInfo(t):t},e.prototype.calculateParentPosition=function(t){if(h(t))return{left:0,top:0};var e=t.getBoundingClientRect(),i=getComputedStyle(t);return{left:e.left+window.pageXOffset-parseInt(i.marginLeft,10),top:e.top+window.pageYOffset-parseInt(i.marginTop,10)}},e.prototype.intDrag=function(t){if(c(t.changedTouches)||1===t.changedTouches.length){var e,i;this.position=this.getMousePosition(t);var n=this.getDocumentWidthHeight("Height");n<this.position.top&&(this.position.top=n);var o=this.getDocumentWidthHeight("Width");if(o<this.position.left&&(this.position.left=o),this.drag){var r=this.getProperTargetElement(t);this.trigger("drag",{event:t,element:this.element,target:r})}var s=this.checkTargetElement(t);s.target&&s.instance?(s.instance.dragData[this.scope]=this.droppables[this.scope],s.instance.intOver(t,s.target),this.hoverObject=s):this.hoverObject&&(this.hoverObject.instance.intOut(t,s.target),this.hoverObject.instance.dragData[this.scope]=null,this.hoverObject=null);var a=this.droppables[this.scope].helper;this.parentClientRect=this.calculateParentPosition(this.helperElement.offsetParent);var l=this.parentClientRect.left,h=this.parentClientRect.top,d=this.getCoordinates(t),p=d.pageX,u=d.pageY,g=this.position.left-this.diffX,m=this.position.top-this.diffY;if(this.dragArea){var f=getComputedStyle(a);if(this.pageX!==p||this.skipDistanceCheck){var v=a.offsetWidth+(parseFloat(f.marginLeft)+parseFloat(f.marginRight));e=this.dragLimit.left>g?this.dragLimit.left:this.dragLimit.right<g+v?this.dragLimit.right-v:g}if(this.pageY!==u||this.skipDistanceCheck){var y=a.offsetHeight+(parseFloat(f.marginTop)+parseFloat(f.marginBottom));i=this.dragLimit.top>m?this.dragLimit.top:this.dragLimit.bottom<m+y?this.dragLimit.bottom-y:m}}else e=g,i=m;var b=h+this.borderWidth.top,w=l+this.borderWidth.left,x=this.getProcessedPositionValue({top:i-b+"px",left:e-w+"px"});I(a,this.getDragPosition(x)),!this.elementInViewport(a)&&this.enableAutoScroll&&this.helperElement.scrollIntoView(),this.position.left=e,this.position.top=i,this.pageX=p,this.pageY=u}},e.prototype.getDragPosition=function(t){var e=l({},t);return this.axis&&("x"===this.axis?delete e.top:"y"===this.axis&&delete e.left),e},e.prototype.getDocumentWidthHeight=function(t){var e=document.body,i=document.documentElement;return Math.max(e["scroll"+t],i["scroll"+t],e["offset"+t],i["offset"+t],i["client"+t])},e.prototype.intDragStop=function(t){if(c(t.changedTouches)||1===t.changedTouches.length){if(-1!==["touchend","pointerup","mouseup"].indexOf(t.type)){if(this.dragStop){var e=this.getProperTargetElement(t);this.trigger("dragStop",{event:t,element:this.element,target:e,helper:this.helperElement})}this.intDestroy(t)}else this.element.setAttribute("aria-grabbed","false");var i=this.checkTargetElement(t);i.target&&i.instance&&(i.instance.dragStopCalled=!0,i.instance.dragData[this.scope]=this.droppables[this.scope],i.instance.intDrop(t,i.target)),this.setGlobalDroppables(!0),document.body.classList.remove("e-prevent-select")}},e.prototype.intDestroy=function(t){this.toggleEvents(),document.body.classList.remove("e-prevent-select"),this.element.setAttribute("aria-grabbed","false"),ha.remove(document,ma.touchMoveEvent,this.intDragStart),ha.remove(document,ma.touchEndEvent,this.intDragStop),ha.remove(document,ma.touchEndEvent,this.intDestroy),ha.remove(document,ma.touchMoveEvent,this.intDrag)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"draggable"},e.prototype.setDragArea=function(){var t,e,i,n=0,o=0;if(i="string"===typeof this.dragArea?O(this.dragArea):this.dragArea){var r=i.getBoundingClientRect();t=r.width?r.width:r.right-r.left,e=r.height?r.height:r.bottom-r.top;for(var s=["Top","Left","Bottom","Right"],a=getComputedStyle(i),l=0;l<s.length;l++){var h=s[l],c=a["border"+h+"Width"],d=a["padding"+h],p=h.toLowerCase();this.borderWidth[p]=isNaN(parseFloat(c))?0:parseFloat(c),this.padding[p]=isNaN(parseFloat(d))?0:parseFloat(d)}n=r.top,o=r.left,this.dragLimit.left=o+this.borderWidth.left+this.padding.left,this.dragLimit.top=n+this.borderWidth.top+this.padding.top,this.dragLimit.right=o+t-(this.borderWidth.right+this.padding.right),this.dragLimit.bottom=n+e-(this.borderWidth.bottom+this.padding.bottom)}},e.prototype.getProperTargetElement=function(t){var e,i=this.getCoordinates(t),n=this.helperElement.style.display||"";return u(t.target,this.helperElement)||-1!==t.type.indexOf("touch")?(this.helperElement.style.display="none",e=document.elementFromPoint(i.clientX,i.clientY),this.helperElement.style.display=n):e=t.target,e},e.prototype.getMousePosition=function(t){var e=this.getCoordinates(t),i=this.clone?e.pageX:e.pageX-this.relativeXPosition,n=this.clone?e.pageY:e.pageY-this.relativeYPosition;return{left:i-(this.margin.left+this.cursorAt.left),top:n-(this.margin.top+this.cursorAt.top)}},e.prototype.getCoordinates=function(t){return t.type.indexOf("touch")>-1?t.changedTouches[0]:t},e.prototype.getHelperElement=function(t){var e;return this.clone?this.helper?e=this.helper({sender:t,element:this.target}):(e=b("div",{className:"e-drag-helper e-block-touch",innerHTML:"Draggable"}),document.body.appendChild(e)):e=this.element,e},e.prototype.setGlobalDroppables=function(t,e,i){this.droppables[this.scope]=t?null:{draggable:e,helper:i,draggedElement:this.element}},e.prototype.checkTargetElement=function(t){var e=this.getProperTargetElement(t),i=this.getDropInstance(e);if(!i&&e&&!h(e.parentNode)){var n=M(e.parentNode,".e-droppable")||e.parentElement;n&&(i=this.getDropInstance(n))}return{target:e,instance:i}},e.prototype.getDropInstance=function(t){var e,i=t&&t.ej2_instances;if(i)for(var n=0,o=i;n<o.length;n++){var r=o[n];if("droppable"===r.getModuleName()){e=r;break}}return e},e.prototype.destroy=function(){this.toggleEvents(!0),t.prototype.destroy.call(this)},Ja([G({},tl)],e.prototype,"cursorAt",void 0),Ja([Y(!0)],e.prototype,"clone",void 0),Ja([Y()],e.prototype,"dragArea",void 0),Ja([J()],e.prototype,"drag",void 0),Ja([J()],e.prototype,"dragStart",void 0),Ja([J()],e.prototype,"dragStop",void 0),Ja([Y(1)],e.prototype,"distance",void 0),Ja([Y()],e.prototype,"handle",void 0),Ja([Y()],e.prototype,"abort",void 0),Ja([Y()],e.prototype,"helper",void 0),Ja([Y("default")],e.prototype,"scope",void 0),Ja([Y("")],e.prototype,"dragTarget",void 0),Ja([Y()],e.prototype,"axis",void 0),Ja([Y()],e.prototype,"queryPositionInfo",void 0),Ja([Y(!1)],e.prototype,"enableTailMode",void 0),Ja([Y(!1)],e.prototype,"skipDistanceCheck",void 0),Ja([Y(!0)],e.prototype,"preventDefault",void 0),Ja([Y(!1)],e.prototype,"enableAutoScroll",void 0),e=i=Ja([$],e);var i}(pa),il=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),nl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},ol=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.mouseOver=!1,n.dragData={},n.dragStopCalled=!1,n.bind(),n}return il(e,t),e.prototype.bind=function(){this.wireEvents()},e.prototype.wireEvents=function(){ha.add(this.element,ma.touchEndEvent,this.intDrop,this)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"droppable"},e.prototype.intOver=function(t,e){if(!this.mouseOver){var i=this.dragData[this.scope];this.trigger("over",{event:t,target:e,dragData:i}),this.mouseOver=!0}},e.prototype.intOut=function(t,e){this.mouseOver&&(this.trigger("out",{evt:t,target:e}),this.mouseOver=!1)},e.prototype.intDrop=function(t,e){if(this.dragStopCalled){this.dragStopCalled=!1;var i,n=!0,o=this.dragData[this.scope],r=!!o&&(o.helper&&S(o.helper));r&&(i=this.isDropArea(t,o.helper,e),this.accept&&(n=R(o.helper,this.accept))),r&&this.drop&&i.canDrop&&n&&this.trigger("drop",{event:t,target:i.target,droppedElement:o.helper,dragData:o}),this.mouseOver=!1}},e.prototype.isDropArea=function(t,e,i){var n={canDrop:!0,target:i||t.target},o="touchend"===t.type;if(o||n.target===e){e.style.display="none";var r=o?t.changedTouches[0]:t,s=document.elementFromPoint(r.clientX,r.clientY);n.canDrop=!1,n.canDrop=u(s,this.element),n.canDrop&&(n.target=s),e.style.display=""}return n},e.prototype.destroy=function(){ha.remove(this.element,ma.touchEndEvent,this.intDrop),t.prototype.destroy.call(this)},nl([Y()],e.prototype,"accept",void 0),nl([Y("default")],e.prototype,"scope",void 0),nl([J()],e.prototype,"drop",void 0),nl([J()],e.prototype,"over",void 0),nl([J()],e.prototype,"out",void 0),e=nl([$],e)}(pa),rl=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},al={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222},ll=function(t){function e(e,n){var o=t.call(this,n,e)||this;return o.keyPressHandler=function(t){for(var e=t.altKey,n=t.ctrlKey,r=t.shiftKey,s=t.which,a=0,l=Object.keys(o.keyConfigs);a<l.length;a++)for(var h=l[a],c=0,d=o.keyConfigs[h].split(",");c<d.length;c++){var p=d[c],u=i.getKeyConfigData(p.trim());e===u.altKey&&n===u.ctrlKey&&r===u.shiftKey&&s===u.keyCode&&(t.action=h,o.keyAction&&o.keyAction(t))}},o.bind(),o}return rl(e,t),i=e,e.prototype.destroy=function(){this.unwireEvents(),t.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.bind=function(){this.wireEvents()},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},e.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},e.getKeyConfigData=function(t){if(t in this.configCache)return this.configCache[t];var e=t.toLowerCase().split("+"),n={altKey:-1!==e.indexOf("alt"),ctrlKey:-1!==e.indexOf("ctrl"),shiftKey:-1!==e.indexOf("shift"),keyCode:null};return e[e.length-1].length>1&&Number(e[e.length-1])?n.keyCode=Number(e[e.length-1]):n.keyCode=i.getKeyCode(e[e.length-1]),i.configCache[t]=n,n},e.getKeyCode=function(t){return al[t]||t.toUpperCase().charCodeAt(0)},e.configCache={},sl([Y({})],e.prototype,"keyConfigs",void 0),sl([Y("keyup")],e.prototype,"eventName",void 0),sl([J()],e.prototype,"keyAction",void 0),e=i=sl([$],e);var i}(pa),hl=function(){function t(t,e,i){this.controlName=t,this.localeStrings=e,this.setLocale(i||_a)}return t.prototype.setLocale=function(e){var i=this.intGetControlConstant(t.locale,e);this.currentLocale=i||this.localeStrings},t.load=function(t){this.locale=l(this.locale,t,{},!0)},t.prototype.getConstant=function(t){return this.currentLocale[t]||this.localeStrings[t]||""},t.prototype.intGetControlConstant=function(t,e){return t[e]?t[e][this.controlName]:null},t.locale={},t}(),cl=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),dl=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},pl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cl(e,t),dl([Y(50)],e.prototype,"swipeThresholdDistance",void 0),e}(xa),ul=/(Up|Down)/,gl=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.touchAction=!0,n.tapCount=0,n.startEvent=function(t){if(!0===n.touchAction){var e=t.changedTouches?t.changedTouches[0]:t;void 0!==t.changedTouches&&(n.touchAction=!1),n.isTouchMoved=!1,n.movedDirection="",n.startPoint=n.lastMovedPoint={clientX:e.clientX,clientY:e.clientY},n.startEventData=e,n.hScrollLocked=n.vScrollLocked=!1,n.tStampStart=Date.now(),n.timeOutTapHold=setTimeout(function(){n.tapHoldEvent(t)},n.tapHoldThreshold),ha.add(n.element,ma.touchMoveEvent,n.moveEvent,n),ha.add(n.element,ma.touchEndEvent,n.endEvent,n),ha.add(n.element,ma.touchCancelEvent,n.cancelEvent,n)}},n.moveEvent=function(t){var e=t.changedTouches?t.changedTouches[0]:t;n.movedPoint=e,n.isTouchMoved=!(e.clientX===n.startPoint.clientX&&e.clientY===n.startPoint.clientY);var i={};n.isTouchMoved&&(clearTimeout(n.timeOutTapHold),n.calcScrollPoints(t),i=l(i,{},{startEvents:n.startEventData,originalEvent:t,startX:n.startPoint.clientX,startY:n.startPoint.clientY,distanceX:n.distanceX,distanceY:n.distanceY,scrollDirection:n.scrollDirection,velocity:n.getVelocity(e)}),n.trigger("scroll",i),n.lastMovedPoint={clientX:e.clientX,clientY:e.clientY})},n.cancelEvent=function(t){clearTimeout(n.timeOutTapHold),clearTimeout(n.timeOutTap),n.tapCount=0,n.swipeFn(t),ha.remove(n.element,ma.touchCancelEvent,n.cancelEvent)},n.endEvent=function(t){n.swipeFn(t),n.isTouchMoved||"function"==typeof n.tap&&(n.trigger("tap",{originalEvent:t,tapCount:++n.tapCount}),n.timeOutTap=setTimeout(function(){n.tapCount=0},n.tapThreshold)),n.modeclear()},n.swipeFn=function(t){clearTimeout(n.timeOutTapHold),clearTimeout(n.timeOutTap);var e=t;t.changedTouches&&(e=t.changedTouches[0]);var i=e.clientX-n.startPoint.clientX,o=e.clientY-n.startPoint.clientY;i=Math.floor(i<0?-1*i:i),o=Math.floor(o<0?-1*o:i),n.isTouchMoved=i>1||o>1,n.endPoint=e,n.calcPoints(t);var r={originalEvent:t,startEvents:n.startEventData,startX:n.startPoint.clientX,startY:n.startPoint.clientY,distanceX:n.distanceX,distanceY:n.distanceY,swipeDirection:n.movedDirection,velocity:n.getVelocity(e)};if(n.isTouchMoved){var s=void 0,a=n.swipeSettings.swipeThresholdDistance;s=l(s,n.defaultArgs,r);var h=!1,c=n.element,d=n.isScrollable(c),p=ul.test(n.movedDirection);(a<n.distanceX&&!p||a<n.distanceY&&p)&&(h=!d||n.checkSwipe(c,p)),h&&n.trigger("swipe",s)}n.modeclear()},n.modeclear=function(){n.modeClear=setTimeout(function(){n.touchAction=!0},"function"!=typeof n.tap?0:10),n.lastTapTime=(new Date).getTime(),ha.remove(n.element,ma.touchMoveEvent,n.moveEvent),ha.remove(n.element,ma.touchEndEvent,n.endEvent),ha.remove(n.element,ma.touchCancelEvent,n.cancelEvent)},n.bind(),n}return cl(e,t),e.prototype.onPropertyChanged=function(t,e){},e.prototype.bind=function(){this.wireEvents(),ma.isIE&&this.element.classList.add("e-block-touch")},e.prototype.destroy=function(){this.unwireEvents(),t.prototype.destroy.call(this)},e.prototype.wireEvents=function(){ha.add(this.element,ma.touchStartEvent,this.startEvent,this)},e.prototype.unwireEvents=function(){ha.remove(this.element,ma.touchStartEvent,this.startEvent)},e.prototype.getModuleName=function(){return"touch"},e.prototype.isScrollable=function(t){var e=getComputedStyle(t),i=e.overflow+e.overflowX+e.overflowY;return!!/(auto|scroll)/.test(i)},e.prototype.tapHoldEvent=function(t){this.tapCount=0,this.touchAction=!0;var e;ha.remove(this.element,ma.touchMoveEvent,this.moveEvent),ha.remove(this.element,ma.touchEndEvent,this.endEvent),e={originalEvent:t},this.trigger("tapHold",e),ha.remove(this.element,ma.touchCancelEvent,this.cancelEvent)},e.prototype.calcPoints=function(t){var e=t.changedTouches?t.changedTouches[0]:t;this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(e.clientX)-Math.abs(this.startPoint.clientX)),this.distanceY=Math.abs(Math.abs(e.clientY)-Math.abs(this.startPoint.clientY)),this.distanceX>this.distanceY?this.movedDirection=e.clientX>this.startPoint.clientX?"Right":"Left":this.movedDirection=e.clientY<this.startPoint.clientY?"Up":"Down"},e.prototype.calcScrollPoints=function(t){var e=t.changedTouches?t.changedTouches[0]:t;this.defaultArgs={originalEvent:t},this.distanceX=Math.abs(Math.abs(e.clientX)-Math.abs(this.lastMovedPoint.clientX)),this.distanceY=Math.abs(Math.abs(e.clientY)-Math.abs(this.lastMovedPoint.clientY)),(this.distanceX>this.distanceY||!0===this.hScrollLocked)&&!1===this.vScrollLocked?(this.scrollDirection=e.clientX>this.lastMovedPoint.clientX?"Right":"Left",this.hScrollLocked=!0):(this.scrollDirection=e.clientY<this.lastMovedPoint.clientY?"Up":"Down",this.vScrollLocked=!0)},e.prototype.getVelocity=function(t){var e=t.clientX,i=t.clientY,n=Date.now(),o=e-this.startPoint.clientX,r=i-this.startPoint.clientX,s=n-this.tStampStart;return Math.sqrt(o*o+r*r)/s},e.prototype.checkSwipe=function(t,e){var i=["scroll","offset"],n=e?["Height","Top"]:["Width","Left"];return t[i[0]+n[0]]<=t[i[1]+n[0]]||(0===t[i[0]+n[1]]||t[i[1]+n[0]]+t[i[0]+n[1]]>=t[i[0]+n[0]])},dl([J()],e.prototype,"tap",void 0),dl([J()],e.prototype,"tapHold",void 0),dl([J()],e.prototype,"swipe",void 0),dl([J()],e.prototype,"scroll",void 0),dl([Y(350)],e.prototype,"tapThreshold",void 0),dl([Y(750)],e.prototype,"tapHoldThreshold",void 0),dl([G({},pl)],e.prototype,"swipeSettings",void 0),e=dl([$],e)}(pa),ml=new RegExp("\\n|\\r|\\s\\s+","g"),fl=new RegExp(/'|"/g),vl=new RegExp("if ?\\("),yl=new RegExp("else if ?\\("),bl=new RegExp("else"),wl=new RegExp("for ?\\("),xl=new RegExp("(/if|/for)"),Cl=new RegExp("\\((.*)\\)",""),Sl=new RegExp("^[0-9]+$","g"),El=new RegExp("[\\w\"'.\\s+]+","g"),Pl=new RegExp('"(.*?)"',"g"),Ll=new RegExp("\\${([^}]*)}","g"),Tl=/^[\n\r.]+\<tr|^\<tr/,kl=/^[\n\r.]+\<svg|^\<path|^\<g/,Ol={compile:(new(function(){function t(){}return t.prototype.compile=function(t,e){return void 0===e&&(e={}),ht(t,e)},t}())).compile},Al=function(){function t(t,e){this.width=t,this.height=e}return t.prototype.isEmpty=function(){return 0===this.height&&0===this.width},t.prototype.clone=function(){return new t(this.width,this.height)},t}(),Ml=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Il=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Dl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ml(e,t),e.equals=function(t,e){return t===e||!(!t||!e)&&(!t||!e||t.x===e.x&&t.y===e.y)},e.isEmptyPoint=function(t){return!t.x||!t.y},e.transform=function(t,e,i){var n={x:0,y:0};return n.x=Math.round(100*(t.x+i*Math.cos(e*Math.PI/180)))/100,n.y=Math.round(100*(t.y+i*Math.sin(e*Math.PI/180)))/100,n},e.findLength=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},e.findAngle=function(t,e){var i=Math.atan2(e.y-t.y,e.x-t.x);return i=180*i/Math.PI,(i%=360)<0&&(i+=360),i},e.distancePoints=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},e.adjustPoint=function(t,e,i,n){var o,r=i?{x:t.x,y:t.y}:{x:e.x,y:e.y};return t.x===e.x?t.y<e.y&&i||t.y>e.y&&!i?r.y+=n:r.y-=n:t.y===e.y?t.x<e.x&&i||t.x>e.x&&!i?r.x+=n:r.x-=n:i?(o=this.findAngle(t,e),r=this.transform(t,o,n)):(o=this.findAngle(e,t),r=this.transform(e,o,n)),r},e.direction=function(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?t.x<e.x?"Right":"Left":t.y<e.y?"Bottom":"Top"},Il([Y(0)],e.prototype,"x",void 0),Il([Y(0)],e.prototype,"y",void 0),e}(xa),Rl=function(){function t(t,e,i,n){this.x=Number.MAX_VALUE,this.y=Number.MAX_VALUE,this.width=0,this.height=0,void 0===t||void 0===e?(t=e=Number.MAX_VALUE,i=n=0):(void 0===i&&(i=0),void 0===n&&(n=0)),this.x=t,this.y=e,this.width=i,this.height=n}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return{x:this.left,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return{x:this.right,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return{x:this.left,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return{x:this.right,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"middleLeft",{get:function(){return{x:this.left,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"middleRight",{get:function(){return{x:this.right,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topCenter",{get:function(){return{x:this.x+this.width/2,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomCenter",{get:function(){return{x:this.x+this.width/2,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),t.prototype.equals=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},t.prototype.uniteRect=function(t){var e=Math.max(Number.NaN===this.right||this.x===Number.MAX_VALUE?t.right:this.right,t.right),i=Math.max(Number.NaN===this.bottom||this.y===Number.MAX_VALUE?t.bottom:this.bottom,t.bottom);return this.x=Math.min(this.left,t.left),this.y=Math.min(this.top,t.top),this.width=e-this.x,this.height=i-this.y,this},t.prototype.unitePoint=function(t){if(this.x===Number.MAX_VALUE)return this.x=t.x,void(this.y=t.y);var e=Math.min(this.left,t.x),i=Math.min(this.top,t.y),n=Math.max(this.right,t.x),o=Math.max(this.bottom,t.y);this.x=e,this.y=i,this.width=n-this.x,this.height=o-this.y},t.prototype.Inflate=function(t){return this.x-=t,this.y-=t,this.width+=2*t,this.height+=2*t,this},t.prototype.intersects=function(t){return!(this.right<t.left||this.left>t.right||this.top>t.bottom||this.bottom<t.top)},t.prototype.containsRect=function(t){return this.left<=t.left&&this.right>=t.right&&this.top<=t.top&&this.bottom>=t.bottom},t.prototype.containsPoint=function(t,e){return void 0===e&&(e=0),this.left-e<=t.x&&this.right+e>=t.x&&this.top-e<=t.y&&this.bottom+e>=t.y},t.toBounds=function(e){for(var i=new t,n=0,o=e;n<o.length;n++){var r=o[n];i.unitePoint(r)}return i},t.empty=new t(Number.MAX_VALUE,Number.MIN_VALUE,0,0),t}();!function(t){t[t.Identity=0]="Identity",t[t.Translation=1]="Translation",t[t.Scaling=2]="Scaling",t[t.Unknown=4]="Unknown"}(t.MatrixTypes||(t.MatrixTypes={}));var Nl=function(){function t(t,e,i,n,o,r,s){this.m11=t,this.m12=e,this.m21=i,this.m22=n,this.offsetX=o,this.offsetY=r,this.type=s}return t}();!function(t){t[t.Visible=1]="Visible",t[t.Hidden=2]="Hidden",t[t.Hover=4]="Hover",t[t.Connect=8]="Connect"}(t.PortVisibility||(t.PortVisibility={})),function(t){t[t.None=0]="None",t[t.ShowHorizontalLines=1]="ShowHorizontalLines",t[t.ShowVerticalLines=2]="ShowVerticalLines",t[t.ShowLines=3]="ShowLines",t[t.SnapToHorizontalLines=4]="SnapToHorizontalLines",t[t.SnapToVerticalLines=8]="SnapToVerticalLines",t[t.SnapToLines=12]="SnapToLines",t[t.SnapToObject=16]="SnapToObject",t[t.All=31]="All"}(t.SnapConstraints||(t.SnapConstraints={})),function(t){t[t.None=1]="None",t[t.ConnectorSourceThumb=2]="ConnectorSourceThumb",t[t.ConnectorTargetThumb=4]="ConnectorTargetThumb",t[t.ResizeSouthEast=8]="ResizeSouthEast",t[t.ResizeSouthWest=16]="ResizeSouthWest",t[t.ResizeNorthEast=32]="ResizeNorthEast",t[t.ResizeNorthWest=64]="ResizeNorthWest",t[t.ResizeEast=128]="ResizeEast",t[t.ResizeWest=256]="ResizeWest",t[t.ResizeSouth=512]="ResizeSouth",t[t.ResizeNorth=1024]="ResizeNorth",t[t.Rotate=2048]="Rotate",t[t.UserHandle=4096]="UserHandle",t[t.ToolTip=8192]="ToolTip",t[t.ResizeAll=2046]="ResizeAll",t[t.All=16382]="All"}(t.SelectorConstraints||(t.SelectorConstraints={})),function(t){t[t.None=1]="None",t[t.Select=2]="Select",t[t.Delete=4]="Delete",t[t.Drag=8]="Drag",t[t.DragSourceEnd=16]="DragSourceEnd",t[t.DragTargetEnd=32]="DragTargetEnd",t[t.DragSegmentThumb=64]="DragSegmentThumb",t[t.AllowDrop=128]="AllowDrop",t[t.Bridging=256]="Bridging",t[t.BridgeObstacle=512]="BridgeObstacle",t[t.InheritBridging=1024]="InheritBridging",t[t.PointerEvents=2048]="PointerEvents",t[t.Tooltip=4096]="Tooltip",t[t.InheritTooltip=8192]="InheritTooltip",t[t.Interaction=4218]="Interaction",t[t.ReadOnly=16384]="ReadOnly",t[t.Default=11838]="Default"}(t.ConnectorConstraints||(t.ConnectorConstraints={})),function(t){t[t.ReadOnly=2]="ReadOnly",t[t.InheritReadOnly=4]="InheritReadOnly"}(t.AnnotationConstraints||(t.AnnotationConstraints={})),function(t){t[t.None=0]="None",t[t.Select=2]="Select",t[t.Drag=4]="Drag",t[t.Rotate=8]="Rotate",t[t.Shadow=16]="Shadow",t[t.PointerEvents=32]="PointerEvents",t[t.Delete=64]="Delete",t[t.InConnect=128]="InConnect",t[t.OutConnect=256]="OutConnect",t[t.Individual=512]="Individual",t[t.Expandable=1024]="Expandable",t[t.AllowDrop=2048]="AllowDrop",t[t.Inherit=78]="Inherit",t[t.ResizeNorthEast=4096]="ResizeNorthEast",t[t.ResizeEast=8192]="ResizeEast",t[t.ResizeSouthEast=16384]="ResizeSouthEast",t[t.ResizeSouth=32768]="ResizeSouth",t[t.ResizeSouthWest=65536]="ResizeSouthWest",t[t.ResizeWest=131072]="ResizeWest",t[t.ResizeNorthWest=262144]="ResizeNorthWest",t[t.ResizeNorth=524288]="ResizeNorth",t[t.Resize=1044480]="Resize",t[t.AspectRatio=1048576]="AspectRatio",t[t.Tooltip=2097152]="Tooltip",t[t.InheritTooltip=4194304]="InheritTooltip",t[t.ReadOnly=8388608]="ReadOnly",t[t.Default=5240814]="Default"}(t.NodeConstraints||(t.NodeConstraints={})),function(t){t[t.Rotate=2]="Rotate",t[t.ConnectorSource=4]="ConnectorSource",t[t.ConnectorTarget=8]="ConnectorTarget",t[t.ResizeNorthEast=16]="ResizeNorthEast",t[t.ResizeEast=32]="ResizeEast",t[t.ResizeSouthEast=64]="ResizeSouthEast",t[t.ResizeSouth=128]="ResizeSouth",t[t.ResizeSouthWest=256]="ResizeSouthWest",t[t.ResizeWest=512]="ResizeWest",t[t.ResizeNorthWest=1024]="ResizeNorthWest",t[t.ResizeNorth=2048]="ResizeNorth",t[t.Default=4094]="Default"}(t.ThumbsConstraints||(t.ThumbsConstraints={})),function(t){t[t.None=1]="None",t[t.Bridging=2]="Bridging",t[t.UndoRedo=4]="UndoRedo",t[t.Tooltip=8]="Tooltip",t[t.UserInteraction=16]="UserInteraction",t[t.ApiUpdate=32]="ApiUpdate",t[t.PageEditable=48]="PageEditable",t[t.Zoom=64]="Zoom",t[t.PanX=128]="PanX",t[t.PanY=256]="PanY",t[t.Pan=384]="Pan",t[t.Default=500]="Default"}(t.DiagramConstraints||(t.DiagramConstraints={})),function(t){t[t.None=0]="None",t[t.SingleSelect=1]="SingleSelect",t[t.MultipleSelect=2]="MultipleSelect",t[t.ZoomPan=4]="ZoomPan",t[t.DrawOnce=8]="DrawOnce",t[t.ContinuousDraw=16]="ContinuousDraw",t[t.Default=3]="Default"}(t.DiagramTools||(t.DiagramTools={})),function(t){t[t.Self=1]="Self",t[t.Parent=2]="Parent"}(t.Transform||(t.Transform={})),function(t){t[t.Canvas=0]="Canvas",t[t.Svg=1]="Svg"}(t.RenderMode||(t.RenderMode={})),function(t){t[t.None=0]="None",t[t.Control=1]="Control",t[t.Meta=1]="Meta",t[t.Alt=2]="Alt",t[t.Shift=4]="Shift"}(t.KeyModifiers||(t.KeyModifiers={})),function(t){t[t.None=null]="None",t[t.Number0=0]="Number0",t[t.Number1=1]="Number1",t[t.Number2=2]="Number2",t[t.Number3=3]="Number3",t[t.Number4=4]="Number4",t[t.Number5=5]="Number5",t[t.Number6=6]="Number6",t[t.Number7=7]="Number7",t[t.Number8=8]="Number8",t[t.Number9=9]="Number9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.Delete=46]="Delete",t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.BackSpace=8]="BackSpace",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.Star=56]="Star",t[t.Plus=187]="Plus",t[t.Minus=189]="Minus"}(t.Keys||(t.Keys={})),function(t){t[t.Render=2]="Render",t[t.PublicMethod=4]="PublicMethod",t[t.ToolAction=8]="ToolAction",t[t.UndoRedo=16]="UndoRedo",t[t.TextEdit=32]="TextEdit",t[t.Group=64]="Group",t[t.Clear=128]="Clear"}(t.DiagramAction||(t.DiagramAction={})),function(t){t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Three=3]="Three",t[t.Four=4]="Four",t[t.Five=5]="Five"}(t.NoOfSegments||(t.NoOfSegments={})),function(t){t[t.collectionChange=0]="collectionChange",t[t.rotateChange=1]="rotateChange",t[t.positionChange=2]="positionChange",t[t.propertyChange=3]="propertyChange",t[t.selectionChange=4]="selectionChange",t[t.sizeChange=5]="sizeChange",t[t.drop=6]="drop",t[t.sourcePointChange=7]="sourcePointChange",t[t.targetPointChange=8]="targetPointChange",t[t.connectionChange=9]="connectionChange",t[t.animationComplete=10]="animationComplete",t[t.click=11]="click",t[t.doubleClick=12]="doubleClick",t[t.scrollChange=13]="scrollChange",t[t.dragEnter=14]="dragEnter",t[t.dragLeave=15]="dragLeave",t[t.dragOver=16]="dragOver",t[t.textEdit=17]="textEdit",t[t.paletteSelectionChange=18]="paletteSelectionChange",t[t.historyChange=19]="historyChange",t[t.mouseEnter=20]="mouseEnter",t[t.mouseLeave=21]="mouseLeave",t[t.mouseOver=22]="mouseOver"}(t.DiagramEvent||(t.DiagramEvent={})),function(t){t[t.None=1]="None",t[t.Drag=2]="Drag",t[t.Draw=4]="Draw"}(t.PortConstraints||(t.PortConstraints={}));var Bl,Hl,zl,jl,Fl,Vl,_l,Wl=function(){function e(){this.pivot={x:.5,y:.5},this.isDirt=!0,this.visible=!0,this.offsetX=0,this.offsetY=0,this.cornerRadius=0,this.minHeight=void 0,this.minWidth=void 0,this.maxWidth=void 0,this.maxHeight=void 0,this.width=void 0,this.height=void 0,this.rotateAngle=0,this.margin={left:0,right:0,top:0,bottom:0},this.horizontalAlignment="Auto",this.verticalAlignment="Auto",this.relativeMode="Point",this.transform=t.Transform.Self|t.Transform.Parent,this.style={fill:"white",strokeColor:"black",opacity:1,strokeWidth:1},this.desiredSize=new Al,this.actualSize=new Al,this.parentTransform=0,this.isSvgRender=!1,this.bounds=new Rl(0,0,0,0),this.corners=new Rl(0,0,0,0),this.shadow=null,this.description="",this.staticSize=!1,this.isRectElement=!1,this.position=void 0,this.unitMode=void 0,this.float=!1,this.floatingBounds=void 0,this.id=qr()}return e.prototype.setOffsetWithRespectToBounds=function(t,e,i){this.unitMode=i,this.position={x:t,y:e}},e.prototype.getAbsolutePosition=function(t){if(void 0!==this.position)return"Absolute"===this.unitMode?this.position:{x:this.position.x*t.width,y:this.position.y*t.height}},Object.defineProperty(e.prototype,"outerBounds",{get:function(){return this.floatingBounds||this.bounds},set:function(t){this.floatingBounds=t},enumerable:!0,configurable:!0}),e.prototype.measure=function(t){var e=void 0!==this.width?this.width:(t.width||0)-this.margin.left-this.margin.right,i=void 0!==this.height?this.height:(t.height||0)-this.margin.top-this.margin.bottom;return this.desiredSize=new Al(e,i),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=t,this.updateBounds(),this.actualSize},e.prototype.updateBounds=function(){this.bounds=Xr(this)},e.prototype.validateDesiredSize=function(t,e){return!this.isRectElement||this.width||this.minWidth||this.maxWidth||(t.width=50),!this.isRectElement||this.height||this.minHeight||this.maxHeight||(t.height=50),(void 0===t||void 0!==this.width&&void 0!==this.height)&&((t=t||new Al).width=void 0===this.width?(e.width||0)-this.margin.left-this.margin.right:this.width,t.height=void 0===this.height?(e.height||0)-this.margin.top-this.margin.bottom:this.height),void 0!==this.minWidth&&(t.width=Math.max(t.width,this.minWidth)),void 0!==this.minHeight&&(t.height=Math.max(t.height,this.minHeight)),void 0!==this.maxWidth&&(t.width=Math.min(t.width,this.maxWidth)),void 0!==this.maxHeight&&(t.height=Math.min(t.height,this.maxHeight)),t},e}(),Ul=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ql=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Xl=function(t){switch(t.type){case"Linear":return Jl;case"Radial":return $l;default:return Jl}},Yl=function(){function t(t,e,i,n){this.left=t,this.right=e,this.top=i,this.bottom=n}return t}(),Gl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y(0)],e.prototype,"left",void 0),ql([Y(0)],e.prototype,"right",void 0),ql([Y(0)],e.prototype,"top",void 0),ql([Y(0)],e.prototype,"bottom",void 0),e}(xa),Zl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y(45)],e.prototype,"angle",void 0),ql([Y(5)],e.prototype,"distance",void 0),ql([Y(.7)],e.prototype,"opacity",void 0),ql([Y("lightgrey")],e.prototype,"color",void 0),e}(xa),Kl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y("")],e.prototype,"color",void 0),ql([Y(0)],e.prototype,"offset",void 0),ql([Y(1)],e.prototype,"opacity",void 0),e}(xa),Ql=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([K([],Kl)],e.prototype,"stops",void 0),ql([Y("None")],e.prototype,"type",void 0),ql([Y("")],e.prototype,"id",void 0),e}(xa),Jl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y(0)],e.prototype,"x1",void 0),ql([Y(0)],e.prototype,"x2",void 0),ql([Y(0)],e.prototype,"y1",void 0),ql([Y(0)],e.prototype,"y2",void 0),e}(Ql),$l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y(0)],e.prototype,"cx",void 0),ql([Y(0)],e.prototype,"cy",void 0),ql([Y(0)],e.prototype,"fx",void 0),ql([Y(0)],e.prototype,"fy",void 0),ql([Y(50)],e.prototype,"r",void 0),e}(Ql),th=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y("white")],e.prototype,"fill",void 0),ql([Y("black")],e.prototype,"strokeColor",void 0),ql([Y("")],e.prototype,"strokeDashArray",void 0),ql([Y(1)],e.prototype,"strokeWidth",void 0),ql([Y(1)],e.prototype,"opacity",void 0),ql([Z(Xl)],e.prototype,"gradient",void 0),e}(xa),eh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y("transparent")],e.prototype,"fill",void 0),e}(th),ih=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ul(e,t),ql([Y("black")],e.prototype,"color",void 0),ql([Y("Arial")],e.prototype,"fontFamily",void 0),ql([Y(12)],e.prototype,"fontSize",void 0),ql([Y(!1)],e.prototype,"italic",void 0),ql([Y(!1)],e.prototype,"bold",void 0),ql([Y("CollapseSpace")],e.prototype,"whiteSpace",void 0),ql([Y("WrapWithOverflow")],e.prototype,"textWrapping",void 0),ql([Y("Center")],e.prototype,"textAlign",void 0),ql([Y("None")],e.prototype,"textDecoration",void 0),ql([Y("Wrap")],e.prototype,"textOverflow",void 0),e}(th),nh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),oh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.padding=new Yl(0,0,0,0),e.desiredBounds=void 0,e.measureChildren=!0,e.prevRotateAngle=0,e}return nh(e,t),e.prototype.hasChildren=function(){return void 0!==this.children&&this.children.length>0},e.prototype.measure=function(t){this.desiredBounds=void 0;var i,n,o=void 0;if(this.hasChildren()){for(var r=0;r<this.children.length;r++){var s="Stretch"===(i=this.children[r]).horizontalAlignment||"Stretch"===i.verticalAlignment;(this.measureChildren||s||i instanceof e&&void 0!==i.measureChildren)&&i.measure(t),n=this.GetChildrenBounds(i),"Stretch"!==i.horizontalAlignment&&"Stretch"!==i.verticalAlignment&&(void 0===this.desiredBounds?this.desiredBounds=n:this.desiredBounds.uniteRect(n))}if(void 0!==this.desiredBounds&&0!==this.rotateAngle){var a={x:this.desiredBounds.x+this.desiredBounds.width*this.pivot.x,y:this.desiredBounds.y+this.desiredBounds.height*this.pivot.y},l=rs(this.rotateAngle,void 0,void 0,a);this.desiredBounds.x=l.x-this.desiredBounds.width*this.pivot.x,this.desiredBounds.y=l.y-this.desiredBounds.height*this.pivot.y}this.desiredBounds&&(o=new Al(this.desiredBounds.width,this.desiredBounds.height))}return o=this.validateDesiredSize(o,t),this.stretchChildren(o),this.desiredSize=o,o},e.prototype.arrange=function(t){var i,n=this.desiredBounds;if(n){this.offsetX,this.offsetY;if(this.offsetX=n.x+n.width*this.pivot.x,this.offsetY=n.y+n.height*this.pivot.y,this.hasChildren())for(var o=0;o<this.children.length;o++){var r=!1;"Stretch"===(i=this.children[o]).horizontalAlignment&&(i.offsetX=this.offsetX,i.parentTransform=this.parentTransform+this.rotateAngle,r=!0),"Stretch"===i.verticalAlignment&&(i.offsetY=this.offsetY,i.parentTransform=this.parentTransform+this.rotateAngle,r=!0),(r||this.measureChildren||i instanceof e&&void 0!==i.measureChildren)&&i.arrange(i.desiredSize)}}return this.actualSize=t,this.updateBounds(),this.prevRotateAngle=this.rotateAngle,t},e.prototype.stretchChildren=function(t){if(this.hasChildren())for(var i=0,n=this.children;i<n.length;i++){var o=n[i];"Stretch"!==o.horizontalAlignment&&void 0!==o.desiredSize.width||(o.desiredSize.width=t.width-o.margin.left-o.margin.right),"Stretch"!==o.verticalAlignment&&void 0!==o.desiredSize.height||(o.desiredSize.height=t.height-o.margin.top-o.margin.bottom),o instanceof e&&o.stretchChildren(o.desiredSize)}},e.prototype.applyPadding=function(t){t.width+=this.padding.left+this.padding.right,t.height+=this.padding.top+this.padding.bottom},e.prototype.findChildOffsetFromCenter=function(t,e){var i=ss({x:e.x-t.desiredSize.width/2,y:e.y-t.desiredSize.height/2},t);i=rs(t.rotateAngle,e.x,e.y,i),i=rs(this.rotateAngle+this.parentTransform,this.offsetX,this.offsetY,i),t.offsetX=i.x,t.offsetY=i.y},e.prototype.GetChildrenBounds=function(t){var e;e=t.desiredSize.clone();t.rotateAngle,this.rotateAngle;var i={x:t.offsetX,y:t.offsetY},n=i.x-e.width*t.pivot.x,o=i.y-e.height*t.pivot.y,r=n+e.width,s=o+e.height,a={x:n,y:o},l={x:r,y:o},h={x:n,y:s},c={x:r,y:s};return a=rs(t.rotateAngle,t.offsetX,t.offsetY,a),l=rs(t.rotateAngle,t.offsetX,t.offsetY,l),h=rs(t.rotateAngle,t.offsetX,t.offsetY,h),c=rs(t.rotateAngle,t.offsetX,t.offsetY,c),0!==this.rotateAngle&&(a=rs(-this.rotateAngle,void 0,void 0,a),l=rs(-this.rotateAngle,void 0,void 0,l),h=rs(-this.rotateAngle,void 0,void 0,h),c=rs(-this.rotateAngle,void 0,void 0,c)),Rl.toBounds([a,l,h,c])},e}(Wl),rh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sh=function(t){function e(){var e=t.call(this)||this;return e.pathData="",e.transformPath=!0,e.absolutePath="",e.absoluteBounds=new Rl,e}return rh(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.pathData},set:function(t){this.pathData!==t&&(this.pathData=t,this.isDirt=!0)},enumerable:!0,configurable:!0}),e.prototype.getPoints=function(){var t=this;return this.pointTimer||(this.pointTimer=setTimeout(function(){t.points=null,t.pointTimer=null},200)),this.points=this.points||nr(this),rr(this,this.points)},e.prototype.measure=function(t){return this.staticSize&&void 0!==this.width&&void 0!==this.height?this.absoluteBounds=new Rl(this.offsetX-this.width*this.pivot.x,this.offsetY-this.height*this.pivot.y,this.width,this.height):this.isDirt&&(this.transformPath||void 0===this.width||void 0===this.height)&&(this.absoluteBounds=sr(this.data?this.data:"")),void 0===this.width?this.desiredSize=new Al(this.absoluteBounds.width,this.height||this.absoluteBounds.height):void 0===this.height?this.desiredSize=new Al(this.width||this.absoluteBounds.width,this.absoluteBounds.height):this.desiredSize=new Al(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return(this.isDirt||this.actualSize.width!==t.width||this.actualSize.height!==t.height)&&(this.isDirt=!0,this.absolutePath=this.updatePath(this.data,this.absoluteBounds,t),this.staticSize||(this.points=null)),this.actualSize=this.desiredSize,this.updateBounds(),this.isDirt=!1,this.actualSize},e.prototype.updatePath=function(t,e,i){var n=!1,o="",r=-e.x,s=-e.y,a=[];return i.width===e.width&&i.height===e.height||(r=i.width/Number(e.width?e.width:1),s=i.height/Number(e.height?e.height:1),n=!0),a=ut(t),a=xt(a),o=(n||this.isDirt)&&this.transformPath?yt(a,r,s,n,e.x,e.y,0,0):Ct(a),n=!1,o},e}(Wl),ah=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),lh=function(t){function e(e,i){var n=t.call(this)||this;return n.data="",n.nodeId="",n.diagramId="",n.scale="Stretch",n.diagramId=i,n.nodeId=e,n}return ah(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.data},set:function(t){this.data=t,this.template=Vr(this,!1),this.isDirt=!0},enumerable:!0,configurable:!0}),e.prototype.measure=function(t){if(this.isDirt){var e=gr(this.template);this.contentSize=new Al,this.contentSize.width=e.width,this.contentSize.height=e.height;var i=e.x,n=e.y;this.templatePosition={x:i,y:n},this.isDirt=!1}if(void 0===this.width||void 0===this.height){var o=mr(this.template);this.desiredSize=new Al(o.width,o.height)}else this.desiredSize=new Al(this.width,this.height);return this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=new Al(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize},e}(Wl),hh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ch=function(t){function e(){var e=t.call(this)||this;return e.textContent="",e.hyperlink={color:"blue"},e.doWrap=!0,e.textNodes=[],e.style={color:"black",fill:"white",strokeColor:"black",strokeWidth:1,fontFamily:"Arial",fontSize:12,whiteSpace:"CollapseSpace",textWrapping:"WrapWithOverflow",textAlign:"Center",italic:!1,bold:!1,textDecoration:"None",strokeDashArray:"",opacity:5,gradient:null,textOverflow:"Wrap"},e}return hh(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.textContent},set:function(t){this.textContent!==t&&(this.textContent=t,this.isDirt=!0,this.doWrap=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.textNodes},set:function(t){this.textNodes=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapBounds",{get:function(){return this.textWrapBounds},set:function(t){this.textWrapBounds=t},enumerable:!0,configurable:!0}),e.prototype.refreshTextElement=function(){this.isDirt=!0},e.prototype.measure=function(t){var e;return e=this.isDirt?pr(this,this.style,this.content,this.width):this.desiredSize,void 0===this.width||void 0===this.height?this.desiredSize=new Al(e.width,e.height):this.desiredSize=new Al(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return(t.width!==this.actualSize.width||t.height!==this.actualSize.height||this.isDirt)&&(this.doWrap=!0),this.actualSize=t,this.updateBounds(),this.isDirt=!1,this.actualSize},e}(Wl),dh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ph=function(t){function e(){var e=t.call(this)||this;return e.imageSource="",e.imageScale="None",e.imageAlign="None",e.stretch="Stretch",e}return dh(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this.imageSource},set:function(t){this.imageSource=t,this.isDirt=!0},enumerable:!0,configurable:!0}),e.prototype.measure=function(t){return this.isDirt&&("Stretch"!==this.stretch||void 0===this.width&&void 0===this.height)&&(this.contentSize=ur(this.source,this.contentSize),this.isDirt=!1),void 0!==this.width&&void 0!==this.height?(this.desiredSize=new Al(this.width,this.height),this.contentSize=this.desiredSize):this.desiredSize=this.contentSize,this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=new Al(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize},e}(Wl),uh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gh=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.measureChildren=void 0,t}return uh(i,e),i.prototype.measure=function(t){var i=void 0,n=void 0;if(this.hasChildren()){for(var o=0,r=this.children;o<r.length;o++){var s=r[o];s.measure(t);var a=s.desiredSize.clone();0!==s.rotateAngle&&(a=os(a,s.rotateAngle));var l=a.width+s.margin.right,h=a.height+s.margin.bottom,c=new Rl(s.margin.left,s.margin.top,l,h);s.float&&void 0!==s.getAbsolutePosition(a)||(void 0===n?n=c:n.uniteRect(c))}if(n){var d=0,p=0;d=Math.max(n.left,0),p=Math.max(n.top,0),i=new Al(n.width+d,n.height+p)}}return i=e.prototype.validateDesiredSize.call(this,i,t),e.prototype.stretchChildren.call(this,i),i.width+=this.padding.left+this.padding.right,i.height+=this.padding.top+this.padding.bottom,this.desiredSize=i,i},i.prototype.arrange=function(i){if(this.outerBounds=new Rl,this.hasChildren()){var n=void 0,o=void 0;n=this.offsetY-i.height*this.pivot.y+this.padding.top,o=this.offsetX-i.width*this.pivot.x+this.padding.left;for(var r=0,s=this.children;r<s.length;r++){var a=s[r];if(0!=(a.transform&t.Transform.Parent)){a.parentTransform=this.parentTransform+this.rotateAngle;var l=a.desiredSize.clone();0!==a.rotateAngle&&(l=os(l,a.rotateAngle));var h=void 0,c={x:0,y:0},d=o,p=n;if("Point"===a.relativeMode){var u=a.getAbsolutePosition(i);void 0!==u&&(d+=u.x,p+=u.y)}c={x:(h="Object"===a.relativeMode?this.alignChildBasedOnParent(a,l,i,d,p):this.alignChildBasedOnaPoint(a,d,p)).x+l.width/2,y:h.y+l.height/2},e.prototype.findChildOffsetFromCenter.call(this,a,c)}a.arrange(a.desiredSize),this.outerBounds.uniteRect(a.outerBounds)}}return this.actualSize=i,this.updateBounds(),this.outerBounds.uniteRect(this.bounds),i},i.prototype.alignChildBasedOnParent=function(t,e,i,n,o){switch(t.horizontalAlignment){case"Auto":case"Left":n+=t.margin.left;break;case"Right":n+=i.width-e.width-t.margin.right;break;case"Stretch":case"Center":n+=i.width/2-e.width/2}switch(t.verticalAlignment){case"Auto":case"Top":o+=t.margin.top;break;case"Bottom":o+=i.height-e.height-t.margin.bottom;break;case"Stretch":case"Center":o+=i.height/2-e.height/2}return{x:n,y:o}},i.prototype.alignChildBasedOnaPoint=function(t,e,i){switch(t.horizontalAlignment){case"Auto":case"Left":e+=t.margin.left;break;case"Stretch":case"Center":e-=t.desiredSize.width*t.pivot.x;break;case"Right":e-=t.desiredSize.width+t.margin.right}switch(t.verticalAlignment){case"Auto":case"Top":i+=t.margin.top;break;case"Stretch":case"Center":i-=t.desiredSize.height*t.pivot.y;break;case"Bottom":i-=t.desiredSize.height+t.margin.bottom}return{x:e,y:i}},i}(oh),mh={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Ellipse:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Triangle:"M45,0 L90,45 L0,45 L45,0 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Pentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Trapezoid:"M127.2842,291.4492 L95.0322,291.4492 L81.1582,256.3152 L141.1582,256.3152 L127.2842,291.4492 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Cylinder:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z"},fh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},yh=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return fh(i,e),vh([Y("")],i.prototype,"id",void 0),vh([Y("Center")],i.prototype,"horizontalAlignment",void 0),vh([Y("Center")],i.prototype,"verticalAlignment",void 0),vh([G({},Gl)],i.prototype,"margin",void 0),vh([Y(12)],i.prototype,"width",void 0),vh([Y(12)],i.prototype,"height",void 0),vh([G({},th)],i.prototype,"style",void 0),vh([Y("Square")],i.prototype,"shape",void 0),vh([Y(t.PortVisibility.Connect)],i.prototype,"visibility",void 0),vh([Y("")],i.prototype,"pathData",void 0),vh([Y(t.PortConstraints.None)],i.prototype,"constraints",void 0),vh([Y()],i.prototype,"addInfo",void 0),i}(xa),bh=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return fh(e,t),vh([G({x:.5,y:.5},Dl)],e.prototype,"offset",void 0),e}(yh),wh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ch=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wh(e,t),xh([Y("blue")],e.prototype,"color",void 0),xh([Y("")],e.prototype,"content",void 0),xh([Y("")],e.prototype,"link",void 0),xh([Y("None")],e.prototype,"textDecoration",void 0),e}(xa),Sh=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return wh(i,e),xh([Y("")],i.prototype,"content",void 0),xh([Y(!0)],i.prototype,"visibility",void 0),xh([Y(t.AnnotationConstraints.InheritReadOnly)],i.prototype,"constraints",void 0),xh([G(void 0,Ch)],i.prototype,"hyperlink",void 0),xh([Y("")],i.prototype,"id",void 0),xh([Y()],i.prototype,"width",void 0),xh([Y()],i.prototype,"height",void 0),xh([G({strokeWidth:0,strokeColor:"transparent",fill:"transparent"},ih)],i.prototype,"style",void 0),xh([Y("Center")],i.prototype,"horizontalAlignment",void 0),xh([Y("Center")],i.prototype,"verticalAlignment",void 0),xh([G({},Gl)],i.prototype,"margin",void 0),xh([Y("Shape")],i.prototype,"type",void 0),xh([Y()],i.prototype,"addInfo",void 0),i}(xa),Eh=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return wh(e,t),xh([G({x:.5,y:.5},Dl)],e.prototype,"offset",void 0),e}(Sh),Ph=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return wh(e,t),xh([Y(.5)],e.prototype,"offset",void 0),xh([G({x:0,y:0},Dl)],e.prototype,"displacement",void 0),xh([Y("Center")],e.prototype,"alignment",void 0),e}(Sh),Lh={X:"M14,14 L106,106 M106,14 L14,106",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z",Square:"M0,0 L10,0 L10,10 L0,10 z"},Th={OpenArrow:"M15.9,23 L5,16 L15.9,9 L17,10.7 L8.7,16 L17,21.3Z",Square:"M0,0 L10,0 L10,10 L0,10 z",Fletch:"M14.8,10c0,0-3.5,6,0.2,12c0,0-2.5-6-10.9-6C4.1,16,11.3,16,14.8,10z",OpenFetch:"M6,17c-0.6,0-1-0.4-1-1s0.4-1,1-1c10.9,0,11-5,11-5c0-0.6,0.4-1,1-1s1,0.4,1,1C19,10.3,18.9,17,6,17C6,17,6,17,6,17z M18,23c-0.5,0-1-0.4-1-1c0-0.2-0.3-5-11-5c-0.6,0-1-0.5-1-1s0.4-1,1-1c0,0,0,0,0,0c12.9,0,13,6.7,13,7    C19,22.6,18.6,23,18,23z",IndentedArrow:"M17,10c0,0-4.5,5.5,0,12L5,16L17,10z",OutdentedArrow:"M14.6,10c0,0,5.4,6,0,12L5,16L14.6,10z",DoubleArrow:"M19,10 L19,22 L13,16Z M12,10 L12,22 L6,16Z",Arrow:"M15,10 L15,22 L5,16Z",Diamond:"M12,23l-7-7l7-7l6.9,7L12,23z",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z"},kh={Process:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",Decision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",Document:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",PreDefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",Terminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",Sort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",MultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",Collate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",SummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",Or:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",InternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",Extract:"M0,35 L30,0 L60,35 Z",ManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",Merge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",SequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",Data:"M 10 0 L 40 0 L 30 40 L 0 40 Z",Card:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",Delay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",Preparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",Display:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",ManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",StoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z"},Oh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ah=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Mh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Oh(e,t),Ah([Y("None")],e.prototype,"shape",void 0),Ah([Y("white")],e.prototype,"fill",void 0),Ah([Y("Auto")],e.prototype,"horizontalAlignment",void 0),Ah([Y("Auto")],e.prototype,"verticalAlignment",void 0),Ah([Y(10)],e.prototype,"width",void 0),Ah([Y(10)],e.prototype,"height",void 0),Ah([G({x:.5,y:1},Dl)],e.prototype,"offset",void 0),Ah([Y("#1a1a1a")],e.prototype,"borderColor",void 0),Ah([Y(1)],e.prototype,"borderWidth",void 0),Ah([G({},Gl)],e.prototype,"margin",void 0),Ah([Y("")],e.prototype,"pathData",void 0),Ah([Y("")],e.prototype,"content",void 0),Ah([Y(0)],e.prototype,"cornerRadius",void 0),Ah([G({left:2,right:2,top:2,bottom:2},Gl)],e.prototype,"padding",void 0),e}(xa),Ih=!1,Dh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Rh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Nh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Dh(e,t),Rh([Y("left")],e.prototype,"X",void 0),Rh([Y("top")],e.prototype,"Y",void 0),e}(xa),Bh={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},Hh=function(t){function e(e,i){var n=t.call(this,i,e)||this;return n.fixedParent=!1,n}return Dh(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"width":I(this.element,{width:m(t.width)});break;case"height":I(this.element,{height:m(t.height)});break;case"zIndex":I(this.element,{zIndex:t.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":var o=t.offsetX-e.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+o).toString()+"px";break;case"offsetY":var r=t.offsetY-e.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+r).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":"none"!==t.actionOnScroll?this.wireScrollEvents():this.unwireScrollEvents()}},e.prototype.getModuleName=function(){return"popup"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){this.element.classList.remove(Bh.ROOT,Bh.RTL),this.unwireEvents(),t.prototype.destroy.call(this)},e.prototype.render=function(){this.element.classList.add(Bh.ROOT);var t={};1e3!==this.zIndex&&(t.zIndex=this.zIndex),"auto"!==this.width&&(t.width=m(this.width)),"auto"!==this.height&&(t.height=m(this.height)),I(this.element,t),this.setEnableRtl(),this.setContent(),this.wireEvents()},e.prototype.wireEvents=function(){ma.isDevice&&ha.add(window,"orientationchange",this.orientationOnChange,this),"none"!==this.actionOnScroll&&this.wireScrollEvents()},e.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,e=this.getScrollableParent(this.getRelateToElement());t<e.length;t++){var i=e[t];ha.add(i,"scroll",this.scrollRefresh,this)}},e.prototype.unwireEvents=function(){ma.isDevice&&ha.remove(window,"orientationchange",this.orientationOnChange),"none"!==this.actionOnScroll&&this.unwireScrollEvents()},e.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,e=this.getScrollableParent(this.getRelateToElement());t<e.length;t++){var i=e[t];ha.remove(i,"scroll",this.scrollRefresh)}},e.prototype.getRelateToElement=function(){var t=""===this.relateTo||h(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:t},!0),"string"==typeof this.relateTo?document.querySelector(this.relateTo):this.relateTo},e.prototype.scrollRefresh=function(t){if("reposition"===this.actionOnScroll?this.element.offsetParent===t.target||this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&null==t.target.parentElement||this.refreshPosition():"hide"===this.actionOnScroll&&this.hide(),"none"!==this.actionOnScroll&&this.getRelateToElement()){var e=this.isElementOnViewport(this.getRelateToElement(),t.target);e||this.targetInvisibleStatus?e&&(this.targetInvisibleStatus=!1):(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0)}},e.prototype.isElementOnViewport=function(t,e){for(var i=this.getScrollableParent(t),n=0;n<i.length;n++)if(!this.isElementVisible(t,i[n]))return!1;return!0},e.prototype.isElementVisible=function(t,e){var i=t.getBoundingClientRect();if(!i.height||!i.width)return!1;if(e.getBoundingClientRect){var n=e.getBoundingClientRect();return!(i.bottom<n.top||i.bottom>n.bottom||i.right>n.right||i.left<n.left)}var o=window,r={top:o.scrollY,left:o.scrollX,right:o.scrollX+o.outerWidth,bottom:o.scrollY+o.outerHeight},s=_t(t),a={top:s.top,left:s.left,right:s.left+i.width,bottom:s.top+i.height},l={top:r.bottom-a.top,left:r.right-a.left,bottom:a.bottom-r.top,right:a.right-r.left};return l.top>0&&l.left>0&&l.right>0&&l.bottom>0},e.prototype.preRender=function(){},e.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(Bh.RTL):this.element.classList.remove(Bh.RTL)},e.prototype.setContent=function(){h(this.content)||(this.element.innerHTML="","string"==typeof this.content?this.element.textContent=this.content:this.element.appendChild(this.content))},e.prototype.orientationOnChange=function(){var t=this;setTimeout(function(){t.refreshPosition()},200)},e.prototype.refreshPosition=function(t){h(t)||this.checkFixedParent(t),this.reposition(),this.checkCollision()},e.prototype.reposition=function(){var t,e=this.getRelateToElement();if("number"==typeof this.position.X&&"number"==typeof this.position.Y)t={left:this.position.X,top:this.position.Y};else if(e){var i=this.element.style.display;this.element.style.display="block",t=this.getAnchorPosition(e,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=i}else t={left:0,top:0};this.element.style.left=t.left+"px",this.element.style.top=t.top+"px"},e.prototype.getAnchorPosition=function(t,e,i,n,o){var r=e.getBoundingClientRect(),s=t.getBoundingClientRect(),a=t,l={left:0,top:0};switch(l=e.offsetParent&&"BODY"===e.offsetParent.tagName&&"BODY"===t.tagName?_t(t):Vt(a,e),i.X){default:case"left":break;case"center":"container"===this.targetType?l.left+=s.width/2-r.width/2:l.left+=s.width/2;break;case"right":"container"===this.targetType?l.left+=s.width-r.width:l.left+=s.width}switch(i.Y){default:case"top":break;case"center":"container"===this.targetType?l.top+=s.height/2-r.height/2:l.top+=s.height/2;break;case"bottom":"container"===this.targetType?l.top+=s.height-r.height:l.top+=s.height}return l.left+=n,l.top+=o,l},e.prototype.callFlip=function(t){var e=this.getRelateToElement();ie(this.element,e,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,t,this.fixedParent)},e.prototype.callFit=function(t){if(0!==ee(this.element,this.viewPortElement).length)if(h(this.viewPortElement)){var e=te(this.element,this.viewPortElement,t);this.element.style.left=e.left+"px",this.element.style.top=e.top+"px"}else{var i=this.element.getBoundingClientRect(),n=this.viewPortElement.getBoundingClientRect();t&&!0===t.Y&&(n.top>i.top?this.element.style.top="0px":n.bottom<i.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(i.bottom-n.bottom)+"px")),t&&!0===t.X&&(n.right<i.right?this.element.style.left=parseInt(this.element.style.left,10)-(i.right-n.right)+"px":n.left>i.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-i.left)+"px"))}},e.prototype.checkCollision=function(){var t=this.collision.X,e=this.collision.Y;"none"===t&&"none"===e||("flip"===t&&"flip"===e?this.callFlip({X:!0,Y:!0}):"fit"===t&&"fit"===e?this.callFit({X:!0,Y:!0}):("flip"===t?this.callFlip({X:!0,Y:!1}):"flip"===e&&this.callFlip({Y:!0,X:!1}),"fit"===t?this.callFit({X:!0,Y:!1}):"fit"===e&&this.callFit({X:!1,Y:!0})))},e.prototype.show=function(t,e){var i=this;if(1e3===this.zIndex||!h(e)){var n=h(e)?this.element:e;this.zIndex=Se(n),I(this.element,{zIndex:this.zIndex})}t=h(t)||"object"!=typeof t?this.showAnimation:t,"none"===this.collision.X&&"none"===this.collision.Y||(x([this.element],Bh.CLOSE),w([this.element],Bh.OPEN),this.checkCollision(),x([this.element],Bh.OPEN),w([this.element],Bh.CLOSE)),h(t)?(x([this.element],Bh.CLOSE),w([this.element],Bh.OPEN),this.trigger("open")):(t.begin=function(){i.isDestroyed||(x([i.element],Bh.CLOSE),w([i.element],Bh.OPEN))},t.end=function(){i.isDestroyed||i.trigger("open")},new ya(t).animate(this.element))},e.prototype.hide=function(t){var e=this;h(t=h(t)||"object"!=typeof t?this.hideAnimation:t)?(x([this.element],Bh.OPEN),w([this.element],Bh.CLOSE),this.trigger("close")):(t.end=function(){e.isDestroyed||(x([e.element],Bh.OPEN),w([e.element],Bh.CLOSE),e.trigger("close"))},new ya(t).animate(this.element))},e.prototype.getScrollableParent=function(t){return this.checkFixedParent(t),Ce(t,this.fixedParent)},e.prototype.checkFixedParent=function(t){for(var e=t.parentElement;e&&"HTML"!==e.tagName;){var i=getComputedStyle(e);"fixed"===i.position&&this.element.offsetParent&&"BODY"===this.element.offsetParent.tagName&&(this.element.style.position="fixed",this.fixedParent=!0),e=e.parentElement,h(this.element.offsetParent)&&"fixed"===i.position&&"fixed"===this.element.style.position&&(this.fixedParent=!0)}},Rh([Y("auto")],e.prototype,"height",void 0),Rh([Y("auto")],e.prototype,"width",void 0),Rh([Y(null)],e.prototype,"content",void 0),Rh([Y("container")],e.prototype,"targetType",void 0),Rh([Y(null)],e.prototype,"viewPortElement",void 0),Rh([Y({X:"none",Y:"none"})],e.prototype,"collision",void 0),Rh([Y("")],e.prototype,"relateTo",void 0),Rh([G({},Nh)],e.prototype,"position",void 0),Rh([Y(0)],e.prototype,"offsetX",void 0),Rh([Y(0)],e.prototype,"offsetY",void 0),Rh([Y(1e3)],e.prototype,"zIndex",void 0),Rh([Y(!1)],e.prototype,"enableRtl",void 0),Rh([Y("reposition")],e.prototype,"actionOnScroll",void 0),Rh([Y(null)],e.prototype,"showAnimation",void 0),Rh([Y(null)],e.prototype,"hideAnimation",void 0),Rh([J()],e.prototype,"open",void 0),Rh([J()],e.prototype,"close",void 0),Rh([J()],e.prototype,"targetExitViewport",void 0),e=Rh([$],e)}(Ka),zh=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Fh={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},Vh=function(t){function e(e,i){return t.call(this,e,i)||this}return zh(e,t),e.prototype.preRender=function(){},e.prototype.render=function(){this.initialize()},e.prototype.initialize=function(){this.cssClass&&w([this.element],this.cssClass.split(" ")),this.isPrimary&&this.element.classList.add(Fh.PRIMARY),this.content&&(this.element.innerHTML=this.content),this.setIconCss(),this.enableRtl&&this.element.classList.add(Fh.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents(),this.removeRippleEffect=it(this.element,{selector:"."+Fh.BUTTON})},e.prototype.controlStatus=function(t){this.element.disabled=t},e.prototype.setIconCss=function(){if(this.iconCss){var t=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?t.classList.add("e-icon-"+this.iconPosition.toLowerCase()):this.element.classList.add(Fh.ICONBTN);var e=this.element.childNodes[0];e&&"Left"===this.iconPosition?this.element.insertBefore(t,e):this.element.appendChild(t)}},e.prototype.wireEvents=function(){this.isToggle&&ha.add(this.element,"click",this.btnClickHandler,this)},e.prototype.unWireEvents=function(){this.isToggle&&ha.remove(this.element,"click",this.btnClickHandler)},e.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},e.prototype.destroy=function(){var e,i=this.element;t.prototype.destroy.call(this),x([this.element],[Fh.PRIMARY,Fh.RTL,Fh.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round"]),["e-ripple","disabled"].forEach(function(t){i.removeAttribute(t)}),this.content&&(i.innerHTML=i.innerHTML.replace(this.content,"")),(e=i.querySelector("span.e-btn-icon"))&&L(e),this.unWireEvents(),this.removeRippleEffect()},e.prototype.getModuleName=function(){return"btn"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"isPrimary":t.isPrimary?this.element.classList.add(Fh.PRIMARY):this.element.classList.remove(Fh.PRIMARY);break;case"disabled":this.controlStatus(t.disabled),this.unWireEvents();break;case"iconCss":var o=this.element.querySelector("span.e-btn-icon");o?(o.className="e-btn-icon "+t.iconCss,this.element.textContent.trim()&&("Left"===this.iconPosition?o.classList.add("e-icon-left"):o.classList.add("e-icon-right"))):this.setIconCss();break;case"iconPosition":(o=this.element.querySelector("span.e-btn-icon"))&&L(o),this.setIconCss();break;case"cssClass":e.cssClass&&x([this.element],e.cssClass.split(" ")),t.cssClass&&w([this.element],t.cssClass.split(" "));break;case"enableRtl":t.enableRtl?this.element.classList.add(Fh.RTL):this.element.classList.remove(Fh.RTL);break;case"content":Pe(this.element)||this.element.classList.remove(Fh.ICONBTN),this.element.innerHTML=t.content,this.setIconCss();break;case"isToggle":t.isToggle?ha.add(this.element,"click",this.btnClickHandler,this):(ha.remove(this.element,"click",this.btnClickHandler),x([this.element],["e-active"]))}},jh([Y("Left")],e.prototype,"iconPosition",void 0),jh([Y("")],e.prototype,"iconCss",void 0),jh([Y(!1)],e.prototype,"disabled",void 0),jh([Y(!1)],e.prototype,"isPrimary",void 0),jh([Y("")],e.prototype,"cssClass",void 0),jh([Y("")],e.prototype,"content",void 0),jh([Y(!1)],e.prototype,"isToggle",void 0),e=jh([$],e)}(Ka),_h=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Uh="e-ripple-container",qh="e-checkbox-wrapper",Xh=(function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isKeyPressed=!1,n}_h(e,t),e.prototype.changeState=function(t){var e,i,n=this.getWrapper().getElementsByClassName("e-frame")[0];ba&&(i=this.getWrapper().getElementsByClassName(Uh)[0]),"check"===t?(n.classList.remove("e-stop"),n.classList.add("e-check"),i&&(i.classList.remove("e-ripple-stop"),i.classList.add("e-ripple-check")),e="true",this.element.checked=!0):"uncheck"===t?(x([n],["e-check","e-stop"]),i&&x([i],["e-ripple-check","e-ripple-stop"]),e="false",this.element.checked=!1):(n.classList.remove("e-check"),n.classList.add("e-stop"),i&&(i.classList.remove("e-ripple-check"),i.classList.add("e-ripple-stop")),e="mixed",this.element.indeterminate=!0),this.getWrapper().setAttribute("aria-checked",e)},e.prototype.clickHandler=function(t){this.focusOutHandler(),this.indeterminate?(this.changeState(this.checked?"check":"uncheck"),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck"),this.checked=!1):(this.changeState("check"),this.checked=!0);var e={checked:this.element.checked,event:t};this.trigger("change",e)},e.prototype.destroy=function(){var e=this,i=this.getWrapper();t.prototype.destroy.call(this),this.disabled||this.unWireEvents(),"INPUT"===this.tagName?(i.parentNode.insertBefore(this.element,i),L(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(t){e.element.removeAttribute(t)})):(["role","aria-checked","class"].forEach(function(t){i.removeAttribute(t)}),this.element.id&&i.setAttribute("id",this.element.id),i.innerHTML="")},e.prototype.focusHandler=function(){this.isKeyPressed&&this.getWrapper().classList.add("e-focus")},e.prototype.focusOutHandler=function(){this.getWrapper().classList.remove("e-focus")},e.prototype.getModuleName=function(){return"checkbox"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},e.prototype.getWrapper=function(){return this.element.parentElement.parentElement},e.prototype.initialize=function(){this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&this.changeState("check"),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var t=this.element.parentElement;t.classList.contains(qh)||(t=this.createElement("div",{className:qh,attrs:{role:"checkbox","aria-checked":"false"}}),this.element.parentNode.insertBefore(t,this.element));var e=this.createElement("label",{attrs:{for:this.element.id}}),i=this.createElement("span",{className:"e-icons e-frame"});if(this.enableRtl&&t.classList.add("e-rtl"),this.cssClass&&w([t],this.cssClass.split(" ")),t.appendChild(e),e.appendChild(this.element),e.appendChild(i),ba){var n=this.createElement("span",{className:Uh});"Before"===this.labelPosition?e.appendChild(n):e.insertBefore(n,i),it(n,{duration:400,isCenterRipple:!0})}this.label&&this.setText(this.label)},e.prototype.keyDownHandler=function(){this.isKeyPressed=!0},e.prototype.labelMouseHandler=function(t){Oe(t,this.getWrapper().getElementsByClassName(Uh)[0])},e.prototype.mouseDownHandler=function(){this.isKeyPressed=!1},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getWrapper(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(t.checked?"check":"uncheck");break;case"indeterminate":t.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":t.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,i.classList.remove("e-checkbox-disabled"),i.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":e.cssClass&&i.classList.remove(e.cssClass),i.classList.add(t.cssClass);break;case"enableRtl":t.enableRtl?i.classList.add("e-rtl"):i.classList.remove("e-rtl");break;case"label":this.setText(t.label);break;case"labelPosition":var r=i.getElementsByClassName("e-label")[0],s=i.getElementsByTagName("label")[0];L(r),"After"===t.labelPosition?s.appendChild(r):s.insertBefore(r,i.getElementsByClassName("e-frame")[0]);break;case"name":this.element.setAttribute("name",t.name);break;case"value":this.element.setAttribute("value",t.value)}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,t=Ee(this.createElement,"EJS-CHECKBOX","checkbox",t,qh,"checkbox"),this.element=t,"checkbox"!==this.element.getAttribute("type")&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=d("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents()},e.prototype.setDisabled=function(){var t=this.getWrapper();this.element.disabled=!0,t.classList.add("e-checkbox-disabled"),t.setAttribute("aria-disabled","true")},e.prototype.setText=function(t){var e=this.getWrapper().getElementsByClassName("e-label")[0];if(e)e.textContent=t;else{e=this.createElement("span",{className:"e-label",innerHTML:t});var i=this.getWrapper().getElementsByTagName("label")[0];"Before"===this.labelPosition?i.insertBefore(e,this.getWrapper().getElementsByClassName("e-frame")[0]):i.appendChild(e)}},e.prototype.unWireEvents=function(){var t=this.getWrapper();ha.remove(this.element,"click",this.clickHandler),ha.remove(document,"keydown",this.keyDownHandler),ha.remove(t,"mousedown",this.mouseDownHandler),ha.remove(this.element,"focus",this.focusHandler),ha.remove(this.element,"focusout",this.focusOutHandler);var e=t.getElementsByTagName("label")[0];ha.remove(e,"mousedown",this.labelMouseHandler),ha.remove(e,"mouseup",this.labelMouseHandler)},e.prototype.wireEvents=function(){var t=this.getWrapper();ha.add(this.element,"click",this.clickHandler,this),ha.add(document,"keydown",this.keyDownHandler,this),ha.add(t,"mousedown",this.mouseDownHandler,this),ha.add(this.element,"focus",this.focusHandler,this),ha.add(this.element,"focusout",this.focusOutHandler,this);var e=t.getElementsByTagName("label")[0];ha.add(e,"mousedown",this.labelMouseHandler,this),ha.add(e,"mouseup",this.labelMouseHandler,this)},Wh([J()],e.prototype,"change",void 0),Wh([Y(!1)],e.prototype,"checked",void 0),Wh([Y("")],e.prototype,"cssClass",void 0),Wh([Y(!1)],e.prototype,"disabled",void 0),Wh([Y(!1)],e.prototype,"indeterminate",void 0),Wh([Y("")],e.prototype,"label",void 0),Wh([Y("After")],e.prototype,"labelPosition",void 0),Wh([Y("")],e.prototype,"name",void 0),Wh([Y("")],e.prototype,"value",void 0),e=Wh([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),Yh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Gh=(function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isKeyPressed=!1,n}return Xh(e,t),i=e,e.prototype.changeHandler=function(t){this.checked=!0,this.dataBind();var e={value:this.value,event:t};this.trigger("change",e)},e.prototype.updateChange=function(t){for(var e,n=this.element.getAttribute("name"),o=document.querySelectorAll('input.e-radio[name="'+n+'"]'),r=0;r<o.length;r++)(e=o[r])!==this.element&&(f(e,i).checked=!1)},e.prototype.destroy=function(){var e=this,i=this.element.parentElement;t.prototype.destroy.call(this),this.disabled||this.unWireEvents(),"INPUT"===this.tagName?(i.parentNode.insertBefore(this.element,i),L(i),this.element.checked=!1,["name","value","disabled"].forEach(function(t){e.element.removeAttribute(t)})):(["role","aria-checked","class"].forEach(function(t){i.removeAttribute(t)}),this.element.id&&i.setAttribute("id",this.element.id),i.innerHTML="")},e.prototype.focusHandler=function(){this.isKeyPressed&&this.getLabel().classList.add("e-focus")},e.prototype.focusOutHandler=function(){this.getLabel().classList.remove("e-focus")},e.prototype.getModuleName=function(){return"radio"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},e.prototype.getLabel=function(){return this.element.nextElementSibling},e.prototype.initialize=function(){this.initWrapper(),this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},e.prototype.initWrapper=function(){var t,e=this.element.parentElement;e.classList.contains("e-radio-wrapper")||(e=this.createElement("div",{className:"e-radio-wrapper"}),this.element.parentNode.insertBefore(e,this.element));var i=this.createElement("label",{attrs:{for:this.element.id}});e.appendChild(this.element),e.appendChild(i),ba&&(t=this.createElement("span",{className:"e-ripple-container"}),i.appendChild(t),it(t,{duration:400,isCenterRipple:!0})),this.enableRtl&&i.classList.add("e-rtl"),this.cssClass&&w([i],this.cssClass.split(" ")),this.label&&this.setText(this.label)},e.prototype.keyDownHandler=function(){this.isKeyPressed=!0},e.prototype.labelRippleHandler=function(t){Oe(t,this.getLabel().getElementsByClassName("e-ripple-container")[0])},e.prototype.mouseDownHandler=function(){this.isKeyPressed=!1},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getLabel(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"checked":t.checked&&this.updateChange(t.checked),this.element.checked=t.checked;break;case"disabled":t.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":e.cssClass&&x([i],e.cssClass.split(" ")),w([i],t.cssClass.split(" "));break;case"enableRtl":t.enableRtl?i.classList.add("e-rtl"):i.classList.remove("e-rtl");break;case"label":this.setText(t.label);break;case"labelPosition":"Before"===t.labelPosition?i.classList.add("e-right"):i.classList.remove("e-right");break;case"name":this.element.setAttribute("name",t.name);break;case"value":this.element.setAttribute("value",t.value)}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,t=Ee(this.createElement,"EJS-RADIOBUTTON","radio",t,"e-radio-wrapper","radio"),this.element=t,"radio"!==this.element.getAttribute("type")&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=d("e-"+this.getModuleName()))},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents()},e.prototype.setDisabled=function(){this.element.disabled=!0},e.prototype.setText=function(t){var e=this.getLabel(),i=e.getElementsByClassName("e-label")[0];i?i.textContent=t:(i=this.createElement("span",{className:"e-label",innerHTML:t}),e.appendChild(i)),"Before"===this.labelPosition?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},e.prototype.unWireEvents=function(){var t=this.getLabel();ha.remove(this.element,"change",this.changeHandler),ha.remove(document,"keydown",this.keyDownHandler),ha.remove(t,"mousedown",this.mouseDownHandler),ha.remove(this.element,"focus",this.focusHandler),ha.remove(this.element,"focusout",this.focusOutHandler);var e=t.getElementsByClassName("e-label")[0];e&&(ha.remove(e,"mousedown",this.labelRippleHandler),ha.remove(e,"mouseup",this.labelRippleHandler))},e.prototype.wireEvents=function(){var t=this.getLabel();ha.add(this.element,"change",this.changeHandler,this),ha.add(document,"keydown",this.keyDownHandler,this),ha.add(t,"mousedown",this.mouseDownHandler,this),ha.add(this.element,"focus",this.focusHandler,this),ha.add(this.element,"focusout",this.focusOutHandler,this);var e=t.getElementsByClassName("e-label")[0];e&&(ha.add(e,"mousedown",this.labelRippleHandler,this),ha.add(e,"mouseup",this.labelRippleHandler,this))},Yh([J()],e.prototype,"change",void 0),Yh([Y(!1)],e.prototype,"checked",void 0),Yh([Y("")],e.prototype,"cssClass",void 0),Yh([Y(!1)],e.prototype,"disabled",void 0),Yh([Y("")],e.prototype,"label",void 0),Yh([Y("After")],e.prototype,"labelPosition",void 0),Yh([Y("")],e.prototype,"name",void 0),Yh([Y("")],e.prototype,"value",void 0),e=i=Yh([$],e);var i}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),Zh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Kh="e-ripple-container",Qh=(function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.isKeyPressed=!1,n.isDrag=!1,n}Gh(e,t),e.prototype.changeState=function(t){var e,i,n=this.getWrapper(),o=n.querySelector(".e-switch-inner"),r=n.querySelector(".e-switch-handle");ba&&(i=n.getElementsByClassName(Kh)[0]),t?(w([o,r],"e-switch-active"),e="true",this.element.checked=!0,this.checked=!0,i&&w([i],["e-ripple-check"])):(x([o,r],"e-switch-active"),e="false",this.element.checked=!1,this.checked=!1,i&&x([i],["e-ripple-check"])),n.setAttribute("aria-checked",e)},e.prototype.clickHandler=function(t){this.isDrag=!1,this.focusOutHandler(),this.changeState(!this.checked),this.element.focus();var e={checked:this.element.checked,event:t};this.trigger("change",e)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.disabled||this.unWireEvents(),Le(this,this.getWrapper(),this.tagName)},e.prototype.focusHandler=function(){this.isKeyPressed&&this.getWrapper().classList.add("e-focus")},e.prototype.focusOutHandler=function(){this.getWrapper().classList.remove("e-focus")},e.prototype.getModuleName=function(){return"switch"},e.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},e.prototype.getWrapper=function(){return this.element.parentElement},e.prototype.initialize=function(){this.name&&this.element.setAttribute("name",this.name),this.value&&this.element.setAttribute("value",this.value),this.checked&&this.changeState(!0),this.disabled&&this.setDisabled(),(this.onLabel||this.offLabel)&&this.setLabel(this.onLabel,this.offLabel)},e.prototype.initWrapper=function(){var t=this.element.parentElement;t.classList.contains("e-switch-wrapper")||(t=this.createElement("div",{className:"e-switch-wrapper",attrs:{role:"switch","aria-checked":"false"}}),this.element.parentNode.insertBefore(t,this.element));var e=this.createElement("span",{className:"e-switch-inner"}),i=this.createElement("span",{className:"e-switch-on"}),n=this.createElement("span",{className:"e-switch-off"}),o=this.createElement("span",{className:"e-switch-handle"});if(t.appendChild(this.element),e.appendChild(i),e.appendChild(n),t.appendChild(e),t.appendChild(o),ba){var r=this.createElement("span",{className:Kh});o.appendChild(r),it(r,{duration:400,isCenterRipple:!0})}this.enableRtl&&t.classList.add("e-rtl"),this.cssClass&&w([t],this.cssClass.split(" "))},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getWrapper(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"checked":this.changeState(t.checked);break;case"disabled":t.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,i.classList.remove("e-switch-disabled"),i.setAttribute("aria-disabled","false"),this.wireEvents());break;case"value":this.element.setAttribute("value",t.value);break;case"name":this.element.setAttribute("name",t.name);break;case"onLabel":case"offLabel":this.setLabel(t.onLabel,t.offLabel);break;case"enableRtl":t.enableRtl?i.classList.add("e-rtl"):i.classList.remove("e-rtl");break;case"cssClass":e.cssClass&&i.classList.remove(e.cssClass),i.classList.add(t.cssClass)}},e.prototype.preRender=function(){var t=this.element;this.tagName=this.element.tagName,Te(this,"EJS-SWITCH","e-switch-wrapper",t,this.getModuleName())},e.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents()},e.prototype.rippleHandler=function(t){Oe(t,this.getWrapper().getElementsByClassName(Kh)[0]),"mousedown"===t.type&&t.currentTarget.classList.contains("e-switch-wrapper")&&1===t.which&&(this.isDrag=!0,this.isKeyPressed=!1)},e.prototype.rippleTouchHandler=function(t){var e=this.getWrapper().getElementsByClassName(Kh)[0];if(e){var i=document.createEvent("MouseEvents");i.initEvent(t,!1,!0),e.dispatchEvent(i)}},e.prototype.setDisabled=function(){var t=this.getWrapper();this.element.disabled=!0,t.classList.add("e-switch-disabled"),t.setAttribute("aria-disabled","true")},e.prototype.setLabel=function(t,e){var i=this.getWrapper();t&&(i.querySelector(".e-switch-on").textContent=t),e&&(i.querySelector(".e-switch-off").textContent=e)},e.prototype.switchFocusHandler=function(){this.isKeyPressed=!0},e.prototype.switchMouseUp=function(t){var e=t.target;this.getWrapper().getElementsByClassName(Kh)[0];"touchmove"===t.type&&t.preventDefault(),"touchstart"===t.type&&(this.isDrag=!0,this.rippleTouchHandler("mousedown")),this.isDrag&&("mouseup"===t.type&&e.className.indexOf("e-switch")<0||"touchend"===t.type)&&(this.clickHandler(t),this.rippleTouchHandler("mouseup"),t.preventDefault())},e.prototype.toggle=function(){this.clickHandler()},e.prototype.wireEvents=function(){var t=this.getWrapper();t.querySelector(".e-switch-handle");ha.add(t,"click",this.clickHandler,this),ha.add(this.element,"focus",this.focusHandler,this),ha.add(this.element,"focusout",this.focusOutHandler,this),ha.add(document,"mouseup",this.switchMouseUp,this),ha.add(document,"keydown",this.switchFocusHandler,this),ha.add(t,"mousedown mouseup",this.rippleHandler,this),ha.add(t,"touchstart touchmove touchend",this.switchMouseUp,this)},e.prototype.unWireEvents=function(){var t=this.getWrapper();t.querySelector(".e-switch-handle");ha.remove(t,"click",this.clickHandler),ha.remove(this.element,"focus",this.focusHandler),ha.remove(this.element,"focusout",this.focusOutHandler),ha.remove(document,"mouseup",this.switchMouseUp),ha.remove(document,"keydown",this.switchFocusHandler),ha.remove(t,"mousedown mouseup",this.rippleHandler),ha.remove(t,"touchstart touchmove touchend",this.switchMouseUp)},Zh([J()],e.prototype,"change",void 0),Zh([Y(!1)],e.prototype,"checked",void 0),Zh([Y("")],e.prototype,"cssClass",void 0),Zh([Y(!1)],e.prototype,"disabled",void 0),Zh([Y("")],e.prototype,"name",void 0),Zh([Y("")],e.prototype,"onLabel",void 0),Zh([Y("")],e.prototype,"offLabel",void 0),Zh([Y("")],e.prototype,"value",void 0),e=Zh([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),Jh=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},$h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qh(e,t),Jh([Y()],e.prototype,"buttonModel",void 0),Jh([Y()],e.prototype,"click",void 0),e}(xa),tc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qh(e,t),Jh([Y("Fade")],e.prototype,"effect",void 0),Jh([Y(400)],e.prototype,"duration",void 0),Jh([Y(0)],e.prototype,"delay",void 0),e}(xa),ec="e-dialog",ic=(function(t){function e(e,i){return t.call(this,e,i)||this}Qh(e,t),e.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents()},e.prototype.preRender=function(){var t=this;this.headerContent=null;for(var e=[],i=0;i<this.element.classList.length;i++)h(this.element.classList[i].match("e-control"))&&h(this.element.classList[i].match(ec))||e.push(this.element.classList[i]);x([this.element],e),this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(e){t.hide(e)},this.dlgOverlayClickEventHandler=function(e){t.trigger("overlayClick",e)};var n={close:"Close"};if(this.l10n=new hl("dialog",n,this.locale),h(this.target)){var o=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=o}},e.prototype.keyDown=function(t){var e=this;if(9===t.keyCode&&this.isModal){var i=void 0;h(this.btnObj)||(i=this.btnObj[this.btnObj.length-1]),h(i)||document.activeElement!==i.element||t.shiftKey||(t.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&t.shiftKey&&(t.preventDefault(),h(i)||i.element.focus())}var n=document.activeElement,o=["input","textarea"].indexOf(n.tagName.toLowerCase())>-1,r=!1;if(o||(r=n.hasAttribute("contenteditable")&&"true"===n.getAttribute("contenteditable")),27===t.keyCode&&this.closeOnEscape&&this.hide(t),13===t.keyCode&&!t.ctrlKey&&"textarea"!==n.tagName.toLowerCase()&&o&&!h(this.primaryButtonEle)||13===t.keyCode&&t.ctrlKey&&("textarea"===n.tagName.toLowerCase()||r)&&!h(this.primaryButtonEle)){var s;this.buttons.some(function(t,e){s=e;var i=t.buttonModel;return!h(i)&&!0===i.isPrimary})&&"function"==typeof this.buttons[s].click&&setTimeout(function(){e.buttons[s].click.call(e,t)})}},e.prototype.initialize=function(){h(this.target)||(this.targetEle="string"==typeof this.target?document.querySelector(this.target):this.target),w([this.element],ec),ma.isDevice&&w([this.element],"e-device"),this.setCSSClass(),this.setMaxHeight()},e.prototype.initRender=function(){var t=this;this.initialRender=!0,k(this.element,{role:"dialog"}),1e3===this.zIndex?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.setTargetContent(),""===this.header||h(this.header)||this.setHeader(),this.showCloseIcon&&this.renderCloseIcon(),this.setContent(),""===this.footerTemplate||h(this.footerTemplate)?h(this.buttons[0].buttonModel)||this.setButton():this.setFooterTemplate(),this.allowDragging&&!h(this.headerContent)&&this.setAllowDragging(),k(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal(),h(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new Hh(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",open:function(e){t.focusContent();var i={container:t.isModal?t.dlgContainer:t.element,element:t.element,target:t.target};t.trigger("open",i)},close:function(e){t.unBindEvent(t.element),t.isModal&&(t.dlgContainer.style.display="none"),t.trigger("close",t.closeArgs),h(t.storeActiveElement)||t.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),w([this.element],"e-popup-close"),this.isModal&&this.setOverlayZindex(),this.visible?this.show():this.isModal&&(this.dlgOverlay.style.display="none"),this.initialRender=!1},e.prototype.setOverlayZindex=function(t){var e;e=h(t)?parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:t,this.dlgOverlay.style.zIndex=(e-1).toString(),this.dlgContainer.style.zIndex=e.toString()},e.prototype.positionChange=function(){this.isModal?"number"==typeof this.position.X&&"number"==typeof this.position.Y?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},e.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},e.prototype.setAllowDragging=function(){var t=this;this.dragObj=new el(this.element,{clone:!1,abort:".e-dlg-closeicon-btn",handle:".e-dlg-header-content",dragStart:function(e){t.trigger("dragStart",e)},dragStop:function(e){t.isModal&&(h(t.position)||t.dlgContainer.classList.remove("e-dlg-"+t.position.X+"-"+t.position.Y),t.element.style.position="relative"),t.trigger("dragStop",e)},drag:function(e){t.trigger("drag",e)}}),h(this.targetEle)||(this.dragObj.dragArea=this.targetEle)},e.prototype.setButton=function(){this.buttonContent=[],this.btnObj=[];for(e=0;e<this.buttons.length;e++){var t=this.createElement("button",{attrs:{type:"button"}});this.buttonContent.push(t.outerHTML)}this.setFooterTemplate();for(var e=0;e<this.buttons.length;e++)this.btnObj[e]=new Vh(this.buttons[e].buttonModel),"function"==typeof this.buttons[e].click&&ha.add(this.ftrTemplateContent.children[e],"click",this.buttons[e].click,this),this.btnObj[e].appendTo(this.ftrTemplateContent.children[e]),this.btnObj[e].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]},e.prototype.setContent=function(){k(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.contentEle=this.createElement("div",{className:"e-dlg-content",id:this.element.id+"_dialog-content"}),this.innerContentElement?this.contentEle.appendChild(this.innerContentElement):(h(this.content)||""===this.content)&&this.initialRender||("string"==typeof this.content?this.contentEle.innerHTML=this.content:this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle)),h(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),"auto"===this.height&&this.setMaxHeight()},e.prototype.setTemplate=function(t,e){for(var i=[],n=0,o=pt(t)({});n<o.length;n++){var r=o[n];i.push(r)}P([].slice.call(i),e)},e.prototype.setMaxHeight=function(){var t=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=h(this.target)?window.innerHeight-20+"px":this.targetEle.offsetHeight-20+"px",this.element.style.display=t},e.prototype.setEnableRTL=function(){this.enableRtl?w([this.element],"e-rtl"):x([this.element],"e-rtl")},e.prototype.setTargetContent=function(){if(h(this.content)||""===this.content){var t=""!==this.element.innerHTML.replace(/\s/g,"");if(this.element.children.length>0||t)for(this.innerContentElement=document.createDocumentFragment();0!==this.element.childNodes.length;)this.innerContentElement.appendChild(this.element.childNodes[0])}},e.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:"e-dlg-header"}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle),k(this.element,{"aria-labelledby":this.element.id+"_title"}),this.element.insertBefore(this.headerContent,this.element.children[0])},e.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:"e-footer-content"}),""===this.footerTemplate||h(this.footerTemplate)?this.ftrTemplateContent.innerHTML=this.buttonContent.join(""):this.setTemplate(this.footerTemplate,this.ftrTemplateContent),this.element.appendChild(this.ftrTemplateContent)},e.prototype.createHeaderContent=function(){h(this.headerContent)&&(this.headerContent=this.createElement("div",{className:"e-dlg-header-content"}))},e.prototype.renderCloseIcon=function(){this.closeIcon=this.createElement("button",{className:"e-dlg-closeicon-btn",attrs:{type:"button"}}),this.closeIconBtnObj=new Vh({cssClass:"e-flat",iconCss:"e-icon-dlg-close e-icons"}),this.closeIconTitle(),h(this.headerContent)?(this.createHeaderContent(),E([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):E([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon)},e.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var t=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",t)},e.prototype.setCSSClass=function(t){this.cssClass&&w([this.element],this.cssClass.split(" ")),t&&x([this.element],t.split(" "))},e.prototype.setIsModal=function(){this.dlgContainer=this.createElement("div",{className:"e-dlg-container"}),this.element.classList.remove("e-popup-open"),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),w([this.element],"e-dlg-modal"),this.dlgOverlay=this.createElement("div",{className:"e-dlg-overlay"}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},e.prototype.getValidFocusNode=function(t){for(var e,i=0;i<t.length;i++)if(((e=t[i]).clientHeight>0||"a"===e.tagName.toLowerCase()&&e.hasAttribute("href"))&&e.tabIndex>-1&&!e.disabled&&!this.disableElement(e,'[disabled],[aria-disabled="true"],[type="hidden"]'))return e;return e},e.prototype.focusableElements=function(t){if(!h(t)){var e=t.querySelectorAll('input,select,textarea,button,a,[contenteditable="true"],[tabindex]');return this.getValidFocusNode(e)}return null},e.prototype.getAutoFocusNode=function(t){var e=t.querySelector(".e-dlg-closeicon-btn"),i=t.querySelectorAll("[autofocus]"),n=this.getValidFocusNode(i);if(h(n)){if(n=this.focusableElements(this.contentEle),!h(n))return e=n;if(!h(this.primaryButtonEle))return this.element.querySelector(".e-primary")}else e=n;return e},e.prototype.disableElement=function(t,e){var i=t?t.matches||t.webkitMatchesSelector||t.msMatchesSelector:null;if(i)for(;t;t=t.parentNode)if(t instanceof Element&&i.call(t,e))return t;return null},e.prototype.focusContent=function(){var t=this.getAutoFocusNode(this.element);(h(t)?this.element:t).focus(),this.bindEvent(this.element)},e.prototype.bindEvent=function(t){ha.add(t,"keydown",this.keyDown,this)},e.prototype.unBindEvent=function(t){ha.remove(t,"keydown",this.keyDown)},e.prototype.getModuleName=function(){return"dialog"},e.prototype.onPropertyChanged=function(t,e){if(this.element.classList.contains(ec))for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"content":h(this.content)||""===this.content?h(this.contentEle)||(L(this.contentEle),this.contentEle=null):h(this.contentEle)||"dialog"===this.contentEle.getAttribute("role")?this.setContent():(this.contentEle.innerHTML="","string"==typeof this.content?this.contentEle.innerHTML=this.content:this.contentEle.appendChild(this.content),this.setMaxHeight());break;case"header":""===this.header||h(this.header)?this.headerEle&&(L(this.headerEle),this.headerEle=null):this.setHeader();break;case"footerTemplate":if(""===this.footerTemplate||h(this.footerTemplate)){if(!this.ftrTemplateContent)return;L(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName("e-icon-dlg-close").length>0?this.showCloseIcon||""!==this.header&&!h(this.header)?this.showCloseIcon||L(this.closeIcon):(L(this.headerContent),this.headerContent=null):(this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":I(this.element,{height:m(t.height)});break;case"width":I(this.element,{width:m(t.width)});break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex);break;case"cssClass":this.setCSSClass(e.cssClass);break;case"buttons":h(this.buttons[0].buttonModel)||(h(this.ftrTemplateContent)||(L(this.ftrTemplateContent),this.ftrTemplateContent=null),this.footerTemplate="",this.setButton());break;case"allowDragging":this.allowDragging&&!h(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.popupObj.relateTo=t.target;break;case"position":if(this.isModal){var o=h(e.position.X)?this.position.X:e.position.X,r=h(e.position.Y)?this.position.Y:e.position.Y;this.dlgContainer.classList.contains("e-dlg-"+o+"-"+r)&&this.dlgContainer.classList.remove("e-dlg-"+o+"-"+r)}this.positionChange();break;case"enableRtl":this.setEnableRTL()}},e.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",h(this.targetEle)||this.targetEle.appendChild(this.dlgContainer);else{for(x([this.element],"e-dlg-modal"),x([document.body],"e-scroll-disabled"),L(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange()},e.prototype.setzIndex=function(t,e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.zIndex=Se(t),this.isProtectedOnChange=i,e&&(this.popupObj.zIndex=this.zIndex)},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){if(this.element.classList.contains(ec)){this.unWireEvents(),t.prototype.destroy.call(this);var e=[ec,"e-rtl","e-dlg-modal"];if(x([this.element,this.element],e),this.popupObj.element.classList.contains("e-popup")&&this.popupObj.destroy(),!h(this.btnObj))for(var i=void 0;i<this.btnObj.length;i++)this.btnObj[i].destroy();for(this.isModal&&(L(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),L(this.dlgContainer)),this.element.innerHTML="";this.element.attributes.length>0;)this.element.removeAttribute(this.element.attributes[0].name);for(var n=0;n<this.clonedEle.attributes.length;n++)this.element.setAttribute(this.clonedEle.attributes[n].name,this.clonedEle.attributes[n].value)}},e.prototype.wireEvents=function(){this.showCloseIcon&&ha.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&ha.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},e.prototype.unWireEvents=function(){if(this.showCloseIcon&&ha.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&ha.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),!h(this.buttons[0].buttonModel))for(var t=0;t<this.buttons.length;t++)"function"==typeof this.buttons[t].click&&ha.remove(this.ftrTemplateContent.children[t],"click",this.buttons[t].click)},e.prototype.refreshPosition=function(){this.popupObj.refreshPosition()},e.prototype.show=function(t){if(this.element.classList.contains(ec)&&(!this.element.classList.contains("e-popup-open")||!h(t))){h(t)||this.fullScreen(t);var e={cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target};if(this.trigger("beforeOpen",e),e.cancel)return;this.storeActiveElement=document.activeElement,this.element.tabIndex=-1,this.isModal&&!h(this.dlgOverlay)&&(this.dlgOverlay.style.display="block",this.dlgContainer.style.display="flex",h(this.targetEle)?w([document.body],"e-scroll-disabled"):(this.targetEle===document.body?this.dlgContainer.style.position="fixed":this.dlgContainer.style.position="absolute",this.dlgOverlay.style.position="absolute",this.element.style.position="relative",w([this.targetEle],"e-scroll-disabled")));var i={name:this.animationSettings.effect+"In",duration:this.animationSettings.duration,delay:this.animationSettings.delay},n=this.isModal?this.element.parentElement:this.element;this.calculatezIndex&&(this.setzIndex(n,!0),I(this.element,{zIndex:this.zIndex}),this.isModal&&this.setOverlayZindex(this.zIndex)),"None"===this.animationSettings.effect?this.popupObj.show():this.popupObj.show(i),this.dialogOpen=!0;var o=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!0,this.isProtectedOnChange=o}},e.prototype.hide=function(t){if(this.element.classList.contains(ec)){var e={cancel:!1,isInteraction:!!t,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:t};if(this.trigger("beforeClose",e),this.closeArgs=e,!e.cancel){this.isModal&&(this.dlgOverlay.style.display="none",h(this.targetEle)?x([document.body],"e-scroll-disabled"):x([this.targetEle],"e-scroll-disabled"));var i={name:this.animationSettings.effect+"Out",duration:this.animationSettings.duration,delay:this.animationSettings.delay};"None"===this.animationSettings.effect?this.popupObj.hide():this.popupObj.hide(i),this.dialogOpen=!1;var n=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.visible=!1,this.isProtectedOnChange=n}}},e.prototype.fullScreen=function(t){this.element.offsetTop,this.element.offsetLeft;if(t){w([this.element],"e-dlg-fullscreen");var e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=h(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=e,w([document.body],"e-scroll-disabled"),this.allowDragging&&!h(this.dragObj)&&this.dragObj.destroy()}else x([this.element],"e-dlg-fullscreen"),x([document.body],"e-scroll-disabled"),this.allowDragging&&!h(this.headerContent)&&this.setAllowDragging();return t},Jh([Y("")],e.prototype,"content",void 0),Jh([Y(!1)],e.prototype,"showCloseIcon",void 0),Jh([Y(!1)],e.prototype,"isModal",void 0),Jh([Y("")],e.prototype,"header",void 0),Jh([Y(!0)],e.prototype,"visible",void 0),Jh([Y("auto")],e.prototype,"height",void 0),Jh([Y("100%")],e.prototype,"width",void 0),Jh([Y("")],e.prototype,"cssClass",void 0),Jh([Y(1e3)],e.prototype,"zIndex",void 0),Jh([Y(null)],e.prototype,"target",void 0),Jh([Y("")],e.prototype,"footerTemplate",void 0),Jh([Y(!1)],e.prototype,"allowDragging",void 0),Jh([K([{}],$h)],e.prototype,"buttons",void 0),Jh([Y(!0)],e.prototype,"closeOnEscape",void 0),Jh([G({},tc)],e.prototype,"animationSettings",void 0),Jh([G({X:"center",Y:"center"},Nh)],e.prototype,"position",void 0),Jh([J()],e.prototype,"created",void 0),Jh([J()],e.prototype,"open",void 0),Jh([J()],e.prototype,"beforeOpen",void 0),Jh([J()],e.prototype,"close",void 0),Jh([J()],e.prototype,"beforeClose",void 0),Jh([J()],e.prototype,"dragStart",void 0),Jh([J()],e.prototype,"dragStop",void 0),Jh([J()],e.prototype,"drag",void 0),Jh([J()],e.prototype,"overlayClick",void 0),e=Jh([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),nc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ic(e,t),nc([Y({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),nc([Y({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e}(xa),rc=function(t){function e(e,i){return t.call(this,e,i)||this}return ic(e,t),e.prototype.initialize=function(){this.formatPosition(),w([this.element],"e-tooltip")},e.prototype.formatPosition=function(){0===this.position.indexOf("Top")||0===this.position.indexOf("Bottom")?(t=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=t[0],this.tooltipPositionX=t[1]):(e=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=e[0],this.tooltipPositionY=e[1]);var t,e},e.prototype.renderArrow=function(){this.setTipClass(this.position);var t=this.createElement("div",{className:"e-arrow-tip "+this.tipClass});t.appendChild(this.createElement("div",{className:"e-arrow-tip-outer "+this.tipClass})),t.appendChild(this.createElement("div",{className:"e-arrow-tip-inner "+this.tipClass})),this.tooltipEle.appendChild(t)},e.prototype.setTipClass=function(t){0===t.indexOf("Right")?this.tipClass="e-tip-left":0===t.indexOf("Bottom")?this.tipClass="e-tip-top":0===t.indexOf("Left")?this.tipClass="e-tip-right":this.tipClass="e-tip-bottom"},e.prototype.renderPopup=function(t){var e=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(t);this.popupObj=new Hh(this.tooltipEle,{height:this.height,width:this.width,position:{X:e.left,Y:e.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},e.prototype.getTooltipPosition=function(t){this.tooltipEle.style.display="none";var e=_t(t,this.tooltipPositionX,this.tooltipPositionY);this.tooltipEle.style.display="";var i=this.calculateTooltipOffset(this.position);return this.collisionFlipFit(t,e.left+i.left,e.top+i.top)},e.prototype.reposition=function(t){var e=this.getTooltipPosition(t);this.popupObj.position={X:e.left,Y:e.top},this.popupObj.dataBind()},e.prototype.openPopupHandler=function(){this.trigger("afterOpen",this.tooltipEventArgs)},e.prototype.closePopupHandler=function(){this.clear(),this.trigger("afterClose",this.tooltipEventArgs)},e.prototype.calculateTooltipOffset=function(t){var e={top:0,left:0},i=this.tooltipEle.offsetWidth,n=this.tooltipEle.offsetHeight,o=this.tooltipEle.querySelector(".e-arrow-tip"),r=o?o.offsetWidth:0,s=o?o.offsetHeight:0,a=this.showTipPointer?0:8,l=s/2+2+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),h=r/2+2+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(a+=2),t){case"RightTop":e.left+=r+a,e.top-=n-l;break;case"RightCenter":e.left+=r+a,e.top-=n/2;break;case"RightBottom":e.left+=r+a,e.top-=l;break;case"BottomRight":e.top+=s+a,e.left-=h;break;case"BottomCenter":e.top+=s+a,e.left-=i/2;break;case"BottomLeft":e.top+=s+a,e.left-=i-h;break;case"LeftBottom":e.left-=r+i+a,e.top-=l;break;case"LeftCenter":e.left-=r+i+a,e.top-=n/2;break;case"LeftTop":e.left-=r+i+a,e.top-=n-l;break;case"TopLeft":e.top-=n+s+a,e.left-=i-h;break;case"TopRight":e.top-=n+s+a,e.left-=h;break;default:e.top-=n+s+a,e.left-=i/2}return e.left+=this.offsetX,e.top+=this.offsetY,e},e.prototype.updateTipPosition=function(t){var e=this.tooltipEle.querySelectorAll(".e-arrow-tip,.e-arrow-tip-outer,.e-arrow-tip-inner");x(e,["e-tip-bottom","e-tip-top","e-tip-left","e-tip-right"]),this.setTipClass(t),w(e,this.tipClass)},e.prototype.adjustArrow=function(t,e,i,n){if(!1!==this.showTipPointer){this.updateTipPosition(e);var o,r,s=this.tooltipEle.clientWidth,a=this.tooltipEle.clientHeight,l=this.tooltipEle.querySelector(".e-arrow-tip"),h=this.tooltipEle.querySelector(".e-arrow-tip-inner"),c=l.offsetWidth,d=l.offsetHeight;if("e-tip-bottom"===this.tipClass||"e-tip-top"===this.tipClass)"e-tip-bottom"===this.tipClass?(r="99.9%",h.style.top="-"+(d-2)+"px"):(r=-(d-1)+"px",h.style.top="-"+(d-6)+"px"),o=(p="Center"!==i||s>t.offsetWidth||this.mouseTrail)&&"Left"===i||!p&&"End"===this.tipPointerPosition?s-c-2+"px":p&&"Right"===i||!p&&"Start"===this.tipPointerPosition?"2px":s/2-c/2+"px";else{"e-tip-right"===this.tipClass?(o="99.9%",h.style.left="-"+(c-2)+"px"):(o=-(c-1)+"px",h.style.left=c-2-c+"px");var p="Center"!==n||a>t.offsetHeight||this.mouseTrail;r=p&&"Top"===n||!p&&"End"===this.tipPointerPosition?a-d-2+"px":p&&"Bottom"===n||!p&&"Start"===this.tipPointerPosition?"2px":a/2-d/2+"px"}l.style.top=r,l.style.left=o}},e.prototype.renderContent=function(t){var e=this.tooltipEle.querySelector(".e-tip-content");t&&!h(t.getAttribute("title"))&&(t.setAttribute("data-content",t.getAttribute("title")),t.removeAttribute("title")),h(this.content)?t&&!h(t.getAttribute("data-content"))&&(e.innerHTML=t.getAttribute("data-content")):(e.innerHTML="",this.content instanceof HTMLElement?e.appendChild(this.content):"string"==typeof this.content?e.innerHTML=this.content:P(pt(this.content)(),e))},e.prototype.renderCloseIcon=function(){if(this.isSticky){var t=this.createElement("div",{className:"e-icons e-tooltip-close"});this.tooltipEle.appendChild(t),ha.add(t,ma.touchStartEvent,this.onStickyClose,this)}},e.prototype.addDescribedBy=function(t,e){var i=(t.getAttribute("aria-describedby")||"").split(/\s+/);i.indexOf(e)<0&&i.push(e),k(t,{"aria-describedby":i.join(" ").trim(),"data-tooltip-id":e})},e.prototype.removeDescribedBy=function(t){var e=t.getAttribute("data-tooltip-id"),i=(t.getAttribute("aria-describedby")||"").split(/\s+/),n=i.indexOf(e);-1!==n&&i.splice(n,1),t.removeAttribute("data-tooltip-id");var o=i.join(" ").trim();o?t.setAttribute("aria-describedby",o):t.removeAttribute("aria-describedby")},e.prototype.tapHoldHandler=function(t){clearTimeout(this.autoCloseTimer),this.targetHover(t.originalEvent)},e.prototype.touchEndHandler=function(t){var e=this;if(!this.isSticky){var i=function(){e.close()};this.autoCloseTimer=setTimeout(i,1500)}},e.prototype.targetClick=function(t){var e;h(e=this.target?M(t.target,this.target):this.element)||(null===e.getAttribute("data-tooltip-id")?this.targetHover(t):this.isSticky||this.hideTooltip(this.animation.close,t,e))},e.prototype.targetHover=function(t){var e;if(e=this.target?M(t.target,this.target):this.element,!h(e)&&null===e.getAttribute("data-tooltip-id")){for(var i=0,n=[].slice.call(document.querySelectorAll("[data-tooltip-id= "+this.ctrlId+"_content]"));i<n.length;i++){var o=n[i];this.restoreElement(o)}this.showTooltip(e,this.animation.open,t),this.wireMouseEvents(t,e)}},e.prototype.showTooltip=function(t,e,i){var n=this;if(clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.tooltipEventArgs=i?{type:i.type,cancel:!1,target:t,event:i,element:this.tooltipEle}:{type:null,cancel:!1,target:t,event:null,element:this.tooltipEle},this.trigger("beforeRender",this.tooltipEventArgs),this.tooltipEventArgs.cancel)return this.isHidden=!0,void this.clear();if(this.isHidden=!1,h(this.tooltipEle)?(this.ctrlId=d(this.element.getAttribute("id")?this.element.getAttribute("id"):"tooltip"),this.tooltipEle=this.createElement("div",{className:"e-tooltip-wrap e-popup",attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+m(this.width)+";height:"+m(this.height)+";position:absolute;"}),this.cssClass&&w([this.tooltipEle],this.cssClass.split(" ")),ma.isDevice&&w([this.tooltipEle],"e-bigger"),"auto"!==this.width&&(this.tooltipEle.style.maxWidth=m(this.width)),this.tooltipEle.appendChild(this.createElement("div",{className:"e-tip-content"})),document.body.appendChild(this.tooltipEle),this.addDescribedBy(t,this.ctrlId+"_content"),this.renderContent(t),w([this.tooltipEle],"e-popup-open"),this.showTipPointer&&this.renderArrow(),this.renderCloseIcon(),this.renderPopup(t)):(this.adjustArrow(t,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(t,this.ctrlId+"_content"),this.renderContent(t),ya.stop(this.tooltipEle),this.reposition(t)),x([this.tooltipEle],"e-popup-open"),w([this.tooltipEle],"e-popup-close"),this.tooltipEventArgs=i?{type:i.type,cancel:!1,target:t,event:i,element:this.tooltipEle}:{type:null,cancel:!1,target:t,event:null,element:this.tooltipEle},this.trigger("beforeOpen",this.tooltipEventArgs),this.tooltipEventArgs.cancel)return this.isHidden=!0,void this.clear();var o={name:e.effect,duration:e.duration,delay:e.delay,timingFunction:"easeOut"};if("None"===e.effect&&(o=void 0),this.openDelay>0){var r=function(){n.popupObj&&n.popupObj.show(o,t)};this.showTimer=setTimeout(r,this.openDelay)}else this.popupObj.show(o,t)},e.prototype.checkCollision=function(t,e,i){var n={left:e,top:i,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},o=ee(this.tooltipEle,this.target?this.element:null,e,i);return o.length>0&&(n.horizontal=o.indexOf("left")>=0?"Right":o.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=o.indexOf("top")>=0?"Bottom":o.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},e.prototype.collisionFlipFit=function(t,e,i){var n=this.checkCollision(t,e,i),o=n.position;if(this.tooltipPositionY!==n.vertical&&(o=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(0===o.indexOf("Left")&&(n.vertical="LeftTop"===o||"LeftCenter"===o?"Top":"Bottom",o=n.vertical+"Left"),0===o.indexOf("Right")&&(n.vertical="RightTop"===o||"RightCenter"===o?"Top":"Bottom",o=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:t,event:null,element:this.tooltipEle,collidedPosition:o},this.trigger("beforeCollision",this.tooltipEventArgs),n.position!==o){var r=_t(t,this.tooltipPositionX,n.vertical);this.adjustArrow(t,o,n.horizontal,n.vertical);var s=this.calculateTooltipOffset(o);n.position=o,n.left=r.left+s.left,n.top=r.top+s.top}else this.adjustArrow(t,o,n.horizontal,n.vertical);var a={left:n.left,top:n.top},l=te(this.tooltipEle,this.target?this.element:null,{X:!0,Y:!1},a).left;if(this.showTipPointer&&(0===o.indexOf("Bottom")||0===o.indexOf("Top"))){var h=this.tooltipEle.querySelector(".e-arrow-tip"),c=parseInt(h.style.left,10)-(l-n.left);c<0?c=0:c+h.offsetWidth>this.tooltipEle.clientWidth&&(c=this.tooltipEle.clientWidth-h.offsetWidth),h.style.left=c.toString()+"px"}return a.left=l,a},e.prototype.hideTooltip=function(t,e,i){var n,o=this;if(e?(n=this.target?i||e.target:this.element,this.tooltipEventArgs={type:e.type,cancel:!1,target:n,event:e,element:this.tooltipEle}):(n=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]"),this.tooltipEventArgs={type:null,cancel:!1,target:n,event:null,element:this.tooltipEle}),!h(n))if(this.trigger("beforeClose",this.tooltipEventArgs),this.tooltipEventArgs.cancel)this.isHidden=!1;else{this.restoreElement(n),this.isHidden=!0;var r={name:t.effect,duration:t.duration,delay:t.delay,timingFunction:"easeIn"};if("None"===t.effect&&(r=void 0),this.closeDelay>0){var s=function(){o.popupObj&&o.popupObj.hide(r)};this.hideTimer=setTimeout(s,this.closeDelay)}else this.popupObj.hide(r)}},e.prototype.restoreElement=function(t){this.unwireMouseEvents(t),h(t.getAttribute("data-content"))||(t.setAttribute("title",t.getAttribute("data-content")),t.removeAttribute("data-content")),this.removeDescribedBy(t)},e.prototype.clear=function(){this.tooltipEle&&(x([this.tooltipEle],"e-popup-close"),w([this.tooltipEle],"e-popup-open")),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&T(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},e.prototype.onMouseOut=function(t){this.hideTooltip(this.animation.close,t)},e.prototype.onStickyClose=function(t){this.close()},e.prototype.onMouseMove=function(t){var e=0,i=0;t.type.indexOf("touch")>-1?(t.preventDefault(),e=t.touches[0].pageX,i=t.touches[0].pageY):(e=t.pageX,i=t.pageY),ya.stop(this.tooltipEle),x([this.tooltipEle],"e-popup-close"),w([this.tooltipEle],"e-popup-open"),this.adjustArrow(t.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.calculateTooltipOffset(this.position),o=e+n.left+this.offsetX,r=i+n.top+this.offsetY,s=this.checkCollision(t.target,o,r);if(this.tooltipPositionX!==s.horizontal||this.tooltipPositionY!==s.vertical){var a=0===this.position.indexOf("Bottom")||0===this.position.indexOf("Top")?s.vertical+s.horizontal:s.horizontal+s.vertical;s.position=a,this.adjustArrow(t.target,s.position,s.horizontal,s.vertical);var l=this.calculateTooltipOffset(s.position);s.left=e+l.left-this.offsetX,s.top=i+l.top-this.offsetY}this.tooltipEle.style.left=s.left+"px",this.tooltipEle.style.top=s.top+"px"},e.prototype.keyDown=function(t){this.tooltipEle&&27===t.keyCode&&this.close()},e.prototype.touchEnd=function(t){this.tooltipEle&&null===M(t.target,".e-tooltip")&&this.close()},e.prototype.scrollHandler=function(t){this.tooltipEle&&this.close()},e.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn)},e.prototype.preRender=function(){this.tipClass="e-tip-bottom",this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},e.prototype.wireEvents=function(t){for(var e=0,i=this.getTriggerList(t);e<i.length;e++){var n=i[e];if("Custom"===n)return;"Focus"===n&&this.wireFocusEvents(),"Click"===n&&ha.add(this.element,ma.touchStartEvent,this.targetClick,this),"Hover"===n&&(ma.isDevice?(this.touchModule=new gl(this.element,{tapHoldThreshold:500,tapHold:this.tapHoldHandler.bind(this)}),ha.add(this.element,ma.touchEndEvent,this.touchEndHandler,this)):ha.add(this.element,"mouseover",this.targetHover,this))}ha.add(document,"touchend",this.touchEnd,this),ha.add(document,"scroll",this.scrollHandler,this),ha.add(document,"keydown",this.keyDown,this)},e.prototype.getTriggerList=function(t){return"Auto"===t&&(t=ma.isDevice?"Hover":"Hover Focus"),t.split(" ")},e.prototype.wireFocusEvents=function(){if(h(this.target))ha.add(this.element,"focus",this.targetHover,this);else for(var t=0,e=[].slice.call(this.element.querySelectorAll(this.target));t<e.length;t++){var i=e[t];ha.add(i,"focus",this.targetHover,this)}},e.prototype.wireMouseEvents=function(t,e){this.tooltipEle&&(this.isSticky||("focus"===t.type&&ha.add(e,"blur",this.onMouseOut,this),"mouseover"===t.type&&ha.add(e,"mouseleave",this.onMouseOut,this)),this.mouseTrail&&ha.add(e,"mousemove touchstart mouseenter",this.onMouseMove,this))},e.prototype.unwireEvents=function(t){for(var e=0,i=this.getTriggerList(t);e<i.length;e++){var n=i[e];if("Custom"===n)return;"Focus"===n&&this.unwireFocusEvents(),"Click"===n&&ha.remove(this.element,ma.touchStartEvent,this.targetClick),"Hover"===n&&(ma.isDevice?(this.touchModule&&this.touchModule.destroy(),ha.remove(this.element,ma.touchEndEvent,this.touchEndHandler)):ha.remove(this.element,"mouseover",this.targetHover))}ha.remove(document,"touchend",this.touchEnd),ha.remove(document,"scroll",this.scrollHandler),ha.remove(document,"keydown",this.keyDown)},e.prototype.unwireFocusEvents=function(){if(h(this.target))ha.remove(this.element,"focus",this.targetHover);else for(var t=0,e=[].slice.call(this.element.querySelectorAll(this.target));t<e.length;t++){var i=e[t];ha.remove(i,"focus",this.targetHover)}},e.prototype.unwireMouseEvents=function(t){if(!this.isSticky)for(var e=0,i=this.getTriggerList(this.opensOn);e<i.length;e++){var n=i[e];"Focus"===n&&ha.remove(t,"blur",this.onMouseOut),"Hover"!==n||ma.isDevice||ha.remove(t,"mouseleave",this.onMouseOut)}this.mouseTrail&&ha.remove(t,"mousemove touchstart mouseenter",this.onMouseMove)},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"width":this.tooltipEle&&(this.tooltipEle.style.width=m(t.width));break;case"height":this.tooltipEle&&(this.tooltipEle.style.height=m(t.height));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(e.opensOn),this.wireEvents(t.opensOn);break;case"position":this.formatPosition();var o=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]");if(this.tooltipEle&&o){var r=this.tooltipEle.querySelector(".e-arrow-tip-inner");r.style.top=r.style.left=null,this.reposition(o)}break;case"tipPointerPosition":var s=document.querySelector("[data-tooltip-id= "+this.ctrlId+"_content]");this.tooltipEle&&s&&this.reposition(s);break;case"offsetX":if(this.tooltipEle){var a=t.offsetX-e.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+a).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var l=t.offsetY-e.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+l).toString()+"px"}break;case"cssClass":this.tooltipEle&&(e.cssClass&&x([this.tooltipEle],e.cssClass.split(" ")),t.cssClass&&w([this.tooltipEle],t.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?w([this.tooltipEle],"e-rtl"):x([this.tooltipEle],"e-rtl"))}},e.prototype.open=function(t,e){void 0===e&&(e=this.animation.open),"none"!==t.style.display&&this.showTooltip(t,e)},e.prototype.close=function(t){void 0===t&&(t=this.animation.close),this.hideTooltip(t)},e.prototype.refresh=function(t){this.tooltipEle&&this.renderContent(t),this.popupObj&&t&&this.reposition(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),x([this.element],"e-tooltip"),this.unwireEvents(this.opensOn),this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&T(this.tooltipEle),this.tooltipEle=null,this.popupObj=null},nc([Y("auto")],e.prototype,"width",void 0),nc([Y("auto")],e.prototype,"height",void 0),nc([Y()],e.prototype,"content",void 0),nc([Y()],e.prototype,"target",void 0),nc([Y("TopCenter")],e.prototype,"position",void 0),nc([Y(0)],e.prototype,"offsetX",void 0),nc([Y(0)],e.prototype,"offsetY",void 0),nc([Y(!0)],e.prototype,"showTipPointer",void 0),nc([Y("Auto")],e.prototype,"tipPointerPosition",void 0),nc([Y("Auto")],e.prototype,"opensOn",void 0),nc([Y(!1)],e.prototype,"mouseTrail",void 0),nc([Y(!1)],e.prototype,"isSticky",void 0),nc([G({},oc)],e.prototype,"animation",void 0),nc([Y(0)],e.prototype,"openDelay",void 0),nc([Y(0)],e.prototype,"closeDelay",void 0),nc([Y()],e.prototype,"cssClass",void 0),nc([Y(!1)],e.prototype,"enableRtl",void 0),nc([J()],e.prototype,"beforeRender",void 0),nc([J()],e.prototype,"beforeOpen",void 0),nc([J()],e.prototype,"afterOpen",void 0),nc([J()],e.prototype,"beforeClose",void 0),nc([J()],e.prototype,"afterClose",void 0),nc([J()],e.prototype,"beforeCollision",void 0),nc([J()],e.prototype,"created",void 0),nc([J()],e.prototype,"destroyed",void 0),e=nc([$],e)}(Ka),sc={},ac=null,lc=null,hc=30,cc=30,dc=30,pc="e-spin-show",uc="e-spin-hide",gc="e-spin-material",mc="e-spin-fabric",fc="e-spin-bootstrap",vc="e-spin-high-contrast",yc="e-spinner-pane",bc="e-spinner-inner",wc="e-path-circle",xc="e-path-arc",Cc="e-spin-label",Sc="e-spin-template",Ec=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Lc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ec(e,t),Pc([Y("")],e.prototype,"content",void 0),Pc([Y("TopLeft")],e.prototype,"position",void 0),Pc([Y("Mouse")],e.prototype,"relativeMode",void 0),Pc([Y(!0)],e.prototype,"showTipPointer",void 0),Pc([Y("auto")],e.prototype,"width",void 0),Pc([Y("auto")],e.prototype,"height",void 0),Pc([Y()],e.prototype,"animation",void 0),e}(xa),Tc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),kc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tc(e,t),kc([Y("")],e.prototype,"id",void 0),kc([Y(-1)],e.prototype,"zIndex",void 0),kc([G({},Gl)],e.prototype,"margin",void 0),kc([Y(!0)],e.prototype,"visible",void 0),kc([K([],bh)],e.prototype,"ports",void 0),kc([Y(!0)],e.prototype,"isExpanded",void 0),kc([G({},Lc)],e.prototype,"tooltip",void 0),kc([G({},Mh)],e.prototype,"expandIcon",void 0),kc([G({},Mh)],e.prototype,"collapseIcon",void 0),kc([Y(!1)],e.prototype,"excludeFromLayout",void 0),kc([Y()],e.prototype,"addInfo",void 0),e}(xa),Ac=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Mc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ic=function(t){switch(t.type){case"Bpmn":return Hc;default:return Bc}},Dc=function(t){switch(t.type){case"Straight":return jc;case"Bezier":return Fc;case"Orthogonal":return Vc;default:return jc}},Rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([Y(10)],e.prototype,"width",void 0),Mc([Y(10)],e.prototype,"height",void 0),Mc([Y("Arrow")],e.prototype,"shape",void 0),Mc([G({fill:"black",strokeColor:"black",strokeWidth:1},th)],e.prototype,"style",void 0),Mc([G({x:0,y:.5},Dl)],e.prototype,"pivot",void 0),Mc([Y("")],e.prototype,"pathData",void 0),e}(xa),Nc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([Y(0)],e.prototype,"angle",void 0),Mc([Y(0)],e.prototype,"distance",void 0),e}(xa),Bc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([Y("None")],e.prototype,"type",void 0),e}(xa),Hc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([Y("Sequence")],e.prototype,"flow",void 0),Mc([Y("Normal")],e.prototype,"sequence",void 0),Mc([Y("Default")],e.prototype,"message",void 0),Mc([Y("Default")],e.prototype,"association",void 0),e}(Bc),zc=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.points=[],r}return Ac(e,t),Mc([Y("Straight")],e.prototype,"type",void 0),e}(xa),jc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([G({x:0,y:0},Dl)],e.prototype,"point",void 0),e}(zc),Fc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([G({x:0,y:0},Dl)],e.prototype,"point1",void 0),Mc([G({x:0,y:0},Dl)],e.prototype,"point2",void 0),Mc([G({angle:0,distance:0},Nc)],e.prototype,"vector1",void 0),Mc([G({angle:0,distance:0},Nc)],e.prototype,"vector2",void 0),e}(jc),Vc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ac(e,t),Mc([Y(null)],e.prototype,"length",void 0),Mc([Y(null)],e.prototype,"direction",void 0),e}(zc),_c=function(e){function i(t,i,n,o){var r=e.call(this,t,i,n,o)||this;return r.parentId="",r.bridges=[],r}return Ac(i,e),i.prototype.init=function(t){this.id||(this.id=qr());var e,i=new gh,n=new sh;n.id=this.id+"_path";var o=new sh,r=new sh;n=this.getSegmentElement(this,n);var s,a=[];switch(a=this.getConnectorPoints(this.type),a=this.clipDecorators(this,a),s=Rl.toBounds(a),i.width=s.width,i.height=s.height,i.offsetX=s.x+i.pivot.x*s.width,i.offsetY=s.y+i.pivot.y*s.height,this.shape.type){case"Bpmn":switch(this.shape.flow){case"Sequence":e=this.getBpmnSequenceFlow();break;case"Association":(e=new sh).visible=!1,this.getBpmnAssociationFlow();break;case"Message":e=this.getBpmnMessageFlow(),n=this.getSegmentElement(this,n),this.updateShapePosition(this,e)}}var l=this.intermediatePoints;if("Bezier"===this.type){var h=this.segments[0],c=this.segments[this.segments.length-1];l=[Dl.isEmptyPoint(c.point2)?c.bezierPoint2:c.point2,Dl.isEmptyPoint(h.point1)?h.bezierPoint1:h.point1]}var d=t.getDescription;this.sourceWrapper&&this.sourceWrapper.style.strokeWidth;if(o=this.getDecoratorElement(a[0],l[1],this.sourceDecorator,!0,d),r=this.getDecoratorElement(a[a.length-1],l[l.length-2],this.targetDecorator,!1,d),o.id=this.id+"_srcDec",r.id=this.id+"_tarDec",n.style=this.style,n.style.fill="transparent",void 0!==d){var p=d(this,t);n.description=p||this.id}i.style.strokeColor="transparent",i.style.fill="transparent",i.style.strokeWidth=0,i.children=[n,o,r],i.id=this.id,void 0!==e&&i.children.push(e),i.offsetX=n.offsetX,i.offsetY=n.offsetY,i.width=n.width,i.height=n.height;for(var u=0;this.annotations,u<this.annotations.length;u++)i.children.push(this.getAnnotationElement(this.annotations[u],this.intermediatePoints,s,d));return this.wrapper=i,i},i.prototype.getBpmnSequenceFlow=function(){var e,i=new sh,n=new sh;if("Normal"===this.shape.sequence&&"Bezier"!==this.type&&(this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black"),"Default"===this.shape.sequence){i=this.getSegmentElement(this,i);for(var o=this.intermediatePoints,r=0;r<o.length-1;r++)length+=this.distance(o[r],o[r+1]),e=this.findPath(o[r],o[r+1]),n.data=e[0],n.id=this.id+"_"+this.shape.sequence,n.offsetX=e[1].x,n.offsetY=e[1].y,n.rotateAngle=45,n.transform=t.Transform.Self;this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black"}return"Conditional"===this.shape.sequence&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Diamond",this.sourceDecorator.style.fill="white",this.targetDecorator.style.fill="black",this.sourceDecorator.width=20,this.sourceDecorator.height=10),n},i.prototype.getBpmnAssociationFlow=function(){"Default"===this.shape.association&&(this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black"),"Directional"===this.shape.association&&(this.style.strokeDashArray="2 2",this.targetDecorator.style.fill="black",this.targetDecorator.shape="Arrow"),"BiDirectional"===this.shape.association&&(this.style.strokeDashArray="2 2",this.targetDecorator.shape="Arrow",this.targetDecorator.style.fill="black",this.sourceDecorator.shape="Arrow",this.sourceDecorator.style.fill="white",this.sourceDecorator.width=5,this.sourceDecorator.height=10)},i.prototype.getBpmnMessageFlow=function(){var e=new sh;return this.style.strokeDashArray="4 4",this.targetDecorator.shape="Arrow",this.targetDecorator.width=5,this.targetDecorator.height=10,this.sourceDecorator.shape="Circle","InitiatingMessage"!==this.shape.message&&"NonInitiatingMessage"!==this.shape.message||(e.id=this.id+"_"+this.shape.message,e.width=25,e.height=15,e.data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",e.horizontalAlignment="Center",e.verticalAlignment="Center",e.transform=t.Transform.Self,e.style.fill="NonInitiatingMessage"===this.shape.message?"lightgrey":"white"),e},i.prototype.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},i.prototype.findPath=function(t,e){var i={x:t.x,y:t.y},n=this.distance(t,e);n=Math.min(30,n/2);var o=Ui(t,e),r=Dl.transform({x:i.x,y:i.y},o,n),s=Dl.transform({x:r.x,y:r.y},o,-12),a=Dl.transform({x:s.x,y:s.y},o,24);return["M"+s.x+" "+s.y+" L"+a.x+" "+a.y,r]},i.prototype.getAnnotationElement=function(t,e,i,n){t.id=t.id||qr();var o=new ch;o.constraints=t.constraints,o.visible=t.visibility,o.horizontalAlignment=t.horizontalAlignment,o.verticalAlignment=t.verticalAlignment,void 0!==i.width&&(o.width=(t.width||i.width)-t.margin.left-t.margin.right),o.margin=t.margin,o.id=this.id+"_"+t.id,0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth),o.content=t.content,o.style=t.style;var r,s=as(n);return s&&(r=s(t,this)),o.description=r||o.id,this.updateAnnotation(t,e,i,o),o.style.textOverflow="Wrap",o},i.prototype.updateAnnotation=function(t,e,i,n){var o,r,s,a,l,h,c={x:0,y:0};t.margin={left:0,right:0,top:0,bottom:0},n.refreshTextElement(),n.width=(t.width||i.width)-n.margin.left-n.margin.right,r=(o=Mo(e,t,i)).point,0===i.width&&(i.width=this.style.strokeWidth),0===i.height&&(i.height=this.style.strokeWidth),h={x:(r.x-i.x)/i.width,y:(r.y-i.y)/i.height},c.x=i.width*h.x,c.y=i.height*h.y,a=(s=Ro(t,o.angle,e)).hAlign,l=s.vAlign;var d,p;"left"===a?(d="Left",c.x+=t.displacement.x):"right"===a?(d="Right",c.x-=t.displacement.x):"center"===a&&(d="Center"),"top"===l?(p="Top",c.y+=t.displacement.y):"bottom"===l?(p="Bottom",c.y-=t.displacement.y):"center"===l&&(p="Center"),n.horizontalAlignment=d,n.verticalAlignment=p,n.setOffsetWithRespectToBounds(c.x,c.y,"Absolute"),n.relativeMode="Point"},i.prototype.getConnectorPoints=function(t,e,i){Math.abs(this.sourcePoint.x-this.targetPoint.x),Math.abs(this.sourcePoint.y-this.targetPoint.y);var n=(e=fi(this,i)).slice(0);return n&&n.length>0&&(this.sourcePoint=n[0],this.targetPoint=n[n.length-1]),n},i.prototype.clipDecorator=function(t,e,i){var n={x:0,y:0},o={x:0,y:0},r={x:0,y:0},s=e.length;o=i?e[0]:e[s-1],r=i?e[1]:e[s-2];var a=Dl.distancePoints(o,r);a=0===a?1:a;var l=t.style.strokeWidth-1;n.x=Math.round(o.x+l*(r.x-o.x)/a),n.y=Math.round(o.y+l*(r.y-o.y)/a);var h=1,c=i?t.sourceWrapper:t.targetWrapper;return c&&(h=c.style.strokeWidth),(i&&"None"!==t.sourceDecorator.shape||!i&&"None"!==t.targetDecorator.shape)&&(n=Dl.adjustPoint(n,r,!0,h/2)),n},i.prototype.clipDecorators=function(t,e){return"None"!==t.sourceDecorator.shape&&(e[0]=this.clipDecorator(t,e,!0)),"None"!==t.targetDecorator.shape&&(e[e.length-1]=this.clipDecorator(t,e,!1)),e},i.prototype.updateSegmentElement=function(t,e,i){var n,o=new Rl;if(n=this.getSegmentPath(t,e),"Bezier"===t.type){if(this.segments.length>0)for(var r=0;r<this.segments.length;r++){var s=this.segments[r],a=t.segments[r],l=Dl.isEmptyPoint(s.point1)?a.bezierPoint1:a.point1,h=Dl.isEmptyPoint(s.point2)?a.bezierPoint2:a.point2;o.uniteRect(On(s.points[0],l,h,s.points[1],t))}}else o=Rl.toBounds(e);return i.width=o.width,i.height=o.height,i.offsetX=o.x+i.width/2,i.offsetY=o.y+i.height/2,i.data=n,t.wrapper&&(t.wrapper.offsetX=i.offsetX,t.wrapper.offsetY=i.offsetY,t.wrapper.width=o.width,t.wrapper.height=o.height),i},i.prototype.getSegmentElement=function(t,e){var i=[];return i=this.getConnectorPoints(t.type),this.intermediatePoints=i,e.staticSize=!0,e=this.updateSegmentElement(t,i,e)},i.prototype.getDecoratorElement=function(e,i,n,o,r){var s=new sh;if(s.transform=t.Transform.Self,this.updateDecoratorElement(s,e,i,n),void 0!==r){var a=r(n,this);s.description=a||"source"}return s},i.prototype.bridgePath=function(t,e,i){var n=e;if(t.bridges.length>0)if("Straight"===t.type)for(o=0;o<t.bridges.length;o++)(r=t.bridges[o]).rendered||(n+=" L"+r.startPoint.x+" "+r.startPoint.y,n+=r.path,r.rendered=!0);else if("Orthogonal"===t.type)for(var o=0;o<t.bridges.length;o++){var r=t.bridges[o];r.segmentPointIndex===i&&(r.rendered||r.segmentPointIndex===i&&(n+=" L"+r.startPoint.x+" "+r.startPoint.y,n+=r.path,r.rendered=!0))}return n},i.prototype.updateDecoratorElement=function(t,e,i,n){var o,r;t.offsetX=e.x,t.offsetY=e.y,r=Dl.findAngle(e,i),o=zt(n.shape,n);var s=new Al(n.width,n.height);t.pivot.x=n.pivot.x,t.pivot.y=n.pivot.y,t.style=n.style,t.rotateAngle=r,t.data=o,t.width=s.width,t.height=s.height},i.prototype.getSegmentPath=function(t,e){for(var i,n,o,r="",s=[],a=0;a<e.length;)s.push({x:e[a].x,y:e[a].y}),a++;for(var l=0;l<t.bridges.length;l++)t.bridges[l].rendered=!1;if(s=this.clipDecorators(t,s),this.cornerRadius>0&&"Bezier"!==this.type)for(var h=0;h<s.length-1;h++){i=s[h],0===h&&(r="M"+i.x+" "+i.y);var c=Dl.distancePoints(s[h],s[h+1]);c>0&&(n=h<s.length-2?c<2*this.cornerRadius?Dl.adjustPoint(s[h],s[h+1],!1,c/2):Dl.adjustPoint(s[h],s[h+1],!1,this.cornerRadius):s[h+1],h>0&&(c<2*this.cornerRadius?(o=Dl.adjustPoint(s[h],s[h+1],!0,c/2),h<s.length-2&&(n=null)):o=Dl.adjustPoint(s[h],s[h+1],!0,this.cornerRadius)),o&&(r+="Q"+i.x+" "+i.y+" "+o.x+" "+o.y),n&&(t.bridges.length>0&&(r=this.bridgePath(t,r,h),"Orthogonal"===t.type&&(r=this.bridgePath(t,r,h+1))),r+=" L"+n.x+" "+n.y))}else if("Bezier"===this.type){for(var d=void 0,p=this.segments,u=0;u<p.length;u++)s.length>2&&(p[u].bezierPoint1={x:0,y:0},p[u].bezierPoint2={x:0,y:0}),!Dl.isEmptyPoint(p[u].point1)||p[u].vector1.angle||p[u].vector1.distance?p[u].vector1.angle||p[u].vector1.distance?p[u].bezierPoint1=Dl.transform(s[u],p[u].vector1.angle,p[u].vector1.distance):p[u].bezierPoint1={x:p[u].point1.x||p[u].bezierPoint1.x,y:p[u].point1.y||p[u].bezierPoint1.y}:((t.sourceID||this.sourcePortID)&&this.sourceWrapper&&(d=Ln(this.sourceWrapper.bounds,s[u],!0)),p[u].bezierPoint1=kn(s[u],s[u+1],d)),!Dl.isEmptyPoint(p[u].point2)||p[u].vector2.angle||p[u].vector2.distance?p[u].vector2.angle||p[u].vector2.distance?p[u].bezierPoint2=Dl.transform(s[u+1],p[u].vector2.angle,p[u].vector2.distance):p[u].bezierPoint2={x:p[u].point2.x||p[u].bezierPoint2.x,y:p[u].point2.y||p[u].bezierPoint2.y}:((t.targetID||this.targetPortID)&&this.targetWrapper&&(d=Ln(this.targetWrapper.bounds,s[u+1],!0)),p[u].bezierPoint2=kn(s[u+1],s[u],d));s.splice(1,0,{x:p[0].bezierPoint1.x,y:p[0].bezierPoint1.y}),s.splice(s.length-1,0,{x:p[p.length-1].bezierPoint2.x,y:p[p.length-1].bezierPoint2.y}),s=this.clipDecorators(t,s);for(var g=0;g<p.length;g++){0===g&&(r="M"+s[0].x+" "+s[0].y);var m=g===p.length-1?s[s.length-1].x+" "+s[s.length-1].y:p[g].points[p[g].points.length-1].x+" "+p[g].points[p[g].points.length-1].y;r+="C"+p[g].bezierPoint1.x+" "+p[g].bezierPoint1.y+" "+p[g].bezierPoint2.x+" "+p[g].bezierPoint2.y+" "+m}}else for(var f=0;f<s.length;f++)i=s[f],0===f&&(r="M"+i.x+" "+i.y),f>0&&(r=this.bridgePath(t,r,f),r+=" L"+i.x+" "+i.y);return r},i.prototype.updateShapeElement=function(t){var e;switch(t.shape.type){case"Bpmn":t.wrapper.children[3]instanceof sh&&(e=t.wrapper.children[3]),"Message"===t.shape.flow&&this.updateShapePosition(t,e)}},i.prototype.updateShapePosition=function(t,e){for(var i,n,o=0,r=this.intermediatePoints,s=0;s<r.length-1;s++){var a=.5*(o+=this.distance(r[s],r[s+1]));o>=a&&(i=Ui(r[s],r[s+1]),n=Dl.transform(r[s],i,a))}e.offsetX=n.x,e.offsetY=n.y},i.prototype.scale=function(t,e,i,n,o){var r=0,s=0;if(this.wrapper&&this.wrapper.outerBounds){var a=En(this),l=(this.wrapper.bounds.width||this.style.strokeWidth||1)-2,h=(this.wrapper.bounds.height||this.style.strokeWidth||1)-2;r=a.width-l,s=a.height-h,t=(i-Math.max(r,s))/l,e=(n-Math.max(r,s))/h,r=s=Math.min(r,s)}t=e=Math.min(t,e);var c=Et();Tt(c,-(o=o||this.wrapper).rotateAngle,o.offsetX,o.offsetY),kt(c,t,e,o.offsetX,o.offsetY),Tt(c,o.rotateAngle,o.offsetX,o.offsetY);var d=Lt(c,this.intermediatePoints);return this.sourcePoint=d[0],this.targetPoint=d[d.length-1],d=this.intermediatePoints=fi(this),qo(this,d),{x:r,y:s}},Mc([Z(Ic)],i.prototype,"shape",void 0),Mc([Y(t.ConnectorConstraints.Default)],i.prototype,"constraints",void 0),Mc([Y(10)],i.prototype,"bridgeSpace",void 0),Mc([K([],Ph)],i.prototype,"annotations",void 0),Mc([G({},Dl)],i.prototype,"sourcePoint",void 0),Mc([G({},Dl)],i.prototype,"targetPoint",void 0),Mc([Q(Dc)],i.prototype,"segments",void 0),Mc([Y("")],i.prototype,"sourceID",void 0),Mc([Y("")],i.prototype,"targetID",void 0),Mc([Y(10)],i.prototype,"hitPadding",void 0),Mc([Y("Straight")],i.prototype,"type",void 0),Mc([Y(0)],i.prototype,"cornerRadius",void 0),Mc([G({shape:"None"},Rc)],i.prototype,"sourceDecorator",void 0),Mc([G({shape:"Arrow"},Rc)],i.prototype,"targetDecorator",void 0),Mc([G({},Lc)],i.prototype,"tooltip",void 0),Mc([Y("")],i.prototype,"sourcePortID",void 0),Mc([Y("")],i.prototype,"targetPortID",void 0),Mc([G({strokeWidth:1,strokeColor:"black"},eh)],i.prototype,"style",void 0),Mc([Y(null)],i.prototype,"wrapper",void 0),i}(Oc),Wc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Uc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},qc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Wc(e,t),Uc([Y("")],e.prototype,"name",void 0),Uc([Y("")],e.prototype,"pathData",void 0),Uc([Y("#000000")],e.prototype,"backgroundColor",void 0),Uc([Y("top")],e.prototype,"side",void 0),Uc([Y("")],e.prototype,"borderColor",void 0),Uc([Y(.5)],e.prototype,"borderWidth",void 0),Uc([Y(25)],e.prototype,"size",void 0),Uc([Y("white")],e.prototype,"pathColor",void 0),Uc([Y(10)],e.prototype,"displacement",void 0),Uc([Y(!0)],e.prototype,"visible",void 0),Uc([Y(0)],e.prototype,"offset",void 0),Uc([G({},Gl)],e.prototype,"margin",void 0),Uc([Y("Center")],e.prototype,"horizontalAlignment",void 0),Uc([Y("Center")],e.prototype,"verticalAlignment",void 0),e}(xa),Xc=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Wc(i,e),i.prototype.init=function(t){var e=new oh;if(e.measureChildren=!1,e.children=[],this.nodes||this.connectors){for(var i=0;i<this.nodes.length;i++){o=t.nameTable[this.nodes[i].id].wrapper;e.children.push(o)}for(var n=0;n<this.connectors.length;n++){var o=t.nameTable[this.connectors[n].id].wrapper;e.children.push(o)}}return this.wrapper=e,e},Uc([Y(null)],i.prototype,"wrapper",void 0),Uc([K([],fd)],i.prototype,"nodes",void 0),Uc([K([],_c)],i.prototype,"connectors",void 0),Uc([Y()],i.prototype,"width",void 0),Uc([Y()],i.prototype,"height",void 0),Uc([Y(0)],i.prototype,"rotateAngle",void 0),Uc([Y(0)],i.prototype,"offsetX",void 0),Uc([Y(0)],i.prototype,"offsetY",void 0),Uc([G({x:.5,y:.5},Dl)],i.prototype,"pivot",void 0),Uc([Y("CompleteIntersect")],i.prototype,"rubberBandSelectionMode",void 0),Uc([K([],qc)],i.prototype,"userHandles",void 0),Uc([Y(t.SelectorConstraints.All)],i.prototype,"constraints",void 0),i}(xa),Yc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gc=function(t){function e(e,i){var n=t.call(this)||this;return n.data="",n.nodeId="",n.diagramId="",n.diagramId=i,n.nodeId=e,n}return Yc(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.data},set:function(t){this.data=t,this.template=Vr(this,!0),this.isDirt=!0},enumerable:!0,configurable:!0}),e}(Wl),Zc=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Kc=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Qc=function(t){switch(t.type){case"Basic":return od;case"Flow":return rd;case"Path":return $c;case"Image":return id;case"Text":return nd;case"Bpmn":return md;case"Native":return td;case"HTML":return ed;default:return od}},Jc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Basic")],e.prototype,"type",void 0),e}(xa),$c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Path")],e.prototype,"type",void 0),Kc([Y("")],e.prototype,"data",void 0),e}(Jc),td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Native")],e.prototype,"type",void 0),Kc([Y("")],e.prototype,"content",void 0),Kc([Y("Stretch")],e.prototype,"scale",void 0),e}(Jc),ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("HTML")],e.prototype,"type",void 0),Kc([Y("")],e.prototype,"content",void 0),e}(Jc),id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Image")],e.prototype,"type",void 0),Kc([Y("")],e.prototype,"source",void 0),Kc([Y("")],e.prototype,"scale",void 0),Kc([Y("None")],e.prototype,"align",void 0),e}(Jc),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Text")],e.prototype,"type",void 0),Kc([Y("")],e.prototype,"content",void 0),Kc([G({},Gl)],e.prototype,"margin",void 0),e}(Jc),od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Basic")],e.prototype,"type",void 0),Kc([Y("Rectangle")],e.prototype,"shape",void 0),Kc([Y(0)],e.prototype,"cornerRadius",void 0),Kc([K([],Dl)],e.prototype,"points",void 0),e}(Jc),rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Flow")],e.prototype,"type",void 0),Kc([Y("Terminator")],e.prototype,"shape",void 0),e}(Jc),sd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("None")],e.prototype,"type",void 0),e}(xa),ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("None")],e.prototype,"type",void 0),Kc([Y(!1)],e.prototype,"collection",void 0),e}(xa),ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("None")],e.prototype,"type",void 0),Kc([Y("None")],e.prototype,"loop",void 0),Kc([Y(!1)],e.prototype,"call",void 0),Kc([Y(!1)],e.prototype,"compensation",void 0),e}(xa),hd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Start")],e.prototype,"event",void 0),Kc([Y("None")],e.prototype,"trigger",void 0),e}(xa),cd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("None")],e.prototype,"trigger",void 0),Kc([Y("Start")],e.prototype,"event",void 0),Kc([Y("")],e.prototype,"id",void 0),Kc([G({},Dl)],e.prototype,"offset",void 0),Kc([K([],Eh)],e.prototype,"annotations",void 0),Kc([K([],bh)],e.prototype,"ports",void 0),Kc([Y()],e.prototype,"width",void 0),Kc([Y()],e.prototype,"height",void 0),Kc([G({},Gl)],e.prototype,"margin",void 0),Kc([Y("Center")],e.prototype,"horizontalAlignment",void 0),Kc([Y("Center")],e.prototype,"verticalAlignment",void 0),Kc([Y(!0)],e.prototype,"visible",void 0),e}(xa),dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([G({id:"success",event:"End",offset:{x:1,y:.5}},cd)],e.prototype,"success",void 0),Kc([G({id:"failure",event:"Intermediate",trigger:"Error",offset:{x:.25,y:1}},cd)],e.prototype,"failure",void 0),Kc([G({id:"cancel",event:"Intermediate",trigger:"Cancel",offset:{x:.75,y:1}},cd)],e.prototype,"cancel",void 0),e}(xa),pd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("None")],e.prototype,"type",void 0),Kc([Y(!1)],e.prototype,"adhoc",void 0),Kc([Y("Default")],e.prototype,"boundary",void 0),Kc([Y(!1)],e.prototype,"compensation",void 0),Kc([Y("None")],e.prototype,"loop",void 0),Kc([Y(!0)],e.prototype,"collapsed",void 0),Kc([K([],cd)],e.prototype,"events",void 0),Kc([G({},dd)],e.prototype,"transaction",void 0),Kc([Y(void 0)],e.prototype,"processes",void 0),e}(xa),ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Task")],e.prototype,"activity",void 0),Kc([G({},ld)],e.prototype,"task",void 0),Kc([G({},pd)],e.prototype,"subProcess",void 0),e}(xa),gd=function(t){function e(e,i,n,o){return t.call(this,e,i,n,o)||this}return Zc(e,t),Kc([Y("")],e.prototype,"text",void 0),Kc([Y("")],e.prototype,"id",void 0),Kc([Y()],e.prototype,"angle",void 0),Kc([Y()],e.prototype,"height",void 0),Kc([Y()],e.prototype,"width",void 0),Kc([Y()],e.prototype,"length",void 0),e}(xa),md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zc(e,t),Kc([Y("Bpmn")],e.prototype,"type",void 0),Kc([Y("Event")],e.prototype,"shape",void 0),Kc([G({},hd)],e.prototype,"event",void 0),Kc([G({},sd)],e.prototype,"gateway",void 0),Kc([G({},ad)],e.prototype,"dataObject",void 0),Kc([G({},ud)],e.prototype,"activity",void 0),Kc([K([],gd)],e.prototype,"annotations",void 0),e}(Jc),fd=function(e){function i(t,i,n,o){var r=e.call(this,t,i,n,o)||this;return r.parentId="",r.processId="",r.outEdges=[],r.inEdges=[],r}return Zc(i,e),Object.defineProperty(i.prototype,"actualSize",{get:function(){return null!==this.wrapper?this.wrapper.actualSize:new Al(this.width||0,this.height||0)},enumerable:!0,configurable:!0}),i.prototype.init=function(e){var i,n=new Wl;switch(this.shape.changedProperties={},this.shape.oldProperties={},this.shape.type){case"Path":var o=new sh;o.data=this.shape.data,n=o;break;case"Image":var r=new ph;r.source=this.shape.source,r.imageAlign=this.shape.align,r.imageScale=this.shape.scale,n=r;break;case"Text":var s=new ch;s.content=this.shape.content,n=s,i=this.style,n.style=i;break;case"Basic":if("Rectangle"===this.shape.shape)(n=l=new Wl).cornerRadius=this.shape.cornerRadius;else if("Polygon"===this.shape.shape){var a=new sh;a.data=ft(this.shape.points),n=a}else{var l=new sh,h=Bt(this.shape.shape);l.data=h,n=l}break;case"Flow":var c=new sh,d=Ft(this.shape.shape);c.data=d,n=c;break;case"Bpmn":if(e.bpmnModule){n=e.bpmnModule.initBPMNContent(n,this,e);var p=this.shape.activity.subProcess;if(p.processes&&p.processes.length)for(var u=0,g=this.shape.activity.subProcess.processes;u<g.length;u++){var m=g[u];!e.nameTable[m]||e.nameTable[m].processId&&e.nameTable[m].processId!==this.id||(e.nameTable[m].processId=this.id,p.collapsed&&e.updateElementVisibility(e.nameTable[m].wrapper,e.nameTable[m],!p.collapsed),n.children.push(e.nameTable[m].wrapper))}}break;case"Native":var f=new lh(this.id,e.element.id);f.content=this.shape.content,f.scale=this.shape.scale,n=f;break;case"HTML":var v=new Gc(this.id,e.element.id);v.content=this.shape.content,n=v}return n.id=this.id+"_content",n.relativeMode="Object",void 0!==this.width&&(n.width=this.width),n.horizontalAlignment="Stretch",void 0!==this.height&&(n.height=this.height),void 0!==this.minHeight&&(n.minHeight=this.minHeight),void 0!==this.maxHeight&&(n.maxHeight=this.maxHeight),void 0!==this.minWidth&&(n.minWidth=this.minWidth),void 0!==this.maxWidth&&(n.maxWidth=this.maxWidth),"Rectangle"!==this.shape.shape||this.shape.cornerRadius||(n.isRectElement=!0),n.verticalAlignment="Stretch",this.shape instanceof nd&&(n.margin=this.shape.margin),Fn(this)&&0!=(this.constraints&t.NodeConstraints.Shadow)&&(n.shadow=this.shadow),"Bpmn"===this.shape.type&&"Message"!==this.shape.shape&&"DataSource"!==this.shape.shape||"Text"!==this.shape.type&&(n.style=this.style),n},i.prototype.initContainer=function(){this.id||(this.id=qr());var t=this.children?new oh:new gh;return t.id=this.id,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t.visible=this.visible,t.style.fill=this.backgroundColor,t.style.strokeColor=this.borderColor,t.style.strokeWidth=this.borderWidth,t.rotateAngle=this.rotateAngle,t.minHeight=this.minHeight,t.minWidth=this.minWidth,t.maxHeight=this.maxHeight,t.maxWidth=this.maxWidth,t.pivot=this.pivot,t.margin=this.margin,this.wrapper=t,t},i.prototype.initPorts=function(t,e){this.wrapper;for(var i,n=0;this.ports,n<this.ports.length;n++){i=this.initPortWrapper(this.ports[n]);var o=void 0,r=as(t);r&&(o=r(i,this)),i.description=o||i.id,e.children.push(i)}},i.prototype.getIconOffet=function(t,e){var i,n;return"BottomToTop"===t.orientation?(i=e.offset.x,n=1-e.offset.y):"LeftToRight"===t.orientation?(i=e.offset.y,n=e.offset.x):"RightToLeft"===t.orientation?(i=1-e.offset.y,n=e.offset.x):(i=e.offset.x,n=e.offset.y),{x:i,y:n}},i.prototype.initIcons=function(t,e,i,n){this.wrapper;var o,r=this.isExpanded?this.expandIcon:this.collapseIcon;if("None"!==r.shape){var s=new gh;s.float=!0;var a=[];s.id=this.id+"_icon_content",s.children=a,s.height=r.height,s.width=r.width,s.style.strokeColor="transparent",s.margin=r.margin,s.horizontalAlignment="Center",s.verticalAlignment="Center",s.visible=this.visible,o=this.getIconOffet(e,r),s.setOffsetWithRespectToBounds(o.x,o.y,"Fraction"),s.relativeMode="Point",this.initIconSymbol(r,s,t,n);var l=void 0,h=as(t);h&&(l=h(r,this)),s.description=l||s.id,i.children.push(s)}},i.prototype.initAnnotations=function(t,e){for(var i,n=0;this.annotations,n<this.annotations.length;n++){i=this.initAnnotationWrapper(this.annotations[n]);var o=void 0,r=as(t);r&&(o=r(i,this)),i.description=o||i.id,e.children.push(i)}},i.prototype.initPortWrapper=function(e){e.id=e.id||qr();var i=new sh;i.height=e.height,i.width=e.width;var n="Custom"===e.shape?e.pathData:Ht(e.shape);i.id=this.id+"_"+e.id,i.margin=e.margin,i.data=n;var o=e.style;return i.style={fill:o.fill,strokeColor:o.strokeColor,gradient:null,opacity:o.opacity,strokeDashArray:o.strokeDashArray,strokeWidth:o.strokeWidth},i.horizontalAlignment=e.horizontalAlignment,i.verticalAlignment=e.verticalAlignment,i.setOffsetWithRespectToBounds(e.offset.x,e.offset.y,"Fraction"),void 0===this.width&&void 0===this.height||(i.float=!0),i.relativeMode="Point",i.visible=!(!Zo(e,t.PortVisibility.Visible)||Zo(e,t.PortVisibility.Hover)||Zo(e,t.PortVisibility.Connect)),i},i.prototype.initAnnotationWrapper=function(t){t.id=t.id||qr();var e=t,i=new ch;i.constraints=t.constraints,i.height=t.height,i.width=t.width,i.visible=t.visibility,i.id=this.id+"_"+t.id;var n=t.style,o=t.hyperlink.link?t.hyperlink:void 0;return i.style={fill:n.fill,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth,bold:n.bold,textWrapping:n.textWrapping,color:o?o.color||i.hyperlink.color:n.color,whiteSpace:n.whiteSpace,fontFamily:n.fontFamily,fontSize:n.fontSize,italic:n.italic,gradient:null,opacity:n.opacity,strokeDashArray:n.strokeDashArray,textAlign:n.textAlign,textOverflow:t.style.textOverflow,textDecoration:o?o.textDecoration||i.hyperlink.textDecoration:n.textDecoration},i.hyperlink.link=t.hyperlink.link||void 0,i.hyperlink.content=t.hyperlink.content||void 0,i.hyperlink.textDecoration=t.hyperlink.textDecoration||void 0,i.content=o?o.content||i.hyperlink.link:t.content,void 0!==this.width&&(i.width=this.width-t.margin.left-t.margin.right),i.margin=t.margin,i.horizontalAlignment=t.horizontalAlignment,i.verticalAlignment=t.verticalAlignment,i.setOffsetWithRespectToBounds(e.offset.x,e.offset.y,"Fraction"),void 0===this.width&&void 0===this.height||(i.float=!0),i.relativeMode="Point",i},i.prototype.initIconContainer=function(t,e){var i=new Wl;return i.id=e.id+"_rect",i.height=t.height,i.width=t.width,i.visible=e.visible,i.margin=t.margin,i.cornerRadius=t.cornerRadius,i.style={fill:t.fill,strokeColor:t.borderColor,strokeWidth:t.borderWidth},i.setOffsetWithRespectToBounds(.5,.5,"Fraction"),i.horizontalAlignment="Center",i.verticalAlignment="Center",i.relativeMode="Object",i.description=i.description||"Click here to expand or collapse",i},i.prototype.initIconSymbol=function(t,e,i,n){var o;if(e.children.push(this.initIconContainer(t,e)),"Template"===t.shape)(o=new lh(this.id,n)).content=t.content,o.height=10,o.width=10;else{(o=new sh).data=jt(t);var r=sr(o.data);o.height=r.height<10?r.height:10-(t.padding.bottom+t.padding.top),o.width=r.width<10?r.width:10-(t.padding.left+t.padding.right)}o.id=e.id+"_shape",o.horizontalAlignment="Center",o.verticalAlignment="Center",o.visible=e.visible,o.visible=e.visible,o.style={fill:"black",strokeColor:t.borderColor,strokeWidth:t.borderWidth},o.setOffsetWithRespectToBounds(.5,.5,"Fraction"),o.relativeMode="Object",o.description=e.description||"Click here to expand or collapse",e.children.push(o)},Kc([K([],Eh)],i.prototype,"annotations",void 0),Kc([Y(0)],i.prototype,"offsetX",void 0),Kc([Y(0)],i.prototype,"offsetY",void 0),Kc([G({x:.5,y:.5},Dl)],i.prototype,"pivot",void 0),Kc([Y()],i.prototype,"width",void 0),Kc([Y()],i.prototype,"height",void 0),Kc([Y()],i.prototype,"minWidth",void 0),Kc([Y()],i.prototype,"minHeight",void 0),Kc([Y()],i.prototype,"maxWidth",void 0),Kc([Y()],i.prototype,"maxHeight",void 0),Kc([Y(0)],i.prototype,"rotateAngle",void 0),Kc([G({},ih)],i.prototype,"style",void 0),Kc([Y("transparent")],i.prototype,"backgroundColor",void 0),Kc([Y("none")],i.prototype,"borderColor",void 0),Kc([Y(0)],i.prototype,"borderWidth",void 0),Kc([Y()],i.prototype,"data",void 0),Kc([Z(Qc)],i.prototype,"shape",void 0),Kc([Y(null)],i.prototype,"wrapper",void 0),Kc([Y(t.NodeConstraints.Default)],i.prototype,"constraints",void 0),Kc([G({},Zl)],i.prototype,"shadow",void 0),Kc([Y()],i.prototype,"children",void 0),i}(Oc),vd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),yd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},bd=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.offset=0,n.scale=1,n}return vd(e,t),e.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.updateRulerGeometry()},e.prototype.getModuleName=function(){return"Ruler"},e.prototype.destroy=function(){this.unWireEvents(),this.notify("destroy",{}),t.prototype.destroy.call(this),this.element.classList.remove("e-ruler")},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"length":case"interval":case"segmentWidth":case"tickAlignment":case"markerColor":case"thickness":this.updateRuler()}},e.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},e.prototype.renderRulerSpace=function(){var t=this.getRulerGeometry(),e=document.getElementById(this.element.id+"_ruler_space");return e||((e=document.createElement("div")).setAttribute("id",this.element.id+"_ruler_space"),e.style.height=t.height+"px",e.style.width=t.width+"px",e.style.cssFloat="left",this.element.appendChild(e)),e},e.prototype.updateRuler=function(){var t=this.getRulerSize(),e=this.getRulerGeometry(),i=0,n=0,o=new Al,r=this.getRulerSVG(e);if(r&&(i=this.length,o.height=t,n=this.offset,i&&i!==1/0)){var s=i+this.segmentWidth,a=n;this.updateSegments(a,s+Math.abs(a),r,t)}},e.prototype.updateSegments=function(t,e,i,n){for(var o=t,r={trans:0};o<e;){var s=this.getNewSegment(o,i);s&&(i.appendChild(s.segment),o=this.updateSegment(t,e,s,o,r,n))}},e.prototype.updateSegment=function(t,e,i,n,o,r){var s=this.updateSegmentWidth(this.scale);n===t?(this.startValue=Math.floor(t/s)*s/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString(),this.defStartValue=n=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=t-n:this.vRulerOffset=t-n):(this.startValue=n/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.startValue.toString()),this.updateTickLabel(i,r);var a="Horizontal"===this.orientation?o.trans+.5+",0.5":"0.5,"+(o.trans+.5);return i.segment.setAttribute("transform","translate("+a+")"),o.trans+=s,n+=s},e.prototype.updateTickLabel=function(t,e){var i=t.segment.lastChild.getBBox(),n="Horizontal"===this.orientation,o="RightOrBottom"===this.tickAlignment,r=n?2:0,s=n?o?e/2+5.5-5.5:e/2+5.5:i.height,a=o?-(i.width+2)+","+(e/2-i.height):-(i.width+2)+","+(e/2-i.height/2),l=n?{x:r,y:s}:{x:r,y:s,transform:"rotate(270)translate("+a+")"};_r(t.segment.lastChild,l)},e.prototype.getNewSegment=function(t,e){var i=this.createNewTicks(t,e);return{segment:i,label:this.createTickLabel(e,i)}},e.prototype.createNewTicks=function(t,e){var i,n,o,r=this.updateSegmentWidth(this.scale);o=Nr("g",{class:"e-ruler-segment"});for(var s=0;s<this.interval;s++)n=r/this.interval,i=this.createTick(e,n,s+1,t),o.appendChild(i);return o},e.prototype.getLinePoint=function(t,e,i){var n=this.updateSegmentWidth(this.scale),o=this.getRulerSize();return e*=i-1,i=e%n==0?o:.3*o},e.prototype.createTick=function(t,e,i,n){var o,r,s,a=this.getLinePoint(t,e,i),l=this.getRulerSize(),h="Horizontal"===this.orientation,c="RightOrBottom"===this.tickAlignment,d=as(this.arrangeTick);r={ruler:void 0,tickLength:a,tickInterval:this.segmentWidth/this.interval*(i-1)},d&&d(r),a=r.tickLength;var p=e*(i-1),u=h?p:c?l:0,g=h?p:c?l-a:l-(l-a);return s={x1:u,y1:h?c?l:l-(l-a):p,x2:g,y2:h?c?l-a:0:p,"stroke-width":"1",stroke:"black"},(o=Nr("line",s)).setAttribute("class","e-ruler-tick"),o},e.prototype.createTickLabel=function(t,e){var i;return e&&(i=Nr("text",{class:"e-ruler-tick-label"}),e.appendChild(i)),i},e.prototype.updateSegmentWidth=function(t){if(100!==this.segmentWidth)return this.segmentWidth;var e,i=1;for(e=100,e=100/Math.pow(2,Math.round(Math.log(t)/Math.log(2)));e>100;)i/=10,e/=10;for(;e<25;)i*=10,e*=10;return e>=25&&e%25!=0&&(e=25*Math.round(e/25)),e*t/i},e.prototype.createMarkerLine=function(t,e,i){var n;return e&&((n=t.getElementById(e.id+"_marker"))&&n.parentNode.removeChild(n),n=Nr("line",i)),n},e.prototype.drawRulerMarker=function(t,e,i){var n,o,r,s,a,l,h,c="Horizontal"===this.orientation,d=t.getElementsByTagName("svg");for(a=0;a<d.length;a++){d[a]&&(n=d[a]);break}if(n){o=this.getRulerSize(),l={id:t.id+"_marker",x1:0,y1:0,x2:c?0:o,y2:c?o:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},h=this.createMarkerLine(n,t,l),r=this.scale,s=this.offset-this.defStartValue;var p=(c?e.x:e.y)*r+i+s;h.setAttribute("transform","translate("+(c?p+.5+" 0.5":"0.5 "+(p+.5))+")"),n.appendChild(h)}},e.prototype.getRulerGeometry=function(){return new Al(this.element?this.element.getBoundingClientRect().width:0,this.element?this.element.getBoundingClientRect().height:0)},e.prototype.getRulerSize=function(){return this.thickness},e.prototype.getRulerSVG=function(t){var e,i,n=this.getRulerSize();if(this.element&&(e=document.getElementById(this.element.id+"_ruler_space"))){if(i=Nr("svg",{id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?t.width+200:n+"px",height:"Horizontal"===this.orientation?n:t.height+200+"px",style:"position:inherit;"}),e.childNodes.length>0)for(var o=e.childNodes.length-1;o>=0;o--)e.childNodes[o].parentNode.removeChild(e.childNodes[o]);e.appendChild(i)}return i},e.prototype.wireEvents=function(){},e.prototype.unWireEvents=function(){},yd([Y(5)],e.prototype,"interval",void 0),yd([Y(100)],e.prototype,"segmentWidth",void 0),yd([Y("Horizontal")],e.prototype,"orientation",void 0),yd([Y("RightOrBottom")],e.prototype,"tickAlignment",void 0),yd([Y("red")],e.prototype,"markerColor",void 0),yd([Y(25)],e.prototype,"thickness",void 0),yd([Y(null)],e.prototype,"arrangeTick",void 0),yd([Y(400)],e.prototype,"length",void 0),e}(Ka),wd=function(t){return t&&(t=void 0!==t.sourceID||void 0!==t.sourcePoint||void 0!==t.targetID||void 0!==t.targetPoint||void 0!==t.type?_c:fd),t},xd=function(){function t(){}return t.getContext=function(t){return t.getContext("2d")},t.setCanvasSize=function(t,e,i){t&&(t.setAttribute("width",e.toString()),t.setAttribute("height",i.toString()))},t.prototype.renderGradient=function(t,e,i,n){var o,r,s;if("None"!==t.gradient.type){for(h=0;h<t.gradient.stops.length;h++)o=void 0!==o?t.gradient.stops[h].offset:Math.max(o,t.gradient.stops[h].offset),r=void 0!==r?t.gradient.stops[h].offset:Math.min(r,t.gradient.stops[h].offset);if("Linear"===t.gradient.type){var a=t.gradient;s=e.createLinearGradient(i+a.x1,n+a.y1,i+a.x2,n+a.y2)}else{var l=t.gradient;s=e.createRadialGradient(i+l.fx,n+l.fy,0,i+l.cx,n+l.cy,l.r)}for(var h=0;h<t.gradient.stops.length;h++){var c=t.gradient.stops[h],d=r<0?(o+c.offset)/(2*o):c.offset/o;s.addColorStop(d,c.color)}e.fillStyle=s}return e},t.prototype.renderShadow=function(e,i,n){void 0===n&&(n=null);var o=t.getContext(i);o.save(),o.beginPath(),o.strokeStyle=o.fillStyle=e.shadow.color,o.globalAlpha=e.shadow.opacity;var r={x:0,y:0},s=Dl.transform(r,e.shadow.angle,e.shadow.distance),a=e.x+s.x,l=e.y+s.y,h=a+e.width*e.pivotX,c=l+e.height*e.pivotY;this.rotateContext(i,e.angle,h,c),n?(o.translate(a,l),this.renderPath(i,e,n),o.translate(-a,-l)):(o.rect(a,l,e.width,e.height),o.fillRect(a,l,e.width,e.height)),o.fill(),o.stroke(),o.closePath(),o.restore()},t.createCanvas=function(t,e,i){var n=document.createElement("canvas");return n.setAttribute("id",t),this.setCanvasSize(n,e,i),n},t.prototype.setStyle=function(e,i){var n=t.getContext(e);"none"===i.fill&&(i.fill="transparent"),"none"===i.stroke&&(i.stroke="transparent"),n.strokeStyle=i.stroke,n.lineWidth=i.strokeWidth,0===i.strokeWidth&&(n.strokeStyle="transparent"),n.globalAlpha=i.opacity;var o=[];i.dashArray&&(o=this.parseDashArray(i.dashArray)),n.setLineDash(o),i.gradient&&"None"!==i.gradient.type?this.renderGradient(i,n,0,0):n.fillStyle=i.fill},t.prototype.rotateContext=function(e,i,n,o){var r=t.getContext(e);r.translate(n,o),r.rotate(i*Math.PI/180),r.translate(-n,-o)},t.prototype.setFontStyle=function(e,i){var n=t.getContext(e),o="";i.italic&&(o+="italic "),i.bold&&(o+="bold "),o+=i.fontSize+"px ",o+=i.fontFamily,n.font=o},t.prototype.parseDashArray=function(t){for(var e=[],i=-1!==t.indexOf(" ")?" ":",",n=0,o=t.split(i);n<o.length;n++){var r=o[n];e.push(Number(r))}return e},t.prototype.drawRectangle=function(e,i){if(!0===i.visible)if(i.cornerRadius)i.data=mt(i.cornerRadius,i.height,i.width),this.drawPath(e,i);else{var n=t.getContext(e);i.shadow&&this.renderShadow(i,e),n.save(),n.beginPath();i.cornerRadius;var o=i.x+i.width*i.pivotX,r=i.y+i.height*i.pivotY;this.rotateContext(e,i.angle,o,r),this.setStyle(e,i),n.rect(i.x,i.y,i.width,i.height),n.fillRect(i.x,i.y,i.width,i.height),n.fill(),n.stroke(),n.closePath(),n.restore()}},t.prototype.drawPath=function(e,i){var n=[];n=vt(n=ut(i.data)),i.shadow&&this.renderShadow(i,e,n);var o=t.getContext(e);o.save(),o.beginPath();var r=i.y+i.height*i.pivotY,s=i.x+i.width*i.pivotX;this.rotateContext(e,i.angle,s,r),this.setStyle(e,i),o.translate(i.x,i.y),this.renderPath(e,i,n),o.fill(),o.translate(-i.x,-i.y),o.stroke(),o.restore()},t.prototype.renderPath=function(e,i,n){if(!0===i.visible){var o,r=t.getContext(e),s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,d=void 0,p=void 0,u=void 0,g=void 0,m=n;for(p=0,u=0,g=0,o=m.length;g<o;++g){var f=m[g],v=f.command;switch("x1"in f&&(l=f.x1),"x2"in f&&(c=f.x2),"y1"in f&&(h=f.y1),"y2"in f&&(d=f.y2),"x"in f&&(p=f.x),"y"in f&&(u=f.y),v){case"M":r.moveTo(p,u),f.x=p,f.y=u;break;case"L":r.lineTo(p,u),f.x=p,f.y=u;break;case"C":r.bezierCurveTo(l,h,c,d,p,u),f.x=p,f.y=u,f.x1=l,f.y1=h,f.x2=c,f.y2=d;break;case"Q":r.quadraticCurveTo(l,h,p,u),f.x=p,f.y=u,f.x1=l,f.y1=h;break;case"A":var y={x:s,y:a},b=f.r1,w=f.r2,x=f.angle*(Math.PI/180),C=f.largeArc,S=f.sweep,E={x:p,y:u},P={x:Math.cos(x)*(y.x-E.x)/2+Math.sin(x)*(y.y-E.y)/2,y:-Math.sin(x)*(y.x-E.x)/2+Math.cos(x)*(y.y-E.y)/2},L=Math.pow(P.x,2)/Math.pow(b,2)+Math.pow(P.y,2)/Math.pow(w,2);L>1&&(b*=Math.sqrt(L),w*=Math.sqrt(L));var T=Math.pow(w,2)*Math.pow(P.x,2),k=(C===S?-1:1)*Math.sqrt((Math.pow(b,2)*Math.pow(w,2)-Math.pow(b,2)*Math.pow(P.y,2)-T)/(Math.pow(b,2)*Math.pow(P.y,2)+Math.pow(w,2)*Math.pow(P.x,2)));isNaN(k)&&(k=0);var O={x:k*b*P.y/w,y:k*-w*P.x/b},A={x:(y.x+E.x)/2+Math.cos(x)*O.x-Math.sin(x)*O.y,y:(y.y+E.y)/2+Math.sin(x)*O.x+Math.cos(x)*O.y},M=this.a([1,0],[(P.x-O.x)/b,(P.y-O.y)/w]),I=[(P.x-O.x)/b,(P.y-O.y)/w],D=[(-P.x-O.x)/b,(-P.y-O.y)/w],R=this.a(I,D);if(this.r(I,D)<=-1&&(R=Math.PI),this.r(I,D)>=1&&(R=0),f.centp=A,f.xAxisRotation=x,f.rx=b,f.ry=w,f.a1=M,f.ad=R,f.sweep=S,null!=r){var N=b>w?b:w,B=b>w?1:b/w,H=b>w?w/b:1;r.save(),r.translate(A.x,A.y),r.rotate(x),r.scale(B,H),r.arc(0,0,N,M,M+R,!S),r.scale(1/B,1/H),r.rotate(-x),r.translate(-A.x,-A.y),r.restore()}break;case"Z":case"z":r.closePath(),p=s,u=a}s=p,a=u}}},t.prototype.drawText=function(e,i){if(i.content&&!0===i.visible){var n=t.getContext(e);n.save(),this.setStyle(e,i);var o=i.x+i.width*i.pivotX,r=i.y+i.height*i.pivotY;this.rotateContext(e,i.angle,o,r),this.setFontStyle(e,i);var s=0,a=[];a=i.childNodes;var l=i.wrapBounds;if(n.fillStyle=i.color,l){var h=this.labelAlign(i,l,a);for(s=0;s<a.length;s++){var c=a[s],d=h.x+c.x-l.x,p=h.y+c.dy*s+.8*i.fontSize;if(l.width>i.width&&"Wrap"!==i.textOverflow&&(c.text=is(c.text,i)),n.fillText(c.text,d,p),"Underline"===i.textDecoration||"Overline"===i.textDecoration||"LineThrough"===i.textDecoration){var u=d,g=void 0,m=d+n.measureText(c.text).width,f=void 0;switch(i.textDecoration){case"Underline":g=p+2,f=p+2;break;case"Overline":g=h.y+c.dy*s,f=h.y+c.dy*s;break;case"LineThrough":g=(p+h.y+c.dy*s)/2+2,f=(p+h.y+c.dy*s)/2+2}n.beginPath(),n.moveTo(u,g),n.lineTo(m,f),n.strokeStyle=i.color,n.lineWidth=.08*i.fontSize,n.globalAlpha=i.opacity,n.stroke()}}}n.restore()}},t.prototype.drawImage=function(e,i){var n=this;if(i.visible){var o=t.getContext(e);o.save();i.x,i.width,i.pivotX,i.y,i.height,i.pivotY;var r=new Image;r.src=i.source,r.onload=function(){o.rotate(i.angle*Math.PI/180);var t=new Image;t.src=i.source,n.image(o,t,i.x,i.y,i.width,i.height,i),o.rotate(-i.angle*Math.PI/180)},o.restore()}},t.prototype.image=function(t,e,i,n,o,r,s){t.beginPath();var a=e.width,l=e.height,h=o,c=r,d=0,p=0;if(s&&"None"!==s.alignment){var u=s.alignment.toLowerCase().substr(1,3),g=s.alignment.toLowerCase().substr(5,3);if("Slice"===s.scale){var m=function(){d=h,p=l*h/a},f=function(){d=a*c/l,p=c};h>c?(m(),c>p&&f()):h===c?a>l?f():m():(f(),h>d&&m());var v=this.getSliceOffset(u,d,h,a),y=this.getSliceOffset(g,p,c,l),b=a-v,w=l-y,x=d-v*(d/a),C=p-y*(p/l),S=document.createElement("canvas");S.setAttribute("width",o.toString()),S.setAttribute("height",r.toString()),S.getContext("2d").drawImage(e,v,y,b,w,0,0,x,C),t.drawImage(S,i,n,o,r)}else if("Meet"===s.scale){var E=l/a,P=c/h;d=P>E?h:c/E,p=P>E?h*E:c,i+=this.getMeetOffset(u,d,h),n+=this.getMeetOffset(g,p,c),t.drawImage(e,0,0,a,l,i,n,d,p)}else t.drawImage(e,i,n,o,r)}else t.drawImage(e,i,n,o,r);t.closePath()},t.prototype.getSliceOffset=function(t,e,i,n){switch(t){case"min":return 0;case"mid":return(e-i)/2*n/e;case"max":return(e-i)*n/e;default:return 0}},t.prototype.getMeetOffset=function(t,e,i){var n=Math.max(e,i),o=Math.min(e,i);switch(t){case"min":return 0;case"mid":return(n-o)/2;case"max":return n-o;default:return 0}},t.prototype.m=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},t.prototype.r=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(this.m(t)*this.m(e))},t.prototype.a=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(this.r(t,e))},t.prototype.labelAlign=function(t,e,i){var n=new Al(e.width,i.length*t.fontSize),o={x:0,y:0},r=t.x,s=t.y,a=.5*t.width,l=.5*t.height;return"left"===t.textAlign?a=0:"center"===t.textAlign?a=e.width>t.width&&("Ellipsis"===t.textOverflow||"Clip"===t.textOverflow)?0:.5*t.width:"right"===t.textAlign&&(a=1*t.width),o.x=r+a+(e?e.x:0),o.y=s+l-n.height/2,o},t}(),Cd=function(){function t(){}return t.prototype.renderShadow=function(t,e,i,n){void 0===i&&(i=null);var o,r,s={x:0,y:0},a=Dl.transform(s,t.shadow.angle,t.shadow.distance),l=t.x+a.x,h=t.y+a.y;t.width,t.pivotX,t.height,t.pivotY;n&&(r=n.getElementById(e.id+"_shadow")),r||(o=i?"path":"rect",r=document.createElementNS("http://www.w3.org/2000/svg",o),e.appendChild(r));var c={id:e.id+"_shadow",fill:t.shadow.color,stroke:t.shadow.color,opacity:t.shadow.opacity.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+(t.x+a.x)+","+(t.y+a.y)+")"};if(n){var d=n.getElementById(e.id);d&&d.insertBefore(r,d.firstChild)}_r(r,c),i?i&&this.renderPath(r,t,i):_r(r,{width:t.width,height:t.height})},t.prototype.parseDashArray=function(t){return[]},t.prototype.drawRectangle=function(t,e,i,n,o,r,s){e.shadow&&!n&&this.renderShadow(e,t,void 0,r);var a;a=e.id===t.id?e.id+"_container":e.id;var l;r&&(l=r.getElementById(a)),l&&!o||(l=document.createElementNS("http://www.w3.org/2000/svg","rect"),t.appendChild(l));var h;r&&!e.shadow&&(h=r.getElementById(e.id+"_groupElement_shadow"))&&h.parentNode.removeChild(h);var c={id:a,x:e.x.toString(),y:e.y.toString(),width:e.width.toString(),height:e.height.toString(),visibility:e.visible?"visible":"hidden",transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")",rx:e.cornerRadius||0,ry:e.cornerRadius||0,opacity:e.opacity,"aria-label":s||""};e.class&&(c.class=e.class);s||(c["pointer-events"]="none"),_r(l,c),this.setSvgStyle(l,e,i)},t.prototype.updateSelectionRegion=function(t,e){var i;i=t.parentNode.getElementById(e.id);var n;n={id:e.id,x:e.x.toString(),y:e.y.toString(),width:e.width.toString(),height:e.height.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")",class:"e-diagram-selected-region"},i||(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),t.appendChild(i)),this.setSvgStyle(i,e),_r(i,n)},t.prototype.createGElement=function(t,e){return Nr(t,e)},t.prototype.drawLine=function(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","line");this.setSvgStyle(i,e);var n=e.x+e.width*e.pivotX,o=e.y+e.height*e.pivotY,r={id:e.id,x1:e.startPoint.x+e.x,y1:e.startPoint.y+e.y,x2:e.endPoint.x+e.x,y2:e.endPoint.y+e.y,stroke:e.stroke,"stroke-width":e.strokeWidth.toString(),opacity:e.opacity.toString(),transform:"rotate("+e.angle+" "+n+" "+o+")",visibility:e.visible?"visible":"hidden"};e.class&&(r.class=e.class),_r(i,r),t.appendChild(i)},t.prototype.drawCircle=function(t,e,i,n){var o=document.createElementNS("http://www.w3.org/2000/svg","circle");this.setSvgStyle(o,e);var r=e.class||"";i||(r+=" e-disabled");var s={id:e.id,cx:e.centerX,cy:e.centerY,r:e.radius,visibility:e.visible?"visible":"hidden",class:r,"aria-label":n?n["aria-label"]:""};o.style.display=e.visible?"block":"none",_r(o,s),t.appendChild(o)},t.prototype.drawPath=function(t,e,i,n,o,r){var s=Math.floor(10*Math.random()+1);t.id,s.toString();var a=[];a=vt(a=ut(e.data)),e.shadow&&this.renderShadow(e,t,a,o);var l;o&&!e.shadow&&(l=o.getElementById(e.id+"_groupElement_shadow"))&&l.parentNode.removeChild(l);var h;o&&(h=o.getElementById(e.id)),h&&!n||(h=document.createElementNS("http://www.w3.org/2000/svg","path"),t.appendChild(h)),this.renderPath(h,e,a);var c={id:e.id,transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")translate("+e.x+","+e.y+")",visibility:e.visible?"visible":"hidden",opacity:e.opacity,"aria-label":r||""};e.class&&(c.class=e.class),_r(h,c),this.setSvgStyle(h,e,i)},t.prototype.renderPath=function(t,e,i){var n,o,r,s,a,l,h,c,d=i,p="";for(a=0,l=0,c=0,h=d.length;c<h;++c){var u=d[c],g=u.command;switch("x1"in u&&(n=u.x1),"x2"in u&&(r=u.x2),"y1"in u&&(o=u.y1),"y2"in u&&(s=u.y2),"x"in u&&(a=u.x),"y"in u&&(l=u.y),g){case"M":p=p+"M"+a.toString()+","+l.toString()+" ";break;case"L":p=p+"L"+a.toString()+","+l.toString()+" ";break;case"C":p=p+"C"+n.toString()+","+o.toString()+","+r.toString()+","+s.toString()+",",p+=a.toString()+","+l.toString()+" ";break;case"Q":p=p+"Q"+n.toString()+","+o.toString()+","+a.toString()+","+l.toString()+" ";break;case"A":p=p+"A"+u.r1.toString()+","+u.r2.toString()+","+u.angle.toString()+",",p+=u.largeArc.toString()+","+u.sweep+","+a.toString()+","+l.toString()+" ";break;case"Z":case"z":p+="Z "}}t.setAttribute("d",p)},t.prototype.setSvgFontStyle=function(t,e){t.style.fontStyle=e.italic?"italic":"normal",t.style.fontWeight=e.bold?"bold":"normal",t.style.fontSize=e.fontSize.toString()+"px",t.style.fontFamily=e.fontFamily},t.prototype.drawText=function(t,e,i,n,o){if(void 0!==e.content){var r=void 0,s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,d=0,p=0,u=0,g=void 0;if(i&&(g=i.getElementById(e.id+"_text")),g){if(e.doWrap)for(;g.firstChild;)g.removeChild(g.firstChild)}else e.doWrap=!0,g=document.createElementNS("http://www.w3.org/2000/svg","text"),"pre-wrap"===e.whiteSpace&&g.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.appendChild(g);var m=e.x+e.width*e.pivotX,f=e.y+e.height*e.pivotY;if(e.doWrap)for(this.setSvgStyle(g,e,o),this.setSvgFontStyle(g,e),r=document.createTextNode(e.content),s=e.childNodes,a=e.wrapBounds,l=this.svgLabelAlign(e,a,s),a.width>e.width&&"Wrap"!==e.textOverflow&&(s[0].text=is(e.content,e)),u=0;u<s.length;u++)c=document.createElementNS("http://www.w3.org/2000/svg","tspan"),r=document.createTextNode(s[u].text),h=s[u],d=l.x+h.x-a.x,p=l.y+h.dy*u+.8*e.fontSize,_r(c,{x:d.toString(),y:p.toString()}),g.setAttribute("fill",h.text),c.appendChild(r),g.appendChild(c);e.textDecoration&&"LineThrough"===e.textDecoration&&(e.textDecoration=$r(e.textDecoration)),_r(g,{id:e.id+"_text",fill:e.color,visibility:e.visible?"visible":"hidden","text-decoration":e.textDecoration,transform:"rotate("+e.angle+","+m+","+f+")translate("+e.x+","+e.y+")",opacity:e.opacity,"aria-label":n||""})}},t.prototype.drawImage=function(t,e,i){var n;e.id;i&&(n=i.getElementById(e.id+"image")),n||(n=document.createElementNS("http://www.w3.org/2000/svg","image"),t.appendChild(n));var o=new Image;o.src=e.source;var r="None"!==e.scale?e.scale:"",s=e.alignment,a=s.charAt(0).toLowerCase()+s.slice(1);r&&(a+=" "+r.charAt(0).toLowerCase()+r.slice(1)),_r(n,{id:e.id+"image",x:e.x.toString(),y:e.y.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")",width:e.width.toString(),visibility:e.visible?"visible":"hidden",height:e.height.toString(),preserveAspectRatio:a}),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o.src.toString())},t.prototype.drawHTMLContent=function(t,e,i){var n;if(e){var o=void 0;for(o=0;o<e.childNodes.length;o++)e.childNodes[o].id===t.id+"_html_element"&&(n=e.childNodes[o])}n||((n=Rr("div",{id:t.id+"_html_element",class:"foreign-object"})).appendChild(t.template.cloneNode(!0)),e.appendChild(n)),n.setAttribute("style","height:"+t.actualSize.height+"px; width:"+t.actualSize.width+"px;left:"+t.corners.x+"px; top:"+t.corners.y+"px;position:absolute;transform:rotate("+t.parentTransform+"deg);pointer-events:all;visibility:"+(t.visible?"visible":"hidden")+";")},t.prototype.drawNativeContent=function(t,e,i,n,o){var r,s;o&&(r=o.getElementById(t.id+"_native_element"),s=o.getElementById(t.id+"_clip")),r||((r=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id",t.id+"_native_element"),r.appendChild(t.template.cloneNode(!0)),e.appendChild(r)),s&&r.removeChild(s),r.setAttribute("style","visibility:"+(t.visible?"visible":"hidden")+";"),this.setNativTransform(t,r,i,n),"Slice"===t.scale&&this.drawClipPath(t,r,i,n,o),_r(r,t.description?{"aria-label":t.description}:{})},t.prototype.setNativTransform=function(t,e,i,n){var o=0!==t.contentSize.width?t.contentSize.width:1,r=0!==t.contentSize.height?t.contentSize.height:1,s=t.templatePosition.x*n/o,a=t.templatePosition.y*i/r;e.setAttribute("transform","rotate("+t.parentTransform+","+t.offsetX+","+t.offsetY+") translate("+(t.offsetX-s-n*t.pivot.x)+","+(t.offsetY-a-i*t.pivot.y)+") scale("+n/o+","+i/r+")")},t.prototype.drawClipPath=function(t,e,i,n,o){var r=t.contentSize.width,s=t.contentSize.height,a=(t.actualSize.width,t.actualSize.height,t.width/(n/r)),l=t.height/(i/s),h=t.templatePosition.x+(t.width>=t.height?0:(r-a)/2),c=t.templatePosition.y+(t.height>=t.width?0:(s-l)/2),d=o.getElementById(t.id+"_clip");(d=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id",t.id+"_clip"),e.appendChild(d);var p=o.getElementById(t.id+"_clip_rect");return p=document.createElementNS("http://www.w3.org/2000/svg","rect"),d.appendChild(p),_r(p,{id:t.id+"_clip_rect",width:a.toString(),height:l.toString(),x:h.toString(),y:c.toString()}),e.setAttribute("clip-path","url(#"+t.id+"_clip)"),e},t.prototype.renderGradient=function(t,e,i){var n,o,r,s=Lr(i),a=s.getElementById(i+"gradient_pattern");a||(a=Nr("defs",{id:i+"gradient_pattern"}),s.insertBefore(a,s.firstChild));var l,h;if("None"!==t.gradient.type){for(c=0;c<t.gradient.stops.length;c++)n=n?Math.max(n,t.gradient.stops[c].offset):t.gradient.stops[c].offset,o=o?Math.min(o,t.gradient.stops[c].offset):t.gradient.stops[c].offset;"Linear"===t.gradient.type?((h=t.gradient).id=e.id+"_linear",(r=s.getElementById(e.id+"_linear"))&&r.parentNode.removeChild(r),r=this.createLinearGradient(h),a.appendChild(r)):((l=t.gradient).id=e.id+"_radial",r=s.getElementById(e.id+"_radial"),(r=s.getElementById(e.id+"_linear"))&&r.parentNode.removeChild(r),r=this.createRadialGradient(l),a.appendChild(r));for(var c=0;c<t.gradient.stops.length;c++){var d=t.gradient.stops[c],p=o<0?(n+d.offset)/(2*n):d.offset/n,u=document.createElementNS("http://www.w3.org/2000/svg","stop");_r(u,{offset:p.toString(),style:"stop-color:"+d.color}),r.appendChild(u)}}return r},t.prototype.createLinearGradient=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");return _r(e,{id:t.id,x1:t.x1+"%",y1:t.y1+"%",x2:t.x2+"%",y2:t.y2+"%"}),e},t.prototype.createRadialGradient=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","radialGradient");return _r(e,{id:t.id,cx:t.cx+"%",cy:t.cy+"%",r:t.r+"%",fx:t.fx+"%",fy:t.fy+"%"}),e},t.prototype.setSvgStyle=function(t,e,i){"none"===e.fill&&(e.fill="transparent"),"none"===e.stroke&&(e.stroke="transparent");var n,o=[];void 0!==e.dashArray&&(o=(new xd).parseDashArray(e.dashArray)),n=e.gradient&&"None"!==e.gradient.type?"url(#"+this.renderGradient(e,t,i).id+")":e.fill,e.stroke&&t.setAttribute("stroke",e.stroke),void 0!==e.strokeWidth&&t.setAttribute("stroke-width",e.strokeWidth.toString()),o&&t.setAttribute("stroke-dasharray",o.toString()),n&&t.setAttribute("fill",n)},t.prototype.svgLabelAlign=function(t,e,i){var n=new Al(e.width,i.length*t.fontSize),o={x:0,y:0},r=.5*t.width,s=.5*t.height;return"left"===t.textAlign?r=0:"center"===t.textAlign?r=e.width>t.width&&("Ellipsis"===t.textOverflow||"Clip"===t.textOverflow)?0:.5*t.width:"right"===t.textAlign&&(r=1*t.width),o.x=0+r+(e?e.x:0),o.y=0+s-n.height/2,o},t}(),Sd=function(){function e(t,e,i){this.renderer=null,this.isSvgMode=!0,this.diagramId=t,this.element=yr(this.diagramId),this.svgRenderer=e,this.isSvgMode=i,this.renderer=i?new Cd:new xd}return e.prototype.setCursor=function(t,e){t.style.cursor=e},e.prototype.setLayers=function(){this.iconSvgLayer=this.element.getElementsByClassName("e-ports-expand-layer")[0],this.adornerSvgLayer=this.element.getElementsByClassName("e-adorner-layer")[0],this.nativeSvgLayer=this.element.getElementsByClassName("e-native-layer")[0],this.diagramSvgLayer=this.element.getElementsByClassName("e-diagram-layer")[0]},e.prototype.getAdornerLayer=function(){return xr(this.diagramId)},e.prototype.getParentSvg=function(t,e,i){return this.diagramId&&t&&t.id?t.id.split("_icon_content").length>1||t.id.split("_nodeport").length>1?this.iconSvgLayer:e&&"selector"===e?this.adornerSvgLayer:t instanceof lh?this.nativeSvgLayer:this.diagramSvgLayer:i},e.prototype.getParentElement=function(t,e,i){var n=e;if(i&&this.diagramId&&t&&t.id){t.id.split("_icon_content").length>1?(n=i.getElementById(this.diagramId+"_diagramExpander"),e=null):t.id.split("_nodeport").length>1?n=i.getElementById(this.diagramId+"_diagramPorts"):t instanceof lh?(n=i.getElementById(this.diagramId+"_nativeLayer"),e=null):n=i.getElementById(this.diagramId+"_diagramLayer");var o=this.getGroupElement(t,e||n);n=o.g,o.svg&&(i=o.svg)}return{g:n,svg:i}},e.prototype.getGroupElement=function(t,e){var i,n,o=this.getParentSvg(t);if(e&&o){if(o&&!(i=o.getElementById(t.id+"_groupElement"))&&o!==this.nativeSvgLayer){var r=this.nativeSvgLayer;i=r.getElementById(t.id+"_groupElement"),n=r}i||(i=this.svgRenderer.createGElement("g",{id:t.id+"_groupElement"}),e.appendChild(i))}return{g:i,svg:n}},e.prototype.renderElement=function(t,e,i,n,o,r){t instanceof oh?this.renderContainer(t,e,i,n,o,r):t instanceof ph?this.renderImageElement(t,e,n,o):t instanceof sh?this.renderPathElement(t,e,n,o):t instanceof ch?this.renderTextElement(t,e,n,o):t instanceof lh?this.renderNativeElement(t,e,n,o):t instanceof Gc?this.renderHTMLElement(t,e,i,n,o):this.renderRect(t,e,n,o)},e.prototype.drawSelectionRectangle=function(t,e,i,n,o,r){t=(t+r.tx)*r.scale,e=(e+r.ty)*r.scale;var s={width:i*r.scale,height:n*r.scale,x:t+.5,y:e+.5,fill:"transparent",stroke:"gray",angle:0,pivotX:.5,pivotY:.5,strokeWidth:1,dashArray:"6 3",opacity:1,visible:!0,id:o.id+"_selected_region"},a=this.getAdornerLayer();this.svgRenderer.updateSelectionRegion(a,s)},e.prototype.renderHighlighter=function(t,e,i){var n=t.actualSize.width||2,o=t.actualSize.height||2,r=t.offsetX-n*t.pivot.x,s=t.offsetY-o*t.pivot.y;r=(r+i.tx)*i.scale,s=(s+i.ty)*i.scale;var a={width:n*i.scale,height:o*i.scale,x:r,y:s,fill:"transparent",stroke:"#8CC63F",angle:t.rotateAngle,pivotX:t.pivot.x,pivotY:t.pivot.y,strokeWidth:4,dashArray:"",opacity:1,cornerRadius:0,visible:!0,id:e.id+"_highlighter",class:"e-diagram-highlighter"};this.svgRenderer.drawRectangle(e,a,this.diagramId)},e.prototype.drawLine=function(t,e){this.svgRenderer.drawLine(t,e)},e.prototype.drawPath=function(t,e){this.svgRenderer.drawPath(t,e,this.diagramId)},e.prototype.renderResizeHandle=function(e,i,n,o,r,s,a,l){var h=e.offsetX-e.actualSize.width*e.pivot.x,c=e.offsetY-e.actualSize.height*e.pivot.y,d=e.actualSize.height,p=e.actualSize.width;n&t.ThumbsConstraints.Rotate&&(this.renderPivotLine(e,i,s,r,a),this.renderRotateThumb(e,i,s,r,a)),this.renderBorder(e,i,s,l);var u=e.actualSize.width*o,g=e.actualSize.height*o;u>=40&&g>=40&&(r&t.SelectorConstraints.ResizeNorthWest&&this.renderCircularHandle("resizeNorthWest",e,h,c,i,Go(r,"ResizeNorthWest"),n&t.ThumbsConstraints.ResizeNorthWest,s,void 0,a,{"aria-label":"Thumb to resize the selected object on top left side direction"},void 0,"e-diagram-resize-handle e-northwest"),r&t.SelectorConstraints.ResizeNorthEast&&this.renderCircularHandle("resizeNorthEast",e,h+p,c,i,Go(r,"ResizeNorthEast"),n&t.ThumbsConstraints.ResizeNorthEast,s,void 0,a,{"aria-label":"Thumb to resize the selected object on top right side direction"},void 0,"e-diagram-resize-handle e-northeast"),r&t.SelectorConstraints.ResizeSouthWest&&this.renderCircularHandle("resizeSouthWest",e,h,c+d,i,Go(r,"ResizeSouthWest"),n&t.ThumbsConstraints.ResizeSouthWest,s,void 0,a,{"aria-label":"Thumb to resize the selected object on bottom left side direction"},void 0,"e-diagram-resize-handle e-southwest"),r&t.SelectorConstraints.ResizeSouthEast&&this.renderCircularHandle("resizeSouthEast",e,h+p,c+d,i,Go(r,"ResizeSouthEast"),n&t.ThumbsConstraints.ResizeSouthEast,s,void 0,a,{"aria-label":"Thumb to resize the selected object on bottom right side direction"},void 0,"e-diagram-resize-handle e-southeast")),r&t.SelectorConstraints.ResizeNorth&&this.renderCircularHandle("resizeNorth",e,h+p/2,c,i,Go(r,"ResizeNorth"),n&t.ThumbsConstraints.ResizeNorth,s,void 0,a,{"aria-label":"Thumb to resize the selected object on top side direction"},void 0,"e-diagram-resize-handle e-north"),r&t.SelectorConstraints.ResizeSouth&&this.renderCircularHandle("resizeSouth",e,h+p/2,c+d,i,Go(r,"ResizeSouth"),n&t.ThumbsConstraints.ResizeSouth,s,void 0,a,{"aria-label":"Thumb to resize the selected object on bottom side direction"},void 0,"e-diagram-resize-handle e-south"),r&t.SelectorConstraints.ResizeWest&&this.renderCircularHandle("resizeWest",e,h,c+d/2,i,Go(r,"ResizeWest"),n&t.ThumbsConstraints.ResizeWest,s,void 0,a,{"aria-label":"Thumb to resize the selected object on left side direction"},void 0,"e-diagram-resize-handle e-west"),r&t.SelectorConstraints.ResizeEast&&this.renderCircularHandle("resizeEast",e,h+p,c+d/2,i,Go(r,"ResizeEast"),n&t.ThumbsConstraints.ResizeEast,s,void 0,a,{"aria-label":"Thumb to resize the selected object on right side direction"},void 0,"e-diagram-resize-handle e-east")},e.prototype.renderEndPointHandle=function(e,i,n,o,r,s,a,l){var h,c,d=e.sourcePoint,p=e.targetPoint,u=e.wrapper;if(this.renderCircularHandle("connectorSourceThumb",u,d.x,d.y,i,Go(o,"ConnectorSourceThumb"),n&t.ThumbsConstraints.ConnectorSource,r,s,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),this.renderCircularHandle("connectorTargetThumb",u,p.x,p.y,i,Go(o,"ConnectorTargetThumb"),n&t.ThumbsConstraints.ConnectorTarget,r,a,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend"),l)if(("Straight"===e.type||"Bezier"===e.type)&&e.segments.length>0)for(h=0;h<e.segments.length-1;h++)c=e.segments[h],this.renderCircularHandle("segementThumb_"+(h+1),u,c.point.x,c.point.y,i,!0,n&t.ThumbsConstraints.ConnectorSource,r,s,null,null,h);else for(h=0;h<e.segments.length;h++){var g=e.segments[h];this.renderOrthogonalThumbs("orthoThumb_"+(h+1),u,g,i,Go(o,"ConnectorSourceThumb"),r)}if("Bezier"===e.type)for(h=0;h<e.segments.length;h++){var m=e.segments[h],f=Dl.isEmptyPoint(m.point1)?m.bezierPoint1:m.point1;this.renderCircularHandle("bezierPoint_"+(h+1)+"_1",u,f.x,f.y,i,Go(o,"ConnectorSourceThumb"),n&t.ThumbsConstraints.ConnectorSource,r,void 0,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-bezier-handle e-source"),Go(o,"ConnectorSourceThumb")&&this.renderBezierLine("bezierLine_"+(h+1)+"_1",u,i,m.points[0],Dl.isEmptyPoint(m.point1)?m.bezierPoint1:m.point1,r),f=Dl.isEmptyPoint(m.point2)?m.bezierPoint2:m.point2,this.renderCircularHandle("bezierPoint_"+(h+1)+"_2",u,f.x,f.y,i,Go(o,"ConnectorTargetThumb"),n&t.ThumbsConstraints.ConnectorTarget,r,void 0,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-bezier-handle e-target"),Go(o,"ConnectorTargetThumb")&&this.renderBezierLine("bezierLine_"+(h+1)+"_2",u,i,m.points[1],Dl.isEmptyPoint(m.point2)?m.bezierPoint2:m.point2,r)}},e.prototype.renderOrthogonalThumbs=function(t,e,i,n,o,r){var s,a,l,h=0;for(h=0;h<i.points.length-1;h++)l=Dl.distancePoints(i.points[h],i.points[h+1]),s=i.points[h].y.toFixed(2)===i.points[h+1].y.toFixed(2)?"horizontal":"vertical",a=l>=50,this.renderOrthogonalThumb(t+"_"+(h+1),e,(i.points[h].x+i.points[h+1].x)/2,(i.points[h].y+i.points[h+1].y)/2,n,a,s,r)},e.prototype.renderOrthogonalThumb=function(t,e,i,n,o,r,s,a){var l,h,c;"horizontal"===s?(l="M0,7 L15,0 L30,7 L15,14 z",h=-15,c=-7):(l="M7,0 L0,15 L7,30 L14,15 z",h=-7,c=-15);var d={x:(i+a.tx)*a.scale+h,y:(n+a.ty)*a.scale+c,angle:0,fill:"#e2e2e2",stroke:"black",strokeWidth:1,dashArray:"",data:l,width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:r,id:t};this.svgRenderer.drawPath(o,d,this.diagramId)},e.prototype.renderPivotLine=function(e,i,n,o,r){var s=e,a=!!(o&t.SelectorConstraints.Rotate);r&&(a=!1);var l=this.getBaseAttributes(s,n);l.fill="None",l.stroke="black",l.strokeWidth=1,l.dashArray="2,3",l.visible=a;var h=n.scale;l.x*=h,l.y*=h,l.width*=h,l.height*=h,l.id="pivotLine",l.class="e-diagram-pivot-line";var c={x:s.actualSize.width*s.pivot.x*h,y:-20},d={x:s.actualSize.width*s.pivot.x*h,y:0};l.startPoint=c,l.endPoint=d,this.svgRenderer.drawLine(i,l)},e.prototype.renderBezierLine=function(t,e,i,n,o,r){var s=this.getBaseAttributes(e,r);s.id=t,s.stroke="black",s.strokeWidth=1,s.dashArray="3,3",s.fill="None",s.class="e-diagram-bezier-line",s.x=0,s.y=0;var a=r.scale,l={x:(n.x+r.tx)*a,y:(n.y+r.ty)*a},h={x:(o.x+r.tx)*a,y:(o.y+r.ty)*a};s.startPoint=l,s.endPoint=h,this.svgRenderer.drawLine(i,s)},e.prototype.renderCircularHandle=function(t,e,i,n,o,r,s,a,l,h,c,d,p){var u=e,g=7,m={x:i,y:n};if(0!==u.rotateAngle||0!==u.parentTransform){var f=Et();Tt(f,u.rotateAngle+u.parentTransform,u.offsetX,u.offsetY),m=Pt(f,m)}var v=this.getBaseAttributes(u);v.stroke="black",v.strokeWidth=1,void 0!==d?(g=5,v.id="segmentEnd_"+d,v.fill="#e2e2e2"):(g=7,v.fill=l?"#8CC63F":"white"),v.centerX=(m.x+a.tx)*a.scale,v.centerY=(m.y+a.ty)*a.scale,v.radius=g,v.angle=0,v.id=t,v.visible=r,v.class=p,l&&(v.class+=" e-connected"),h&&(v.visible=!1),this.svgRenderer.drawCircle(o,v,s,c)},e.prototype.renderBorder=function(t,e,i,n){var o=t,r=this.getBaseAttributes(o,i);r.x*=i.scale,r.y*=i.scale,r.width*=i.scale,r.height*=i.scale,r.fill="transparent",r.stroke="#097F7F",r.strokeWidth=.6,r.dashArray="6,3",r.class="e-diagram-border",r.id="borderRect",n||(r.class+=" e-disabled"),r.cornerRadius=0;var s=this.getParentSvg(t,"selector");this.svgRenderer.drawRectangle(e,r,this.diagramId,void 0,!0,s)},e.prototype.renderUserHandler=function(e,i,n){for(var o=e.wrapper,r=0,s=e.userHandles;r<s.length;r++){var a=s[r],l=(new sh,void 0),h=a.pathData;(l=Xo(e,a,n)).x=(l.x+n.tx)*n.scale,l.y=(l.y+n.ty)*n.scale,a.visible&&(a.visible=!!(e.constraints&t.SelectorConstraints.UserHandle));var c=this.getBaseAttributes(o);c.id=a.name+"_userhandle",c.fill=a.backgroundColor,c.stroke=a.borderColor,c.strokeWidth=a.borderWidth,c.centerX=l.x,c.centerY=l.y,c.radius=.5*a.size,c.class="e-diagram-userhandle-circle",c.angle=0,c.visible=a.visible,c.opacity=1,this.svgRenderer.drawCircle(i,c,1,{"aria-label":a.name+"user handle"});var d=[];d=xt(d=ut(h));var p=sr(h),u=yt(d,(a.size-.45*a.size)/p.width,(a.size-.45*a.size)/p.height,!0,p.x,p.y,0,0);p=sr(u);var g={x:l.x-p.width/2,y:l.y-p.height/2,angle:0,id:"",class:"e-diagram-userhandle-path",fill:a.pathColor,stroke:a.backgroundColor,strokeWidth:.5,dashArray:"",data:u,width:a.size-5,height:a.size-5,pivotX:0,pivotY:0,opacity:1,visible:a.visible};this.svgRenderer.drawPath(i,g,this.diagramId,void 0,void 0,{"aria-label":a.name+"user handle"})}},e.prototype.renderRotateThumb=function(e,i,n,o,r){new sh;var s,a=new Al;a.width=18,a.height=16;var l=e.offsetY-e.actualSize.height*e.pivot.y,h=e.offsetX-e.actualSize.width*e.pivot.x,c=!!(o&t.SelectorConstraints.Rotate);r&&(c=!1);var d=h+e.pivot.x*e.actualSize.width,p=l;if(d=(d+n.tx)*n.scale,p=(p+n.ty)*n.scale,s={x:d-.5*a.width,y:p-30-.5*a.height},0!==e.rotateAngle||0!==e.parentTransform){var u=Et();Tt(u,e.rotateAngle+e.parentTransform,(n.tx+e.offsetX)*n.scale,(n.ty+e.offsetY)*n.scale),s=Pt(u,s)}var g={x:s.x,y:s.y,angle:e.rotateAngle,fill:"#231f20",stroke:"black",strokeWidth:.5,dashArray:"",data:"M 16.856144362449648 10.238890446662904 L 18.000144362449646 3.437890446662903L 15.811144362449646 4.254890446662903 C 14.837144362449646 2.5608904466629028 13.329144362449647  1.2598904466629026 11.485144362449645 0.5588904466629026 C 9.375144362449646 - 0.24510955333709716 7.071144362449646  - 0.18010955333709716 5.010144362449646 0.7438904466629028 C 2.942144362449646 1.6678904466629028 1.365144362449646 3.341890446662903 0.558144362449646 5.452890446662903 C - 0.244855637550354 7.567890446662903 - 0.17985563755035394 9.866890446662904 0.7431443624496461 11.930890446662904 C 1.6681443624496461 13.994890446662904 3.343144362449646 15.575890446662903 5.457144362449647 16.380890446662903 C 6.426144362449647 16.7518904466629 7.450144362449647 16.9348904466629 8.470144362449647 16.9348904466629 C 9.815144362449647 16.9348904466629 11.155144362449647 16.6178904466629 12.367144362449647 15.986890446662901 L 11.351144362449647 14.024890446662901 C 9.767144362449647 14.8468904466629 7.906144362449647 14.953890446662902 6.237144362449647 14.3178904466629 C 4.677144362449647 13.7218904466629 3.444144362449647 12.5558904466629 2.758144362449647 11.028890446662901 C 2.078144362449646 9.501890446662903 2.031144362449646 7.802890446662903 2.622144362449646 6.243890446662903 C 3.216144362449646 4.6798904466629025 4.387144362449646 3.442890446662903 5.914144362449646 2.760890446662903 C 7.437144362449646 2.078890446662903 9.137144362449646 2.0298904466629026 10.700144362449645 2.6258904466629027 C 11.946144362449646 3.100890446662903 12.971144362449646 3.9538904466629026 13.686144362449646 5.049890446662903 L 11.540144362449645 5.850890446662903 L 16.856144362449648 10.238890446662904 Z",width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:c,id:e.id,class:"e-diagram-rotate-handle"};g.id="rotateThumb",this.svgRenderer.drawPath(i,g,this.diagramId,!0,void 0,{"aria-label":"Thumb to rotate the selected object"})},e.prototype.renderPathElement=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.data=t.absolutePath,o.data=t.absolutePath;var r=t.description?t.description:t.id;this.renderer.drawPath(e,o,this.diagramId,void 0,n,r)},e.prototype.renderSvgGridlines=function(e,i,n,o,r,s){var a=document.createElementNS("http://www.w3.org/2000/svg","pattern"),l=document.createElementNS("http://www.w3.org/2000/svg","defs");l.setAttribute("id",this.diagramId+"_grid_pattern_defn"),(e.constraints&t.SnapConstraints.ShowHorizontalLines||e.constraints&t.SnapConstraints.ShowVerticalLines)&&a.setAttribute("id",this.diagramId+"_pattern");var h=0,c=0,d=0,p=0,u=1,g=!1;if(o.showRulers&&o.dynamicGrid&&r&&s)d=s.updateSegmentWidth(n.scale),p=r.updateSegmentWidth(n.scale),e.horizontalGridlines.scaledIntervals=[d/r.interval],e.verticalGridlines.scaledIntervals=[p/s.interval],g=!0;else{for(var m=0,f=e.verticalGridlines.lineIntervals;m<f.length;m++)h+=b=f[m];for(var v=0,y=e.horizontalGridlines.lineIntervals;v<y.length;v++){var b=y[v];c+=b}u=this.scaleSnapInterval(e,n.scale)}h=g?p:h*u,c=g?d:c*u,_r(a,{id:this.diagramId+"_pattern",x:0,y:0,width:h,height:c,patternUnits:"userSpaceOnUse"}),this.horizontalSvgGridlines(a,h,c,u,e,o,s,g),this.verticalSvgGridlines(a,h,c,u,e,o,r,g),l.appendChild(a),i.appendChild(l)},e.prototype.horizontalSvgGridlines=function(e,i,n,o,r,s,a,l){var h,c=0,d=[];if(r.constraints&t.SnapConstraints.ShowHorizontalLines){var p=r.horizontalGridlines.lineIntervals;r.horizontalGridlines.lineColor;r.horizontalGridlines.lineDashArray&&(d=this.renderer.parseDashArray(r.horizontalGridlines.lineDashArray)),s.showRulers&&s.dynamicGrid&&a&&(p=this.updateLineIntervals(p,s,a,n));for(var u=0;u<p.length;u+=2){h=document.createElementNS("http://www.w3.org/2000/svg","path");var g=c+p[u]/2;g=l?g:g*o,_r(h,{"stroke-width":p[u],stroke:r.horizontalGridlines.lineColor,d:"M0,"+g+" L"+i+","+g+" Z",dashArray:d.toString(),class:1.25===p[u]?"e-diagram-thick-grid":"e-diagram-thin-grid"}),e.appendChild(h),c+=p[u+1]+p[u]}}},e.prototype.verticalSvgGridlines=function(e,i,n,o,r,s,a,l){var h,c=0,d=[];if(r.constraints&t.SnapConstraints.ShowVerticalLines){var p=r.verticalGridlines.lineIntervals;r.verticalGridlines.lineColor;r.verticalGridlines.lineDashArray&&(d=this.renderer.parseDashArray(r.verticalGridlines.lineDashArray)),s.showRulers&&s.dynamicGrid&&a&&(p=this.updateLineIntervals(p,s,a,i));for(var u=0;u<p.length;u+=2){h=document.createElementNS("http://www.w3.org/2000/svg","path");var g=c+p[u]/2;g=l?g:g*o,_r(h,{"stroke-width":p[u],stroke:r.verticalGridlines.lineColor,d:"M"+g+",0 L"+g+","+n+" Z",dashArray:d.toString(),class:1.25===p[u]?"e-diagram-thick-grid":"e-diagram-thin-grid"}),e.appendChild(h),c+=p[u+1]+p[u]}}},e.prototype.updateGrid=function(t,e,i,n,o,r){var s,a=e.getElementById(this.diagramId+"_grid_rect"),l=!1;if(a){var h=e.getElementById(this.diagramId+"_pattern");h&&h.parentNode.removeChild(h);var c=0,d=0,p=1;n.showRulers&&n.dynamicGrid&&r&&o?(c=r.updateSegmentWidth(i.scale),d=o.updateSegmentWidth(i.scale),l=!0,t.horizontalGridlines.scaledIntervals=[c/o.interval],t.verticalGridlines.scaledIntervals=[d/r.interval]):p=this.scaleSnapInterval(t,i.scale);var u=0;for(s=0;s<t.horizontalGridlines.lineIntervals.length;s++)u+=t.horizontalGridlines.lineIntervals[s];var g=0;for(s=0;s<t.verticalGridlines.lineIntervals.length;s++)g+=t.verticalGridlines.lineIntervals[s];var m={x:-i.tx*i.scale,y:-i.ty*i.scale};_r(a,m),g=l?d:g*p,u=l?c:u*p,m={id:this.diagramId+"_pattern",x:0,y:0,width:g,height:u,patternUnits:"userSpaceOnUse"},_r(h=document.createElementNS("http://www.w3.org/2000/svg","pattern"),m),this.horizontalSvgGridlines(h,g,u,p,t,n,r,l),this.verticalSvgGridlines(h,g,u,p,t,n,o,l),e.getElementById(this.diagramId+"_grid_pattern_defn").appendChild(h)}},e.prototype.updateLineIntervals=function(t,e,i,n){for(var o=[],r=n/i.interval,s=0;s<2*i.interval;s++)o[s]=s%2==0?0===s?1.25:.25:r-o[s-1];return o},e.prototype.scaleSnapInterval=function(t,e){if(e>=2)for(;e>=2;)e/=2;else if(e<=.5)for(;e<=.5;)e*=2;var i;if(t.horizontalGridlines.scaledIntervals=t.horizontalGridlines.snapIntervals,t.verticalGridlines.scaledIntervals=t.verticalGridlines.snapIntervals,1!==e){var n=t.horizontalGridlines;for(n.scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*e;for((n=t.verticalGridlines).scaledIntervals=[],i=0;i<n.snapIntervals.length;i++)n.scaledIntervals[i]=n.snapIntervals[i]*e}return e},e.prototype.renderTextElement=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.cornerRadius=0,this.renderer.drawRectangle(e,o,this.diagramId,void 0,void 0,n),o.whiteSpace=ns(t.style.whiteSpace,t.style.textWrapping),o.content=t.content,o.breakWord=$r(t.style.textWrapping),o.textAlign=Jr(t.style.textAlign),o.color=t.style.color,o.italic=t.style.italic,o.bold=t.style.bold,o.fontSize=t.style.fontSize,o.fontFamily=t.style.fontFamily,o.textOverflow=t.style.textOverflow,o.textDecoration=t.style.textDecoration,o.doWrap=t.doWrap,o.wrapBounds=t.wrapBounds,o.childNodes=t.childNodes,o.dashArray="",o.strokeWidth=0,o.fill="";var r=t.description?t.description:t.content?t.content:t.id;this.renderer.drawText(e,o,n,r,this.diagramId),this.isSvgMode&&(t.doWrap=!1)},e.prototype.renderNativeElement=function(t,e,i,n){var o,r,s=this.getParentSvg(t,void 0,e)||n,a=this.getParentElement(t,e,s).g||e,l=this.getBaseAttributes(t,i);switch(l.fill="transparent",l.cornerRadius=t.cornerRadius,l.stroke="transparent",this.renderer.drawRectangle(e,l,this.diagramId,void 0,void 0,n),t.scale){case"None":o=t.contentSize.width,r=t.contentSize.height;break;case"Stretch":o=t.actualSize.width,r=t.actualSize.height;break;case"Meet":o=r=t.actualSize.width<=t.actualSize.height?t.actualSize.width:t.actualSize.height;break;case"Slice":o=r=t.actualSize.width>=t.actualSize.height?t.actualSize.width:t.actualSize.height}this.svgRenderer&&this.svgRenderer.drawNativeContent(t,a,r,o,s)},e.prototype.renderHTMLElement=function(t,e,i,n,o){var r=this.getBaseAttributes(t,n);r.fill="transparent",r.cornerRadius=t.cornerRadius,r.stroke="transparent",this.renderer.drawRectangle(e,r,this.diagramId,void 0,void 0,o),this.svgRenderer&&this.svgRenderer.drawHTMLContent(t,i.children[0],n)},e.prototype.renderImageElement=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.cornerRadius=0,this.renderer.drawRectangle(e,o,this.diagramId,void 0,void 0,n);var r,s,a,l;if("Stretch"===t.stretch)r=t.actualSize.width,s=t.actualSize.height;else{var h=t.contentSize.width,c=t.contentSize.height,d=o.width/h,p=o.height/c,u=void 0;switch(t.stretch){case"Meet":r=h*(u=Math.min(d,p)),s=c*u,o.x+=Math.abs(o.width-r)/2,o.y+=Math.abs(o.height-s)/2;break;case"Slice":d=o.width/h,p=o.height/c,r=h*(u=Math.max(d,p)),s=c*u,a=o.width/r*h,l=o.height/s*c;break;case"None":r=h,s=c}}o.width=r,o.height=s,o.sourceWidth=a,o.sourceHeight=l,o.source=t.source,o.alignment=t.imageAlign,o.scale=t.imageScale,o.description=t.description?t.description:t.id,this.renderer.drawImage(e,o,n)},e.prototype.renderContainer=function(t,e,i,n,o,r){var s={svg:o,g:e};if(this.diagramId&&(o=this.getParentSvg(t)||o,this.isSvgMode)){var a=void 0;a=this.getParentElement(t,e,o).g||e,o=this.getParentSvg(this.hasNativeParent(t.children))||o;var l=this.getParentElement(this.hasNativeParent(t.children),a,o);s.svg=l.svg||o,s.g=l.g||a,r?(o&&(o.getElementById(s.g.id)||e.appendChild(s.g)),e=s.g):e=s.g}if(this.renderRect(t,e,n,o),t.hasChildren())for(var h,c=void 0,d=0,p=t.children;d<p.length;d++){var u=p[d];o=this.getParentSvg(this.hasNativeParent(t.children)||u)||o,this.isSvgMode&&(c=(h=this.getParentElement(this.hasNativeParent(t.children)||u,e,o)).g||e,h.svg&&(o=h.svg)),this.renderElement(u,c||e,i,n,o,!0)}},e.prototype.hasNativeParent=function(t,e){if(t&&t.length>0){var i=t[0];if(i instanceof lh)return i;i.children&&i.children.length&&this.hasNativeParent(i.children,e++||0)}},e.prototype.renderRect=function(t,e,i,n){var o=this.getBaseAttributes(t,i);o.cornerRadius=t.cornerRadius||0;var r=t.description?t.description:t.id;this.renderer.drawRectangle(e,o,this.diagramId,void 0,void 0,n,r)},e.prototype.drawRect=function(t,e){e.cornerRadius=0,this.svgRenderer.drawRectangle(t,e,this.diagramId)},e.prototype.getBaseAttributes=function(t,e){var i={width:t.actualSize.width,height:t.actualSize.height,x:t.offsetX-t.actualSize.width*t.pivot.x+.5,y:t.offsetY-t.actualSize.height*t.pivot.y+.5,fill:t.style.fill,stroke:t.style.strokeColor,angle:t.rotateAngle+t.parentTransform,pivotX:t.pivot.x,pivotY:t.pivot.y,strokeWidth:t.style.strokeWidth,dashArray:t.style.strokeDashArray||"",opacity:t.style.opacity,shadow:t.shadow,gradient:t.style.gradient,visible:t.visible,id:t.id,description:t.description};return e&&(i.x+=e.tx,i.y+=e.ty),i},e.renderSvgBackGroundImage=function(t,e,i,n,o,r){document.getElementById(e.id);var s=Lr(e.id).getElementById(e.id+"_image");if(!s&&t.source){var a=Tr(e.id);(s=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("id",e.id+"_image"),a.appendChild(s)}if(s){s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.source);var l="None"!==t.scale?t.scale:"",h=t.align,c=h.charAt(0).toLowerCase()+h.slice(1)+" "+l.charAt(0).toLowerCase()+l.slice(1);document.getElementById(e.id);_r(s,{id:e.id+"_image",x:i,y:n,width:o,height:r,preserveAspectRatio:c})}},e.prototype.transformLayers=function(t,e){e&&Cr(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),Or(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+")"),Mr(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),Ar(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),Ir(this.diagramId).setAttribute("transform","translate("+t.tx*t.scale+","+t.ty*t.scale+"),scale("+t.scale+")"),Dr(this.diagramId).children[0].style.transform="translate("+t.tx*t.scale+"px,"+t.ty*t.scale+"px)scale("+t.scale+")"},e.prototype.updateNode=function(t,e,i,n){this.renderElement(t,e,i,n,this.getParentSvg(t))},e}(),Ed=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ed(e,t),Pd([Y("")],e.prototype,"source",void 0),Pd([Y("transparent")],e.prototype,"color",void 0),Pd([Y("None")],e.prototype,"scale",void 0),Pd([Y("None")],e.prototype,"align",void 0),e}(xa),Td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ed(e,t),Pd([Y(null)],e.prototype,"width",void 0),Pd([Y(null)],e.prototype,"height",void 0),Pd([G({},Gl)],e.prototype,"margin",void 0),Pd([Y("Landscape")],e.prototype,"orientation",void 0),Pd([Y("Infinity")],e.prototype,"boundaryConstraints",void 0),Pd([G({},Ld)],e.prototype,"background",void 0),Pd([Y(!1)],e.prototype,"multiplePage",void 0),Pd([Y(!1)],e.prototype,"showPageBreaks",void 0),e}(xa),kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ed(e,t),Pd([Y(0)],e.prototype,"horizontalOffset",void 0),Pd([Y(0)],e.prototype,"verticalOffset",void 0),Pd([Y(1)],e.prototype,"currentZoom",void 0),Pd([Y(0)],e.prototype,"viewPortWidth",void 0),Pd([Y(0)],e.prototype,"viewPortHeight",void 0),Pd([Y(.2)],e.prototype,"minZoom",void 0),Pd([Y(30)],e.prototype,"maxZoom",void 0),Pd([Y("Diagram")],e.prototype,"scrollLimit",void 0),Pd([Y()],e.prototype,"scrollableArea",void 0),Pd([Y(!1)],e.prototype,"canAutoScroll",void 0),Pd([G({left:15,right:15,top:15,bottom:15},Gl)],e.prototype,"autoScrollBorder",void 0),e}(xa),Od=function(){function t(){this.services={}}return t.prototype.register=function(t,e){this.services[t]=e},t.prototype.getService=function(t){return this.services[t]},t}(),Ad=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Md=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ad(e,t),Md([Y("lightgray")],e.prototype,"lineColor",void 0),Md([Y("")],e.prototype,"lineDashArray",void 0),Md([Y([1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75])],e.prototype,"lineIntervals",void 0),Md([Y([20])],e.prototype,"snapIntervals",void 0),e}(xa),Dd=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ad(i,e),Md([G({},Id)],i.prototype,"horizontalGridlines",void 0),Md([G({},Id)],i.prototype,"verticalGridlines",void 0),Md([Y(t.SnapConstraints.All)],i.prototype,"constraints",void 0),Md([Y(5)],i.prototype,"snapAngle",void 0),Md([Y(5)],i.prototype,"snapObjectDistance",void 0),i}(xa),Rd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Nd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Bd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Rd(e,t),Nd([Y(5)],e.prototype,"interval",void 0),Nd([Y(100)],e.prototype,"segmentWidth",void 0),Nd([Y("Horizontal")],e.prototype,"orientation",void 0),Nd([Y("RightOrBottom")],e.prototype,"tickAlignment",void 0),Nd([Y("red")],e.prototype,"markerColor",void 0),Nd([Y(25)],e.prototype,"thickness",void 0),Nd([Y(null)],e.prototype,"arrangeTick",void 0),e}(xa),Hd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Rd(e,t),Nd([Y(!1)],e.prototype,"showRulers",void 0),Nd([Y(!0)],e.prototype,"dynamicGrid",void 0),Nd([G({orientation:"Horizontal"},Bd)],e.prototype,"horizontalRuler",void 0),Nd([G({orientation:"Vertical"},Bd)],e.prototype,"verticalRuler",void 0),e}(xa),zd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jd=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Fd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zd(e,t),jd([Y("")],e.prototype,"id",void 0),jd([Y(null)],e.prototype,"dataManager",void 0),jd([Y("")],e.prototype,"root",void 0),jd([Y("")],e.prototype,"parentId",void 0),jd([Y()],e.prototype,"data",void 0),jd([Y()],e.prototype,"doBinding",void 0),e}(xa),Vd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),_d=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vd(e,t),_d([Y("")],e.prototype,"fixedNode",void 0),_d([Y(30)],e.prototype,"horizontalSpacing",void 0),_d([Y(30)],e.prototype,"verticalSpacing",void 0),_d([Y(30)],e.prototype,"maxIteration",void 0),_d([Y(40)],e.prototype,"springFactor",void 0),_d([Y(50)],e.prototype,"springLength",void 0),_d([G({left:50,top:50,right:0,bottom:0},Gl)],e.prototype,"margin",void 0),_d([Y("Auto")],e.prototype,"horizontalAlignment",void 0),_d([Y("Auto")],e.prototype,"verticalAlignment",void 0),_d([Y("TopToBottom")],e.prototype,"orientation",void 0),_d([Y("Auto")],e.prototype,"connectionDirection",void 0),_d([Y("Default")],e.prototype,"connectorSegments",void 0),_d([Y("None")],e.prototype,"type",void 0),_d([Y()],e.prototype,"getLayoutInfo",void 0),_d([Y()],e.prototype,"getBranch",void 0),_d([Y()],e.prototype,"bounds",void 0),_d([Y(!0)],e.prototype,"enableAnimation",void 0),_d([Y("")],e.prototype,"root",void 0),e}(xa),Ud={None:"default",Rotate:"crosshair",Select:"default",Drag:"move",ResizeWest:"w-resize",ResizeEast:"e-resize",ResizeSouth:"s-resize",ResizeNorth:"n-resize",Draw:"crosshair",PortDraw:"crosshair",ResizeNorthEast:"ne-resize",ResizeNorthWest:"nw-resize",ResizeSouthEast:"se-resize",ResizeSouthWest:"sw-resize",ConnectorSourceEnd:"move",ConnectorTargetEnd:"move",BezierSourceThumb:"move",BezierTargetThumb:"move",OrthoThumb:"move",SegmentEnd:"move",Pan:"pointer",Hyperlink:"pointer",PortDrag:"pointer"},qd=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xd=function(){function t(t,e){void 0===e&&(e=!1),this.commandHandler=null,this.inAction=!1,this.isProtectChange=!1,this.currentElement=null,this.blocked=!1,this.isTooltipVisible=!1,this.childTable={},this.undoElement={nodes:[],connectors:[]},this.undoParentElement={nodes:[],connectors:[]},this.commandHandler=t,this.isProtectChange=e}return t.prototype.startAction=function(t){this.currentElement=t,this.inAction=!0},t.prototype.mouseDown=function(t){this.currentElement=t.source,this.startPosition=this.currentPosition=this.prevPosition=t.position,this.isTooltipVisible=!0,this.startAction(t.source),this.commandHandler.startTransaction(this.isProtectChange)},t.prototype.mouseMove=function(t){return this.currentPosition=t.position,!this.blocked},t.prototype.mouseUp=function(t){this.currentPosition=t.position,this.isTooltipVisible=!1,this.commandHandler.endTransaction(this.isProtectChange),this.endAction()},t.prototype.endAction=function(){this.isTooltipVisible||this.commandHandler.closeTooltip(),this.commandHandler=null,this.currentElement=null,this.currentPosition=null,this.inAction=!1,this.blocked=!1},t.prototype.mouseWheel=function(t){this.currentPosition=t.position},t.prototype.mouseLeave=function(t){this.mouseUp(t)},t}(),Yd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qd(e,t),e.prototype.mouseDown=function(e){this.inAction=!0,t.prototype.mouseDown.call(this,e)},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.inAction&&!1===Dl.equals(this.currentPosition,this.prevPosition)){var i=Rl.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.drawSelectionRectangle(i.x,i.y,i.width,i.height)}return!this.blocked},e.prototype.mouseUp=function(e){if(!1===Dl.equals(this.currentPosition,this.prevPosition)&&this.inAction){var i=Rl.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.doRubberBandSelection(i)}else{var n=this.commandHandler.getSelectedObject();this.commandHandler.hasSelection()&&e.info&&e.info.ctrlKey?e&&e.source&&(this.commandHandler.isSelected(e.source)?1===e.clickCount&&this.commandHandler.unSelect(e.source):this.commandHandler.selectObjects([e.source],!0)):(this.commandHandler.clearSelection(null===e.source),e.source&&this.commandHandler.selectObjects([e.source],!1,n))}this.inAction=!1,t.prototype.mouseUp.call(this,e)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e}(Xd),Gd=function(e){function i(t,i){var n=e.call(this,t,!0)||this;return n.endPoint=i,n}return qd(i,e),i.prototype.mouseDown=function(t){this.inAction=!0,this.undoElement=void 0,this instanceof $d||(this.undoElement=Yr(t.source)),e.prototype.mouseDown.call(this,t);var i;if(t.source&&t.source.connectors&&({x:this.prevPosition.x,y:this.prevPosition.y},i=t.source.connectors[0]),"BezierSourceThumb"===this.endPoint||"BezierTargetThumb"===this.endPoint)for(var n=0;n<i.segments.length;n++){var o=i.segments[n],r=Dl.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,s=Dl.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2;(ps(this.currentPosition,r,i.hitPadding)||ps(this.currentPosition,s,i.hitPadding))&&(this.selectedSegment=o)}this.currentPosition=t.position},i.prototype.mouseUp=function(i){if(this.commandHandler.updateSelector(),this.commandHandler.removeSnap(),this instanceof $d||("ConnectorSourceEnd"!==this.endPoint||Dl.equals(i.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)&&i.source.connectors[0].sourceID===this.undoElement.connectors[0].sourceID)&&("ConnectorTargetEnd"!==this.endPoint||Dl.equals(i.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint)&&i.source.connectors[0].targetID===this.undoElement.connectors[0].targetID)){if(!(this instanceof $d||"BezierTargetThumb"!==this.endPoint&&"BezierSourceThumb"!==this.endPoint)&&this.undoElement&&i.source){var n=void 0,o={type:"SegmentChanged",redoObject:n=Yr(i.source),undoObject:this.undoElement,category:"Internal"};this.commandHandler.addHistoryEntry(o)}}else{var r=void 0,s=void 0;i.source&&i.source.connectors&&(r={x:this.prevPosition.x,y:this.prevPosition.y},s=i.source.connectors[0]);var a=void 0,l=void 0;if(i.target){var h=this.commandHandler.findTarget(i.targetWrapper,i.target,"ConnectorSourceEnd"===this.endPoint);h instanceof bh?a=h.id:l=h.id}var c={connector:s,state:"Completed",targetNode:l,oldValue:r,newValue:r,cancel:!1,targetPort:a},d="ConnectorSourceEnd"===this.endPoint?t.DiagramEvent.sourcePointChange:t.DiagramEvent.targetPointChange;if(this.commandHandler.triggerEvent(d,c),this.commandHandler.removeTerminalSegment(s,!0),this.undoElement&&i.source){var n=void 0,o={type:"ConnectionChanged",redoObject:Yr(n=Yr(i.source)),undoObject:Yr(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(o)}}e.prototype.mouseUp.call(this,i)},i.prototype.mouseMove=function(i){if(e.prototype.mouseMove.call(this,i),!(this instanceof $d)&&("ConnectorSourceEnd"===this.endPoint&&Dl.equals(i.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)||"ConnectorTargetEnd"===this.endPoint&&Dl.equals(i.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint))){var n=void 0,o=void 0;i.source&&i.source.connectors&&(n={x:this.prevPosition.x,y:this.prevPosition.y},o=i.source.connectors[0]);var r=void 0,s=void 0;i.target&&(s=i.target.id,(m=this.commandHandler.findTarget(i.targetWrapper,i.target,"ConnectorSourceEnd"===this.endPoint))instanceof bh||m instanceof cd?r=m.id:s=m.id);var a={connector:o,state:"Start",targetNode:s,oldValue:n,newValue:n,cancel:!1,targetPort:r},l="ConnectorSourceEnd"===this.endPoint?t.DiagramEvent.sourcePointChange:t.DiagramEvent.targetPointChange;this.commandHandler.triggerEvent(l,a)}if(this.currentPosition=i.position,this.currentPosition&&this.prevPosition){var h=this.currentPosition.x-this.prevPosition.x,c=this.currentPosition.y-this.prevPosition.y,d=void 0,n=void 0;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition);var p=void 0;i.source&&i.source.connectors&&(d={x:this.currentPosition.x,y:this.currentPosition.y},n={x:this.prevPosition.x,y:this.prevPosition.y},p=i.source.connectors[0]);var u=void 0,g=void 0;if(i.target){var m=this.commandHandler.findTarget(i.targetWrapper,i.target,"ConnectorSourceEnd"===this.endPoint);m instanceof bh?u=m.id:g=m.id}a={connector:p,state:"Progress",targetNode:g,oldValue:n,newValue:d,cancel:!1,targetPort:u};if(!(this instanceof $d)){l="ConnectorSourceEnd"===this.endPoint?t.DiagramEvent.sourcePointChange:t.DiagramEvent.targetPointChange;this.commandHandler.triggerEvent(l,a)}if((!a.cancel&&this.inAction&&void 0!==this.endPoint&&0!==h||0!==c)&&(this.blocked=!this.commandHandler.dragConnectorEnds(this.endPoint,i.source,this.currentPosition,this.selectedSegment,i.target,u),this.commandHandler.updateSelector(),i.target&&("ConnectorSourceEnd"===this.endPoint&&_n(i.target)||"ConnectorTargetEnd"===this.endPoint&&Vn(i.target))?(this.commandHandler.canDisconnect(this.endPoint,i,u,g)&&this.commandHandler.disConnect(i.source,this.endPoint),this.commandHandler.connect(this.endPoint,i)):-1===this.endPoint.indexOf("Bezier")&&(this.commandHandler.disConnect(i.source,this.endPoint),this.commandHandler.updateSelector())),this.commandHandler.canEnableDefaultTooltip()){var f=this.getTooltipContent(i.position);this.commandHandler.showTooltip(i.source,i.position,f,"ConnectTool",this.isTooltipVisible),this.isTooltipVisible=!1}}return this.prevPosition=this.currentPosition,!this.blocked},i.prototype.mouseLeave=function(t){this.mouseUp(t)},i.prototype.getTooltipContent=function(t){return"X:"+Math.round(t.x)+" Y:"+Math.round(t.y)},i.prototype.endAction=function(){e.prototype.endAction.call(this),this.prevPosition=null,this.endPoint=null},i}(Xd),Zd=function(e){function i(t,i){var n=e.call(this,t,!0)||this;return n.currentTarget=null,n.objectType=i,n}return qd(i,e),i.prototype.mouseDown=function(t){if(t.source instanceof fd||t.source instanceof _c){this.commandHandler.selectObjects([t.source],t.info&&t.info.ctrlKey);var i={nodes:[],connectors:[]};t.source instanceof fd?i.nodes.push(Yr(t.source)):i.connectors.push(Yr(t.source)),this.undoElement=Yr(i)}else this.undoElement=Yr(t.source);this.undoParentElement=this.commandHandler.getSubProcess(t.source),e.prototype.mouseDown.call(this,t),this.initialOffset={x:0,y:0}},i.prototype.mouseUp=function(i){var n,o=!1;if("Port"!==this.objectType){if(i.source instanceof fd||i.source instanceof _c){var r={nodes:[],connectors:[]};i.source instanceof fd?r.nodes.push(Yr(i.source)):r.connectors.push(Yr(i.source)),n=Yr(r);var s=i.source.wrapper;n.offsetX=s.offsetX,n.offsetY=s.offsetY}else n=Yr(i.source);if(n.offsetX!==this.undoElement.offsetX||n.offsetY!==this.undoElement.offsetY){var a=void 0,l=void 0;i.source&&(l={offsetX:i.source.wrapper.offsetX,offsetY:i.source.wrapper.offsetY},a={offsetX:i.source.wrapper.offsetX,offsetY:i.source.wrapper.offsetY});d={source:i.source,state:"Completed",oldValue:a,newValue:l,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:!0,cancel:!1};this.commandHandler.triggerEvent(t.DiagramEvent.positionChange,d),this.commandHandler.startGroupAction(),o=!0;var h={type:"PositionChanged",redoObject:Yr(n),undoObject:Yr(this.undoElement),category:"Internal"};if(n.nodes[0]&&n.nodes[0].processId){var c={type:"SizeChanged",category:"Internal",undoObject:this.undoParentElement,redoObject:this.commandHandler.getSubProcess(i.source)};this.commandHandler.addHistoryEntry(c)}this.commandHandler.addHistoryEntry(h)}this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,0,0);if(this.commandHandler.removeSnap(),this.commandHandler.removeHighlighter(),i.source&&this.currentTarget&&Un(this.currentTarget)&&this.commandHandler.isDroppable(i.source,this.currentTarget)){this.commandHandler.drop(this.currentElement,this.currentTarget,this.currentPosition);var d={element:i.source,target:this.currentTarget,position:this.currentPosition,cancel:!1};this.commandHandler.triggerEvent(t.DiagramEvent.drop,d)}this.commandHandler.updateSelector(),o&&this.commandHandler.endGroupAction()}e.prototype.mouseUp.call(this,i)},i.prototype.mouseMove=function(i){e.prototype.mouseMove.call(this,i);var n=!1;i.source instanceof fd||i.source instanceof _c?i.source instanceof fd?i.source.offsetX===this.undoElement.nodes[0].offsetX&&i.source.offsetY===this.undoElement.nodes[0].offsetY&&(n=!0):Dl.equals(i.source.sourcePoint,this.undoElement.connectors[0].sourcePoint)&&Dl.equals(i.source.targetPoint,this.undoElement.connectors[0].targetPoint)&&(n=!0):i.source.wrapper.offsetX===this.undoElement.wrapper.offsetX&&i.source.wrapper.offsetY===this.undoElement.wrapper.offsetY&&(n=!0);var o;i.source&&(o={offsetX:i.source.wrapper.offsetX,offsetY:i.source.wrapper.offsetY});var r={source:i.source,state:"Start",oldValue:o,newValue:o,target:i.target,targetPosition:i.position,allowDrop:!0,cancel:!1};if(n&&this.commandHandler.triggerEvent(t.DiagramEvent.positionChange,r),this.currentPosition=i.position,"Port"!==this.objectType){this.currentPosition.x,this.prevPosition.x,this.currentPosition.y,this.prevPosition.y;var s=this.initialOffset.x+(this.currentPosition.x-this.prevPosition.x),a=this.initialOffset.y+(this.currentPosition.y-this.prevPosition.y);this.commandHandler.dragOverElement(i,this.currentPosition),this.commandHandler.disConnect(i.source),this.commandHandler.removeSnap();var l,h=void 0,c=this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,s,a);this.initialOffset.x=s-c.x,this.initialOffset.y=a-c.y,i.source&&(l={offsetX:i.source.wrapper.offsetX,offsetY:i.source.wrapper.offsetY},h={offsetX:i.source.wrapper.offsetX+c.x,offsetY:i.source.wrapper.offsetY+c.y}),this.currentTarget&&i.target!==this.currentTarget&&this.commandHandler.removeChildFromBPmn(i.source,i.target,this.currentTarget),this.currentTarget=i.target;var d={source:i.source,state:"Progress",oldValue:l,newValue:h,target:i.target,targetPosition:i.position,allowDrop:!0,cancel:!1};if(this.commandHandler.triggerEvent(t.DiagramEvent.positionChange,d),!d.cancel){this.blocked=!this.commandHandler.dragSelectedObjects(c.x,c.y);var p=!this.commandHandler.mouseOver(this.currentElement,this.currentTarget,this.currentPosition);this.blocked=this.blocked||p}if(this.currentTarget&&i.source!==this.currentTarget&&this.commandHandler.isDroppable(i.source,this.currentTarget)?this.commandHandler.drawHighlighter(this.currentTarget):this.commandHandler.removeHighlighter(),this.commandHandler.canEnableDefaultTooltip()){var u=this.getTooltipContent(i.source);this.commandHandler.showTooltip(i.source,i.position,u,"MoveTool",this.isTooltipVisible),this.isTooltipVisible=!1}}else this.commandHandler.portDrag(i.source,i.sourceWrapper,i.position.x-this.prevPosition.x,i.position.y-this.prevPosition.y);return this.prevPosition=this.currentPosition,!this.blocked},i.prototype.getTooltipContent=function(t){return"X:"+Math.round(t.wrapper.bounds.x)+" Y:"+Math.round(t.wrapper.bounds.y)},i.prototype.mouseLeave=function(t){this.mouseUp(t)},i.prototype.endAction=function(){e.prototype.endAction.call(this),this.currentTarget=null,this.prevPosition=null},i}(Xd),Kd=function(e){function i(t){return e.call(this,t,!0)||this}return qd(i,e),i.prototype.mouseDown=function(t){if(this.undoElement=Yr(t.source),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children)for(var i=[],n=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],i),o=0;o<n.length;o++){var r=this.commandHandler.cloneChild(n[o].id);this.childTable[n[o].id]=Yr(r)}e.prototype.mouseDown.call(this,t)},i.prototype.mouseUp=function(i){if(this.undoElement.rotateAngle!==i.source.wrapper.rotateAngle){var n={rotateAngle:i.source.wrapper.rotateAngle},o={source:i.source,state:"Completed",oldValue:n,newValue:n,cancel:!1};this.commandHandler.triggerEvent(t.DiagramEvent.rotateChange,o);var r=void 0,s={type:"RotationChanged",redoObject:Yr(r=Yr(i.source)),undoObject:Yr(this.undoElement),category:"Internal",childTable:this.childTable};this.commandHandler.addHistoryEntry(s),this.commandHandler.updateSelector()}e.prototype.mouseUp.call(this,i)},i.prototype.mouseMove=function(i){if(e.prototype.mouseMove.call(this,i),this.undoElement.rotateAngle===i.source.wrapper.rotateAngle){var n={rotateAngle:i.source.wrapper.rotateAngle},o={source:i.source,state:"Start",oldValue:n,newValue:n,cancel:!1};this.commandHandler.triggerEvent(t.DiagramEvent.rotateChange,o)}this.currentPosition=i.position;var r={x:this.currentElement.wrapper.offsetX,y:this.currentElement.wrapper.offsetY},s=Dl.findAngle(r,this.currentPosition)+90,a=this.commandHandler.snapAngle(s);s=((s=0!==a?a:s)+360)%360;var l={rotateAngle:i.source.wrapper.rotateAngle},h={rotateAngle:s},c={source:i.source,state:"Progress",oldValue:l,newValue:h,cancel:!1};if(this.commandHandler.triggerEvent(t.DiagramEvent.rotateChange,c),c.cancel||(this.blocked=!this.commandHandler.rotateSelectedItems(s-this.currentElement.wrapper.rotateAngle)),this.commandHandler.canEnableDefaultTooltip()){var d=this.getTooltipContent(i.source);this.commandHandler.showTooltip(i.source,i.position,d,"RotateTool",this.isTooltipVisible),this.isTooltipVisible=!1}return!this.blocked},i.prototype.getTooltipContent=function(t){return Math.round(t.rotateAngle%360).toString()+"°"},i.prototype.mouseLeave=function(t){this.mouseUp(t)},i.prototype.endAction=function(){e.prototype.endAction.call(this)},i}(Xd),Qd=function(e){function i(t,i){var n=e.call(this,t,!0)||this;return n.initialBounds=new Rl,n.corner=i,n}return qd(i,e),i.prototype.mouseDown=function(t){if(this.undoElement=Yr(t.source),this.undoParentElement=this.commandHandler.getSubProcess(t.source),e.prototype.mouseDown.call(this,t),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children)for(var i=[],n=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],i),o=0;o<n.length;o++){var r=this.commandHandler.cloneChild(n[o].id);this.childTable[n[o].id]=Yr(r)}e.prototype.mouseDown.call(this,t),this.initialBounds.x=t.source.wrapper.offsetX,this.initialBounds.y=t.source.wrapper.offsetY,this.initialBounds.height=t.source.wrapper.actualSize.height,this.initialBounds.width=t.source.wrapper.actualSize.width},i.prototype.mouseUp=function(i){if(this.commandHandler.removeSnap(),this.undoElement.offsetX!==i.source.wrapper.offsetX||this.undoElement.offsetY!==i.source.wrapper.offsetY){this.blocked=this.updateSize(i.source,this.currentPosition,this.prevPosition,this.corner);var n={offsetX:i.source.wrapper.offsetX,offsetY:i.source.wrapper.offsetY,width:i.source.wrapper.actualSize.width,height:i.source.wrapper.actualSize.height},o={source:i.source,state:"Completed",oldValue:n,newValue:n,cancel:!1};this.commandHandler.triggerEvent(t.DiagramEvent.sizeChange,o);var r=Yr(i.source),s={type:"SizeChanged",redoObject:Yr(r),undoObject:Yr(this.undoElement),category:"Internal",childTable:this.childTable};if(this.commandHandler.startGroupAction(),this.commandHandler.addHistoryEntry(s),r.nodes[0]&&r.nodes[0].processId){var a={type:"SizeChanged",redoObject:this.commandHandler.getSubProcess(i.source),undoObject:this.undoParentElement,category:"Internal"};this.commandHandler.addHistoryEntry(a)}this.commandHandler.endGroupAction()}return e.prototype.mouseUp.call(this,i),!this.blocked},i.prototype.mouseMove=function(i){if(e.prototype.mouseMove.call(this,i),this.undoElement.offsetX===i.source.wrapper.offsetX&&this.undoElement.offsetY===i.source.wrapper.offsetY){var n={offsetX:i.source.wrapper.offsetX,offsetY:i.source.wrapper.offsetY,width:i.source.wrapper.actualSize.width,height:i.source.wrapper.actualSize.height},o={source:i.source,state:"Start",oldValue:n,newValue:this.currentElement,cancel:!1};this.commandHandler.triggerEvent(t.DiagramEvent.sizeChange,o)}this.currentPosition=i.position;var r={x:this.currentPosition.x-this.startPosition.x,y:this.currentPosition.y-this.startPosition.y};r=rs(-this.currentElement.wrapper.rotateAngle,void 0,void 0,r);this.currentElement.wrapper.actualSize.width,r.x,this.currentElement.wrapper.actualSize.width,this.currentElement.wrapper.actualSize.height,r.y,this.currentElement.wrapper.actualSize.height;if(r=this.getChanges(r),this.commandHandler.removeSnap(),this.blocked=!this.updateSize(i.source,this.startPosition,this.currentPosition,this.corner),this.commandHandler.canEnableDefaultTooltip()){var s=this.getTooltipContent(i.source);this.commandHandler.showTooltip(i.source,i.position,s,"ResizeTool",this.isTooltipVisible),this.isTooltipVisible=!1}return this.prevPosition=this.currentPosition,!this.blocked},i.prototype.mouseLeave=function(t){this.mouseUp(t)},i.prototype.getTooltipContent=function(t){return"W:"+Math.round(t.wrapper.bounds.width)+" H:"+Math.round(t.wrapper.bounds.height)},i.prototype.getPivot=function(){switch(this.corner){case"ResizeWest":return{x:1,y:.5};case"ResizeEast":return{x:0,y:.5};case"ResizeNorth":return{x:.5,y:1};case"ResizeSouth":return{x:.5,y:0};case"ResizeNorthEast":return{x:0,y:1};case"ResizeNorthWest":return{x:1,y:1};case"ResizeSouthEast":return{x:0,y:0};case"ResizeSouthWest":return{x:1,y:0}}return{x:.5,y:.5}},i.prototype.getChanges=function(t){switch(this.corner){case"ResizeEast":return{x:t.x,y:0};case"ResizeSouthEast":return t;case"ResizeSouth":return{x:0,y:t.y};case"ResizeNorth":return{x:0,y:-t.y};case"ResizeNorthEast":return{x:t.x,y:-t.y};case"ResizeNorthWest":return{x:-t.x,y:-t.y};case"ResizeWest":return{x:-t.x,y:0};case"ResizeSouthWest":return{x:-t.x,y:t.y}}return t},i.prototype.updateSize=function(t,e,i,n){var o,r={snapped:!1,offset:0,left:!1,right:!1},s={snapped:!1,offset:0,top:!1,bottom:!1},a=this.currentPosition.x-this.startPosition.x,l=this.currentPosition.y-this.startPosition.y,h=this.commandHandler.snappingModule&&this.commandHandler.snappingModule.canSnap(),c=h?this.commandHandler.snappingModule.getLayer():null;Tt(o=Et(),-t.rotateAngle,0,0);var d=t.offsetX,p=t.offsetY,u=t.width,g=t.height;d-=u*t.pivot.x,p-=g*t.pivot.y;var m,f=0,v=0,y=this.initialBounds;switch(n){case"ResizeWest":a=(m=Pt(o,{x:a,y:l})).x,l=m.y,v=1,a=h?this.commandHandler.snappingModule.snapLeft(r,s,c,a,l,t,i===e,this.initialBounds):a,l=0,f=(y.width-a)/t.width;break;case"ResizeEast":a=(m=Pt(o,{x:a,y:l})).x,l=m.y,a=h?this.commandHandler.snappingModule.snapRight(r,s,c,a,l,t,i===e,this.initialBounds):a,l=0,f=(y.width+a)/t.width,v=1;break;case"ResizeNorth":f=1,a=(m=Pt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapTop(r,s,c,a,l,t,i===e,this.initialBounds):l,v=(y.height-l)/t.height;break;case"ResizeSouth":f=1,a=(m=Pt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapBottom(r,s,c,m.x,m.y,t,i===e,this.initialBounds):l,v=(y.height+l)/t.height;break;case"ResizeNorthEast":a=(m=Pt(o,{x:a,y:l})).x,l=m.y,a=h?this.commandHandler.snappingModule.snapRight(r,s,c,a,l,t,i===e,this.initialBounds):a,l=h?this.commandHandler.snappingModule.snapTop(r,s,c,a,l,t,i===e,this.initialBounds):l,f=(y.width+a)/t.width,v=(y.height-l)/t.height;break;case"ResizeNorthWest":a=(m=Pt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapTop(r,s,c,a,l,t,i===e,this.initialBounds):l,a=h?this.commandHandler.snappingModule.snapLeft(r,s,c,a,l,t,i===e,this.initialBounds):a,f=(y.width-a)/t.width,v=(y.height-l)/t.height;break;case"ResizeSouthEast":a=(m=Pt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapBottom(r,s,c,a,l,t,i===e,this.initialBounds):l,a=h?this.commandHandler.snappingModule.snapRight(r,s,c,a,l,t,i===e,this.initialBounds):a,v=(y.height+l)/t.height,f=(y.width+a)/t.width;break;case"ResizeSouthWest":a=(m=Pt(o,{x:a,y:l})).x,l=m.y,l=h?this.commandHandler.snappingModule.snapBottom(r,s,c,a,l,t,i===e,y):l,a=h?this.commandHandler.snappingModule.snapLeft(r,s,c,a,l,t,i===e,y):a,f=(y.width-a)/t.width,v=(y.height+l)/t.height}return this.scaleObjects(o,f,v,n,e,i,t)},i.prototype.scaleObjects=function(e,i,n,o,r,s,a){1===a.nodes.length&&a.nodes[0].constraints&t.NodeConstraints.AspectRatio&&("ResizeWest"===o||"ResizeEast"===o||"ResizeNorth"===o||"ResizeSouth"===o?1===n&&1===i||(n=i=Math.max(1===n?0:n,1===i?0:i)):n=i=r!==s?Math.max(n,i):0);var l={offsetX:a.offsetX,offsetY:a.offsetY,width:a.width,height:a.height};this.blocked=this.commandHandler.scaleSelectedItems(i,n,this.getPivot());var h={source:a,state:"Progress",oldValue:l,newValue:{offsetX:a.offsetX,offsetY:a.offsetY,width:a.width,height:a.height},cancel:!1};return this.commandHandler.triggerEvent(t.DiagramEvent.sizeChange,h),h.cancel&&this.commandHandler.scaleSelectedItems(1/i,1/n,this.getPivot()),this.blocked},i}(Xd),Jd=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.sourceObject=i,n}return qd(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.inAction=!0},e.prototype.mouseMove=function(e){t.prototype.mouseMove.call(this,e);var i,n={offsetX:this.currentPosition.x,width:3,height:3,offsetY:this.currentPosition.y};if(this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(n)),this.inAction&&!1===Dl.equals(this.currentPosition,this.prevPosition)){var o=Rl.toBounds([this.prevPosition,this.currentPosition]);(i=this.commandHandler.checkBoundaryConstraints(void 0,void 0,o))&&this.commandHandler.updateNodeDimension(this.drawingObject,o)}return i},e.prototype.mouseUp=function(e){var i=Rl.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.checkBoundaryConstraints(void 0,void 0,i),this.drawingObject&&this.drawingObject instanceof fd&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),t.prototype.mouseUp.call(this,e),this.inAction=!1},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e}(Xd),$d=function(t){function e(e,i,n){var o=t.call(this,e,i)||this;return o.sourceObject=n,o}return qd(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.inAction=!0},e.prototype.mouseMove=function(e){if(this.inAction){var i={sourcePoint:this.currentPosition,targetPoint:this.currentPosition};this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(i)),e.source=this.drawingObject,e.target&&this.commandHandler.connect(this.endPoint,e),this.endPoint="ConnectorTargetEnd"}return this.inAction||(this.commandHandler.updateSelector(),e.source&&e.sourceWrapper&&this.commandHandler.renderHighlighter(e,!0)),t.prototype.mouseMove.call(this,e),!this.blocked},e.prototype.mouseUp=function(e){this.drawingObject&&this.drawingObject instanceof _c&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.drawingObject=null),this.inAction=!1,t.prototype.mouseUp.call(this,e)},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e}(Gd),tp=function(t){function e(e){return t.call(this,e,!0)||this}return qd(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.commandHandler.clearSelection();var i={shape:{type:"Text"},offsetX:this.currentPosition.x,width:50,height:20,offsetY:this.currentPosition.y};e.source||(this.drawingNode=this.commandHandler.drawObject(i))},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.drawingNode)this.drawingNode.style.strokeColor="black",this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent";else{var i={shape:{type:"Text"},offsetX:this.currentPosition.x,width:30,height:30,style:{strokeDashArray:"2 2",fill:"transparent"},offsetY:this.currentPosition.y};this.drawingNode=this.commandHandler.drawObject(i)}if(this.inAction&&!1===Dl.equals(this.currentPosition,this.prevPosition)){var n=Rl.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.updateNodeDimension(this.drawingNode,n)}return!this.blocked},e.prototype.mouseUp=function(e){this.drawingNode?(this.drawingNode.style.strokeColor="none",this.drawingNode.style.fill="none"):this.drawingNode=e.source,this.drawingNode&&(this.drawingNode instanceof fd||this.drawingNode instanceof _c)&&this.commandHandler.addText(this.drawingNode,this.currentPosition),t.prototype.mouseUp.call(this,e),this.inAction=!1},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e}(Xd),ep=function(t){function e(e,i){var n=t.call(this,e)||this;return n.zooming=i,n}return qd(e,t),e.prototype.mouseDown=function(e){t.prototype.mouseDown.call(this,e),this.inAction=!0},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.inAction)if(this.zooming||!1!==Dl.equals(this.currentPosition,this.prevPosition)){if(e.moveTouches.length>=2){var i=e.startTouches[0],n=e.startTouches[1],o=e.moveTouches[0],r=e.moveTouches[1],s=this.getDistance(o,r)/this.getDistance(i,n),a=e.position;this.commandHandler.zoom(s,0,0,a),this.updateTouch(i,o),this.updateTouch(n,r)}}else{var l=this.currentPosition.x-this.prevPosition.x,h=this.currentPosition.y-this.prevPosition.y;this.commandHandler.scroll(l,h,this.currentPosition)}return!this.blocked},e.prototype.mouseUp=function(e){t.prototype.mouseUp.call(this,e),this.inAction=!1},e.prototype.endAction=function(){t.prototype.endAction.call(this)},e.prototype.getDistance=function(t,e){var i=e.pageX-t.pageX,n=e.pageY-t.pageY;return Math.sqrt(i*i+n*n)},e.prototype.updateTouch=function(t,e){t.pageX=e.pageX,t.pageY=e.pageY},e}(Xd),ip=function(t){function e(e){return t.call(this,e,!0)||this}return qd(e,t),e.prototype.mouseUp=function(e){this.commandHandler.initExpand(e),t.prototype.mouseUp.call(this,e)},e}(Xd),np=function(t){function e(e){return t.call(this,e,!0)||this}return qd(e,t),e.prototype.mouseUp=function(e){window.open(e.sourceWrapper.hyperlink.link,"_blank").focus(),t.prototype.mouseUp.call(this,e)},e}(Xd),op=function(t){function e(e){return t.call(this,e,!0)||this}return qd(e,t),e.prototype.mouseDown=function(e){if(t.prototype.mouseDown.call(this,e),this.inAction=!0,this.drawingObject){var i=void 0,n=this.drawingObject.shape;i={x:(i=n.points[n.points.length-1]).x,y:i.y},this.drawingObject.shape.points.push(i)}else{this.startPoint={x:this.startPosition.x,y:this.startPosition.y};var o={offsetX:this.currentPosition.x,offsetY:this.currentPosition.y,width:5,height:5,style:{strokeColor:"black",strokeWidth:1},shape:{type:"Basic",shape:"Polygon",points:[{x:this.startPoint.x,y:this.startPoint.y},{x:this.currentPosition.x,y:this.currentPosition.y}]}};this.drawingObject=this.commandHandler.drawObject(o)}},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.inAction){var i=this.drawingObject.shape;if(this.drawingObject&&this.currentPosition&&(i.points[i.points.length-1].x=this.currentPosition.x,i.points[i.points.length-1].y=this.currentPosition.y,this.drawingObject.wrapper.children[0].data=ft(this.drawingObject.shape.points),this.inAction&&!1===Dl.equals(this.currentPosition,this.prevPosition))){var n=Rl.toBounds(this.drawingObject.shape.points);this.commandHandler.updateNodeDimension(this.drawingObject,n)}}return!0},e.prototype.mouseUp=function(e,i){t.prototype.mouseMove.call(this,e),this.inAction&&(this.inAction=!1,this.drawingObject&&this.commandHandler.addObjectToDiagram(this.drawingObject)),this.endAction()},e.prototype.mouseWheel=function(e){t.prototype.mouseWheel.call(this,e),this.mouseMove(e)},e.prototype.endAction=function(){this.inAction=!1,this.drawingObject=null},e}(Xd),rp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sp=function(t){function e(e,i){var n=t.call(this,e,!0)||this;return n.endPoint=i,n}return rp(e,t),e.prototype.mouseDown=function(e){this.inAction=!0,this.undoElement=Yr(e.source),t.prototype.mouseDown.call(this,e);var i;e.source&&e.source.connectors&&(i=e.source.connectors[0]);for(var n=0;n<i.segments.length;n++){var o=i.segments[n];if("OrthoThumb"===this.endPoint)for(var r=0;r<o.points.length-1;r++){var s={x:0,y:0};s.x=(o.points[r].x+o.points[r+1].x)/2,s.y=(o.points[r].y+o.points[r+1].y)/2,ps(this.currentPosition,s,30)&&(this.selectedSegment=o,this.segmentIndex=r)}else ps(this.currentPosition,o.point,10)&&(this.selectedSegment=o)}},e.prototype.mouseMove=function(e){if(t.prototype.mouseMove.call(this,e),this.currentPosition=e.position,this.currentPosition&&this.prevPosition){var i=this.currentPosition.y-this.prevPosition.y,n=this.currentPosition.x-this.prevPosition.x;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition);var o=void 0;if(e.source&&e.source.connectors&&(o=e.source.connectors[0]),this.inAction&&void 0!==this.endPoint&&0!==n||0!==i){if("OrthoThumb"===this.endPoint)this.blocked=!this.dragOrthogonalSegment(o,this.selectedSegment,this.currentPosition,this.segmentIndex);else{var r=this.currentPosition.x-this.selectedSegment.point.x,s=this.currentPosition.y-this.selectedSegment.point.y,a=o.segments.indexOf(this.selectedSegment);this.blocked=!this.commandHandler.dragControlPoint(o,r,s,!1,a)}this.commandHandler.updateSelector()}}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseUp=function(e){var i;if(e.source&&e.source.connectors&&(i=e.source.connectors[0]),e&&e.source&&e.info&&e.info.ctrlKey&&e.info.shiftKey&&"Straight"===i.type)this.addOrRemoveSegment(i,this.currentPosition);else if("OrthoThumb"===this.endPoint&&this.selectedSegment){var n=i.segments.indexOf(this.selectedSegment),o=i.segments[n-1],r=i.segments[n+1];if(n===i.segments.length-2&&this.updateLastSegment(i,this.selectedSegment))i.segments.splice(i.segments.length-2,1);else if(o&&Math.abs(o.length)<5)1!==n&&this.removePrevSegment(i,n);else if(r){var s=Dl.distancePoints(r.points[0],r.points[1]),a=r.length||0===r.length?r.length:s;Math.abs(a)<=5&&this.removeNextSegment(i,n)}this.commandHandler.updateEndPoint(i)}if(this.undoElement){var l=void 0,h={type:"SegmentChanged",redoObject:l=Yr(e.source),undoObject:this.undoElement,category:"Internal"};this.commandHandler.addHistoryEntry(h)}t.prototype.mouseUp.call(this,e)},e.prototype.removePrevSegment=function(t,e){var i=t.segments[e-2],n=t.segments[e+1];if(!((n.length||0===n.length?n.length:Dl.distancePoints(n.points[0],n.points[1]))<=5)){var o=t.segments[e+1];t.segments.splice(e-1,2);var r=this.selectedSegment;"Left"===r.direction||"Right"===r.direction?(i.points[i.points.length-1].x=o.points[0].x,o.points[0].y=i.points[i.points.length-1].y):(i.points[i.points.length-1].y=o.points[0].y,o.points[0].x=i.points[i.points.length-1].x),(r.length||0===r.length)&&this.findSegmentDirection(i),this.findSegmentDirection(o)}},e.prototype.findSegmentDirection=function(t){t.direction&&(t.length||0===t.length)&&(t.length=Dl.distancePoints(t.points[0],t.points[t.points.length-1]),t.direction=Dl.direction(t.points[0],t.points[t.points.length-1]))},e.prototype.removeNextSegment=function(t,e){var i=this.selectedSegment,n=t.segments[e-1],o=t.segments[e+2],r=t.segments[e+1];if(r.length||0===r.length?(t.segments.splice(e,2),"Top"===i.direction||"Bottom"===i.direction?(o.points[0].y=i.points[0].y,n.points[n.points.length-1].x=o.points[0].x):(o.points[0].x=i.points[0].x,n.points[n.points.length-1].y=o.points[0].y)):(t.segments.splice(e+1,1),"Top"===i.direction||"Bottom"===i.direction?n.points[n.points.length-1].x=r.points[r.points.length-1].x:n.points[n.points.length-1].y=r.points[r.points.length-1].y,this.findSegmentDirection(n),i.length=i.direction=null),n&&o&&(n.length=Dl.distancePoints(n.points[0],o.points[0]),n.direction=Dl.direction(n.points[0],o.points[0]),o.length||0===o.length)){o.length=Dl.distancePoints(n.points[n.points.length-1],o.points[o.points.length-1]);var s=n.points,a=o.points;o.direction=Dl.direction(s[s.length-1],a[a.length-1])}},e.prototype.addOrRemoveSegment=function(t,e){for(var i,n,o=0;o<t.segments.length;o++)ps(e,(r=t.segments[o]).point,t.hitPadding)&&(n=o,i=!0);if(i&&void 0!==n){if(t.segments&&t.segments[n]&&"Straight"===t.segments[n].type){var r=t.segments[n],s=t.segments[n+1];s&&(t.segments.splice(n,1),s.points[0]=r.points[0])}}else{var a=this.findIndex(t,e);if(t.segments&&t.segments[a]&&"Straight"===t.segments[a].type){var r=t.segments[a],l=new jc(t,"segments",{type:"Straight",point:e},!0);l.points[0]=r.points[0],l.points[1]=e,r.points[0]=e,t.segments.splice(a,0,l),i=!0}}i&&this.commandHandler.updateEndPoint(t)},e.prototype.findIndex=function(t,e){for(var i=[],n=0;n<t.segments.length;n++){var o=t.segments[n],r=Rl.toBounds([o.points[0],o.points[1]]);r.Inflate(t.hitPadding),r.containsPoint(e)&&i.push(o)}if(1===i.length)return t.segments.indexOf(i[0]);for(var s=void 0,a=void 0,l=void 0,h=void 0,c=void 0,d=void 0,n=0;n<i.length;n++)h=i[n],c=(e.y-h.points[0].y)/(h.points[1].y-e.y),d=(e.x-h.points[0].x)/(h.points[1].x-e.x),s=Math.abs(c-d),0===n&&(a=s,l=0),s<a&&(a=s,l=n);return t.segments.indexOf(i[l])},e.prototype.dragOrthogonalSegment=function(t,e,i,n){var o={x:0,y:0};o.x=(e.points[n].x+e.points[n+1].x)/2,o.y=(e.points[n].y+e.points[n+1].y)/2;var r=i.y-o.y,s=i.x-o.x,a=t.segments.indexOf(e),l=!1;e.points[0].y.toFixed(2),e.points[1].y.toFixed(2);return-1!==a&&(0===a&&1===t.segments.length&&2===e.points.length?(a=this.addSegments(t,e,s,r,a),l=!0):a!==t.segments.length-1||null!==e.direction&&null!==e.length?0===a&&(a=this.insertFirstSegment(t,e,s,r,a),l=!0):(a=this.addTerminalSegment(t,e,s,r,n),l=!0),l&&(this.selectedSegment=e=t.segments[a],this.segmentIndex=0),this.updateAdjacentSegments(t,a,s,r),this.commandHandler.updateEndPoint(t)),!0},e.prototype.addSegments=function(t,e,i,n,o){var r,s,a=[],l=Dl.distancePoints(e.points[0],e.points[1]),h=Dl.direction(e.points[0],e.points[1]);return a.push(new Vc(t,"segments",{type:"Orthogonal",direction:h,length:l/4},!0)),r=e.points[0].y===e.points[1].y?n>0?"Bottom":"Top":i>0?"Right":"Left",s=e.points[0].x===e.points[1].x?n:i,a.push(new Vc(t,"segments",{type:"Orthogonal",direction:r,length:s},!0)),a.push(new Vc(t,"segments",{type:"Orthogonal",direction:h,length:l/2},!0)),t.segments=a.concat(t.segments),o+2},e.prototype.insertFirstSegment=function(t,e,i,n,o){var r,s,a,l,h,c=[];if(t.sourcePortID&&e.length&&t.segments[0].points.length>2){t.segments.splice(0,1);for(var d=void 0,p=0;p<e.points.length-1;p++){var u=Dl.distancePoints(e.points[p],e.points[p+1]),g=Dl.direction(e.points[p],e.points[p+1]);0===(h=new Vc(t,"segments",{type:"Orthogonal",direction:g,length:u},!0)).length&&(!d||"Top"!==d.direction&&"Bottom"!==d.direction?h.direction=n>0?"Bottom":"Top":h.direction=i>0?"Right":"Left"),d=h,c.push(h)}t.segments=c.concat(t.segments),l=1}else{a={type:"Orthogonal",direction:e.direction,length:e.length/3},c.push(new Vc(t,"segments",a,!0)),"Bottom"===e.direction||"Top"===e.direction?(s=Math.abs(i),r=i>0?"Right":"Left"):(s=Math.abs(n),r=n>0?"Bottom":"Top"),h=new Vc(t,"segments",{type:"Orthogonal",direction:r,length:s},!0),c.push(h);var m=t.segments[1];m&&m.length&&(m.length=r!==m.direction?m.length+s:m.length-s),l=2,e.length=2*e.length/3,t.segments=c.concat(t.segments)}return l},e.prototype.updateAdjacentSegments=function(t,e,i,n){var o=t.segments[e],r=o.points[o.points.length-1],s=o.points[0],a=!0;if("Orthogonal"===o.type&&(o.points[0]=s,o.points[o.points.length-1]=r,t.segments[e-1]&&(a=this.updatePreviousSegment(i,n,t,e)),t.segments.length-1>e&&a)){var l=t.segments[e+1];this.updateNextSegment(t,o,l,i,n)}},e.prototype.addTerminalSegment=function(t,e,i,n,o){var r,s,a,l,h=t.segments.indexOf(e);t.segments.pop();var c=t.segments[t.segments.length-1];r=c&&"Orthogonal"===c.type?c:null;for(var d=0;d<e.points.length-2;d++)a=Dl.distancePoints(e.points[d],e.points[d+1]),l=Dl.direction(e.points[d],e.points[d+1]),s=new Vc(t,"segments",{type:"Orthogonal",length:a,direction:l},!0),t.segments.push(s),r=s;var p=o;if((2===e.points.length||p===e.points.length-2)&&(r&&(r.length+=5),void 0!==p)){var u=void 0;a=2*Dl.distancePoints(e.points[e.points.length-2],e.points[e.points.length-1])/3,l=Dl.direction(e.points[e.points.length-2],e.points[e.points.length-1]),u=new Vc(t,"segments",{type:"Orthogonal",length:a,direction:l}),t.segments.push(u)}var g=new Vc(t,"segments",{type:"Orthogonal"},!0);return t.segments.push(g),this.commandHandler.updateEndPoint(t),h+=o},e.prototype.updatePortSegment=function(t,e,i,n,o){if(1===i&&2===t.points.length&&t.length<0){var r=e.sourceWrapper.corners,s=e.segments[i],a=e.segments[i+1],l=void 0,h=[];l=new Vc(e,"segments",{type:"Orthogonal",length:13,direction:t.direction}),h.push(l);var c=void 0;c="Left"===s.direction?s.points[0].x-(r.middleLeft.x-20):"Right"===s.direction?r.middleRight.x+20-s.points[0].x:"Bottom"===s.direction?r.bottomCenter.y+20-s.points[0].y:s.points[0].y-(r.topCenter.y-20);s.direction;l=new Vc(e,"segments",{type:"Orthogonal",length:c,direction:s.direction}),h.push(l),s.length=s.length-c,a&&a.length&&a.direction&&(a.direction===t.direction?a.length-=13:a.direction===Pn(t.direction)&&(a.length+=13)),e.segments=h.concat(e.segments),this.selectedSegment=e.segments[3]}},e.prototype.updatePreviousSegment=function(t,e,i,n){var o=i.segments[n],r=i.segments[n-1];r.points[r.points.length-1]=o.points[0];var s=!i.sourceID||""!==i.sourcePortID,a=!0;return"Orthogonal"===r.type&&("Bottom"===r.direction?r.length+=e:"Top"===r.direction?r.length-=e:"Right"===r.direction?r.length+=t:r.length-=t,""!==i.sourcePortID&&r.length<0?this.updatePortSegment(r,i,n,t,e):i.sourceID&&""===i.sourcePortID&&r.length<0&&1===n&&(a=!1,this.updateFirstSegment(i,o)),s&&this.changeSegmentDirection(r)),a},e.prototype.changeSegmentDirection=function(t){t.length<0&&(t.direction=Pn(t.direction),t.length*=-1)},e.prototype.updateNextSegment=function(t,e,i,n,o){e.points[e.points.length-1];i.points[0]=e.points[e.points.length-1],i&&"Orthogonal"===i.type&&(i.length||0===i.length)&&("Left"===i.direction||"Right"===i.direction?0!==n&&(i.length="Right"===i.direction?i.length-n:i.length+n,(i.length||0===i.length)&&this.changeSegmentDirection(i)):0!==o&&(i.length="Bottom"===i.direction?i.length-o:i.length+o,(i.length||0===i.length)&&this.changeSegmentDirection(i)))},e.prototype.updateFirstSegment=function(t,e){var i,n=t.segments.indexOf(e),o=!1,r=t.segments[n],s=t.segments[n-1];if(s.length<0&&t.sourceID){var a=t.sourceWrapper.corners,l=[],h=void 0,c=!1;this.changeSegmentDirection(r);var d=t.segments[n+1],p=t.segments[n+2];switch(d&&this.changeSegmentDirection(d),p&&this.changeSegmentDirection(p),s.direction){case"Top":case"Bottom":i=r.length>0&&"Left"===r.direction?a.middleLeft:a.middleRight,r.length>a.width/2?Math.abs(s.length)<a.height/2&&(s.length=Dl.distancePoints(a.center,s.points[s.points.length-1]),r.points[0].x=i.x,r.length=Dl.distancePoints(r.points[0],r.points[r.points.length-1]),r.length-=20,o=!0):(d&&d.direction&&d.length&&(d.points[0].y=i.y,d.points[0].x=d.points[d.points.length-1].x="Right"===r.direction?i.x+20:i.x-20),o=!0,c=!0);break;case"Left":case"Right":i=r.length>0&&"Top"===r.direction?a.topCenter:a.bottomCenter,r.length>a.height/2?Math.abs(s.length)<a.width/2&&(s.length=Dl.distancePoints(a.center,s.points[s.points.length-1]),r.points[0].y=i.y,r.length=Dl.distancePoints(r.points[0],r.points[r.points.length-1]),r.length-=20,o=!0):(d&&d.direction&&d.length&&(d.points[0].x=i.x,d.points[0].y=d.points[d.points.length-1].y="Bottom"===r.direction?i.y+20:i.y-20),o=!0,c=!0)}this.changeSegmentDirection(s),this.changeSegmentDirection(r),o&&(h={type:"Orthogonal",direction:r.direction,length:20},l.push(new Vc(t,"segments",h,!0)),c&&(d&&d.direction&&d.length&&(d.length=Dl.distancePoints(d.points[0],d.points[d.points.length-1])),p&&p.direction&&p.length&&(p.length=Dl.distancePoints(d.points[d.points.length-1],p.points[p.points.length-1])),t.segments.splice(n-1,2)),t.segments=l.concat(t.segments)),this.selectedSegment=c?t.segments[n-1]:t.segments[n+1],this.commandHandler.updateEndPoint(t)}},e.prototype.updateLastSegment=function(t,e){if(t.targetID&&""===t.targetPortID){var i=void 0,n=void 0,o=void 0,r=void 0,s=t.targetWrapper.corners,a=e.points[0],l=e.points[e.points.length-1];return"Right"===e.direction||"Left"===e.direction?(i={x:a.x,y:a.y},n={x:"Left"===e.direction?l.x-s.width/2:l.x+s.width/2,y:l.y},o={x:s.center.x,y:s.center.y-s.height},r={x:s.center.x,y:s.center.y+s.height}):(i={x:a.x,y:a.y},n={x:l.x,y:"Bottom"===e.direction?l.y+s.height/2:l.y-s.height/2},o={x:s.center.x-s.width,y:s.center.y},r={x:s.center.x+s.width,y:s.center.y}),Po({X1:i.x,Y1:i.y,X2:n.x,Y2:n.y},{X1:o.x,Y1:o.y,X2:r.x,Y2:r.y}).enabled}return!1},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"ConnectorEditingTool"},e}(Xd),ap=function(){function e(t,e){this.currentAction="None",this.focus=!1,this.isBlocked=!1,this.isMouseDown=!1,this.inAction=!1,this.doingAutoScroll=!1,this.diagram=null,this.objectFinder=null,this.tool=null,this.eventArgs=null,this.diagram=t,this.objectFinder=new lp,this.commandHandler=e}return Object.defineProperty(e.prototype,"action",{get:function(){return this.currentAction},set:function(e){e!==this.currentAction&&("PortDraw"===this.currentAction&&(this.diagram.tool&=~t.DiagramTools.DrawOnce,this.tool&&this.tool.mouseUp({position:this.currentPosition}),this.tool=null),this.currentAction=e,"None"===this.currentAction||"Select"===this.currentAction||this.diagram.diagramActions&t.DiagramAction.TextEdit?this.diagram.diagramActions=this.diagram.diagramActions&~t.DiagramAction.ToolAction:this.diagram.diagramActions=this.diagram.diagramActions|t.DiagramAction.ToolAction,this.diagram.setCursor(this.diagram.getCursor(e,this.inAction)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blocked",{get:function(){return this.isBlocked},set:function(t){this.isBlocked=t,this.blocked?this.diagram.setCursor("not-allowed"):this.diagram.setCursor(this.diagram.getCursor(this.action,this.inAction))},enumerable:!0,configurable:!0}),e.prototype.getMousePosition=function(t){var e,i,n;-1!==t.type.indexOf("touch")?(i=(e=t).changedTouches[0].clientX,n=e.changedTouches[0].clientY):(i=t.clientX,n=t.clientY);var o=new Al;o=uo(this.diagram);var r=this.diagram.element.getBoundingClientRect();return i=i+this.diagram.diagramCanvas.scrollLeft-r.left-o.width,n=n+this.diagram.diagramCanvas.scrollTop-r.top-o.height,i/=this.diagram.scroller.transform.scale,n/=this.diagram.scroller.transform.scale,i-=this.diagram.scroller.transform.tx,n-=this.diagram.scroller.transform.ty,{x:i,y:n}},e.prototype.windowResize=function(t){var e=this;return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){e.updateViewPortSize(e.diagram.element)},300),!1},e.prototype.updateViewPortSize=function(t){var e=document.getElementById(t.id);if(e){var i=e.getBoundingClientRect();this.diagram.scroller.setViewPortSize(i.width,i.height);var n=new Al;n=uo(this.diagram);var o=this.diagram.getSizeValue(this.diagram.width,n.width),r=this.diagram.getSizeValue(this.diagram.height,n.height);this.diagram.diagramCanvas.style.width=o,this.diagram.diagramCanvas.style.height=r,this.diagram.scroller.setSize(),this.diagram.rulerSettings.showRulers&&co(this.diagram)}},e.prototype.canHideResizers=function(){return(this.tool instanceof Zd||this.tool instanceof Kd)&&this.isMouseDown},e.prototype.updateCursor=function(){if(1===this.diagram.selectedItems.nodes.length||1===this.diagram.selectedItems.connectors.length){var t=[];t=t.concat(this.diagram.selectedItems.nodes,this.diagram.selectedItems.connectors),this.blocked=this.isMouseDown&&1===t.length&&this.tool instanceof Yd&&!In(t[0])}},e.prototype.isForeignObject=function(t,e){var i=t;if(i)for(;null!==i.parentNode;){if("string"==typeof i.className&&(!e&&-1!==i.className.indexOf("foreign-object")||e&&-1!==i.className.indexOf("e-diagram-text-edit")))return i;i=i.parentNode}return null},e.prototype.isMetaKey=function(t){return navigator.platform.match("Mac")?t.metaKey:t.ctrlKey},e.prototype.isDeleteKey=function(t,e){return navigator.platform.match("Mac")&&"Backspace"===t&&"delete"===e},e.prototype.mouseDown=function(e){this.focus=!0;var i;if(i=e.touches,!this.checkEditBoxAsTarget(e)&&to(this.diagram)||Gn(this.diagram)&&!Qn(this.diagram))if("Select"!==this.action&&"Drag"!==this.action||this.diagram.updatePortVisibility(this.hoverElement,t.PortVisibility.Hover,!0),this.tool instanceof op&&(2===e.button||2===e.buttons)){var n={element:this.diagram,position:this.currentPosition,count:e.buttons,actualObject:this.eventArgs.actualObject};this.inAction=!1,this.tool.mouseUp(this.eventArgs,n)}else if(!0===this.inAction&&!0===this.isMouseDown&&this.tool instanceof op)this.isMouseDown=!0,this.eventArgs={},this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs);else{this.isMouseDown=!0,this.currentPosition=this.prevPosition=this.getMousePosition(e),this.eventArgs={},this.diagram.endEdit();var o=void 0,r=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action),s=this.objectFinder.findObjectUnderMouse(this.diagram,r,this.action,this.inAction,this.eventArgs,e),a=null;null!==s&&(a=this.diagram.findElementUnderMouse(s,this.currentPosition))&&(o=this.commandHandler.findTarget(a,s)),this.action=this.diagram.findActionToBeDone(s,a,this.currentPosition,o);var l=this.isMetaKey(e);if(l&&e.shiftKey&&this.diagram.connectorEditingToolModule?this.action="SegmentEnd":!l&&!e.shiftKey||Gn(this.diagram)||(this.action="Select"),this.tool=this.diagram.getTool(this.action),this.tool||(this.action="Select",this.tool=this.diagram.getTool(this.action)),this.getMouseEventArgs(this.currentPosition,this.eventArgs),l||e.shiftKey){var h=l&&e.shiftKey?{ctrlKey:l,shiftKey:e.shiftKey}:{ctrlKey:!0};this.eventArgs.info=h}this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs),this.initialEventArgs={source:this.eventArgs.source,sourceWrapper:this.eventArgs.sourceWrapper},this.initialEventArgs.position=this.currentPosition,this.initialEventArgs.info=this.eventArgs.info,this.inAction=!1,"touchstart"===e.type&&(i&&i.length>=2&&(this.touchStartList=jr(this.touchStartList,e,i)),i||e.preventDefault())}this.isForeignObject(e.target)||this.isForeignObject(e.target,!0)||i||e.preventDefault()},e.prototype.mouseMoveExtend=function(e,i){this.tool instanceof op&&this.tool.mouseMove(this.eventArgs),this.diagram.scrollSettings.canAutoScroll?this.checkAutoScroll(e):this.blocked||this.tool.mouseMove(this.eventArgs),this.eventArgs.target&&(this.hoverElement=this.eventArgs.target);var n=!(this.eventArgs.target instanceof fd&&i instanceof fd);this.tool instanceof Gd&&this.diagram.updatePortVisibility(this.hoverElement instanceof fd?this.hoverElement:this.hoverNode,t.PortVisibility.Connect|t.PortVisibility.Hover,n),this.hoverElement instanceof fd&&this.hoverNode instanceof fd&&this.hoverNode&&this.hoverNode.id!==this.hoverElement.id&&this.diagram.updatePortVisibility(this.hoverNode,t.PortVisibility.Connect|t.PortVisibility.Hover,!0),this.hoverElement=n?null:i,this.hoverNode=n?null:i},e.prototype.mouseMove=function(e,i){if(this.focus=!0,to(this.diagram)||Gn(this.diagram)&&!Qn(this.diagram)){this.currentPosition=this.getMousePosition(e);var n=this.diagram.findObjectsUnderMouse(this.currentPosition),o=this.diagram.findObjectUnderMouse(n,this.action,this.inAction);fo(this.diagram,this.currentPosition);var r=!1,s=void 0;if("touchmove"===e.type&&(i=e.touches)&&i.length>1&&(this.touchMoveList=jr(this.touchMoveList,e,i),"PinchZoom"!==this.action&&(r=!0)),!1===Dl.equals(this.currentPosition,this.prevPosition)||this.inAction){if(!1===this.isMouseDown||r){this.eventArgs={};var a=null;null!==o&&(a=this.diagram.findElementUnderMouse(o,this.currentPosition),o!==this.hoverElement?(this.hoverElement&&(this.elementLeave(),this.diagram.updatePortVisibility(this.hoverElement,t.PortVisibility.Hover,!0)),o instanceof fd&&(this.hoverNode=o),this.hoverElement=o,this.elementEnter(this.currentPosition,!1)):this.hoverElement||this.hoverElement!==o||this.elementEnter(this.currentPosition,!0),a&&(s=this.commandHandler.findTarget(a,o))),this.action=this.diagram.findActionToBeDone(o,a,this.currentPosition,s),this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.tool=this.getTool(this.action),this.mouseEvents(),this.tool instanceof $d?this.tool.mouseMove(this.eventArgs):this.tool instanceof op?this.tool.mouseMove(this.eventArgs):i&&this.tool instanceof ep&&this.tool.mouseDown(this.eventArgs),this.updateCursor();var l=!1;(!this.hoverElement||this.tool instanceof ep||!(o instanceof fd)||0!==this.diagram.selectedItems.nodes.length&&ms(this.diagram,this.hoverElement))&&(l=!0),this.diagram.updatePortVisibility(this.hoverElement,t.PortVisibility.Hover,l),null===o&&this.hoverElement&&(this.hoverElement=null,this.elementLeave()),r=!1}else{if(this.eventArgs.position=this.currentPosition,"Drag"===this.action&&!ms(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof Xc&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.mouseEvents(),e.ctrlKey||e.shiftKey){var h=e.ctrlKey&&e.shiftKey?{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey}:{ctrlKey:!0};this.eventArgs.info=h}In(o)&&Mn(o)&&this.initialEventArgs&&this.initialEventArgs.source&&"Select"===this.action&&(!ms(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof Xc&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),o instanceof _c&&(!(o instanceof _c)||ps(this.currentPosition,o.sourcePoint,o.hitPadding)||ps(this.currentPosition,o.targetPoint,o.hitPadding))||(this.action="Drag"),this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs)),this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source),this.updateCursor(),this.inAction=!0,this.initialEventArgs=null,this.mouseMoveExtend(e,o)}this.prevPosition=this.currentPosition,this.isForeignObject(e.target,!0)||e.preventDefault()}}},e.prototype.checkAutoScroll=function(t){var e=this.startAutoScroll(t);if(!e&&this.doingAutoScroll)this.doingAutoScroll=!1,clearInterval(this.timeOutValue);else if(e){if((this.tool instanceof Zd||this.tool instanceof Qd||this.tool instanceof Yd)&&this.inAction){var i=this;this.diagram.scrollSettings.canAutoScroll&&e&&!this.doingAutoScroll&&(this.doingAutoScroll=!0,this.timeOutValue=setInterval(function(n){i.doAutoScroll(e,t,100)},100))}}else this.blocked=!this.tool.mouseMove(this.eventArgs)},e.prototype.mouseUp=function(e){var i;if(i=e.touches,!this.checkEditBoxAsTarget(e)&&to(this.diagram)||Gn(this.diagram)&&!Qn(this.diagram)){if(this.tool&&(!(this.tool instanceof op)||this.tool instanceof op&&2===e.detail)){if(this.diagram.endEdit(),document.getElementById(this.diagram.element.id+"content").focus(),!this.inAction&&3!==e.which&&"Drag"===this.action){this.action="Select";var n=this.diagram.findObjectsUnderMouse(this.currentPosition),o=this.diagram.findObjectUnderMouse(n,this.action,this.inAction),r=!0;!e.ctrlKey&&this.isMouseDown&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1&&1===e.which&&(r=!1,this.commandHandler.clearSelection()),ms(this.diagram,o)&&r||this.commandHandler.selectObjects([o])}if(this.inAction=!1,this.isMouseDown=!1,this.currentPosition=this.getMousePosition(e),this.tool&&(this.tool.prevPosition||this.tool instanceof np)){this.eventArgs.position=this.currentPosition,this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source);var s=this.isMetaKey(e);if(s||e.shiftKey){var a=s&&e.shiftKey?{ctrlKey:s,shiftKey:e.shiftKey}:{ctrlKey:!0};this.eventArgs.info=a}this.eventArgs.clickCount=e.detail,this.tool.mouseUp(this.eventArgs)}if(this.blocked=!1,this.hoverElement){var l=t.PortVisibility.Connect;ms(this.diagram,this.hoverElement)&&(l|=t.PortVisibility.Hover),this.diagram.updatePortVisibility(this.hoverElement,l,!0),this.hoverElement=null}this.touchStartList=null,this.touchMoveList=null,this.tool instanceof tp||(this.tool=null)}i||e.preventDefault(),this.diagram.currentDrawingObject=void 0;var h=this.diagram.selectedItems;if(!this.inAction&&h.wrapper&&h.userHandles.length>0&&this.diagram.renderSelector(!0),!this.inAction&&!this.diagram.currentSymbol){var c={element:this.eventArgs.source||this.diagram,position:this.eventArgs.position,count:e.detail,actualObject:this.eventArgs.actualObject};this.diagram.triggerEvent(t.DiagramEvent.click,c)}this.eventArgs={}}},e.prototype.mouseLeave=function(e){this.tool&&this.inAction&&this.tool.mouseLeave(this.eventArgs),this.eventArgs&&this.eventArgs.source&&(this.diagram.updatePortVisibility(this.eventArgs.source,t.PortVisibility.Hover,!0),this.hoverElement=null),this.tool instanceof Gd&&this.eventArgs&&this.eventArgs.target&&this.eventArgs.target instanceof fd&&(this.diagram.updatePortVisibility(this.eventArgs.target,t.PortVisibility.Hover|t.PortVisibility.Connect,!0),this.hoverElement=null);var i=this.diagram.selectedItems;i&&i.wrapper&&this.diagram.renderSelector(!0),this.isMouseDown=!1,this.focus=!1,this.touchStartList=null,this.touchMoveList=null,this.commandHandler.removeSnap(),this.inAction=!1,this.eventArgs={},this.tool=null,mo(),e.preventDefault()},e.prototype.mouseWheel=function(t){var e=t.wheelDelta>0||-40*t.detail>0,i=this.getMousePosition(t);if(this.diagram.endEdit(),this.diagram.tooltipObject.close(),this.isMetaKey(t))this.diagram.zoom(e?1.2:1/1.2,i),t.preventDefault();else{var n=this.diagram.scroller.horizontalOffset,o=this.diagram.scroller.verticalOffset,r=e?20:-20;this.tool&&this.tool instanceof op&&(this.eventArgs={},this.getMouseEventArgs(i,this.eventArgs),this.eventArgs.position=i,this.tool.mouseWheel(this.eventArgs)),t.shiftKey?this.diagram.scroller.zoom(1,r,0,i):this.diagram.scroller.zoom(1,0,r,i),n===this.diagram.scroller.horizontalOffset&&o===this.diagram.scroller.verticalOffset||t.preventDefault()}},e.prototype.keyDown=function(e){if(!(this.diagram.diagramActions&t.DiagramAction.TextEdit)&&!this.checkEditBoxAsTarget(e)||"Escape"===e.key||27===e.keyCode){var i=void 0,n=e.keyCode?e.keyCode:e.which,o=e.key,r=this.isMetaKey(e);if(this.diagram.commandManager&&this.diagram.commands)for(var s=this.diagram.commands,a=0,l=Object.keys(s);a<l.length;a++){var h=l[a];if((i=this.diagram.commands[h])&&(i.gesture.keyModifiers||i.gesture.key)&&(n===i.gesture.key||o===t.Keys[i.gesture.key]||this.isDeleteKey(o,h))&&(!i.gesture.keyModifiers&&!e.altKey&&!e.shiftKey&&!r||i.gesture.keyModifiers&&(r||e.altKey||e.shiftKey)&&this.altKeyPressed(i.gesture.keyModifiers)&&e.altKey||this.shiftKeyPressed(i.gesture.keyModifiers)&&e.shiftKey||this.ctrlKeyPressed(i.gesture.keyModifiers)&&r)){var c=as(i.canExecute);if(c&&c({keyDownEventArgs:KeyboardEvent,parameter:i.parameter})){e.preventDefault(),"Escape"===e.key&&this.checkEditBoxAsTarget(e)&&document.getElementById(this.diagram.diagramCanvas.id).focus(),i.execute&&as(i.execute)({keyDownEventArgs:KeyboardEvent,parameter:i.parameter});break}}}}},e.prototype.startAutoScroll=function(t){var e=this.getMousePosition(t);e.x*=this.diagram.scroller.currentZoom,e.y*=this.diagram.scroller.currentZoom;var i,n=this.diagram.scrollSettings.autoScrollBorder;return this.diagram.scrollSettings.canAutoScroll&&(e.x+this.diagram.scroller.horizontalOffset+n.right>this.diagram.scroller.viewPortWidth-18?i="right":e.x+this.diagram.scroller.horizontalOffset<n.left?i="left":e.y+this.diagram.scroller.verticalOffset+n.bottom>this.diagram.scroller.viewPortHeight-18?i="bottom":e.y+this.diagram.scroller.verticalOffset<n.top&&(i="top")),i},e.prototype.doAutoScroll=function(t,e,i,n){var o=t;if((this.tool instanceof Zd||this.tool instanceof Qd||this.tool instanceof Yd)&&this.inAction){this.eventArgs.position={x:this.tool.prevPosition.x,y:this.tool.prevPosition.y};var r=this.getMousePosition(e),s=(this.diagram.scrollSettings.autoScrollBorder,0),a=0;switch(o){case"right":this.eventArgs.position.x+=10,s=10;break;case"left":this.eventArgs.position.x-=10,s=-10;break;case"bottom":this.eventArgs.position.y+=10,a=10;break;case"top":this.eventArgs.position.y-=10,a=-10}this.tool.mouseMove(this.eventArgs),this.diagram.scroller.zoom(1,-s,-a,r)}},e.prototype.mouseEvents=function(){for(var e=this.diagram.findObjectsUnderMouse(this.currentPosition),i=0;i<e.length;i++)this.eventArgs.actualObject===e[i]&&e.splice(i,1);var n={targets:e,element:this.eventArgs.source===this.eventArgs.actualObject?void 0:this.eventArgs.source,actualObject:this.eventArgs.actualObject};!this.lastObjectUnderMouse||this.eventArgs.actualObject&&this.lastObjectUnderMouse===this.eventArgs.actualObject||(n.element=this.lastObjectUnderMouse,n.targets=n.actualObject=void 0,this.diagram.triggerEvent(t.DiagramEvent.mouseLeave,n),this.lastObjectUnderMouse=null),(!this.lastObjectUnderMouse&&this.eventArgs.source||this.lastObjectUnderMouse!==this.eventArgs.actualObject)&&(this.lastObjectUnderMouse=this.eventArgs.actualObject,this.diagram.triggerEvent(t.DiagramEvent.mouseEnter,n)),this.eventArgs.actualObject&&this.diagram.triggerEvent(t.DiagramEvent.mouseOver,n)},e.prototype.elementEnter=function(e,i){if(!i){var n=this.hoverElement instanceof fd&&this.hoverElement.constraints&t.NodeConstraints.Tooltip||this.hoverElement instanceof _c&&this.hoverElement.constraints&t.ConnectorConstraints.Tooltip;gi(this.diagram,n?this.hoverElement:void 0);var o=To(this.diagram,e,this.hoverElement);this.diagram.tooltipObject.close(),this.diagram.tooltipObject.offsetX=o.x,this.diagram.tooltipObject.offsetY=o.y,this.diagram.tooltipObject.dataBind(),qn(this.hoverElement,this.diagram)&&this.diagram.tooltipObject.open(this.diagram.element)}},e.prototype.elementLeave=function(){this.diagram.tooltipObject.close()},e.prototype.altKeyPressed=function(e){return!!(e&t.KeyModifiers.Alt)},e.prototype.ctrlKeyPressed=function(e){return!!(e&t.KeyModifiers.Control)},e.prototype.shiftKeyPressed=function(e){return!!(e&t.KeyModifiers.Shift)},e.prototype.scrolled=function(t){this.diagram.updateScrollOffset()},e.prototype.doubleClick=function(e){if(to(this.diagram)){var i=void 0,n=this.diagram.findObjectsUnderMouse(this.currentPosition),o=this.diagram.findObjectUnderMouse(n,this.action,this.inAction);if(null!==o&&to(this.diagram))if(i=this.diagram.findElementUnderMouse(o,this.currentPosition),this.tool&&this.tool instanceof op){var r={source:o||this.diagram,position:this.currentPosition,count:e.detail};this.tool.mouseUp(this.eventArgs,r),this.isMouseDown=!1,this.eventArgs={},this.tool=null,e.preventDefault()}else{var s=this.diagram.commandHandler.getObjectLayer(o.id);if(s&&!s.lock&&s.visible&&!(this.diagram.diagramActions&t.DiagramAction.TextEdit)){var a="";"TextAnnotation"===o.shape.shape&&(a=o.id.split("_textannotation_")[1]),this.diagram.startTextEdit(o,a||(i instanceof ch?i.id.split(o.id+"_")[1]:void 0))}}var l={source:o||this.diagram,position:this.currentPosition,count:e.detail};this.diagram.triggerEvent(t.DiagramEvent.doubleClick,l)}},e.prototype.inputChange=function(t){var e,i,n,o,r,s,a,l,h=document.getElementById(this.diagram.element.id+"_editBox"),c=document.getElementById(this.diagram.element.id+"_editTextBoxDiv"),d=h.value,p=d.split("\n");!(o=this.diagram.selectedItems.nodes[0]?this.diagram.selectedItems.nodes[0]:this.diagram.selectedItems.connectors[0])&&this.tool instanceof tp&&(o=this.diagram.nameTable[this.diagram.activeLabel.parentId]),o&&("Text"!==o.shape.type&&o.annotations.length>0||"Text"===o.shape.type)&&(n=this.diagram.getWrapper(o.wrapper,this.diagram.activeLabel.id),e=(e=o.wrapper.bounds.width>n.bounds.width?o.wrapper.bounds.width:n.bounds.width)>90?e:90,a=dr(n.style,d,void 0,void 0,e),i=Number(h.style.fontSize.split("px")[0]),p.length>1&&""===p[p.length-1]&&(a.height=a.height+i),s=90>(s=a.width)?90:s,r=12>a.height?12:a.height,l=this.diagram.scroller.transform,c.style.left=(n.bounds.center.x+l.tx)*l.scale-s/2-2.5+"px",c.style.top=(n.bounds.center.y+l.ty)*l.scale-r/2-3+"px",c.style.width=s+"px",c.style.height=r+"px",h.style.minHeight="12px",h.style.minWidth="90px",h.style.width=s+"px",h.style.height=r+"px")},e.prototype.isAddTextNode=function(t,e){return!!(this.tool instanceof tp||e)&&(this.tool=null,t&&!Zn(this.diagram)&&(this.diagram.drawingObject=void 0,this.diagram.currentDrawingObject=void 0),!Jo(this.diagram.nodes,t.id)&&!Jo(this.diagram.connectors,t.id))},e.prototype.checkEditBoxAsTarget=function(t){return!(!t.target||t.target.id!==this.diagram.element.id+"_editBox")},e.prototype.getMouseEventArgs=function(t,e,i){e.position=t;var n,o;i?(o=this.diagram.findObjectsUnderMouse(this.currentPosition,i),n=this.diagram.findTargetObjectUnderMouse(o,this.action,this.inAction,e.position,i)):"Drag"===this.action||"ConnectorSourceEnd"===this.action||"SegmentEnd"===this.action||"OrthoThumb"===this.action||"BezierSourceThumb"===this.action||"BezierTargetThumb"===this.action||"ConnectorTargetEnd"===this.action||"Rotate"===this.action||-1!==this.action.indexOf("Resize")?n=this.diagram.selectedItems:(o=this.diagram.findObjectsUnderMouse(this.currentPosition),n=this.diagram.findObjectUnderMouse(o,this.action,this.inAction));var r;return n&&(r=this.diagram.findElementUnderMouse(n,this.currentPosition)),i?(e.target=n,e.targetWrapper=r):(e.source=n,e.sourceWrapper=r),e.actualObject=this.eventArgs.actualObject,e.startTouches=this.touchStartList,e.moveTouches=this.touchMoveList,e},e.prototype.resetTool=function(){this.action="Select",this.hoverElement=null,this.hoverNode=null,this.tool=this.diagram.getTool(this.action),this.updateCursor()},e.prototype.getTool=function(t){switch(t){case"Select":return new Yd(this.commandHandler,!0);case"Drag":return new Zd(this.commandHandler);case"Rotate":return new Kd(this.commandHandler);case"LayoutAnimation":return new ip(this.commandHandler);case"Hyperlink":return new np(this.commandHandler);case"ResizeSouthEast":case"ResizeSouthWest":case"ResizeNorthEast":case"ResizeNorthWest":case"ResizeSouth":case"ResizeNorth":case"ResizeWest":case"ResizeEast":return new Qd(this.commandHandler,t);case"ConnectorSourceEnd":case"ConnectorTargetEnd":case"BezierSourceThumb":case"BezierTargetThumb":return new Gd(this.commandHandler,t);case"SegmentEnd":case"OrthoThumb":return new sp(this.commandHandler,t);case"Draw":var e=xo(this.diagram.drawingObject);if("Node"===e&&"Text"===this.diagram.drawingObject.shape.type)return new tp(this.commandHandler);if("Node"===e&&"Polygon"===this.diagram.drawingObject.shape.shape&&!this.diagram.drawingObject.shape.points)return new op(this.commandHandler);if("Node"===e||"Node"===e&&"Polygon"===this.diagram.drawingObject.shape.shape&&this.diagram.drawingObject.shape.points)return new Jd(this.commandHandler,this.diagram.drawingObject);if("Connector"===e)return new $d(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);break;case"Pan":return new ep(this.commandHandler,!1);case"PinchZoom":return new ep(this.commandHandler,!0);case"PortDrag":return new Zd(this.commandHandler,"Port");case"PortDraw":return new $d(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject)}return null},e.prototype.getCursor=function(t){return fs(t,this.diagram.selectedItems.rotateAngle)},e.prototype.findElementUnderMouse=function(t,e){return this.objectFinder.findElementUnderSelectedItem(t,e)},e.prototype.findObjectsUnderMouse=function(t,e){return this.objectFinder.findObjectsUnderMouse(t,this.diagram,this.eventArgs,e)},e.prototype.findObjectUnderMouse=function(t,e,i){return this.objectFinder.findObjectUnderMouse(this.diagram,t,e,i,this.eventArgs,this.currentPosition)},e.prototype.findTargetUnderMouse=function(t,e,i,n,o){return this.objectFinder.findObjectUnderMouse(this.diagram,t,e,i,this.eventArgs,n,o)},e.prototype.findActionToBeDone=function(t,e,i,n){return ls(t,e,this.currentPosition,this.diagram,this.touchStartList,this.touchMoveList,n)},e}(),lp=function(){function t(){}return t.prototype.findObjectsUnderMouse=function(t,e,i,n,o){var r=[];n&&n instanceof Xc&&n.nodes.length+n.connectors.length===1&&(n=n.nodes[0]||n.connectors[0]).children&&0===n.children.length&&(i.actualObject=n);for(var s,a,l,h,c,d={},p=0,u=e.spatialSearch.findObjects(new Rl(t.x-50,t.y-50,100,100));p<u.length;p++){var g=t;if(a=(S=u[p]).wrapper.outerBounds,((S!==n||e.currentDrawingObject instanceof _c)&&S instanceof _c?S!==e.currentDrawingObject:S.wrapper.visible)&&(w=e.commandHandler.getObjectLayer(S.id))&&!w.lock&&w.visible){if(c=d[w.zIndex]=d[w.zIndex]||[],S.rotateAngle){s=S.wrapper,Tt(h=Et(),-(s.rotateAngle+s.parentTransform),S.offsetX,S.offsetY),g=Pt(h,t),a=s.corners;for(var m=0,f=s.children;m<f.length;m++)l=f[m],a.uniteRect(l.corners)}if((!n||!1===ms(e,S))&&Dn(S,e)&&(S instanceof _c?Eo(S,t):a.containsPoint(g))){var v=S instanceof _c?S.hitPadding||0:0;this.findElementUnderMouse(S,t,v)&&(S instanceof _c&&e.bpmnModule&&(S=e.bpmnModule.findInteractableObject(S,e)),tr(S,"zIndex",c))}}}for(var y=0,b=e.layers;y<b.length;y++)for(var w=b[y],x=0,C=r=r.concat(d[w.zIndex]||[]);x<C.length;x++){var S=C[x];"Bpmn"!==S.shape.type||!S.processId||e.eventHandler.tool instanceof Zd&&!(e.eventHandler.tool instanceof Zd&&Un(S))||(O=r.indexOf(e.nameTable[S.processId]))>-1&&r.splice(O,1)}for(var E=0;E<r.length;E++){var P=e.nameTable[r[E].parentId];if(P)for(var L=this.findElementUnderMouse(P,t),T=0;T<P.ports.length;T++)if(L.id.match("_"+P.ports[T].id+"$")){var k=P.ports[T];if(ao(k,e)||so(k,e))return r}for(;P;){var O=r.indexOf(P);if(-1===O)break;r.splice(O,1),P=e.nameTable[P.parentId]}}return r},t.prototype.isTarget=function(t,e,i){var n,o=e.selectedItems.connectors[0];return!(n="ConnectorSourceEnd"===i?e.nameTable[o.targetID]:n=e.nameTable[o.sourceID])||(n.processId||t.processId)&&n.processId===t.processId||n.processId!==t.processId&&(t=null),t},t.prototype.findObjectUnderMouse=function(t,e,i,n,o,r,s){var a=null;if(0!==e.length)if(s&&s instanceof Xc&&s.nodes.length+s.connectors.length===1&&(s=s.nodes[0]||s.connectors[0]),"ConnectorSourceEnd"===i&&s||"PortDraw"===i||(Kn(t)||Zn(t))&&wd(t.drawingObject)===_c){for(var l=t.selectedItems.connectors[0],h=e.length-1;h>=0;h--)if(e[h]instanceof fd&&_n(e[h]))return a=e[h],l&&(a=this.isTarget(a,t,i)),o.actualObject=a,a}else if("ConnectorTargetEnd"===i&&s){for(h=e.length-1;h>=0;h--)if(e[h]instanceof fd&&Vn(e[h]))return a=e[h],a=this.isTarget(a,t,i),o.actualObject=a,a}else{if(s&&("Drag"===i||t.eventHandler.tool instanceof Zd)){for(var c=0,h=0;h<e.length;h++){var d=e[h];s!==d&&(d instanceof _c||!r||d.wrapper.bounds.containsPoint(r))&&Un(d)&&(a?(a=c>=d.zIndex?a:d,c=Math.max(c,d.zIndex)):c=(a=d).zIndex)}return a&&"Bpmn"===a.shape.type&&(a=t.selectedItems.nodes.length>0&&"Bpmn"===t.selectedItems.nodes[0].shape.type?a:null),a&&(o.actualObject=a),a}if("Select"===i&&t.eventHandler.tool){for(h=e.length-1;h>=0;h--)if(e[h]instanceof _c&&e[h-1]instanceof fd&&e[h-1].ports){if((m=this.findTargetElement(e[h-1].wrapper,r,void 0))&&(m.id.match("_icon_content_shape$")||m.id.match("_icon_content_rect$")))return e[h-1];for(var p=0;p<e[h-1].ports.length;p++)if(m&&m.id.match("_"+e[h-1].ports[p].id+"$")&&so(e[h-1].ports[p],t))return e[h-1]}if(a=e[e.length-1],o.actualObject=a,a.parentId)for(var u=a,g=ms(t,u);u&&(!ms(t,u)||g);)a=u,u=t.nameTable[u.parentId]}else if("Pan"===i||"LayoutAnimation"===i){for(h=e.length-1;h>=0;h--)if(e[h]instanceof fd){var m=this.findTargetElement(e[h].wrapper,r,void 0);if("LayoutAnimation"===i||"Pan"===i||m&&(m.id.match("_icon_content_shape$")||m.id.match("_icon_content_rect$")))return e[h]}}else a=e[e.length-1],o&&a&&(o.actualObject=a)}return a},t.prototype.findElementUnderSelectedItem=function(t,e){return t instanceof Xc?1!==t.nodes.length||t.connectors&&t.connectors.length?t.nodes&&!t.nodes.length||1!==t.connectors.length?null:this.findElementUnderMouse(t.connectors[0],e):this.findElementUnderMouse(t.nodes[0],e):this.findElementUnderMouse(t,e)},t.prototype.findElementUnderMouse=function(t,e,i){return this.findTargetElement(t.wrapper,e,i)},t.prototype.findTargetElement=function(t,e,i){for(var n=t.children.length-1;n>=0;n--){var o=t.children[n];if(o&&o.outerBounds.containsPoint(e)){if(o instanceof oh){var r=this.findTargetElement(o,e);if(r)return r}if(o.bounds.containsPoint(e))return o}}return t.bounds.containsPoint(e,i)&&"none"!==t.style.fill?t:null},t}(),hp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},dp=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;return r.objectZIndex=-1,r.zIndexTable={},r.objects=[],r}return hp(e,t),cp([Y("")],e.prototype,"id",void 0),cp([Y(!0)],e.prototype,"visible",void 0),cp([Y(!1)],e.prototype,"lock",void 0),cp([Y()],e.prototype,"objects",void 0),cp([Y()],e.prototype,"addInfo",void 0),cp([Y(-1)],e.prototype,"zIndex",void 0),e}(xa),pp=function(){function e(t){this.clipboardData={},this.connectorsTable=[],this.processTable={},this.childTable={},this.parentTable={},this.diagram=t}return Object.defineProperty(e.prototype,"snappingModule",{get:function(){return this.diagram.snappingModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"layoutAnimateModule",{get:function(){return this.diagram.layoutAnimateModule},enumerable:!0,configurable:!0}),e.prototype.startTransaction=function(t){this.state={element:this.diagram.selectedItems,backup:null},t&&this.diagram.protectPropertyChange(!0),xr(this.diagram.element.id).style.pointerEvents="none"},e.prototype.endTransaction=function(t){this.state=null,t&&this.diagram.protectPropertyChange(!1),xr(this.diagram.element.id).style.pointerEvents="all"},e.prototype.showTooltip=function(t,e,i,n,o){var r=this;o&&(this.diagram.tooltipObject.position="BottomCenter",this.diagram.tooltipObject.animation={open:{delay:0,duration:0}},this.diagram.tooltip.relativeMode="ConnectTool"===n?"Mouse":"Object",this.diagram.tooltipObject.openDelay=0,this.diagram.tooltipObject.closeDelay=0),this.diagram.tooltipObject.content=i;var s=To(this.diagram,{x:e.x,y:e.y},t);this.diagram.tooltipObject.offsetX=s.x+("ConnectTool"===n?10:0),this.diagram.tooltipObject.offsetY=s.y+10,this.diagram.tooltipObject.dataBind(),o&&setTimeout(function(){r.diagram.tooltipObject.open(r.diagram.element)},1)},e.prototype.closeTooltip=function(){this.diagram.tooltipObject.close()},e.prototype.canEnableDefaultTooltip=function(){return!!(this.diagram.selectedItems.constraints&t.SelectorConstraints.ToolTip)},e.prototype.updateSelector=function(){this.diagram.updateSelector()},e.prototype.triggerEvent=function(e,i){if(e===t.DiagramEvent.drop||e===t.DiagramEvent.positionChange||e===t.DiagramEvent.connectionChange){if(this.diagram.currentSymbol)return;if(e===t.DiagramEvent.drop&&(i.source=this.diagram),this.diagram.currentDrawingObject)return}this.diagram.triggerEvent(e,i)},e.prototype.dragOverElement=function(e,i){if(this.diagram.currentSymbol){var n={element:e.source,target:e.target,mousePosition:i,diagram:this.diagram};this.triggerEvent(t.DiagramEvent.dragOver,n)}},e.prototype.disConnect=function(e,i){var n,o={},r={};if(e instanceof Xc?n=e.connectors[0]:e instanceof _c&&this.diagram.currentDrawingObject&&(n=this.diagram.currentDrawingObject),e&&n&&(gs(this.diagram)||this.diagram.currentDrawingObject))if(!i||"ConnectorSourceEnd"!==i&&"ConnectorTargetEnd"!==i){if("OrthoThumb"!==i&&"SegmentEnd"!==i&&(n.sourceID||n.targetID)){o={sourceID:n.sourceID,sourcePortID:n.sourcePortID,targetID:n.targetID,targetPortID:n.targetPortID},n.sourceID="",n.sourcePortID="",n.targetID="",n.targetPortID="";var s={connector:n,oldValue:o,newValue:r={sourceID:n.sourceID,sourcePortID:n.sourcePortID,targetID:n.targetID,targetPortID:n.targetPortID},cancel:!1,state:"Changing",connectorEnd:i};this.triggerEvent(t.DiagramEvent.connectionChange,s),s.cancel?(n.sourceID=o.sourceID,n.sourcePortID=o.sourcePortID,n.targetID=o.targetID,n.targetPortID=o.targetPortID):(this.diagram.connectorPropertyChange(n,o,r),this.diagram.updateDiagramObject(n),s={connector:n,oldValue:o,newValue:r,cancel:!1,state:"Changed",connectorEnd:i},this.triggerEvent(t.DiagramEvent.connectionChange,s))}}else{var a="ConnectorSourceEnd"===i?"sourceID":"targetID",l="ConnectorSourceEnd"===i?"sourcePortID":"targetPortID";n[a]&&(o[a]=n[a],n[a]="",r[a]=n[a],(n.sourcePortID||n.targetPortID)&&(o[l]=n[l],n[l]="",r[l]=n[l]),this.connectionEventChange(n,o,r,i))}},e.prototype.connectionEventChange=function(e,i,n,o){var r="ConnectorSourceEnd"===o?"sourceID":"targetID",s="ConnectorSourceEnd"===o?"sourcePortID":"targetPortID",a={connector:e,oldValue:{nodeId:i[r],portId:i[s]},newValue:{nodeId:n[r],portId:n[s]},cancel:!1,state:"Changing",connectorEnd:o};this.triggerEvent(t.DiagramEvent.connectionChange,a),a.cancel?(e[r]=i[r],e[s]=i[s],n=i):(this.diagram.connectorPropertyChange(e,i,n),this.diagram.updateDiagramObject(e),a={connector:e,oldValue:{nodeId:i[r],portId:i[s]},newValue:{nodeId:n[r],portId:n[s]},cancel:!1,state:"Changed",connectorEnd:o},this.triggerEvent(t.DiagramEvent.connectionChange,a))},e.prototype.findTarget=function(t,e,i){if(e instanceof fd){if(t&&t.id===e.id+"_content")return e;if(i&&"Bpmn"===e.shape.type&&"Activity"===e.shape.shape&&"Transaction"===e.shape.activity.subProcess.type){var n=e.shape.activity.subProcess.transaction;if(n.success.visible&&0===t.id.indexOf(e.id+"_success"))return n.success;if(n.cancel.visible&&0===t.id.indexOf(e.id+"_cancel"))return n.cancel;if(n.failure.visible&&0===t.id.indexOf(e.id+"_failure"))return n.failure}if(t instanceof sh)for(var o=0;o<e.ports.length;o++){var r=e.ports[o];if(t.id===e.id+"_"+r.id)return r}}return e},e.prototype.canDisconnect=function(t,e,i,n){var o;e.source instanceof Xc?o=e.source.connectors[0]:e.source instanceof _c&&this.diagram.currentDrawingObject&&(o=this.diagram.currentDrawingObject);this.findTarget(e.targetWrapper,e.target,"ConnectorSourceEnd"===t);var r="ConnectorSourceEnd"===t?"sourceID":"targetID",s="ConnectorSourceEnd"===t?"sourcePortID":"targetPortID";return o[r]!==n||o[s]!==i},e.prototype.connect=function(e,i){var n,o,r,s={},a={};i.source instanceof Xc?r=i.source.connectors[0]:i.source instanceof _c&&this.diagram.currentDrawingObject&&(r=this.diagram.currentDrawingObject);var l=this.findTarget(i.targetWrapper,i.target,"ConnectorSourceEnd"===e),h="ConnectorSourceEnd"===e?"sourceID":"targetID",c="ConnectorSourceEnd"===e?"sourcePortID":"targetPortID";if(l instanceof fd)a[h]=r[h],r[h]=l.id,s[h]=r[h],a[c]=r[c],this.connectionEventChange(r,a,s,e);else{n=r[h],o=r[c],r[c]=l.id,r[h]=i.target.id,s[h]=r[h],s[c]=r[c];var d={connector:r,oldValue:{nodeId:n,portId:o},newValue:{nodeId:s[h],portId:s[c]},cancel:!1,state:"Changing",connectorEnd:e};this.triggerEvent(t.DiagramEvent.connectionChange,d),d.cancel?(r[h]=n,r[c]=o,s[h]=n,s[c]=o):(this.diagram.connectorPropertyChange(r,{},s),this.diagram.updateDiagramObject(r),d={connector:r,oldValue:{nodeId:n,portId:o},newValue:{nodeId:s[h],portId:s[c]},cancel:!1,state:"Changed",connectorEnd:e},this.triggerEvent(t.DiagramEvent.connectionChange,d))}this.renderHighlighter(i,void 0,"ConnectorSourceEnd"===e)},e.prototype.cut=function(){this.clipboardData.pasteIndex=0,this.diagram.undoRedoModule&&this.diagram.historyList.startGroupAction(),this.clipboardData.clipObject=this.copyObjects(),this.diagram.undoRedoModule&&this.diagram.historyList.endGroupAction(),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()},e.prototype.addLayer=function(t,e){t.id=t.id||qr(),t.zIndex=this.diagram.layers.length,(t=new dp(this.diagram,"layers",t,!0)).objectZIndex=-1,t.zIndexTable={},this.diagram.layers.push(t),this.diagram.layerZIndexTable[t.zIndex]=t.id,this.diagram.activeLayer=t;t.objects;if(e)for(var i=0;i<e.length;i++)this.diagram.add(e[i])},e.prototype.getObjectLayer=function(t){for(var e=this.diagram.layers,i=0;i<e.length;i++)if(e[i].objects.indexOf(t)>-1)return e[i];return this.diagram.activeLayer},e.prototype.getLayer=function(t){for(var e=this.diagram.layers,i=0;i<e.length;i++)if(e[i].id===t)return e[i]},e.prototype.removeLayer=function(t){var e=this.getLayer(t);if(e){for(var i=this.diagram.layers.indexOf(e),n=e.objects,o=n.length-1;o>=0;o--)this.diagram.unSelect(this.diagram.nameTable[n[o]]),this.diagram.remove(this.diagram.nameTable[n[o]]),"default_layer"!==e.id&&this.diagram.activeLayer.id===t&&(this.diagram.activeLayer=this.diagram.layers[this.diagram.layers.length-1]);delete this.diagram.layerZIndexTable[e.zIndex],this.diagram.layers.splice(i,1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer()}},e.prototype.moveObjects=function(t,e){var i=this.getLayer(e)||this.diagram.activeLayer;this.diagram.setActiveLayer(i.id);for(var n,o=0,r=t;o<r.length;o++){var s=r[o];this.getObjectLayer(s).objects.indexOf(s)>-1&&(n=this.diagram.nameTable[s],this.diagram.unSelect(n),this.diagram.remove(this.diagram.nameTable[s]),this.diagram.add(n))}},e.prototype.cloneLayer=function(t){this.diagram.layers;var e=this.getLayer(t);if(e){var i=[],n={id:t+"_"+qr(),objects:[],visible:!0,lock:!1};this.addLayer(n),n.zIndex=this.diagram.layers.length-1;for(var o=0,r=e.objects;o<r.length;o++){var s=r[o];i.push(this.diagram.nameTable[s])}this.paste(i)}},e.prototype.copy=function(){return this.clipboardData.pasteIndex=1,this.clipboardData.clipObject=this.copyObjects(),this.clipboardData.clipObject},e.prototype.copyObjects=function(){var t=[],e=[];if(this.clipboardData.childTable={},this.diagram.selectedItems.connectors.length>0){t=this.diagram.selectedItems.connectors;for(n=0;n<t.length;n++){var i=Yr(t[n]);e.push(i)}}if(this.diagram.selectedItems.nodes.length>0){t=t.concat(this.diagram.selectedItems.nodes);for(var n=0;n<this.diagram.selectedItems.nodes.length;n++){var o=Yr(this.diagram.selectedItems.nodes[n]);this.copyProcesses(o),e.push(Yr(o));var r=Et();if(Tt(r,-o.rotateAngle,o.offsetX,o.offsetY),o.children){for(var s=this.clipboardData.childTable,a=void 0,l=[],h=this.getAllDescendants(o,l,!0),c=0;c<h.length;c++){var d=s[(a=this.diagram.nameTable[h[c].id]).id]=Yr(a),p=Pt(r,{x:d.wrapper.offsetX,y:d.wrapper.offsetY});a instanceof fd&&(d.offsetX=p.x,d.offsetY=p.y,d.rotateAngle-=o.rotateAngle)}this.clipboardData.childTable=s}}}if(0===this.clipboardData.pasteIndex){this.startGroupAction();for(var u=0,g=t;u<g.length;u++){var m=g[u];this.diagram.nameTable[m.id]&&this.diagram.remove(m)}this.endGroupAction()}return this.sortByZIndex(e,"zIndex"),e},e.prototype.copyProcesses=function(t){if("Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0){for(var e=0,i=t.shape.activity.subProcess.processes;e<i.length;e++){var n=i[e];this.processTable[n]=Yr(this.diagram.nameTable[n]),this.processTable[n].shape.activity.subProcess.processes&&this.processTable[n].shape.activity.subProcess.processes.length>0&&this.copyProcesses(this.processTable[n])}this.clipboardData.processTable=this.processTable}},e.prototype.group=function(){var e=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|t.DiagramAction.Group;var i=[],n={};n.id="group"+qr(),(n=new fd(this.diagram,"nodes",n,!0)).children=[],i=(i=this.diagram.selectedItems.nodes).concat(this.diagram.selectedItems.connectors);for(var o=0;o<i.length;o++)i[o].parentId||n.children.push(i[o].id);this.diagram.add(n);var r={type:"Group",undoObject:n,redoObject:n,category:"Internal"};this.addHistoryEntry(r),this.diagram.diagramActions=this.diagram.diagramActions&~t.DiagramAction.Group,this.diagram.protectPropertyChange(e)},e.prototype.unGroup=function(e){var i=this.diagram.isProtectedOnChange;this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|t.DiagramAction.Group;var n=[];e?n.push(e):n=this.diagram.selectedItems.nodes;for(var o=0;o<n.length;o++){var r=n[o],s={type:"UnGroup",undoObject:Yr(r),redoObject:Yr(r),category:"Internal"};if(this.diagram.diagramActions&t.DiagramAction.UndoRedo||this.addHistoryEntry(s),r.children){for(var a=this.diagram.nameTable[r.parentId],l=r.children.length-1;l>=0;l--)this.diagram.nameTable[r.children[0]].parentId="",this.diagram.deleteChild(this.diagram.nameTable[r.children[0]],r),r.parentId&&r.children[0]&&this.diagram.addChild(a,r.children[0]);r.parentId&&this.diagram.deleteChild(r,a)}this.diagram.removeNode(r),this.clearSelection()}this.diagram.diagramActions=this.diagram.diagramActions&~t.DiagramAction.Group,this.diagram.protectPropertyChange(i)},e.prototype.paste=function(t){if(t||this.clipboardData.clipObject){this.diagram.protectPropertyChange(!0);var e=t?this.getNewObject(t):this.clipboardData.clipObject;if(e){var i=1!==e.length,n=!1,o={},r={};0!==this.clipboardData.pasteIndex&&this.clearSelection(),this.diagram.undoRedoModule&&(n=!0,this.diagram.historyList.startGroupAction());for(var s=0,a=e;s<a.length;s++)o[(h=a[s]).id]=h;for(var l=0;l<e.length;l++){var h=e[l];if(wd(h)===_c){var c=Yr(h),d=c.sourceID;c.sourceID="",o[d]&&r[d]&&(c.sourceID=r[d]),d=c.targetID,c.targetID="",o[d]&&r[d]&&(c.targetID=r[d]);var p=this.cloneConnector(c,i);r[h.id]=p.id}else{var u=this.cloneNode(h,i);if(u){r[h.id]=u.id;var g=h.inEdges;if(g)for(var m=0,f=g;m<f.length;m++)o[b=f[m]]&&r[b]&&((w=this.diagram.nameTable[r[b]]).targetID=r[h.id],this.diagram.connectorPropertyChange(w,{targetID:""},{targetID:w.targetID}));if(g=h.outEdges)for(var v=0,y=g;v<y.length;v++){var b=y[v];if(o[b]&&r[b]){var w=this.diagram.nameTable[r[b]];w.sourceID=r[h.id],this.diagram.connectorPropertyChange(w,{sourceID:""},{sourceID:w.sourceID})}}}}}!0===n&&(this.diagram.historyList.endGroupAction(),n=!1),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.clipboardData.pasteIndex++,this.diagram.protectPropertyChange(!1)}}},e.prototype.getNewObject=function(t){var e,i=[];this.clipboardData.pasteIndex=1;for(var n=0;n<t.length;n++)e=Yr(t[n]),i.push(e);return i},e.prototype.cloneConnector=function(t,e){var i,n=Yr(t);return this.translateObject(n),n.zIndex=-1,i=this.diagram.add(n),this.selectObjects([i],e),i},e.prototype.cloneNode=function(t,e,i){var n,o,r={},s=Yr(t);t.shape&&"Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length&&(o=s.shape.activity.subProcess.processes,s.zIndex=-1,s.shape.activity.subProcess.processes=[]),!t.children||!t.children.length||i&&i.length?(this.translateObject(s),s.zIndex=-1,i&&(s.children=i),n=this.diagram.add(s)):n=this.cloneGroup(t,e);for(var a=0,l=Object.keys(r);a<l.length;a++){var h=l[a];this.diagram.add(r[h])}return o&&o.length&&(n.shape.activity.subProcess.processes=o,this.cloneSubProcesses(n)),n&&this.selectObjects([n],e),n},e.prototype.cloneSubProcesses=function(t){var e=[],i={};if("Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length)for(var n=t.shape.activity.subProcess.processes,o=0;o<n.length;o++){for(var r=this.diagram.nameTable[n[o]]||this.clipboardData.processTable[n[o]],s=0,a=r.outEdges;s<a.length;s++){c=a[s];e.indexOf(c)<0&&e.push(c)}for(var l=0,h=r.inEdges;l<h.length;l++){var c=h[l];e.indexOf(c)<0&&e.push(c)}var d=Yr(this.clipboardData.processTable[n[o]]);d.processId=t.id;var p=this.cloneNode(d,!1);i[n[o]]=p.id,n[o]=p.id,this.diagram.addProcess(p,t.id);for(var u=0,g=e;u<g.length;u++){var m=g[u],f=Yr(this.diagram.nameTable[m]||this.diagram.connectorTable[m]);i[f.sourceID]&&i[f.targetID]&&(f.zIndex=-1,f.id+=qr(),f.sourceID=i[f.sourceID],f.targetID=i[f.targetID],e.splice(e.indexOf(m),1),this.diagram.add(f))}}},e.prototype.cloneGroup=function(t,e){var i=[],n=[];if(n=n.concat(t.children),this.clipboardData.childTable)for(var o=0;o<n.length;o++){var r=this.clipboardData.childTable[n[o]];if(r){var s=void 0;s=wd(r)===_c?this.cloneConnector(r,e):this.cloneNode(r,e),i.push(s.id)}}return this.cloneNode(t,e,i)},e.prototype.translateObject=function(t){t.id+=qr();var e=10*this.clipboardData.pasteIndex;if(wd(t)===_c){if(t.sourcePoint={x:t.sourcePoint.x+e,y:t.sourcePoint.y+e},t.targetPoint={x:t.targetPoint.x+e,y:t.targetPoint.y+e},"Bezier"===t.type)for(var i=t.segments,n=0;n<i.length;n++)Dl.isEmptyPoint(i[n].point1)||(i[n].point1={x:i[n].point1.x+e,y:i[n].point1.y+e}),Dl.isEmptyPoint(i[n].point2)||(i[n].point2={x:i[n].point2.x+e,y:i[n].point2.y+e});if(("Straight"===t.type||"Bezier"===t.type)&&t.segments&&t.segments.length>0)for(var i=t.segments,n=0;n<i.length-1;n++)i[n].point.x+=e,i[n].point.y+=e}else t.offsetX+=e,t.offsetY+=e},e.prototype.drawObject=function(t){var e,i;i=Yr(this.diagram.drawingObject);for(var n=0,o=Object.keys(t);n<o.length;n++){var r=o[n];i[r]=t[r]}return wd(this.diagram.drawingObject)===fd?((e=new fd(this.diagram,"nodes",i,!0)).id=(this.diagram.drawingObject.id||"node")+qr(),this.diagram.initObject(e)):((e=new _c(this.diagram,"connectors",i,!0)).id=(this.diagram.drawingObject.id||"connector")+qr(),this.diagram.initObject(e)),this.diagram.updateDiagramObject(e),this.diagram.currentDrawingObject=e,e},e.prototype.addObjectToDiagram=function(e){var i;this.diagram.removeFromAQuad(e),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[e.id]),delete this.diagram.nameTable[e.id],i=this.diagram.add(e),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.selectObjects([i]),e&&!Zn(this.diagram)&&(this.diagram.tool&=~t.DiagramTools.DrawOnce,this.diagram.currentDrawingObject=void 0)},e.prototype.addText=function(t,e){var i=this.diagram.findElementUnderMouse(t,e);this.diagram.startTextEdit(t,i instanceof ch?i.id.split("_")[1]:void 0)},e.prototype.selectObjects=function(e,i,n){var o={oldValue:n||[],newValue:e,cause:this.diagram.diagramActions,state:"Changing",type:"Addition",cancel:!1};this.diagram.triggerEvent(t.DiagramEvent.selectionChange,o);var r=Yn(this.diagram),s=Xn(this.diagram);if(s||r){if(!r&&(e.length>1||i&&1===e.length)){if(1!==e.length)return;this.clearSelection()}if(!(s||1!==e.length||i&&us(this.diagram)))return void this.clearSelection()}if(!o.cancel){for(var a=0;a<e.length;a++){var l=e[a];if(!0,us(this.diagram)){if((a>0||i)&&l.children&&!l.parentId)for(var h=0;h<this.diagram.selectedItems.nodes.length;h++){var c=this.diagram.nameTable[this.diagram.selectedItems.nodes[h].parentId];c&&(c=this.findParent(c))&&l.id===c.id&&this.selectGroup(l)}this.selectProcesses(l),this.selectBpmnSubProcesses(l)&&this.select(l,a>0||i,!0)}else this.select(l,a>0||i,!0)}o={oldValue:n||[],newValue:e,cause:this.diagram.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.diagram.triggerEvent(t.DiagramEvent.selectionChange,o),this.diagram.renderSelector(i||e&&e.length>1)}},e.prototype.findParent=function(t){return t.parentId&&(t=this.diagram.nameTable[t.parentId],this.findParent(t)),t},e.prototype.selectProcesses=function(t){if(this.hasProcesses(t))for(var e=t.shape.activity.subProcess.processes,i=0;i<e.length;i++){var n=this.diagram.nameTable[e[i]];this.hasProcesses(n)&&this.selectObjects([n],!0),this.unSelect(n)}},e.prototype.selectGroup=function(t){for(var e=0;e<t.children.length;e++){var i=this.diagram.nameTable[t.children[e]];i.children&&this.selectGroup(i),this.unSelect(this.diagram.nameTable[t.children[e]])}},e.prototype.selectBpmnSubProcesses=function(t){var e,i=!0;if(t.processId)i=!ms(this.diagram,this.diagram.nameTable[t.processId])&&this.selectBpmnSubProcesses(this.diagram.nameTable[t.processId]);else if(t instanceof _c&&(t.sourceID&&this.diagram.nameTable[t.sourceID]&&this.diagram.nameTable[t.sourceID].processId&&(e=this.diagram.nameTable[t.sourceID].processId),t.targetID&&this.diagram.nameTable[t.targetID]&&this.diagram.nameTable[t.targetID].processId&&(e=this.diagram.nameTable[t.targetID].processId),e)){if(ms(this.diagram,this.diagram.nameTable[e]))return!1;i=this.selectBpmnSubProcesses(this.diagram.nameTable[e])}return i},e.prototype.hasProcesses=function(t){return!!(t&&"Bpmn"===t.shape.type&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0)},e.prototype.select=function(t,e,i){var n=this.getObjectLayer(t.id);if(Mn(t)&&!(t instanceof Xc)&&!ms(this.diagram,t)&&n&&!n.lock&&n.visible&&t.wrapper.visible){(e=!!us(this.diagram)&&e)||this.clearSelection();var o=this.diagram.selectedItems;t instanceof fd?o.nodes.push(t):o.connectors.push(t),e?(o.wrapper.rotateAngle=o.rotateAngle=0,o.wrapper.children.push(t.wrapper)):(o.init(this.diagram),1===o.nodes.length&&0===o.connectors.length&&(o.rotateAngle=o.nodes[0].rotateAngle,o.wrapper.rotateAngle=o.nodes[0].rotateAngle,o.wrapper.pivot=o.nodes[0].pivot)),i||this.diagram.renderSelector(e)}},e.prototype.unSelect=function(e){var i=[];i.push(e);var n={oldValue:i,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};if(this.diagram.currentSymbol||this.diagram.triggerEvent(t.DiagramEvent.selectionChange,n),ms(this.diagram,e)){var o=this.diagram.selectedItems,r=void 0;e instanceof fd?(r=o.nodes.indexOf(e,0),o.nodes.splice(r,1)):(r=o.connectors.indexOf(e,0),o.connectors.splice(r,1)),(n={oldValue:i,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1}).cancel||(r=o.wrapper.children.indexOf(e.wrapper,0),o.wrapper.children.splice(r,1),this.diagram.updateSelector(),this.diagram.currentSymbol||this.diagram.triggerEvent(t.DiagramEvent.selectionChange,n))}},e.prototype.getChildElements=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];n.children&&n.children.length>0?e.concat(this.getChildElements(n.children)):(e.push(n.id),n instanceof ch&&e.push(n.id+"_text"))}return e},e.prototype.moveSvgNode=function(t,e){var i=yr(e+"_groupElement"),n=yr(t+"_groupElement");i.parentNode.insertBefore(n,i)},e.prototype.sendLayerBackward=function(t){var e=this.getLayer(t);if(e&&0!==e.zIndex){var i=e.zIndex;if("SVG"===this.diagram.mode){var n=e.objects,o=this.getLayer(this.diagram.layerZIndexTable[i-1]).objects[0];if(o)for(var r=0,s=n;r<s.length;r++){var a=s[r];this.moveSvgNode(a,o)}}var l=this.getLayer(this.diagram.layerZIndexTable[i-1]);l.zIndex=l.zIndex+1,e.zIndex=e.zIndex-1;var h=this.diagram.layerZIndexTable[i];this.diagram.layerZIndexTable[i]=this.diagram.layerZIndexTable[i-1],this.diagram.layerZIndexTable[i-1]=h,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}},e.prototype.bringLayerForward=function(t){var e=this.getLayer(t);if(e&&e.zIndex<this.diagram.layers.length-1){var i=e.zIndex;if("SVG"===this.diagram.mode)for(var n=this.getLayer(this.diagram.layerZIndexTable[i+1]).objects[0],o=0,r=e.objects;o<r.length;o++){var s=r[o];n&&this.moveSvgNode(n,s)}var a=this.getLayer(this.diagram.layerZIndexTable[i+1]);a.zIndex=a.zIndex-1,e.zIndex=e.zIndex+1;var l=this.diagram.layerZIndexTable[i];this.diagram.layerZIndexTable[i]=this.diagram.layerZIndexTable[i+1],this.diagram.layerZIndexTable[i+1]=l,"Canvas"===this.diagram.mode&&this.diagram.refreshDiagramLayer()}},e.prototype.sendToBack=function(){if(us(this.diagram)){for(var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.nameTable[t].zIndex,i=this.diagram.layers.indexOf(this.getObjectLayer(t)),n=this.diagram.layers[i].zIndexTable,o=e;o>0;o--)n[o]&&(n[o-1]?(n[o]=n[o-1],this.diagram.nameTable[n[o]].zIndex=o):(n[o-1]=n[o],this.diagram.nameTable[n[o-1]].zIndex=o,delete n[o]));if(n[0]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=0,"SVG"===this.diagram.mode){for(var r=n[o=1];!r&&o<e;)r=n[++o];this.moveSvgNode(t,r)}else this.diagram.refreshCanvasLayers()}},e.prototype.bringToFront=function(){if(us(this.diagram)){for(var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.layers.indexOf(this.getObjectLayer(t)),i=this.diagram.layers[e].zIndexTable,n=Number(Object.keys(i).sort(function(t,e){return Number(t)-Number(e)}).reverse()[0]),o=this.diagram.nameTable[t].zIndex;o<n;o++)i[o]&&(i[o+1]?(i[o]=i[o+1],this.diagram.nameTable[i[o]].zIndex=o):(i[o+1]=i[o],this.diagram.nameTable[i[o+1]].zIndex=o,delete i[o]));if(i[n]=this.diagram.nameTable[t].id,this.diagram.nameTable[t].zIndex=n,"SVG"===this.diagram.mode){var r=this.diagram.diagramLayer,s=(this.getChildElements(this.diagram.nameTable[t].wrapper.children),yr(t+"_groupElement"));s.parentNode.removeChild(s);var a=Dr(this.diagram.element.id);this.diagram.diagramRenderer.renderElement(this.diagram.nameTable[t].wrapper,r,a)}else this.diagram.refreshCanvasLayers()}},e.prototype.sortByZIndex=function(t,e){var i=e||"zIndex";return t=t.sort(function(t,e){return t[i]-e[i]})},e.prototype.sendForward=function(){if(us(this.diagram)){var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.layers.indexOf(this.getObjectLayer(t)),i=this.diagram.layers[e].zIndexTable,n=(Object.keys(i).length,this.diagram.nameTable[t]),o=[],r=this.diagram.spatialSearch.findObjects(n.wrapper.bounds);r.length>2&&(r=this.sortByZIndex(r));for(var s=0,a=r;s<a.length;s++){var l=a[s];if(n.id!==l.id&&e===this.getObjectLayer(l.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)<Number(l.zIndex)&&n.wrapper.bounds.intersects(l.wrapper.bounds)){o.push(l);break}}if(o.length>0){var h=o[0].zIndex,c=n.zIndex;i[h];this.diagram.layers[0].zIndexTable[h]=n.id,this.diagram.nameTable[i[h]].zIndex=h,this.diagram.layers[0].zIndexTable[c]=o[0].id,this.diagram.nameTable[i[c]].zIndex=c,"SVG"===this.diagram.mode?this.moveSvgNode(i[Number(o[0].zIndex)],t):this.diagram.refreshCanvasLayers()}}},e.prototype.sendBackward=function(){if(us(this.diagram)){var t=this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes[0].id:this.diagram.selectedItems.connectors[0].id,e=this.diagram.layers.indexOf(this.getObjectLayer(t)),i=this.diagram.layers[e].zIndexTable,n=(Object.keys(i).length,this.diagram.nameTable[t]),o=[],r=this.diagram.spatialSearch.findObjects(n.wrapper.bounds);r.length>2&&(r=this.sortByZIndex(r));for(var s=0,a=r;s<a.length;s++){var l=a[s];n.id!==l.id&&e===this.getObjectLayer(l.id).zIndex&&Number(this.diagram.nameTable[t].zIndex)>Number(l.zIndex)&&n.wrapper.bounds.intersects(l.wrapper.bounds)&&o.push(l)}if(o.length>0){var h=o[o.length-1].zIndex,c=n.zIndex;i[h];i[h]=n.id,this.diagram.nameTable[i[h]].zIndex=h,i[c]=o[o.length-1].id,this.diagram.nameTable[i[c]].zIndex=c,"SVG"===this.diagram.mode?this.moveSvgNode(t,i[o[o.length-1].zIndex]):this.diagram.refreshCanvasLayers()}}},e.prototype.initSelectorWrapper=function(){var t=this.diagram.selectedItems;t.init(this.diagram),1===t.nodes.length&&0===t.connectors.length&&(t.rotateAngle=t.nodes[0].rotateAngle,t.wrapper.rotateAngle=t.nodes[0].rotateAngle,t.wrapper.pivot=t.nodes[0].pivot)},e.prototype.doRubberBandSelection=function(t){this.clearSelectionRectangle(),this.clearSelection();var e=[],i=[];e=this.diagram.getNodesConnectors(e),(i="CompleteIntersect"===this.diagram.selectedItems.rubberBandSelectionMode?wo(t,e):this.diagram.spatialSearch.findObjects(t)).length&&this.selectObjects(i,!0)},e.prototype.clearSelectionRectangle=function(){var t=br(this.diagram.element.id).getElementById(this.diagram.element.id+"_diagramAdorner_selected_region");t&&T(t)},e.prototype.dragConnectorEnds=function(t,e,i,n,o,r){var s,a,l,h=!1;return e instanceof Xc?s=e.connectors[0]:e instanceof _c&&this.diagram.currentDrawingObject&&(this.clearSelection(),s=this.diagram.currentDrawingObject),"BezierSourceThumb"!==t&&"BezierTargetThumb"!==t||(h=!0),"ConnectorSourceEnd"===t||"BezierSourceThumb"===t?(a=i.x-(h?n.bezierPoint1.x:s.sourcePoint.x),l=i.y-(h?n.bezierPoint1.y:s.sourcePoint.y),this.dragSourceEnd(s,a,l,null,i,t,void 0,o,r,void 0,n)):(a=i.x-(h?n.bezierPoint2.x:s.targetPoint.x),l=i.y-(h?n.bezierPoint2.y:s.targetPoint.y),this.dragTargetEnd(s,a,l,null,i,t,void 0,n))},e.prototype.getSelectedObject=function(){var t=this.diagram.selectedItems;return t.nodes.concat(t.connectors)},e.prototype.clearSelection=function(e){if(us(this.diagram)){var i=this.diagram.selectedItems,n=this.getSelectedObject(),o={oldValue:n,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};e&&this.diagram.triggerEvent(t.DiagramEvent.selectionChange,o),o.cancel||(i.offsetX=0,i.offsetY=0,i.width=0,i.height=0,i.rotateAngle=0,i.nodes=[],i.connectors=[],i.wrapper=null,this.diagram.clearSelectorLayer(),e&&(o={oldValue:n,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.diagram.triggerEvent(t.DiagramEvent.selectionChange,o)))}},e.prototype.drag=function(t,e,i){var n,o=[];if(In(t)&&this.checkBoundaryConstraints(e,i,t.wrapper.bounds)&&oo(this.diagram))if(t instanceof fd){var r={offsetX:t.offsetX,offsetY:t.offsetY};if(t.offsetX+=e,t.offsetY+=i,t.children)for(var s=this.getAllDescendants(t,o),a=0;a<s.length;a++)n=this.diagram.nameTable[s[a].id],this.drag(n,e,i);this.diagram.nodePropertyChange(t,r,{offsetX:t.offsetX,offsetY:t.offsetY})}else{var l=t,h="Bezier"===l.type,c=!1;if(l.sourceWrapper?c=!0:this.dragSourceEnd(l,e,i,!0,null,"",h),l.targetWrapper?c=!0:this.dragTargetEnd(l,e,i,!0,null,"",h),!c){this.dragControlPoint(l,e,i,!0);var d={sourcePoint:l.sourcePoint,targetPoint:l.targetPoint};this.diagram.connectorPropertyChange(l,{},d)}}},e.prototype.updateEndPoint=function(t){var e={sourcePoint:t.sourcePoint,targetPoint:t.targetPoint,sourceID:t.sourceID?t.sourceID:void 0,targetID:t.targetID?t.targetID:void 0,sourcePortID:t.sourcePortID?t.sourcePortID:void 0,targetPortID:t.targetPortID?t.targetPortID:void 0,segments:t.segments?t.segments:void 0};this.diagram.connectorPropertyChange(t,{},e),this.diagram.updateSelector()},e.prototype.dragSourceEnd=function(t,e,i,n,o,r,s,a,l,h,c){var d=this.diagram.nameTable[t.id],p=this.checkBoundaryConstraints(e,i,d.wrapper.bounds);if(Bn(d)&&p&&"BezierSourceThumb"!==r&&oo(this.diagram)&&(d.sourcePoint.x+=e,d.sourcePoint.y+=i,"ConnectorSourceEnd"===r&&"Orthogonal"===d.type&&this.changeSegmentLength(d,a,l,h)),"Bezier"===d.type)if(c)this.translateBezierPoints(t,""===r?"ConnectorSourceEnd":r,e,i,c,o,!s);else for(var u=0;u<t.segments.length;u++)this.translateBezierPoints(t,""===r?"ConnectorSourceEnd":r,e,i,t.segments[u],o,!s);return n||this.updateEndPoint(d),p},e.prototype.changeSegmentLength=function(t,e,i,n){if(t.segments&&null!==t.segments[0].direction&&(!e&&""===t.sourceID||n)){var o=t.segments[0],r=t.segments[1],s=this.diagram.nameTable[t.sourceID],a=void 0;if(o.points[0]=t.sourcePoint,"Top"===o.direction||"Bottom"===o.direction?(o.points[o.points.length-1].x=t.sourcePoint.x,r.points[0].y=o.points[o.points.length-1].y):(o.points[o.points.length-1].y=t.sourcePoint.y,r.points[0].x=o.points[o.points.length-1].x),o.direction&&(o.length||0===o.length)&&(o.length=Dl.distancePoints(o.points[0],o.points[o.points.length-1])),r.direction&&(r.length||0===r.length)&&(r.length=Dl.distancePoints(o.points[o.points.length-1],r.points[r.points.length-1]),r.direction=Dl.direction(o.points[o.points.length-1],r.points[r.points.length-1])),""!==t.sourcePortID&&o.length<10)if(t.segments.length>2){var l=t.segments[2],h=Dl.direction(l.points[0],l.points[1]);o.direction===Pn(h)?("Right"===o.direction?l.points[0].x=o.points[o.points.length-1].x=s.wrapper.corners.middleRight.x+20:"Left"===o.direction?l.points[0].x=o.points[o.points.length-1].x=s.wrapper.corners.middleLeft.x-20:"Top"===o.direction?l.points[0].y=o.points[o.points.length-1].y=s.wrapper.corners.topCenter.y-20:l.points[0].y=o.points[o.points.length-1].y=s.wrapper.corners.bottomCenter.y+20,l.direction&&l.length&&(l.length=Dl.distancePoints(l.points[0],l.points[l.points.length-1])),o.length=Dl.distancePoints(o.points[0],o.points[o.points.length-1])):o.direction===h&&l.direction&&l.length?("Top"===o.direction||"Bottom"===o.direction?(l.points[0]=o.points[0],l.points[l.points.length-1].x=l.points[0].x):(l.points[0]=o.points[0],l.points[l.points.length-1].y=l.points[0].y),l.length=Dl.distancePoints(l.points[0],l.points[l.points.length-1]),t.segments.splice(0,2)):o.length=20}else o.length=20;else o.length<1&&(""!==t.sourceID?("Right"===r.direction?(a=s.wrapper.corners.middleRight,r.points[r.points.length-1].y=a.y):"Left"===r.direction?(a=s.wrapper.corners.middleLeft,r.points[r.points.length-1].y=a.y):"Top"===r.direction?(a=s.wrapper.corners.topCenter,r.points[r.points.length-1].x=a.x):(a=s.wrapper.corners.bottomCenter,r.points[r.points.length-1].x=a.x),r.length=Dl.distancePoints(a,r.points[r.points.length-1]),t.segments.length>2&&(l=t.segments[2]).direction&&l.length&&(l.length=Dl.distancePoints(r.points[r.points.length-1],l.points[l.points.length-1])),t.segments.splice(0,1)):t.segments.splice(0,1))}else e&&i&&t.sourcePortID!==i&&t.segments&&null!==t.segments[0].direction&&e&&e instanceof fd?this.changeSourceEndToPort(t,e,i):e&&(t.sourceID!==e.id||""===t.sourcePortID)&&t.segments&&null!==t.segments[0].direction&&e&&e instanceof fd&&this.changeSourceEndToNode(t,e)},e.prototype.changeSourceEndToPort=function(t,e,i){var n=this.diagram.getWrapper(e.wrapper,i),o={x:n.offsetX,y:n.offsetY},r=Sn(o,e.wrapper.corners,e.wrapper.bounds,!1),s=t.segments[0],a=t.segments[1];if(s.direction!==r){var l=[],h={};if(s.direction===Pn(r)){h={};var c=void 0;"Top"===r||"Bottom"===r?(c="Top"===r?{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(s.points[0].y-o.y)}:{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(o.y-s.points[0].y)},h=s.points[0].x>o.x?{type:"Orthogonal",isTerminal:!0,direction:"Right",length:s.points[0].x-o.x}:{type:"Orthogonal",isTerminal:!0,direction:"Left",length:o.x-s.points[0].x}):(c="Right"===r?{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(s.points[0].x-o.x)}:{type:"Orthogonal",isTerminal:!0,direction:r,length:Math.abs(o.x-s.points[0].x)},h=s.points[0].y>o.y?{type:"Orthogonal",direction:"Top",isTerminal:!0,length:s.points[0].y-o.y}:{type:"Orthogonal",direction:"Bottom",isTerminal:!0,length:o.y-s.points[0].y}),l.push(new Vc(t,"segments",c,!0)),l.push(new Vc(t,"segments",h,!0))}else h={type:"Orthogonal",direction:r,length:20,isTerminal:!0},l.push(new Vc(t,"segments",h,!0));s.direction!==Pn(r)&&("Top"===r||"Bottom"===r?(s.points[0].x=o.x,s.points[0].y=s.points[s.points.length-1].y="Top"===r?o.y-20:o.y+20):(s.points[0].y=o.y,s.points[0].x=s.points[s.points.length-1].x="Right"===r?o.x+20:o.x-20),s.length=Dl.distancePoints(s.points[0],s.points[s.points.length-1]),a.length=Dl.distancePoints(s.points[s.points.length-1],a.points[a.points.length-1])),t.segments=l.concat(t.segments)}else s.points[0]=o,"Top"===r||"Bottom"===r?s.points[s.points.length-1].x=o.x:s.points[s.points.length-1].y=o.y,s.length=Dl.distancePoints(s.points[0],s.points[s.points.length-1]),a.length=Dl.distancePoints(s.points[s.points.length-1],a.points[a.points.length-1])},e.prototype.removeTerminalSegment=function(t,e){for(var i=0;i<t.segments.length-2;i++){var n=t.segments[0];n.isTerminal&&(e?n.isTerminal=!1:(t.segments.splice(i,1),i--))}},e.prototype.changeSourceEndToNode=function(t,e){this.removeTerminalSegment(t);var i,n,o=e.wrapper.children[0].corners,r=t.segments[0],s=t.segments[1],a=[];if("Right"===r.direction||"Left"===r.direction)if(i="Left"===r.direction?o.middleLeft:o.middleRight,r.length>o.width||"Left"===r.direction&&i.x>=r.points[0].x||"Right"===r.direction&&i.x<=r.points[0].x)r.points[0].y=r.points[r.points.length-1].y=i.y,r.points[0].x=i.x,r.length=Dl.distancePoints(r.points[0],r.points[r.points.length-1]),s.length=Dl.distancePoints(r.points[r.points.length-1],s.points[s.points.length-1]);else{l=void 0;n="Bottom"===(l=s.direction?s.direction:Dl.direction(s.points[0],s.points[s.points.length-1]))?o.bottomCenter:o.topCenter,s.length&&s.direction&&(s.length="Top"===l?r.points[r.points.length-1].y-(n.y+20):n.y+20-r.points[r.points.length-1].y),r.length=r.points[r.points.length-1].x-n.x,r.direction=r.length>0?"Right":"Left";h={type:"Orthogonal",direction:l,length:20};a.push(new Vc(t,"segments",h,!0)),t.segments=a.concat(t.segments)}else if(i="Bottom"===r.direction?o.bottomCenter:o.topCenter,r.length>o.height||"Top"===r.direction&&i.y>=r.points[0].y||"Bottom"===r.direction&&i.y<=r.points[0].y)r.points[0].x=r.points[r.points.length-1].x=i.x,r.points[0].y=i.y,r.length=Dl.distancePoints(r.points[0],r.points[r.points.length-1]),s.length=Dl.distancePoints(r.points[r.points.length-1],s.points[s.points.length-1]);else{n="Left"===s.direction?o.middleLeft:o.middleRight;var l=void 0;l=s.direction?s.direction:Dl.direction(s.points[0],s.points[s.points.length-1]),s.length&&s.direction&&(s.length="Left"===l?r.points[r.points.length-1].x-(n.x+20):n.x+20-r.points[r.points.length-1].x),r.length=r.points[r.points.length-1].y-n.y,r.direction=r.length>0?"Bottom":"Top";var h={type:"Orthogonal",direction:l,length:20};a.push(new Vc(t,"segments",h,!0)),t.segments=a.concat(t.segments)}},e.prototype.translateBezierPoints=function(t,e,i,n,o,r,s){var a=t.segments.indexOf(o),l=t.segments[a];l&&("BezierSourceThumb"===e&&(l.vector1.angle||l.vector1.distance)?l.vector1={distance:t.distance(t.sourcePoint,r),angle:Dl.findAngle(t.sourcePoint,r)}:"BezierTargetThumb"===e&&(l.vector2.angle||l.vector2.distance)?l.vector2={distance:t.distance(t.targetPoint,r),angle:Dl.findAngle(t.targetPoint,r)}:("ConnectorSourceEnd"===e&&!t.sourceID||"ConnectorTargetEnd"===e&&!t.targetID)&&s&&Tn(l.vector1)&&Tn(l.vector2)?(Dl.isEmptyPoint(l.point1)&&(l.bezierPoint1=kn(t.sourcePoint,t.targetPoint)),Dl.isEmptyPoint(l.point2)&&(l.bezierPoint2=kn(t.targetPoint,t.sourcePoint))):"BezierSourceThumb"===e||"ConnectorSourceEnd"===e&&!s&&Tn(l.vector1)?(l.bezierPoint1.x+=i,l.bezierPoint1.y+=n,Dl.isEmptyPoint(l.point1)&&!s||(l.point1={x:l.bezierPoint1.x,y:l.bezierPoint1.y})):("BezierTargetThumb"===e||"ConnectorTargetEnd"===e&&!s&&Tn(l.vector2))&&(l.bezierPoint2.x+=i,l.bezierPoint2.y+=n,Dl.isEmptyPoint(l.point2)&&!s||(l.point2={x:l.bezierPoint2.x,y:l.bezierPoint2.y})))},e.prototype.dragTargetEnd=function(t,e,i,n,o,r,s,a){var l=this.diagram.nameTable[t.id],h=this.checkBoundaryConstraints(e,i,l.wrapper.bounds);if(Hn(l)&&"BezierTargetThumb"!==r&&h&&oo(this.diagram)&&(l.targetPoint.x+=e,l.targetPoint.y+=i,"ConnectorTargetEnd"===r&&"Orthogonal"===l.type&&l.segments&&l.segments.length>0)){var c=l.segments[l.segments.length-2];c&&2===l.segments[l.segments.length-1].points.length&&("Left"===c.direction||"Right"===c.direction?c.points[c.points.length-1].x=l.targetPoint.x:c.points[c.points.length-1].y=l.targetPoint.y,c.length=Dl.distancePoints(c.points[0],c.points[c.points.length-1]),c.direction=Dl.direction(c.points[0],c.points[c.points.length-1]))}if("Bezier"===l.type)if(a)this.translateBezierPoints(t,""===r?"ConnectorTargetEnd":r,e,i,a,o,!s);else for(var d=0;d<t.segments.length;d++)this.translateBezierPoints(t,""===r?"ConnectorTargetEnd":r,e,i,t.segments[d],o,!s);return n||this.updateEndPoint(l),h},e.prototype.dragControlPoint=function(t,e,i,n,o){var r=this.diagram.nameTable[t.id];if(("Straight"===r.type||"Bezier"===r.type)&&r.segments.length>0){if(void 0!==o&&r.segments[o])r.segments[o].point.x+=e,r.segments[o].point.y+=i;else for(var s=0;s<r.segments.length-1;s++)r.segments[s].point.x+=e,r.segments[s].point.y+=i;n||this.updateEndPoint(r)}return!0},e.prototype.rotateObjects=function(t,e,i,n,o){n=n||{};var r=Et();Tt(r,i,n.x,n.y);for(var s=0,a=e;s<a.length;s++){var l=a[s];if(l instanceof fd){if(jn(l)&&oo(this.diagram)){if(!1!==o||t!==l){l.rotateAngle+=i,l.rotateAngle=(l.rotateAngle+360)%360;var h=Pt(r,{x:l.offsetX,y:l.offsetY});l.offsetX=h.x,l.offsetY=h.y,this.diagram.nodePropertyChange(l,{},{offsetX:l.offsetX,offsetY:l.offsetY,rotateAngle:l.rotateAngle})}if(l.processId){var c=this.diagram.nameTable[l.processId],d=this.diagram.bpmnModule.getChildrenBound(c,l.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(d,l,this.diagram)}l.children&&l.children.length&&this.getChildren(l,e)}}else this.rotatePoints(l,i,n||{x:l.wrapper.offsetX,y:l.wrapper.offsetY});this.diagram.updateDiagramObject(l)}this.diagram.updateSelector()},e.prototype.snapConnectorEnd=function(e){return this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToLines&&this.snappingModule&&this.diagram.snappingModule.snapConnectorEnd(e),e},e.prototype.snapAngle=function(e){return this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToLines&&this.snappingModule?this.snappingModule.snapAngle(this.diagram,e):0},e.prototype.rotatePoints=function(t,e,i){if(!t.sourceWrapper||!t.targetWrapper){var n=Et();Tt(n,e,i.x,i.y),t.sourcePoint=Pt(n,t.sourcePoint),t.targetPoint=Pt(n,t.targetPoint);var o={sourcePoint:t.sourcePoint,targetPoint:t.targetPoint};this.diagram.connectorPropertyChange(t,{},o)}},e.prototype.scale=function(t,e,i,n,o){var r=this.diagram.nameTable[t.id],s=r,a=[],l=r.wrapper;if(void 0!==l.actualSize.width&&void 0!==l.actualSize.height&&oo(this.diagram)){if(s.children){for(var h=0,c=this.getAllDescendants(s,a);h<c.length;h++){var d=c[h];this.scaleObject(e,i,n,d,l,o)}t.wrapper.measure(new Al),t.wrapper.arrange(t.wrapper.desiredSize),this.diagram.updateGroupOffset(r)}else this.scaleObject(e,i,n,r,l,o);var p=Xr(t.wrapper);if(!this.checkBoundaryConstraints(void 0,void 0,p))return this.scale(t,1/e,1/i,n),!1;this.diagram.updateDiagramObject(t)}return!0},e.prototype.getAllDescendants=function(t,e,i){for(var n=t,o=0;o<n.children.length;o++)(t=this.diagram.nameTable[n.children[o]]).children?(i&&e.push(t),e=this.getAllDescendants(t,e)):e.push(t);return e},e.prototype.getChildren=function(t,e){var i=t;if(t.children)for(var n=0;n<i.children.length;n++)t=this.diagram.nameTable[i.children[n]],e.push(t);return e},e.prototype.cloneChild=function(t){return this.diagram.nameTable[t]},e.prototype.scaleObject=function(t,e,i,n,o,r){t=t<0?1:t,e=e<0?1:e;n.wrapper.offsetX,n.wrapper.offsetY,n.wrapper.actualSize.width,n.wrapper.actualSize.height;if(1!==t||1!==e){var s=void 0,a=void 0;if(n instanceof fd){var l=void 0,h=void 0;"Bpmn"===(f=n).shape.type&&f.shape.activity.subProcess.processes&&f.shape.activity.subProcess.processes.length>0&&(h=this.diagram.bpmnModule.getChildrenBound(f,f.id,this.diagram),l=f.wrapper.bounds.containsRect(h)),s=f.wrapper.actualSize.width*t,a=f.wrapper.actualSize.height*e,void 0!==f.maxWidth&&0!==f.maxWidth&&(s=Math.min(f.maxWidth,s)),void 0!==f.minWidth&&0!==f.minWidth&&(s=Math.max(f.minWidth,s)),void 0!==f.maxHeight&&0!==f.maxHeight&&(a=Math.min(f.maxHeight,a)),void 0!==f.minHeight&&0!==f.minHeight&&(a=Math.max(f.minHeight,a)),l&&(s=Math.max(s,h.right-f.wrapper.bounds.x),a=Math.max(a,h.bottom-f.wrapper.bounds.y)),t=s/f.actualSize.width,e=a/f.actualSize.height}var c=Et(),d=void 0;r||(r=n);var p=(d=r.wrapper).offsetX-d.actualSize.width*d.pivot.x,u=d.offsetY-d.actualSize.height*d.pivot.y,g={x:p+d.actualSize.width*i.x,y:u+d.actualSize.height*i.y};if(g=rs(d.rotateAngle,d.offsetX,d.offsetY,g),Tt(c,-d.rotateAngle,g.x,g.y),kt(c,t,e,g.x,g.y),Tt(c,d.rotateAngle,g.x,g.y),n instanceof fd){var m,f=n,v=void 0,y=Pt(c,{x:f.wrapper.offsetX,y:f.wrapper.offsetY}),b=f.wrapper.offsetX-f.wrapper.actualSize.width*f.pivot.x,w=f.wrapper.offsetY-f.wrapper.actualSize.height*f.pivot.y;if(s>0)if(f.processId){var x=this.diagram.nameTable[f.processId];(!x.maxWidth||f.margin.left+s<x.maxWidth)&&(f.width=s,f.offsetX=y.x)}else f.width=s,f.offsetX=y.x;if(a>0)if(f.processId){var C=this.diagram.nameTable[f.processId];(!C.maxHeight||f.margin.top+a<C.maxHeight)&&(f.height=a,f.offsetY=y.y)}else f.height=a,f.offsetY=y.y;v=f.wrapper.offsetX-f.wrapper.actualSize.width*f.pivot.x,m=f.wrapper.offsetY-f.wrapper.actualSize.height*f.pivot.y,this.diagram.nameTable[f.processId]&&(f.margin.top+(m-w)<=0||f.margin.left+(v-b)<=0)?this.diagram.nodePropertyChange(n,{},{margin:{top:f.margin.top,left:f.margin.left}}):this.diagram.nodePropertyChange(n,{},{width:f.width,height:f.height,offsetX:f.offsetX,offsetY:f.offsetY,margin:{top:f.margin.top+(m-w),left:f.margin.left+(v-b)}})}else{var S=n;if(!S.sourceWrapper||!S.targetWrapper){S.sourcePoint=Pt(c,S.sourcePoint),S.targetPoint=Pt(c,S.targetPoint);var E={sourcePoint:S.sourcePoint,targetPoint:S.targetPoint};this.diagram.connectorPropertyChange(S,{},E)}}var P=this.diagram.nameTable[n.processId];if(P){P.wrapper.bounds,n.wrapper.bounds;h=this.diagram.bpmnModule.getChildrenBound(P,n.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(h,n,this.diagram)}}},e.prototype.portDrag=function(t,e,i,n){var o,r,s=this.findTarget(e,t),a=Xr(t.wrapper),l=Qo(t,s.id),h={};h[l]={offset:{x:s.offset.x,y:s.offset.y}},s&&ao(s,this.diagram)&&(o={ports:h},s.offset.x+=i/a.width,s.offset.y+=n/a.height,(h={})[l]={offset:{x:s.offset.x,y:s.offset.y}},r={ports:h},this.diagram.nodePropertyChange(t,o,r),this.diagram.updateDiagramObject(t))},e.prototype.getSubProcess=function(t){var e,i={nodes:[],connectors:[]};return t instanceof fd?e=t.processId:t&&t.nodes&&t.nodes.length&&t.nodes[0].processId&&(e=t.nodes[0].processId),e?(i.nodes.push(Yr(this.diagram.nameTable[e])),i):i},e.prototype.checkBoundaryConstraints=function(t,e,i){var n=this.diagram.pageSettings,o=this.diagram.pageSettings.boundaryConstraints,r=this.diagram.scroller;if("Page"===o||"Diagram"===o){var s=i?void 0:this.diagram.selectedItems.wrapper.bounds,a="Page"===o?n.width:r.viewPortWidth,l="Page"===o?n.height:r.viewPortHeight,h=i,c=(i?h.right:s.right)+(t||0),d=(i?h.left:s.left)+(t||0),p=(i?h.top:s.top)+(e||0),u=(i?h.bottom:s.bottom)+(e||0);return c<=a&&d>=0&&u<=l&&p>=0}return!0},e.prototype.dragSelectedObjects=function(t,e){var i=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=i.offsetX,this.state.backup.offsetY=i.offsetY),!!this.checkBoundaryConstraints(t,e)&&(this.diagram.drag(i,t,e),!0)},e.prototype.scaleSelectedItems=function(t,e,i){var n=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=n.offsetX,this.state.backup.offsetY=n.offsetY,this.state.backup.width=n.width,this.state.backup.height=n.height,this.state.backup.pivot=i),this.diagram.scale(n,t,e,i)},e.prototype.rotateSelectedItems=function(t){var e=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.angle=e.rotateAngle),this.diagram.rotate(e,t)},e.prototype.hasSelection=function(){return us(this.diagram)},e.prototype.isSelected=function(t){return ms(this.diagram,t)},e.prototype.initExpand=function(t){var e=t.target||t.source;this.expandNode(e,!1,this.diagram)},e.prototype.expandNode=function(t,e,i){var n,o=e?t.isExpanded:!t.isExpanded;return this.expandCollapse(t,o,this.diagram),t.isExpanded=o,this.diagram.layout.fixedNode=t.id,e||this.diagram.updateIcon(t),this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&(this.diagram.organizationalChartModule.isAnimation=!0),n=this.diagram.doLayout(),this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&this.layoutAnimateModule.expand(this.diagram.organizationalChartModule.isAnimation,n,t,this.diagram),n},e.prototype.expandCollapse=function(t,e,i){for(var n=0;n<t.outEdges.length;n++){var o=i.nameTable[t.outEdges[n]],r=i.nameTable[o.targetID];o.visible=e,r.isExpanded&&this.expandCollapse(r,e,i);var s={visible:r.visible};r.visible=e;var a={visible:r.visible};i.nodePropertyChange(r,s,a),i.connectorPropertyChange(o,s,a)}},e.prototype.updateNodeDimension=function(t,e){t instanceof fd&&(t.offsetX=e.x+e.width/2,t.offsetY=e.y+e.height/2,t.width=e.width,t.height=e.height,this.diagram.nodePropertyChange(t,{},{width:e.width,height:e.height,offsetX:t.offsetX,offsetY:t.offsetY}),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer())},e.prototype.drawSelectionRectangle=function(t,e,i,n){this.diagram.drawSelectionRectangle(t,e,i,n)},e.prototype.startGroupAction=function(){this.diagram.startGroupAction()},e.prototype.endGroupAction=function(){this.diagram.endGroupAction()},e.prototype.removeChildFromBPmn=function(t,e,i){var n=this.diagram.nameTable[t.id]||t.nodes[0];if(i&&n&&n.processId&&n.processId===i.wrapper.id){var o=Yr(n);o.processId=n.processId,this.diagram.startGroupAction();for(var r=[],s=(r=r.concat(n.outEdges,n.inEdges)).length-1;s>=0;s--){var a=this.diagram.nameTable[r[s]];a&&this.diagram.remove(a)}var l=void 0;(l=this.diagram.nameTable[n.processId].shape.activity.subProcess.processes||[]).splice(l.indexOf(n.id),1),this.diagram.bpmnModule.removeChildFromBPMN(this.diagram.nameTable[n.processId].wrapper,n.id),this.diagram.nameTable[n.id].processId="",n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY;var h={type:"PositionChanged",redoObject:{nodes:[Yr(n)]},undoObject:{nodes:[o]},category:"Internal"};this.addHistoryEntry(h),this.diagram.endGroupAction()}},e.prototype.isDroppable=function(t,e){var i=this.diagram.nameTable[t.id]||t.nodes[0];return!i||"Bpmn"!==i.shape.type||i.processId!==e.id&&i.id!==e.processId&&!e.shape.activity.subProcess.collapsed},e.prototype.renderHighlighter=function(t,e,i){new Rl;if(t.target instanceof fd||e&&t.source instanceof fd){var n=e?t.source:t.target,o=e?t.sourceWrapper:t.targetWrapper,r=this.findTarget(o,n,i),s=void 0;if(r instanceof cd)for(var a=r.id,l=t.target,h=0,c=l.wrapper.children[0].children[0].children[2].children;h<c.length;h++){var d=c[h];if(d.id===l.id+"_"+a){s=d.children[0];break}}else s=r instanceof fd?r.wrapper:e?t.sourceWrapper:t.targetWrapper;this.diagram.renderHighlighter(s)}},e.prototype.mouseOver=function(t,e,i){return!0},e.prototype.snapPoint=function(t,e,i,n){var o,r=this.diagram.selectedItems,s=e.x<t.x,a=e.y<t.y,l=o={x:i,y:n};return this.snappingModule&&(l=this.diagram.snappingModule.snapPoint(this.diagram,r,s,a,o,t,e)),l},e.prototype.removeSnap=function(){this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject&&this.snappingModule&&this.snappingModule.removeGuidelines(this.diagram)},e.prototype.drop=function(t,e,i){this.diagram.bpmnModule&&(this.diagram.bpmnModule.dropBPMNchild(e,t instanceof fd?t:t.nodes[0],this.diagram),this.diagram.refreshDiagramLayer())},e.prototype.addHistoryEntry=function(t){this.diagram.addHistoryEntry(t)},e.prototype.align=function(t,e){if(t.length>0){var i=0,n=0,o=Xr(t[0].wrapper),r={nodes:[],connectors:[]},s={nodes:[],connectors:[]};for(i=1;i<t.length;i++){var a=0,l=0;"Left"===e?a=t[i]instanceof fd?o.topLeft.x+t[i].width/2-t[i].offsetX:o.topLeft.x-t[i].sourcePoint.x:"Right"===e?a=t[i]instanceof fd?o.topRight.x-t[i].width/2-t[i].offsetX:o.topRight.x-t[i].wrapper.bounds.width-t[i].sourcePoint.x:"Top"===e?l=t[i]instanceof fd?o.top+t[i].height/2-t[i].offsetY:o.top-t[i].sourcePoint.y:"Bottom"===e?l=t[i]instanceof fd?o.bottom-t[i].height/2-t[i].offsetY:o.bottom-t[i].sourcePoint.y:"Center"===e?t[i]instanceof fd?a=o.center.x-t[i].offsetX:(n=Math.abs(o.width-t[i].wrapper.bounds.width),a=o.bottomLeft.x-n/2-t[i].sourcePoint.x):"Middle"===e&&(l=t[i]instanceof fd?o.center.y-t[i].offsetY:o.center.y-t[i].sourcePoint.y),r=this.storeObject(r,t[i]),this.drag(t[i],a,l),this.diagram.updateSelector(),s=this.storeObject(s,t[i])}r=Yr(r),s=Yr(s);var h={type:"Align",category:"Internal",undoObject:Yr(r),redoObject:Yr(s)};this.addHistoryEntry(h)}},e.prototype.distribute=function(t,e){if(t.length>0){var i=0,n=(new Rl,0),o=0,r=0,s=0,a=0,l=0,h=0,c={nodes:[],connectors:[]},d={nodes:[],connectors:[]};for(t=Ao(t),i=1;i<t.length;i++)n=n+t[i].wrapper.bounds.topRight.x-t[i-1].wrapper.bounds.topRight.x,o=o+t[i].wrapper.bounds.topLeft.x-t[i-1].wrapper.bounds.topLeft.x,r=r+t[i].wrapper.bounds.topRight.y-t[i-1].wrapper.bounds.topRight.y,s=s+t[i].wrapper.bounds.bottomRight.y-t[i-1].wrapper.bounds.bottomRight.y,a=a+t[i].wrapper.bounds.center.x-t[i-1].wrapper.bounds.center.x,l=l+t[i].wrapper.bounds.center.y-t[i-1].wrapper.bounds.center.y,h=h+t[i].wrapper.bounds.topRight.y-t[i-1].wrapper.bounds.bottomRight.y;for(i=1;i<t.length-1;i++){var p=0,u=0,g=Xr(t[i-1].wrapper),m=Xr(t[i].wrapper);"RightToLeft"===e||"Center"===e?p=g.center.x-m.center.x+a/(t.length-1):"Right"===e?p=g.topRight.x-m.topRight.x+n/(t.length-1):"Left"===e?p=g.topLeft.x-m.topLeft.x+o/(t.length-1):"Middle"===e?u=g.center.y-m.center.y+l/(t.length-1):"Top"===e?u=g.topRight.y-m.topRight.y+r/(t.length-1):"Bottom"===e?u=g.bottomRight.y-m.bottomRight.y+s/(t.length-1):"BottomToTop"===e&&(u=g.bottomRight.y-m.topRight.y+h/(t.length-1)),c=this.storeObject(c,t[i]),this.drag(t[i],p,u),this.diagram.updateSelector(),d=this.storeObject(d,t[i])}c=Yr(c),d=Yr(d);var f={type:"Distribute",category:"Internal",undoObject:Yr(c),redoObject:Yr(d)};this.addHistoryEntry(f)}},e.prototype.sameSize=function(t,e){if(t.length>0){var i=0,n=void 0;n={x:.5,y:.5};var o=Xr(t[0].wrapper),r={nodes:[],connectors:[]},s={nodes:[],connectors:[]};for(i=1;i<t.length;i++){var a=Xr(t[i].wrapper),l=1,h=1;"Width"===e?l=o.width/a.width:"Height"===e?h=o.height/a.height:"Size"===e&&(l=o.width/a.width,h=o.height/a.height),r=this.storeObject(r,t[i]),this.scale(t[i],l,h,n),s=this.storeObject(s,t[i])}this.diagram.updateSelector(),r=Yr(r),s=Yr(s);var c={type:"Sizing",category:"Internal",undoObject:Yr(r),redoObject:Yr(s)};this.addHistoryEntry(c)}},e.prototype.storeObject=function(t,e){return e instanceof fd?t.nodes.push(Yr(e)):t.connectors.push(Yr(e)),t},e.prototype.scroll=function(t,e,i){var n=io(this.diagram),o=no(this.diagram);this.diagram.pan((t=n?t:0)*this.diagram.scroller.currentZoom,(e=o?e:0)*this.diagram.scroller.currentZoom,i)},e.prototype.drawHighlighter=function(t){this.diagram.renderHighlighter(t.wrapper)},e.prototype.removeHighlighter=function(){this.diagram.clearHighlighter()},e.prototype.zoom=function(t,e,i,n){this.diagram.scroller.zoom(t,e*this.diagram.scroller.currentZoom,i*this.diagram.scroller.currentZoom,n)},e}(),up=function(){function t(t){this.transform={tx:0,ty:0,scale:1},this.vPortWidth=0,this.vPortHeight=0,this.currentZoomFActor=1,this.hOffset=0,this.vOffset=0,this.scrolled=!1,this.hScrollSize=0,this.vScrollSize=0,this.diagram=t,this.objects=[]}return Object.defineProperty(t.prototype,"viewPortHeight",{get:function(){return this.vPortHeight},set:function(t){this.vPortHeight=t,this.diagram.scrollSettings.viewPortHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentZoom",{get:function(){return this.currentZoomFActor},set:function(t){this.currentZoomFActor=t,this.diagram.scrollSettings.currentZoom=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewPortWidth",{get:function(){return this.vPortWidth},set:function(t){this.vPortWidth=t,this.diagram.scrollSettings.viewPortWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"horizontalOffset",{get:function(){return this.hOffset},set:function(t){this.hOffset=t,Math.abs(this.hOffset-this.diagram.scrollSettings.horizontalOffset)>1&&(this.scrolled=!0),this.diagram.scrollSettings.horizontalOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verticalOffset",{get:function(){return this.vOffset},set:function(t){this.vOffset=t,Math.abs(this.vOffset-this.diagram.scrollSettings.verticalOffset)>1&&(this.scrolled=!0),this.diagram.scrollSettings.verticalOffset=t},enumerable:!0,configurable:!0}),t.prototype.updateScrollOffsets=function(t,e){var i=0,n=0,o=this.getPageBounds();o.x*=this.currentZoom,o.y*=this.currentZoom,o.width*=this.currentZoom,o.height*=this.currentZoom,i=Math.max(0,t-o.left),n=Math.max(0,e-o.top),void 0!==t&&void 0!==e?(this.horizontalOffset=i,this.verticalOffset=n,this.diagram.setOffset(i,n)):this.diagram.setOffset(-this.horizontalOffset-o.x,-this.verticalOffset-o.y),this.transform={tx:Math.max(this.horizontalOffset,-o.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-o.top)/this.currentZoom,scale:this.currentZoom}},t.prototype.setScrollOffset=function(t,e){this.scrolled=!1;var i=this.getPageBounds();i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom;var n=-i.left,o=-i.top,r=!1,s=this.viewPortWidth*this.currentZoom,a=this.viewPortHeight*this.currentZoom,l=n-t;if(l!==this.horizontalOffset){n<this.horizontalOffset&&(this.horizontalOffset>l?this.horizontalOffset-=t:this.horizontalOffset=l,r=!0);var h=Math.max(i.right+this.vScrollSize,s);if(!r&&h<-l+this.viewPortWidth){var c=-l+s-this.vScrollSize,d=-this.horizontalOffset+s-this.vScrollSize;c<d?this.horizontalOffset=l:c-i.right>c-d?this.horizontalOffset=l:this.horizontalOffset=-(i.right+this.vScrollSize-s),r=!0}r||(this.horizontalOffset=n-t)}r=!1;var p=o-e;if(p!==this.verticalOffset){o<this.verticalOffset&&(this.verticalOffset>p?this.verticalOffset-=e:this.verticalOffset=p,r=!0);var u=Math.max(i.bottom+this.hScrollSize,a);if(!r&&u<-p+a){var g=-p+a-this.hScrollSize,m=-this.verticalOffset+a-this.hScrollSize;g<m?this.verticalOffset=p:g-i.bottom>g-m?this.verticalOffset=p:this.verticalOffset=-(i.bottom+this.hScrollSize-a),r=!0}r||(this.verticalOffset=o-e)}this.transform={tx:Math.max(this.horizontalOffset,-i.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-i.top)/this.currentZoom,scale:this.currentZoom},this.setSize(),this.scrolled&&this.diagram.endEdit()},t.prototype.setSize=function(){var t=this.getPageBounds();t.x*=this.currentZoom,t.y*=this.currentZoom,t.width*=this.currentZoom,t.height*=this.currentZoom;var e=Math.min(t.x,-this.horizontalOffset),i=Math.min(t.y,-this.verticalOffset),n=(this.horizontalOffset,this.viewPortWidth,t.right,this.verticalOffset,this.viewPortHeight,t.bottom,this.scrollerWidth),o=this.scrollerWidth;-this.verticalOffset<=t.y&&-this.verticalOffset+this.viewPortHeight>=t.bottom&&(o=0),-this.horizontalOffset<=t.x&&-this.horizontalOffset+this.viewPortWidth>=t.right&&(n=0),this.hScrollSize=n,this.vScrollSize=o,this.diagramWidth=Math.max(t.right,-this.horizontalOffset+this.viewPortWidth-o)-e,this.diagramHeight=Math.max(t.bottom,-this.verticalOffset+this.viewPortHeight-n)-i,this.diagram.setSize(this.diagramWidth,this.diagramHeight),this.diagram.element.style.overflow="hidden"},t.prototype.setViewPortSize=function(t,e){this.viewPortWidth=t,this.viewPortHeight=e},t.prototype.getPageBounds=function(t,e){var i=new Rl;if("Content"!==e&&null!==this.diagram.pageSettings.width&&null!==this.diagram.pageSettings.height){var n=this.diagram.pageSettings.width,o=this.diagram.pageSettings.height,r=0,s=0;if(this.diagram.pageSettings.multiplePage){if((i=this.diagram.spatialSearch.getPageBounds(0,0)).right>n&&(n*=a=Math.ceil(i.right/n)),i.bottom>o&&(o*=a=Math.ceil(i.bottom/o)),i.left<0&&Math.abs(i.left)>r){a=Math.ceil(Math.abs(i.left)/this.diagram.pageSettings.width);r=this.diagram.pageSettings.width*a}if(i.top<0&&Math.abs(i.top)>s){var a=Math.ceil(Math.abs(i.top)/this.diagram.pageSettings.height);s=this.diagram.pageSettings.height*a}}return new Rl(-r,-s,n+r,o+s)}var l=t?void 0:0;return this.diagram.spatialSearch.getPageBounds(l,l)},t.prototype.getPageBreak=function(t){for(var e=0,i=0,n=-1,o=[],r=0,s=0,a=0,l=0,h=this.diagram.pageSettings.margin.left,c=this.diagram.pageSettings.margin.right,d=this.diagram.pageSettings.margin.top,p=this.diagram.pageSettings.margin.bottom,u=1,g=1,m={x1:r,y1:a,x2:s,y2:l};t.width>e;)(e+=this.diagram.pageSettings.width?this.diagram.pageSettings.width:t.width)===this.diagram.pageSettings.width&&(m={x1:t.left+h,y1:t.top+d,x2:t.left+h,y2:t.bottom-p},o[++n]=m),e<t.width&&(m={x1:r=t.topLeft.x+this.diagram.pageSettings.width*u,y1:a=t.topLeft.y+d,x2:s=t.bottomLeft.x+this.diagram.pageSettings.width*u,y2:l=t.bottomLeft.y-p},o[++n]=m,u++),t.width===e&&(m={x1:t.right-c,y1:t.top+d,x2:t.right-c,y2:t.bottom-p},o[++n]=m);for(;t.height>i;)(i+=this.diagram.pageSettings.height?this.diagram.pageSettings.height:t.height)===this.diagram.pageSettings.height&&(m={x1:t.left+h,y1:t.top+d,x2:t.right-c,y2:t.top+d},o[++n]=m),i<t.height&&(m={x1:r=t.topLeft.x+h,y1:a=t.topLeft.y+this.diagram.pageSettings.height*g,x2:s=t.topRight.x-c,y2:l=t.topRight.y+this.diagram.pageSettings.height*g},o[++n]=m,g++),t.height===i&&(m={x1:t.left+h,y1:t.bottom-p,x2:t.right-c,y2:t.bottom-p},o[++n]=m);return o},t.prototype.zoom=function(t,e,i,n){if(Jn(this.diagram)&&1!==t||$n(this.diagram)&&1===t){var o=Et();if(kt(o,this.currentZoom,this.currentZoom),Ot(o,this.horizontalOffset,this.verticalOffset),n=n||{x:this.viewPortWidth/2,y:this.viewPortHeight/2},n=Pt(o,n),this.currentZoom*t>=this.diagram.scrollSettings.minZoom&&this.currentZoom*t<=this.diagram.scrollSettings.maxZoom){this.currentZoom*=t;var r=this.getPageBounds();r.x*=this.currentZoom,r.y*=this.currentZoom;var s=Et();kt(s,t,t,n.x,n.y),Ot(s,e||0,i||0),Dt(o,s);var a=Pt(o,{x:0,y:0});1===t&&(a=this.applyScrollLimit(a.x,a.y)),this.transform={tx:Math.max(a.x,-r.left)/this.currentZoom,ty:Math.max(a.y,-r.top)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=a.x,this.verticalOffset=a.y,this.setSize(),"SVG"!==this.diagram.mode&&this.diagram.refreshDiagramLayer(),this.diagram.setOffset(-this.horizontalOffset-r.x,-this.verticalOffset-r.y),co(this.diagram)}}},t.prototype.fitToPage=function(t){var e=(t=t||{}).mode,i=t.region,n=t.margin||{},o=t.canZoomIn,r=t.customBounds;n.bottom=n.bottom||25,n.top=n.top||25,n.left=n.left||25,n.right=n.right||25;var s,a=r,l=-this.horizontalOffset,h=-this.verticalOffset;if("PageSettings"===(i=i||"PageSettings")&&this.diagram.pageSettings.width&&this.diagram.pageSettings.height||this.diagram.nodes.length>0||this.diagram.connectors.length>0){e=e||"Page","CustomBounds"!==i&&(a=this.getPageBounds(!0,i));var c={x:0,y:0};c.x=(this.viewPortWidth-(n.left+n.right))/a.width,c.y=(this.viewPortHeight-(n.top+n.bottom))/a.height,!o&&a.width-this.horizontalOffset<this.viewPortWidth&&a.height-this.verticalOffset<this.viewPortHeight&&(c.x=Math.min(1,c.x),c.y=Math.min(1,c.y));var d=void 0,p=void 0,u=void 0;switch(e){case"Width":s=(d=c.x)/this.currentZoom,l+=(p=(this.viewPortWidth-a.width*d)/2-a.x*d)+(n.left-n.right)/2*d,h-=-this.verticalOffset*s,h="CustomBounds"!==i?h:h-this.verticalOffset*s;break;case"Height":s=(d=c.y)/this.currentZoom,p=(this.viewPortWidth-a.width*d)/2-a.x*d,u=(this.viewPortHeight-a.height*d)/2-a.y*d,l+=p+(n.left-n.right)/2*d,h+=u+(n.top-n.bottom)/2*d;break;case"Page":s=(d=Math.min(c.x,c.y))/this.currentZoom,p=(this.viewPortWidth-a.width*d)/2-a.x*d,u=(this.viewPortHeight-a.height*d)/2-a.y*d,l+=p+(n.left-n.right)/2*d,h+=u+(n.top-n.bottom)/2*d}this.zoom(s,l,h,{x:0,y:0})}else s=1/this.currentZoom,this.zoom(s,l,h,{x:0,y:0})},t.prototype.bringIntoView=function(t){var e=0,i=0,n=this.currentZoom,o=t,r=-this.horizontalOffset,s=-this.verticalOffset;o=new Rl(o.x*n,o.y*n,o.width*n,o.height*n),new Rl(r,s,this.viewPortWidth,this.viewPortHeight).containsRect(o)||(o.right>-r+this.viewPortWidth&&(e=o.right-this.viewPortWidth),o.x<-r&&(e=o.x),o.bottom>-s+this.viewPortHeight&&(i=o.bottom-this.viewPortHeight),o.y<-s&&(i=o.y),this.zoom(1,-this.horizontalOffset-e,-this.verticalOffset-i,null))},t.prototype.bringToCenter=function(t){var e=this.currentZoom,i=new Rl(t.x*e,t.y*e,t.width*e,t.height*e),n=i.x+i.width/2-this.viewPortWidth/2,o=i.y+i.height/2-this.viewPortHeight/2;this.zoom(1,-this.horizontalOffset-n,-this.verticalOffset-o,null)},t.prototype.applyScrollLimit=function(t,e){if("Infinity"!==this.diagram.scrollSettings.scrollLimit){var i=void 0;"Limited"===this.diagram.scrollSettings.scrollLimit&&(i=this.diagram.scrollSettings.scrollableArea),(i=i||this.getPageBounds(!0)).x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom,t*=-1,e*=-1;var n=Math.max(i.right,this.viewPortWidth);if(!(t<=i.x&&(t+this.viewPortWidth>=i.right||t>=i.right-this.viewPortWidth)||t>=i.x&&t+this.viewPortWidth<=n))if(t>=i.x)t=Math.max(i.x,Math.min(t,t-(t+this.viewPortWidth-this.vScrollSize-n)));else{r=i.right-this.viewPortWidth;t=Math.min(r,i.x)}var o=Math.max(i.bottom,this.viewPortHeight);if(!(e<=i.y&&e+this.viewPortHeight>=i.bottom||e>=i.y&&e+this.viewPortHeight<=o))if(e>=i.y)e=Math.max(i.y,Math.min(e,e-(e+this.viewPortHeight-this.hScrollSize-o)));else{var r=i.bottom-this.viewPortHeight;e=Math.min(i.y,r)}t*=-1,e*=-1}return{x:t,y:e}},t}(),gp=function(){function t(t,e,i,n,o){this.objects=[],this.left=t,this.top=e,this.width=i,this.height=n,this.spatialSearch=o}return t.prototype.findQuads=function(t,e){null!=this.first&&this.first.isIntersect(t)&&this.first.findQuads(t,e),null!=this.second&&this.second.isIntersect(t)&&this.second.findQuads(t,e),null!=this.third&&this.third.isIntersect(t)&&this.third.findQuads(t,e),null!=this.fourth&&this.fourth.isIntersect(t)&&this.fourth.findQuads(t,e),this.objects.length>0&&e.push(this)},t.prototype.isIntersect=function(t){return!(this.left+this.width<t.left||this.top+this.height<t.top||this.left>t.right||this.top>t.bottom)},t.prototype.selectQuad=function(){for(var t,e=null,i=this;null!=i;)i=(t=i.getQuad(e)).source,e=t.target||e;return e},t.prototype.getQuad=function(e){var i=this.width/2,n=this.height/2;if(i>=1e3&&n>=1e3){var o=this.left+i,r=this.top+n;if(this.spatialSearch.childRight<=o){if(this.spatialSearch.childBottom<=r)return this.first||((s=new t(this.left,this.top,i,n,this.spatialSearch)).parent=this,this.first=s),{source:this.first};if(this.spatialSearch.childTop>=r)return this.third||((s=new t(this.left,r,i,n,this.spatialSearch)).parent=this,this.third=s),{source:this.third}}else if(this.spatialSearch.childLeft>=o){if(this.spatialSearch.childBottom<=r)return this.second||((s=new t(o,this.top,i,n,this.spatialSearch)).parent=this,this.second=s),{source:this.second};if(this.spatialSearch.childTop>=r){if(!this.fourth){var s=new t(o,r,i,n,this.spatialSearch);s.parent=this,this.fourth=s}return{source:this.fourth}}}}return this,this.objects.push(this.spatialSearch.childNode),{target:this}},t.prototype.isContained=function(){return this.spatialSearch.childLeft>=this.left&&this.spatialSearch.childRight<=this.left+this.width&&this.spatialSearch.childTop>=this.top&&this.spatialSearch.childBottom<=this.top+this.height},t.prototype.addIntoAQuad=function(t){var e={};this.spatialSearch.setCurrentNode(t);for(var i=null;!e.isAdded;)i=(e=this.spatialSearch.parentQuad.add(i)).quad;return i},t.prototype.add=function(e){if(e=null,this.isContained())return e=this.selectQuad(),{isAdded:!0,quad:e};var i=void 0,n=!(0!==this.objects.length||this.first||this.second||this.third||this.fourth),o=2*this.width,r=2*this.height;return this.spatialSearch.childLeft<this.left?this.spatialSearch.childTop<this.top?(i=new t(this.left-this.width,this.top-this.height,o,r,this.spatialSearch),n||(i.fourth=this)):(i=new t(this.left-this.width,this.top,o,r,this.spatialSearch),n||(i.second=this)):this.spatialSearch.childTop<this.top?(i=new t(this.left,this.top-this.height,o,r,this.spatialSearch),n||(i.third=this)):(i=new t(this.left,this.top,o,r,this.spatialSearch),n||(i.first=this)),this.parent=i,this.spatialSearch.parentQuad=i,{isAdded:!1,quad:e}},t}(),mp=function(){function t(t){this.quadSize=500,this.objectTable=t,this.parentQuad=new gp(0,0,2*this.quadSize,2*this.quadSize,this),this.pageLeft=Number.MAX_VALUE,this.pageRight=-Number.MAX_VALUE,this.pageTop=Number.MAX_VALUE,this.pageBottom=-Number.MAX_VALUE,this.quadTable={}}return t.prototype.removeFromAQuad=function(t){if(this.quadTable[t.id]){var e=this.quadTable[t.id],i=e.objects.indexOf(t);-1!==i&&(e.objects.splice(i,1),this.update(e),delete this.quadTable[t.id])}},t.prototype.update=function(t){if(!(t.parent&&0===t.objects.length&&t.first&&t.second&&t.third&&t.fourth))return void(t!==this.parentQuad||t.first||t.second||t.third||t.fourth||(t.left=0,t.width=1e3,t.top=0,t.height=1e3));var e=t.parent;e.first===t?e.first=null:e.second===t?e.second=null:e.third===t?e.third=null:e.fourth===t&&(e.fourth=null),this.update(t.parent)},t.prototype.addIntoAQuad=function(t){var e=this.parentQuad.addIntoAQuad(t);this.quadTable[t.id]=e},t.prototype.updateQuad=function(t){this.setCurrentNode(t);var e=t.outerBounds;if(isNaN(e.x)||isNaN(e.y)||isNaN(e.width)||isNaN(e.height))return!1;if(this.quadTable[t.id]?this.quadTable[t.id].isContained()||(this.removeFromAQuad(t),this.addIntoAQuad(t)):this.addIntoAQuad(t),!this.isWithinPageBounds(e)||this.leftElement===t||this.topElement===t||this.rightElement===t||this.bottomElement===t){var i=!1;return this.pageLeft===this.childLeft&&t===this.leftElement||(this.pageLeft>=this.childLeft?(this.pageLeft=this.childLeft,this.leftElement=t,i=!0):t===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.findLeft(this.parentQuad),i=!0)),this.pageTop===this.childTop&&t===this.topElement||(this.pageTop>=this.childTop?(this.pageTop=this.childTop,this.topElement=t,i=!0):t===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.findTop(this.parentQuad),i=!0)),this.pageBottom===this.childBottom&&t===this.bottomElement||(this.pageBottom<=this.childBottom?(i=!0,this.pageBottom=this.childBottom,this.bottomElement=t):t===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.findBottom(this.parentQuad),i=!0)),this.pageRight===this.childRight&&t===this.rightElement||(this.pageRight<=this.childRight?(this.pageRight=this.childRight,this.rightElement=t,i=!0):t===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.findRight(this.parentQuad),i=!0)),i}return this.setCurrentNode(null),!1},t.prototype.isWithinPageBounds=function(t){return t.left>=this.pageLeft&&t.right<=this.pageRight&&t.top>=this.pageTop&&t.bottom<=this.pageBottom},t.prototype.findQuads=function(t){var e=[];return this.parentQuad.findQuads(t,e),e},t.prototype.findObjects=function(t){for(var e=[],i=0,n=this.findQuads(t);i<n.length;i++)for(var o=0,r=n[i].objects;o<r.length;o++){var s=r[o];s.outerBounds.intersects(t)&&e.push(this.objectTable[s.id])}return e},t.prototype.updateBounds=function(t){var e=!1;return t===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.topElement=null,this.findTop(this.parentQuad),e=!0),t===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.leftElement=null,this.findLeft(this.parentQuad),e=!0),t===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.rightElement=null,this.findRight(this.parentQuad),e=!0),t===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.bottomElement=null,this.findBottom(this.parentQuad),e=!0),e},t.prototype.findBottom=function(t){t.third||t.fourth?(t.third&&this.findBottom(t.third),t.fourth&&this.findBottom(t.fourth)):(t.second&&this.findBottom(t.second),t.first&&this.findBottom(t.first));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageBottom<=n.outerBounds.bottom&&(this.pageBottom=n.outerBounds.bottom,this.bottomElement=n)}},t.prototype.findRight=function(t){t.second||t.fourth?(t.second&&this.findRight(t.second),t.fourth&&this.findRight(t.fourth)):(t.first&&this.findRight(t.first),t.third&&this.findRight(t.third));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageRight<=n.outerBounds.right&&(this.pageRight=n.outerBounds.right,this.rightElement=n)}},t.prototype.findLeft=function(t){t.first||t.third?(t.first&&this.findLeft(t.first),t.third&&this.findLeft(t.third)):(t.second&&this.findLeft(t.second),t.fourth&&this.findLeft(t.fourth));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageLeft>=n.outerBounds.left&&(this.pageLeft=n.outerBounds.left,this.leftElement=n)}},t.prototype.findTop=function(t){t.first||t.second?(t.first&&this.findTop(t.first),t.second&&this.findTop(t.second)):(t.third&&this.findTop(t.third),t.fourth&&this.findTop(t.fourth));for(var e=0,i=t.objects;e<i.length;e++){var n=i[e];this.pageTop>=n.outerBounds.top&&(this.pageTop=n.outerBounds.top,this.topElement=n)}},t.prototype.setCurrentNode=function(t){if(this.childNode=t,t){var e=t.outerBounds;this.childLeft=Number(e.left),this.childTop=Number(e.top),this.childRight=Number(e.right),this.childBottom=Number(e.bottom)}else this.childLeft=Number.MAX_VALUE,this.childTop=Number.MAX_VALUE,this.childRight=-Number.MAX_VALUE,this.childBottom=-Number.MAX_VALUE},t.prototype.getPageBounds=function(t,e){if(this.pageLeft===Number.MAX_VALUE)return new Rl(0,0,0,0);var i=void 0!==t?Math.min(this.pageLeft,0):this.pageLeft,n=void 0!==e?Math.min(this.pageTop,0):this.pageTop;return new Rl(Math.round(i),Math.round(n),Math.round(this.pageRight-i),Math.round(this.pageBottom-n))},t.prototype.getQuad=function(t){return this.quadTable[t.id]},t}(),fp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),vp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},yp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fp(e,t),vp([Y()],e.prototype,"key",void 0),vp([Y()],e.prototype,"keyModifiers",void 0),e}(xa),bp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fp(e,t),vp([Y("")],e.prototype,"name",void 0),vp([Y()],e.prototype,"canExecute",void 0),vp([Y()],e.prototype,"execute",void 0),vp([G({},yp)],e.prototype,"gesture",void 0),vp([Y("")],e.prototype,"parameter",void 0),e}(xa),wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fp(e,t),vp([K([],bp)],e.prototype,"commands",void 0),e}(xa),xp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fp(e,t),vp([Y()],e.prototype,"show",void 0),vp([Y()],e.prototype,"showCustomMenuOnly",void 0),vp([Y()],e.prototype,"items",void 0),e}(xa),Cp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Sp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ep=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.connectorTable={},n.groupTable={},n.activeLabel={id:"",parentId:"",isGroup:!1},n.enterObject={},n.renderTimer=null,n}return Cp(i,e),i.prototype.clearCollection=function(t){for(var e,i=[],n=0,o=Object.keys(this.nameTable);n<o.length;n++){var r=o[n];(e=this.nameTable[r])&&(t&&e instanceof _c||!t&&e instanceof fd)&&i.push(e)}this.clearObjects(i)},i.prototype.onPropertyChanged=function(e,n){for(var o=[],r=!1,s=!1,a=0,l=Object.keys(e);a<l.length;a++)switch(l[a]){case"width":case"height":this.element.style.width=this.getSizeValue(this.width),this.element.style.height=this.getSizeValue(this.height),this.eventHandler.updateViewPortSize(this.element);for(var h=0,c=this.views;h<c.length;h++){var d=c[h],p=this.views[d];p instanceof i||p.updateView(p)}break;case"nodes":if(e.nodes.length>0&&0===n.nodes.length)this.clearCollection(),s=!0;else{for(var u=0,g=Object.keys(e.nodes);u<g.length;u++){var m=g[u],f=Number(m),v=this.nodes[f],y=e.nodes[f];r=r||void 0!==y.excludeFromLayout,this.nodePropertyChange(v,n.nodes[f],y),o.push(v)}"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"connectors":if(e.connectors.length>0&&0===n.connectors.length)this.clearCollection(!0),s=!0;else{for(var b=0,w=Object.keys(e.connectors);b<w.length;b++){var m=w[b],f=Number(m),v=this.connectors[f],y=e.connectors[f];this.connectorPropertyChange(v,n.connectors[f],y,!0),o.push(v)}this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer()}break;case"bridgeDirection":this.updateBridging(),"Canvas"===this.mode&&this.refreshDiagramLayer();break;case"backgroundColor":this.intOffPageBackground();break;case"pageSettings":this.validatePageSize(),this.updatePage();break;case"selectedItems":if(e.selectedItems.userHandles&&this.selectedItems.wrapper&&this.selectedItems.userHandles&&this.selectedItems.userHandles.length>0){this.renderSelector(!0);break}if(e.selectedItems.constraints){this.renderSelector(!0);break}break;case"snapSettings":this.updateSnapSettings(e);break;case"commandManager":this.initCommands();break;case"layout":r=!0;break;case"dataSourceSettings":this.clear(),this.initObjects(),r=!0;break;case"tooltip":di(this);break;case"rulerSettings":this.updateRulerSettings(e);break;case"layers":this.updateLayer(e);break;case"scrollSettings":this.updateScrollSettings(e)}r&&this.doLayout();var x={element:o,cause:this.diagramActions,oldValue:n,newValue:e};if(this.triggerEvent(t.DiagramEvent.propertyChange,x),!s&&this.canLogChange()&&this.modelChanged(e,n)){var C={type:"PropertyChanged",undoObject:n,redoObject:e,category:"Internal"};this.addHistoryEntry(C)}this.resetDiagramActions(),s&&(this.initObjects(!0),this.refreshDiagramLayer())},i.prototype.updateSnapSettings=function(t){(t.snapSettings.constraints||t.snapSettings.horizontalGridlines||t.snapSettings.verticalGridlines)&&this.diagramRenderer.updateGrid(this.snapSettings,Pr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)},i.prototype.updateRulerSettings=function(t){void 0!==t.rulerSettings.dynamicGrid&&this.diagramRenderer.updateGrid(this.snapSettings,Pr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),void 0!==t.rulerSettings.showRulers?(this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):void 0===t.rulerSettings.horizontalRuler&&void 0===t.rulerSettings.verticalRuler||(void 0!==t.rulerSettings.horizontalRuler.thickness||void 0!==t.rulerSettings.verticalRuler.thickness?(po(this),this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):co(this)),this.diagramRenderer.updateGrid(this.snapSettings,Pr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)},i.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},i.prototype.preRender=function(){this.initializePrivateVariables(),this.isProtectedOnChange=!0,this.serviceLocator=new Od,this.initializeServices(),this.initDiagram(),this.initViews(),this.unWireEvents(),this.wireEvents(),this.element.classList.add("e-diagram")},i.prototype.initializePrivateVariables=function(){this.defaultLocale={Copy:"Copy",Cut:"Cut",Paste:"Paste",Undo:"Undo",Redo:"Redo",SelectAll:"Select All",Grouping:"Grouping",Group:"Group",UnGroup:"Un Group",Order:"Order",BringToFront:"Bring To Front",MoveForward:"Move Forward",SendToBack:"Send To Back",SendBackward:"Send Backward"},this.layerZIndex=-1,this.layerZIndexTable={},this.nameTable={},this.groupTable={},this.commands={},this.isLoading||(this.views=[]),this.commandHandler=new pp(this),this.eventHandler=new ap(this,this.commandHandler),this.spatialSearch=new mp(this.nameTable),this.scroller=new up(this)},i.prototype.initializeServices=function(){this.serviceLocator.register("localization",this.localeObj=new hl(this.getModuleName(),this.defaultLocale,this.locale))},i.prototype.render=function(){this.initHistory(),this.diagramRenderer=new Sd(this.element.id,new Cd,"SVG"===this.mode),this.initLayers(),this.initializeDiagramLayers(),this.diagramRenderer.setLayers(),this.initObjects(!0),this.doLayout(),this.validatePageSize(),this.renderPageBreaks(),this.diagramRenderer.renderSvgGridlines(this.snapSettings,Pr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.commandHandler.initSelectorWrapper(),this.notify("initial-load",{}),this.trigger("load"),this.scroller.setSize(),this.scroller.updateScrollOffsets(),this.refreshDiagramLayer(),this.notify("initial-end",{}),this.isProtectedOnChange=!1,this.tooltipObject=di(this),this.diagramActions=t.DiagramAction.Render,this.initCommands(),this.isLoading=!1},i.prototype.getModuleName=function(){return"diagram"},i.prototype.requiredModules=function(){var e=[];return e.push({member:"Bpmn",args:[]}),e.push({member:"Bridging",args:[]}),e.push({member:"ConnectorEditingTool",args:[]}),this.constraints&t.DiagramConstraints.UndoRedo&&e.push({member:"UndoRedo",args:[]}),("OrganizationalChart"===this.layout.type||"HierarchicalTree"===this.layout.type||this.layout.enableAnimation)&&e.push({member:"LayoutAnimate",args:[]}),this.snapSettings.constraints&&e.push({member:"Snapping",args:[this]}),e.push({member:"PrintandExport",args:[this]}),this.contextMenuSettings.show&&e.push({member:"contextMenu",args:[this,this.serviceLocator]}),"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type||e.push({member:"OrganizationalChart",args:[]}),"ComplexHierarchicalTree"===this.layout.type&&e.push({member:"ComplexHierarchicalTree",args:[]}),"MindMap"===this.layout.type&&e.push({member:"MindMapChart",args:[]}),"RadialTree"===this.layout.type&&e.push({member:"RadialTree",args:[]}),"SymmetricalLayout"===this.layout.type&&e.push({member:"SymmetricalLayout",args:[]}),(this.dataSourceSettings.dataManager||this.dataSourceSettings.data)&&e.push({member:"DataBinding",args:[]}),e},i.prototype.destroy=function(){if(clearInterval(this.renderTimer),this.renderTimer=null,this.hRuler&&this.vRuler&&(this.hRuler.destroy(),this.vRuler.destroy()),this.tooltipObject.destroy(),this.droppable.destroy(),this.unWireEvents(),this.notify("destroy",{}),e.prototype.destroy.call(this),document.getElementById(this.element.id)){this.element.classList.remove("e-diagram");for(var t=document.getElementsByClassName("e-tooltip-wrap");t.length>0;)t[0].parentNode.removeChild(t[0]);var i=document.getElementById(this.element.id+"content");i&&this.element.removeChild(i);window.measureElement&&(window.measureElement.usageCount-=1,0===window.measureElement.usageCount&&(window.measureElement.parentNode.removeChild(window.measureElement),window.measureElement=null))}},i.prototype.wireEvents=function(){var t=ma.touchStartEvent,e=ma.touchEndEvent,i=ma.touchMoveEvent,n=ma.isPointer?"pointerleave":"mouseleave",o=ma.isPointer,r="mozilla"===ma.info.name?o?"mousewheel":"DOMMouseScroll":"mousewheel";ha.add(this.diagramCanvas,t,this.eventHandler.mouseDown,this.eventHandler),ha.add(this.diagramCanvas,i,this.eventHandler.mouseMove,this.eventHandler),ha.add(this.diagramCanvas,e,this.eventHandler.mouseUp,this.eventHandler),ha.add(this.diagramCanvas,n,this.eventHandler.mouseLeave,this.eventHandler),ha.add(this.diagramCanvas,"keydown",this.eventHandler.keyDown,this.eventHandler),ha.add(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick,this.eventHandler),ha.add(this.diagramCanvas,"scroll",this.eventHandler.scrolled,this.eventHandler),ha.add(this.diagramCanvas,r,this.eventHandler.mouseWheel,this.eventHandler),ha.add(window,"resize",this.eventHandler.windowResize,this.eventHandler),this.initDroppables()},i.prototype.unWireEvents=function(){var t=ma.touchStartEvent,e=ma.touchMoveEvent,i=ma.isPointer?"pointerleave":"mouseleave",n=ma.isPointer,o="mozilla"===ma.info.name?n?"mousewheel":"DOMMouseScroll":"mousewheel",r=ma.touchEndEvent;ha.remove(this.diagramCanvas,t,this.eventHandler.mouseDown),ha.remove(this.diagramCanvas,e,this.eventHandler.mouseMove),ha.remove(this.diagramCanvas,r,this.eventHandler.mouseUp),ha.remove(this.diagramCanvas,i,this.eventHandler.mouseLeave),ha.remove(this.diagramCanvas,"keydown",this.eventHandler.keyDown),ha.remove(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick),ha.remove(this.diagramCanvas,"scroll",this.eventHandler.scrolled),ha.remove(this.diagramCanvas,o,this.eventHandler.mouseWheel),ha.remove(window,"resize",this.eventHandler.windowResize)},i.prototype.select=function(t,e){null!=t&&this.commandHandler.selectObjects(t,e)},i.prototype.selectAll=function(){var t=[];t=this.getObjectsOfLayer(this.activeLayer.objects),this.select(t)},i.prototype.unSelect=function(t){t&&ms(this,t)&&this.commandHandler.unSelect(t)},i.prototype.clearSelection=function(){this.commandHandler.clearSelection(!0)},i.prototype.updateViewPort=function(){this.eventHandler.updateViewPortSize(this.element)},i.prototype.cutCommand=function(){this.cut()},i.prototype.cut=function(){this.commandHandler.cut()},i.prototype.addProcess=function(t,e){this.bpmnModule&&this.bpmnModule.addProcess(t,e,this)},i.prototype.removeProcess=function(t){this.bpmnModule&&this.bpmnModule.removeProcess(t,this)},i.prototype.pasteCommand=function(){this.paste()},i.prototype.paste=function(t){this.commandHandler.paste(t)},i.prototype.fitToPage=function(t){this.scroller.fitToPage(t)},i.prototype.bringIntoView=function(t){this.scroller.bringIntoView(t)},i.prototype.bringToCenter=function(t){this.scroller.bringToCenter(t)},i.prototype.copyCommand=function(){this.copy()},i.prototype.copy=function(){return this.commandHandler.copy()},i.prototype.group=function(){this.commandHandler.group()},i.prototype.unGroup=function(){this.commandHandler.unGroup()},i.prototype.sendToBack=function(){this.commandHandler.sendToBack()},i.prototype.setActiveLayer=function(t){var e=this.commandHandler.getLayer(t);this.activeLayer=e},i.prototype.addLayer=function(t,e){this.commandHandler.addLayer(t,e)},i.prototype.removeLayer=function(t){this.commandHandler.removeLayer(t)},i.prototype.moveObjects=function(t,e){this.commandHandler.moveObjects(t,e)},i.prototype.sendLayerBackward=function(t){this.commandHandler.sendLayerBackward(t)},i.prototype.bringLayerForward=function(t){this.commandHandler.bringLayerForward(t)},i.prototype.cloneLayer=function(t){this.commandHandler.cloneLayer(t)},i.prototype.bringToFront=function(){this.commandHandler.bringToFront()},i.prototype.moveForward=function(){this.commandHandler.sendForward()},i.prototype.sendBackward=function(){this.commandHandler.sendBackward()},i.prototype.getObject=function(t){return this.nameTable[t]},i.prototype.getActiveLayer=function(){return this.activeLayer},i.prototype.nudgeCommand=function(t,e,i){"object"!=typeof t&&this.nudge(t)},i.prototype.nudge=function(t,e,i){var n=0,o=0;"Left"===t||"Right"===t?n=("Left"===t?-1:1)*(e||1):o=("Up"===t?-1:1)*(i||1);var r=this.selectedItems;this.drag(r,n,o)},i.prototype.drag=function(t,e,i){if(!(this.bpmnModule&&t instanceof fd&&this.bpmnModule.updateAnnotationDrag(t,this,e,i)))if(t instanceof Xc){if(t.nodes&&t.nodes.length)for(var n=0,o=t.nodes;n<o.length;n++){var r=o[n];this.drag(r,e,i)}if(t.connectors&&t.connectors.length)for(var s=0,a=t.connectors;s<a.length;s++){var l=a[s];this.drag(l,e,i)}this.updateSelector()}else t instanceof fd&&this.bpmnModule&&this.bpmnModule.updateAnnotationDrag(t,this,e,i),this.commandHandler.drag(t,e,i)},i.prototype.scale=function(t,e,i,n){var o=!0;if(t instanceof Xc){if(t.nodes&&t.nodes.length)for(var r=0,s=t.nodes;r<s.length;r++){var a=s[r];o=this.commandHandler.scale(a,e,i,n,t)}if(t.connectors&&t.connectors.length)for(var l=0,h=t.connectors;l<h.length;l++){var c=h[l];this.commandHandler.scale(c,e,i,n,t)}this.updateSelector()}else this.commandHandler.scale(t,e,i,n);return o},i.prototype.rotate=function(t,e,i){var n;if(t)if(i=i||{x:t.wrapper.offsetX,y:t.wrapper.offsetY},t instanceof Xc){t.rotateAngle+=e,t.wrapper.rotateAngle+=e;var o=Xr(t.wrapper);if(!(n=this.commandHandler.checkBoundaryConstraints(void 0,void 0,o)))return t.rotateAngle-=e,t.wrapper.rotateAngle-=e,n;var r=[];r=(r=r.concat(t.nodes)).concat(t.connectors),this.commandHandler.rotateObjects(t,r,e,i)}else this.commandHandler.rotateObjects(t,[t],e,i);return n},i.prototype.dragSourceEnd=function(t,e,i){this.commandHandler.dragSourceEnd(t,e,i)},i.prototype.dragTargetEnd=function(t,e,i){this.commandHandler.dragTargetEnd(t,e,i)},i.prototype.findObjectsUnderMouse=function(t,e){return this.eventHandler.findObjectsUnderMouse(t,e)},i.prototype.findObjectUnderMouse=function(t,e,i){return this.eventHandler.findObjectUnderMouse(t,e,i)},i.prototype.findTargetObjectUnderMouse=function(t,e,i,n,o){return this.eventHandler.findTargetUnderMouse(t,e,i,n,o)},i.prototype.findElementUnderMouse=function(t,e){return this.eventHandler.findElementUnderMouse(t,e)},i.prototype.findActionToBeDone=function(t,e,i,n){return this.eventHandler.findActionToBeDone(t,e,i,n)},i.prototype.getTool=function(t){var e,i=as(this.getCustomTool);return i&&(e=i(t))?e:this.eventHandler.getTool(t)},i.prototype.getCursor=function(t,e){var i,n=as(this.getCustomCursor);return n&&(i=n(t,e))?i:this.eventHandler.getCursor(t)},i.prototype.initHistory=function(){this.undoRedoModule&&this.undoRedoModule.initHistory(this)},i.prototype.addHistoryEntry=function(e){this.undoRedoModule&&this.constraints&t.DiagramConstraints.UndoRedo&&!this.currentSymbol&&(this.undoRedoModule.addHistoryEntry(e,this),"StartGroup"!==e.type&&"EndGroup"!==e.type&&this.historyChangeTrigger(e))},i.prototype.historyChangeTrigger=function(e){var i={},n=[];switch(e&&e.redoObject&&e.redoObject.nodes instanceof Array&&e.redoObject.connectors instanceof Array?n=e.redoObject.nodes.concat(e.redoObject.connectors):e.redoObject&&n.push(e.redoObject),i.type=e.type,e.type){case"PositionChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY};break;case"RotationChanged":i.oldValue={rotateAngle:e.undoObject.rotateAngle},i.newValue={rotateAngle:e.redoObject.rotateAngle};break;case"SizeChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY,width:e.undoObject.width,height:e.undoObject.height},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY,width:e.redoObject.width,height:e.redoObject.height};break;case"CollectionChanged":i[e.changeType]=n;break;case"ConnectionChanged":i.oldValue={offsetX:e.undoObject.offsetX,offsetY:e.undoObject.offsetY},i.newValue={offsetX:e.redoObject.offsetX,offsetY:e.redoObject.offsetY}}var o={cause:e.category,source:n,change:i};n.length&&this.triggerEvent(t.DiagramEvent.historyChange,o)},i.prototype.startGroupAction=function(){var t={type:"StartGroup",category:"Internal"};this.addHistoryEntry(t)},i.prototype.endGroupAction=function(){var t={type:"EndGroup",category:"Internal"};this.addHistoryEntry(t)},i.prototype.undo=function(){this.undoRedoModule&&this.constraints&t.DiagramConstraints.UndoRedo&&this.undoRedoModule.undo(this)},i.prototype.redo=function(){this.undoRedoModule&&this.constraints&t.DiagramConstraints.UndoRedo&&this.undoRedoModule.redo(this)},i.prototype.align=function(e,i){i||(i=(i=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|t.DiagramAction.PublicMethod,this.commandHandler.align(i,e)},i.prototype.distribute=function(e,i){i||(i=(i=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|t.DiagramAction.PublicMethod,this.commandHandler.distribute(i,e)},i.prototype.sameSize=function(e,i){i||(i=(i=[]).concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|t.DiagramAction.PublicMethod,this.commandHandler.sameSize(i,e)},i.prototype.zoom=function(t,e){this.scroller.zoom(t,0,0,e)},i.prototype.zoomTo=function(t){var e=t.zoomFactor?t.zoomFactor:.2;e="ZoomOut"===t.type?1/(1+e):1+e,this.scroller.zoom(e,0,0,t.focusPoint)},i.prototype.pan=function(t,e,i){this.scroller.zoom(1,t,e,i)},i.prototype.reset=function(){this.scroller.zoom(1/this.scroller.currentZoom,-this.scroller.horizontalOffset,-this.scroller.verticalOffset,{x:0,y:0})},i.prototype.triggerEvent=function(e,i){i&&this.updateEventValue(i),this.trigger(t.DiagramEvent[e],i)},i.prototype.updateEventValue=function(t){var e=t.element;t.element&&e instanceof Xc&&e.nodes.length+e.connectors.length===1&&(t.element=1===e.nodes.length?e.nodes[0]:e.connectors[0])},i.prototype.add=function(e){var i;if(e){if(e=Yr(e),this.bpmnModule&&!this.bpmnModule.canAdd(e))return null;var n={element:e,cause:this.diagramActions,state:"Changing",type:"Addition",cancel:!1};this.triggerEvent(t.DiagramEvent.collectionChange,n),e.id=e.id||qr();var o=this.activeLayer;if(!n.cancel&&!o.lock){if(o.objects.indexOf(e.id)<0&&!o.lock&&(o.visible||(o.visible=!0,this.dataBind()),o.objects.push(e.id)),wd(e)===_c)i=new _c(this,"connectors",e,!0),this.connectors.push(i),this.initObject(i),!1===e.visible&&this.updateElementVisibility(i.wrapper,i,e.visible),this.updateEdges(i);else if(i=new fd(this,"nodes",e,!0),this.nodes.push(i),this.initObject(i,o),this.bpmnModule){if(i.shape.annotations&&0!==i.shape.annotations.length)for(var r=0,s=this.bpmnModule.getTextAnnotationConn(i);r<s.length;r++){var a=s[r];this.initConnectors(a,o,!1)}i.shape.activity&&i.shape.activity.subProcess.processes&&i.shape.activity.subProcess.processes.length&&this.bpmnModule.updateDocks(i,this)}if(n={element:i,cause:this.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.triggerEvent(t.DiagramEvent.collectionChange,n),!(this.diagramActions&t.DiagramAction.UndoRedo||this.diagramActions&t.DiagramAction.Group)){var l={type:"CollectionChanged",changeType:"Insert",undoObject:Yr(e),redoObject:Yr(e),category:"Internal"};this.addHistoryEntry(l)}this.diagramActions=this.diagramActions|t.DiagramAction.PublicMethod,"SVG"===this.mode&&(this.updateSvgNodes(i),this.updateDiagramObject(i),i.shape.activity&&i.shape.activity.subProcess.processes&&i.shape.activity.subProcess.processes.length&&this.updateProcesses(i))}}return this.resetDiagramActions(t.DiagramAction.PublicMethod),i},i.prototype.updateSvgNodes=function(t){if(t.children)for(var e=0,i=t.children;e<i.length;e++){var n=i[e];if(this.nameTable[n]&&this.nameTable[n].parentId){var o=yr(n+"_groupElement");o.parentNode.removeChild(o)}}},i.prototype.updateProcesses=function(t){if(this.bpmnModule&&t&&t.shape&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length){var e=t.shape.activity.subProcess.processes;this.moveSvgNode(t.id);for(var i=0,n=e;i<n.length;i++){l=n[i];this.moveSvgNode(l);for(var o=[],r=(o=o.concat(this.nameTable[l].outEdges,this.nameTable[l].inEdges)).length-1;r>=0;r--)this.moveSvgNode(o[r])}for(var s=0,a=e;s<a.length;s++){var l=a[s];this.nameTable[l].shape.activity.subProcess.processes&&this.nameTable[l].shape.activity.subProcess.processes.length&&this.updateProcesses(this.nameTable[l])}}else this.moveSvgNode(t.id)},i.prototype.moveSvgNode=function(t){var e=yr(t+"_groupElement"),i=e.parentElement;e.parentNode.removeChild(e),i.appendChild(e)},i.prototype.addTextAnnotation=function(t,e){if(this.bpmnModule){var i=this.bpmnModule.addAnnotation(e,t,this);this.initConnectors(i,this.commandHandler.getObjectLayer(e.id),!1),this.updateDiagramObject(e)}},i.prototype.spliceConnectorEdges=function(t,e){var i,n=[];if(i=e?this.nameTable[t.sourceID]:this.nameTable[t.targetID])for(var o=(n=e?i.outEdges:i.inEdges).length-1;o>=0;o--)n[o]===t.id&&n.splice(o,1)},i.prototype.removeDependentConnector=function(t){for(var e,i=[],n=(i=i.concat(t.outEdges,t.inEdges)).length-1;n>=0;n--)(e=this.nameTable[i[n]])&&(this.connectorTable[e.id]=Yr(e),this.remove(e))},i.prototype.removeObjectsFromLayer=function(t){var e=this.layers.indexOf(this.commandHandler.getObjectLayer(t.id)),i=this.layers[e].objects.indexOf(t.id);i>-1&&(ms(this,t)&&this.unSelect(t),this.layers[e].objects.splice(i,1),delete this.layers[e].zIndexTable[this.nameTable[t.id].zIndex])},i.prototype.removeElements=function(t){if("SVG"===this.mode||"Canvas"===this.mode&&"Native"===t.shape.type){var e=yr(t.id+"_groupElement");e&&e.parentNode.removeChild(e)}this.refreshCanvasLayers();for(var i,n=t.wrapper.children,o=0;o<n.length;o++)if(n[o]instanceof lh||n[o].id&&n[o].id.indexOf("icon_content")>0){n[o].id.indexOf("icon_content")>0&&((i=yr(n[o].id+"_shape_groupElement")).parentNode.removeChild(i),(i=yr(n[o].id+"_rect_groupElement")).parentNode.removeChild(i));for(var r=0,s=this.views;r<s.length;r++){h=s[r];Fr(n[o].id+"_groupElement",h)}}else if(n[o]instanceof Gc)for(var a=0,l=this.views;a<l.length;a++){var h=l[a];Fr(n[o].id+"_html_element",h)}},i.prototype.removeCommand=function(){this.remove()},i.prototype.remove=function(e){var i=[];i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors);var n,o=!1;if(e){if((e=this.nameTable[e.id])&&(Rn(e)||this.diagramActions&t.DiagramAction.Clear)){if(this.bpmnModule&&this.bpmnModule.checkAndRemoveAnnotations(e,this))return void this.refreshCanvasLayers();if(n={element:e,cause:this.diagramActions,state:"Changing",type:"Removal",cancel:!1},this.diagramActions&t.DiagramAction.Clear||this.triggerEvent(t.DiagramEvent.collectionChange,n),!n.cancel){if(!(this.diagramActions&t.DiagramAction.UndoRedo)&&(e instanceof fd||e instanceof _c)){var r={type:"CollectionChanged",changeType:"Remove",undoObject:Yr(e),redoObject:Yr(e),category:"Internal"};this.diagramActions&t.DiagramAction.Clear||i.length>0&&this.undoRedoModule&&!this.layout.type&&(this.historyList.startGroupAction(),o=!0),e instanceof fd&&this.removeDependentConnector(e),this.diagramActions&t.DiagramAction.Clear||this.addHistoryEntry(r)}e.children&&this.deleteGroup(e),e.parentId&&this.deleteChild(e);var s=void 0;this.diagramActions=this.diagramActions|t.DiagramAction.PublicMethod;var a=this.nameTable[e.id];a instanceof fd?("Bpmn"===a.shape.type&&this.bpmnModule&&this.bpmnModule.removeBpmnProcesses(a,this),-1!==(s=this.nodes.indexOf(a))&&(this.nodes.splice(s,1),this.updateNodeEdges(a))):(-1!==(s=this.connectors.indexOf(a))&&this.connectors.splice(s,1),this.updateEdges(a),this.spliceConnectorEdges(e,!0),this.spliceConnectorEdges(e,!1)),o&&this.historyList.endGroupAction(),ms(this,a)&&this.unSelect(a),this.removeObjectsFromLayer(e),this.currentDrawingObject&&(this.currentDrawingObject.wrapper=void 0),delete this.nameTable[e.id],this.removeElements(a),"SVG"!==this.mode&&this.refreshDiagramLayer(),this.diagramActions&t.DiagramAction.Clear||(this.removeFromAQuad(a),n={element:e,cause:this.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.triggerEvent(t.DiagramEvent.collectionChange,n),this.resetTool())}}}else if(i.length>0){this.undoRedoModule&&(this.historyList.startGroupAction(),o=!0);for(var l=0;l<i.length;l++){i[l];this.nameTable[i[l].id]&&this.remove(i[l])}o&&this.historyList.endGroupAction(),this.clearSelection()}},i.prototype.deleteChild=function(t,e){var i;if(e=e?this.nameTable[e.id]:this.nameTable[t.parentId],i="string"==typeof t?t:t.id,e&&e.children){for(var n=0;n<e.children.length;n++)e.children[n]===i&&(e.children.splice(n,1),e.wrapper.children.splice(n,1));e.wrapper.measure(new Al),e.wrapper.arrange(e.wrapper.desiredSize)}},i.prototype.addChild=function(t,e){var i,n=this.nameTable[t.id];n.children&&("string"==typeof e?this.nameTable[e]&&(i=e):(i=e.id=e.id||qr(),this.add(e)),i&&(this.nameTable[i].parentId=n.id,n.children.push(i),n.wrapper.children.push(this.nameTable[i].wrapper),n.wrapper.measure(new Al),n.wrapper.arrange(n.wrapper.desiredSize)))},i.prototype.clear=function(){this.clearObjects()},i.prototype.clearObjects=function(e){var i=[];i=e||(i=i.concat(this.nodes)).concat(this.connectors),this.diagramActions=this.diagramActions|t.DiagramAction.Clear;for(var n=0,o=i;n<o.length;n++){var r=o[n];this.nameTable[r.id]&&this.remove(r)}this.diagramActions=this.diagramActions&~t.DiagramAction.Clear,this.spatialSearch=new mp(this.nameTable),this.initHistory()},i.prototype.startEditCommad=function(){this.startTextEdit()},i.prototype.startTextEdit=function(e,i){if(!Gn(this)||Xn(this)){var n=void 0,o=void 0,r=void 0,s=void 0,a=void 0,l=this.scroller.transform;if(e||(e=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:this.selectedItems.connectors[0]),e){var h=!1;if(this.bpmnModule&&(a=this.bpmnModule.getTextAnnotationWrapper(e,i))&&(e=this.nameTable[e.id.split("_textannotation_")[0]]),a?h=!0:("Text"!==e.shape.type&&0===e.annotations.length&&(this.activeLabel.isGroup=!0,this.startGroupAction(),this.addLabels(e,[{id:qr(),content:""}])),!i&&("Text"!==e.shape.type&&e.annotations.length>0||"Text"===e.shape.type)&&(i="Text"===e.shape.type?e.wrapper.children[0].id.split("_")[1]:e.annotations[0].id),i&&(a=this.getWrapper(e.wrapper,i))),e&&a&&(!ro(a,e)||h)){var c=a.style,d=void 0;d=90>(d=a.bounds.width<e.wrapper.bounds.width?a.bounds.width:e.wrapper.bounds.width)?90:d;var p=document.createElement("div"),u=document.createElement("textarea");p.appendChild(u),n=a.content,(o=dr(a.style,n,void 0,void 0,d)).isEmpty()&&(o="Text"!==e.shape.type?new Al(Ko(e,a.id.split(e.id+"_")[1]).width||50,a.style.fontSize):new Al(e.width>50?50:e.width,a.style.fontSize)),o.width=Math.max(o.width,50),r=(a.bounds.center.x+l.tx)*l.scale-o.width/2-2.5,s=(a.bounds.center.y+l.ty)*l.scale-o.height/2-3,Wr(p,{id:this.element.id+"_editTextBoxDiv",style:"position: absolute;left:"+r+"px;top:"+s+"px;width:"+(o.width+1)+"px;height:"+o.height+"px; containerName:"+e.id+";"}),Wr(u,{id:this.element.id+"_editBox",style:"width:"+(o.width+1)+"px;height:"+o.height+"px;resize: none;outline: none;overflow: hidden;font-family:"+c.fontFamily+";font-size:"+c.fontSize+"px;text-align:"+a.style.textAlign.toLocaleLowerCase()+";",class:"e-diagram-text-edit"}),u.style.fontWeight=c.bold?"bold":"",u.style.fontStyle=c.italic?"italic":"",u.style.textDecoration=c.textDecoration?c.textDecoration:"",u.appendChild(document.createTextNode(n)),this.activeLabel.parentId=e.id,this.activeLabel.id=i,a.visible=!1,this.updateDiagramObject(e),this.diagramActions=this.diagramActions|t.DiagramAction.TextEdit,this.diagramCanvas.appendChild(p),ha.add(u,"input",this.eventHandler.inputChange,this.eventHandler),ha.add(u,"focusout",this.focusOutEdit,this),u.focus(),u.select()}}}},i.prototype.doLayout=function(){var t,e=!1,i=this.isProtectedOnChange;this.protectPropertyChange(!0);var n={x:this.scroller.viewPortWidth,y:this.scroller.viewPortHeight};if(this.organizationalChartModule?(t=this.organizationalChartModule.updateLayout(this.nodes,this.nameTable,this.layout,n,this.dataSourceSettings.id),e=!0):this.mindMapChartModule?(this.mindMapChartModule.updateLayout(this.nodes,this.nameTable,this.layout,n,this.dataSourceSettings.id,this.dataSourceSettings.root),e=!0):this.radialTreeModule?(this.radialTreeModule.updateLayout(this.nodes,this.nameTable,this.layout,n),e=!0):this.symmetricalLayoutModule?(this.symmetricalLayoutModule.maxIteration=this.layout.maxIteration,this.symmetricalLayoutModule.springLength=this.layout.springLength,this.symmetricalLayoutModule.springFactor=this.layout.springFactor,this.symmetricalLayoutModule.updateLayout(this.nodes,this.connectors,this.symmetricalLayoutModule,this.nameTable,this.layout,n),e=!0):this.complexHierarchicalTreeModule&&(this.complexHierarchicalTreeModule.doLayout(this.nodes,this.nameTable,this.layout,n),e=!0),e){this.preventUpdate=!0;for(var o={},r=0,s=this.nodes;r<s.length;r++){var a=s[r];if(this.updateIcon(a),this.updateDefaultLayoutIcons(a),this.nodePropertyChange(a,{},{offsetX:a.offsetX,offsetY:a.offsetY},!0),a.wrapper.measure(new Al(a.wrapper.width,a.wrapper.height)),a.wrapper.arrange(a.wrapper.desiredSize),a.inEdges.length>0)for(var l=0;l<a.inEdges.length;l++)o[(u=this.nameTable[a.inEdges[l]]).id]=u;if(a.outEdges.length>0)for(var h=0;h<a.outEdges.length;h++){var c=this.nameTable[a.outEdges[h]];o[c.id]=c}}for(var d=0,p=Object.keys(o);d<p.length;d++){var u=o[p[d]];qo(u,this.getPoints(u)),u.wrapper.measure(new Al(void 0,void 0)),u.wrapper.arrange(u.wrapper.desiredSize),this.updateQuad(u)}this.preventUpdate=!1,this.updatePage(),this.refreshDiagramLayer()}return i||this.protectPropertyChange(i),t},i.prototype.saveDiagram=function(){return Bo(this)},i.prototype.loadDiagram=function(t){return Ho(t,this)},i.prototype.exportDiagram=function(t){return this.printandExportModule?this.printandExportModule.exportDiagram(t):""},i.prototype.print=function(t){this.printandExportModule&&this.printandExportModule.print(t)},i.prototype.addPorts=function(e,i){var n;i.length>1&&this.startGroupAction();for(var o=0;o<i.length;o++)if(n=new bh(e,"ports",i[o],!0),e.ports.push(n),e.wrapper.children.push(e.initPortWrapper(e.ports[e.ports.length-1])),!(this.diagramActions&t.DiagramAction.UndoRedo||this.diagramActions&t.DiagramAction.Group)){var r={type:"PortCollectionChanged",changeType:"Insert",undoObject:Yr(n),redoObject:Yr(e),category:"Internal"};this.addHistoryEntry(r)}i.length>1&&this.endGroupAction(),e.wrapper.measure(new Al(e.width,e.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateDiagramObject(e)},i.prototype.addLabels=function(e,i){var n,o=e.wrapper;i.length>1&&this.startGroupAction();for(var r=0;r<i.length;r++){if(e instanceof fd)if(n=new Eh(e,"annotations",i[r],!0),e.annotations.push(n),e.children)for(var s=e,a=0;a<s.wrapper.children.length;a++)"group_container"===s.wrapper.children[a].id&&s.wrapper.children[a].children.push(e.initAnnotationWrapper(e.annotations[e.annotations.length-1]));else o.children.push(e.initAnnotationWrapper(e.annotations[e.annotations.length-1]));else if(e instanceof _c){n=new Ph(e,"annotations",i[r],!0),e.annotations.push(n);var l=o.children[0],h=new Rl(l.offsetX-l.width/2,l.offsetY-l.height/2,l.width,l.height);o.children.push(e.getAnnotationElement(e.annotations[e.annotations.length-1],e.intermediatePoints,h,this.getDescription))}if(!(this.diagramActions&t.DiagramAction.UndoRedo||this.diagramActions&t.DiagramAction.Group)){var c={type:"LabelCollectionChanged",changeType:"Insert",undoObject:Yr(n),redoObject:Yr(e),category:"Internal"};this.addHistoryEntry(c)}}i.length>1&&this.endGroupAction(),e.wrapper.measure(new Al(o.width,o.height)),e.wrapper.arrange(o.desiredSize),this.updateDiagramObject(e)},i.prototype.removeLabels=function(e,i){i.length>1&&this.startGroupAction();for(var n=i.length-1;n>=0;n--)for(var o=0;o<e.wrapper.children.length;o++){var r=e.wrapper.children[o];if(r instanceof ch&&r.id.match("_"+i[n].id+"$")){for(var s=0;s<e.annotations.length;s++)if(r.id.match("_"+e.annotations[s].id+"$")){if(!(this.diagramActions&t.DiagramAction.UndoRedo)){var a={type:"LabelCollectionChanged",changeType:"Remove",undoObject:Yr(e.annotations[s]),redoObject:Yr(e),category:"Internal"};this.addHistoryEntry(a)}e.annotations.splice(s,1)}if(e.wrapper.children.splice(o,1),"SVG"===this.mode){var l=yr(r.id);if(l){var h=yr(r.id);h.parentNode.removeChild(h)}yr(r.id+"_text")&&(l=yr(r.id+"_text")).parentNode.removeChild(l)}else this.refreshCanvasLayers()}}i.length>1&&this.endGroupAction()},i.prototype.removePorts=function(e,i){i.length>1&&this.startGroupAction();for(var n=0;n<i.length;n++)for(var o=0;o<e.wrapper.children.length;o++){var r=e.wrapper.children[o];if(r instanceof sh&&r.id.match("_"+i[n].id+"$")){for(var s=0;s<e.ports.length;s++)if(r.id.match("_"+e.ports[s].id+"$")){if(!(this.diagramActions&t.DiagramAction.UndoRedo)){var a={type:"PortCollectionChanged",changeType:"Remove",undoObject:Yr(e.ports[s]),redoObject:Yr(e),category:"Internal"};this.addHistoryEntry(a)}e.ports.splice(s,1)}if(e.wrapper.children.splice(o,1),"SVG"===this.mode){var l=yr(r.id);l.parentNode.removeChild(l)}else this.refreshCanvasLayers()}}i.length>1&&this.endGroupAction()},i.prototype.getSizeValue=function(t,e){var i;if(i=t.toString().indexOf("px")>0?t.toString():t.toString().indexOf("%")>0?void 0!==e?"100%":t.toString():t.toString()+"px",e){uo(this);i="calc("+i+" - "+e+"px)"}return i},i.prototype.renderRulers=function(){this.rulerSettings.showRulers?(lo(this),ho(this,!0),ho(this,!1)):po(this)},i.prototype.intOffPageBackground=function(){var t=new Al;t=uo(this);var e=document.getElementById(this.element.id+"content"),i=this.getSizeValue(this.width,t.width),n=this.getSizeValue(this.height,t.height),o=this.rulerSettings.showRulers?"width:"+i+"; height:"+n+";top:"+t.height+"px;left:"+t.width+"px;overflow: scroll;position:absolute;overflow:auto;":"width:"+i+"; height:"+n+";position:absolute; left:0px;  top:0px;overflow: auto;",r={id:this.element.id+"content",tabindex:"0",style:o};e?(this.diagramCanvas=e,this.diagramCanvas.setAttribute("style",o)):(this.diagramCanvas=Rr("div",r),this.element.appendChild(this.diagramCanvas)),this.diagramCanvas.style.background=this.backgroundColor},i.prototype.initDiagram=function(){this.intOffPageBackground(),Wr(this.element,{style:"width:"+this.getSizeValue(this.width)+"; height:"+this.getSizeValue(this.height)+";position:relative;overflow:hidden;"})},i.prototype.renderBackgroundLayer=function(t,e){var i=this.createSvg(this.element.id+"_backgroundLayer_svg",t.width,t.height);i.setAttribute("style",e);var n=Nr("g",{id:this.element.id+"_backgroundImageLayer",class:"e-background-image-layer"});i.appendChild(n);var o=Nr("g",{id:this.element.id+"_backgroundLayer",class:"e-background-layer"});i.appendChild(o),this.diagramCanvas.appendChild(i)},i.prototype.renderGridLayer=function(t,e){var i=this.createSvg(this.element.id+"_gridline_svg",t.width,t.height);i.setAttribute("class","e-grid-layer");var n=Nr("g",{id:this.element.id+"_gridline",width:"100%",height:"100%"}),o=Nr("rect",{id:this.element.id+"_grid_rect",x:"0",y:"0",width:"100%",height:"100%",fill:"url(#"+this.element.id+"_pattern)"});n.appendChild(o),i.appendChild(n),this.diagramCanvas.appendChild(i),_r(i,{style:e})},i.prototype.renderDiagramLayer=function(t,e){var i;if(this.diagramLayerDiv=document.createElement("div"),i={id:this.element.id+"_diagramLayer_div",style:"width:"+t.width+"px; height:"+t.height+"px;"+e},Wr(this.diagramLayerDiv,i),"SVG"===this.mode){var n=this.createSvg(this.element.id+"_diagramLayer_svg",t.width,t.height);n.setAttribute("style"," pointer-events: none; "),n.setAttribute("class","e-diagram-layer");var o=Nr("g",{id:this.element.id+"_diagramLayer"}),r=Nr("g",{});this.diagramLayer=o,o.setAttribute("style","pointer-events: all;"),r.appendChild(o),n.appendChild(r),this.diagramLayerDiv.appendChild(n)}else this.diagramLayer=xd.createCanvas(this.element.id+"_diagram",t.width,t.height),this.diagramLayer.setAttribute("style","position:absolute;left:0px;top:0px;"),this.diagramLayerDiv.appendChild(this.diagramLayer);this.diagramCanvas.appendChild(this.diagramLayerDiv)},i.prototype.initLayers=function(){var t="position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",e=document.getElementById(this.element.id).getBoundingClientRect(),i=zr();this.scroller.scrollerWidth=i,this.scroller.setViewPortSize(e.width,e.height),this.renderRulers(),Ur(),this.renderBackgroundLayer(e,t),this.renderGridLayer(e,t),this.renderDiagramLayer(e,t),this.renderHTMLLayer(e,t),this.renderPortsExpandLayer(e,t),this.renderNativeLayer(e,t),this.renderAdornerLayer(e,t)},i.prototype.renderAdornerLayer=function(t,e){var i=Rr("div",{id:this.element.id+"_diagramAdornerLayer",style:"width:"+t.width+"px;height:"+t.height+"px;"+e}),n=this.createSvg(this.element.id+"_diagramAdorner_svg",t.width,t.height);n.setAttribute("class","e-adorner-layer"),n.setAttribute("style","pointer-events:none;"),this.adornerLayer=Nr("g",{id:this.element.id+"_diagramAdorner"}),this.adornerLayer.setAttribute("style"," pointer-events: all; "),n.appendChild(this.adornerLayer),i.appendChild(n),this.diagramCanvas.appendChild(i);var o=Nr("g",{id:this.element.id+"_SelectorElement"});this.adornerLayer.appendChild(o),_r(n,{style:"pointer-events:none;"})},i.prototype.renderPortsExpandLayer=function(t,e){var i=this.createSvg(this.element.id+"_diagramPorts_svg",t.width,t.height);i.setAttribute("class","e-ports-expand-layer");var n=Nr("g",{id:this.element.id+"_diagramPorts",class:"e-ports-layer",style:"pointer-events: all;"});i.appendChild(n);var o=Nr("g",{id:this.element.id+"_diagramExpander",class:"e-expand-layer",style:"pointer-events: all;"});i.appendChild(o),this.diagramCanvas.appendChild(i),_r(i,{style:e})},i.prototype.renderHTMLLayer=function(t,e){this.htmlLayer=Rr("div",{id:this.element.id+"_htmlLayer",style:"width:"+t.width+"px; height:"+t.height+"px;position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",class:"e-html-layer"});var i=Rr("div",{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;pointer-events:all;"});this.htmlLayer.appendChild(i),this.diagramCanvas.appendChild(this.htmlLayer)},i.prototype.renderNativeLayer=function(t,e){var i=this.createSvg(this.element.id+"_nativeLayer_svg",t.width,t.height),n=Nr("g",{id:this.element.id+"_nativeLayer",style:"pointer-events:all;"});i.appendChild(n),this.diagramLayerDiv.appendChild(i),_r(i,{class:"e-native-layer",style:e})},i.prototype.createSvg=function(t,e,i){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return _r(n,{id:t,width:e,height:i}),n},i.prototype.initObjects=function(t){this.isLoading||this.initData(),this.initLayerObjects(),this.updateBridging(t)},i.prototype.initLayerObjects=function(){for(var t=this.layers.length>1,e=[],i={},n={},o=[],r=0,s=this.nodes;r<s.length;r++)(x=s[r]).id=x.id||qr(),this.addToLayer(x,t),i[x.id]=x;for(var a=0,l=this.connectors;a<l.length;a++)(x=l[a]).id=x.id||qr(),this.addToLayer(x,t),i[x.id]=x;for(var h=0,c=this.layers;h<c.length;h++){for(var d=0,p=(C=c[h]).objects;d<p.length;d++)if(i[x=p[d]])if(i[x]instanceof _c)if((P=i[x]).sourceID&&P.targetID){var u=i[P.sourceID],g=i[P.targetID];u&&u.wrapper&&g&&g.wrapper?this.initConnectors(i[x],C):e.push(i[x])}else this.initConnectors(i[x],C);else i[x].children?o.push(x):i[x].shape instanceof md&&i[x].shape.activity.subProcess.processes&&i[x].shape.activity.subProcess.processes.length>0?n[i[x].id]=x:this.initNodes(i[x],C);if(this.bpmnModule)for(var m=0,f=this.bpmnModule.textAnnotationConnectors;m<f.length;m++){x=f[m];this.initConnectors(x,C,!1)}}for(var v=0,y=Object.keys(n);v<y.length;v++){x=y[v];this.initObject(i[x]),this.bpmnModule.updateDocks(i[x],this)}for(var b=0,w=o;b<w.length;b++){var x=w[b],C=this.commandHandler.getObjectLayer(x);this.initNodes(i[x],C)}for(var S=0,E=e;S<E.length;S++){var P=E[S],C=this.commandHandler.getObjectLayer(P.id);this.initConnectors(P,C)}},i.prototype.addToLayer=function(t,e){var i;e&&(i=this.commandHandler.getObjectLayer(t.id)),e&&i||-1===this.activeLayer.objects.indexOf(t.id)&&this.activeLayer.objects.push(t.id),this.setZIndex(i||this.activeLayer,t)},i.prototype.updateLayer=function(t){for(var e=0,i=Object.keys(t.layers);e<i.length;e++){for(var n=i[e],o=0,r=this.layers[n].objects;o<r.length;o++){var s=r[o],a=this.nameTable[s];void 0!==t.layers[n].visible?this.updateElementVisibility(a.wrapper,a,t.layers[n].visible):!0===t.layers[n].lock&&this.unSelect(a)}void 0!==t.layers[n].lock&&(this.layers[n].lock=t.layers[n].lock)}"SVG"!==this.mode&&this.refreshDiagramLayer()},i.prototype.updateScrollSettings=function(e){var i=-this.scroller.horizontalOffset+e.scrollSettings.horizontalOffset||0,n=this.scroller.verticalOffset-e.scrollSettings.verticalOffset||0,o={VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom};0===i&&0===n||this.pan(i,n);var r={oldValue:o,newValue:{VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom},source:this};this.triggerEvent(t.DiagramEvent.scrollChange,r)},i.prototype.initData=function(){this.dataBindingModule&&(this.dataSourceSettings.dataManager&&this.dataSourceSettings.dataManager.dataSource&&void 0!==this.dataSourceSettings.dataManager.dataSource.url?this.dataBindingModule.initSource(this.dataSourceSettings,this):this.dataBindingModule.initData(this.dataSourceSettings,this))},i.prototype.initNodes=function(t,e){this.preventUpdate=!0,this.initObject(t,e),this.preventUpdate=!1},i.prototype.initConnectors=function(t,e,i){this.preventUpdate=!0,this.initObject(t,e,i),this.updateEdges(t),this.preventUpdate=!1},i.prototype.setZIndex=function(t,e){var i=t;if(-1===e.zIndex){for(;i.zIndexTable[i.objectZIndex+1];)t.objectZIndex++;e.zIndex=++i.objectZIndex}else{var n=e.zIndex;if(i.zIndexTable[n])for(var o=Object.keys(i.zIndexTable).length,r=0;r<o;r++)if(r===n){for(var s=o;s>n;s--)i.zIndexTable[s]=i.zIndexTable[s-1],this.nameTable[i.zIndexTable[s]]&&(this.nameTable[i.zIndexTable[s]].zIndex=s);i.zIndexTable[r]=e.id}}},i.prototype.initializeDiagramLayers=function(){for(var t=0,e=this.layers;t<e.length;t++){var i=e[t];i.zIndex=this.layers.indexOf(i),this.layerZIndexTable[i.zIndex]=i.id}if(0===this.layers.length){var n={id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}};this.commandHandler.addLayer(n)}this.setActiveLayer(this.layers[this.layers.length-1].id)},i.prototype.resetTool=function(){this.eventHandler.resetTool()},i.prototype.initObject=function(t,e,i){if(void 0===i&&(i=!0),void 0!==t){if(i&&(e||(this.addToLayer(t,!1),e=this.activeLayer),(t instanceof fd||t instanceof _c)&&this.setZIndex(e,t)),t instanceof fd)i&&((n=as(this.getNodeDefaults))&&(o=n(t,this))&&o!==t&&Kr(o,t),this.initNode(t,this.element.id));else if(t instanceof _c){var n=as(this.getConnectorDefaults);if(n){var o=n(t,this);o&&o!==t&&Kr(o,t),t.segments.length&&t.type!==t.segments[0].type&&(t.segments=[])}var r=this.nameTable[t.sourceID],s=this.nameTable[t.targetID];void 0!==r&&_n(r)&&(t.sourceWrapper=this.getEndNodeWrapper(r,t,!0),t.sourcePortID&&(t.sourcePortWrapper=this.getWrapper(r.wrapper,t.sourcePortID))),void 0!==s&&Vn(s)&&(t.targetWrapper=this.getEndNodeWrapper(s,t,!1),t.targetPortID&&(t.targetPortWrapper=this.getWrapper(s.wrapper,t.targetPortID))),i||qo(t,t.getConnectorPoints(t.type)),i&&t.init(this),t.wrapper.measure(new Al(void 0,void 0)),t.wrapper.arrange(t.wrapper.desiredSize)}if(this.bpmnModule&&t instanceof fd&&"Bpmn"===t.shape.type&&t.shape.annotations.length>0&&this.bpmnModule.updateQuad(t,this),i){if(!this.commandHandler.checkBoundaryConstraints(void 0,void 0,t.wrapper.bounds))for(var a=t instanceof fd?this.nodes:this.connectors,l=0;l<=a.length;l++)a[l]&&t.id===a[l].id&&a.splice(l,1);e.zIndexTable[t.zIndex]=t.id}if(this.nameTable[t.id]=t,t instanceof fd&&t.children){this.updateGroupOffset(t),this.groupTable[t.id]=t.children;for(l=0;l<t.children.length;l++)(a=this.nameTable[t.children[l]]).parentId=t.id;!this.isLoading&&t.rotateAngle&&this.commandHandler.rotateObjects(t,[t],t.rotateAngle,{x:t.offsetX,y:t.offsetY},!1)}this.updateQuad(t)}!1===t.visible&&this.updateElementVisibility(t.wrapper,t,!1)},i.prototype.updateDefaultLayoutIcons=function(t){"OrganizationalChart"!==this.layout.type&&"HierarchicalTree"!==this.layout.type&&"ComplexHierarchicalTree"!==this.layout.type||(this.updateDefaultLayoutIcon(t,t.expandIcon),this.updateDefaultLayoutIcon(t,t.collapseIcon))},i.prototype.updateDefaultLayoutIcon=function(t,e){if("None"!==e.shape&&"Auto"===e.horizontalAlignment&&"Auto"===e.verticalAlignment&&.5===e.offset.x&&1===e.offset.y){var i=this.getWrapper(t.wrapper,"icon_content"),n=void 0,o=void 0;"TopToBottom"===this.layout.orientation||"BottomToTop"===this.layout.orientation?(n=.5,o="TopToBottom"===this.layout.orientation?1:0):"RightToLeft"!==this.layout.orientation&&"LeftToRight"!==this.layout.orientation||(n="LeftToRight"===this.layout.orientation?1:0,o=.5),i.setOffsetWithRespectToBounds(n,o,"Fraction"),i.horizontalAlignment="Center",i.verticalAlignment="Center",t.wrapper.measure(new Al(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize)}},i.prototype.updateGroupOffset=function(t){(t.children&&t.children.length>0||t.processId)&&(this.nameTable[t.id].offsetX=t.wrapper.offsetX,this.nameTable[t.id].offsetY=t.wrapper.offsetY,t.children&&t.children.length>0&&(this.nameTable[t.id].width=t.wrapper.actualSize.width,this.nameTable[t.id].height=t.wrapper.actualSize.height))},i.prototype.initNode=function(t,e){var i,n=t.initContainer(),o=new gh;if(n.children||(n.children=[]),t.children){n.measureChildren=!1;for(var r=0;r<t.children.length;r++)this.nameTable[t.children[r]]&&n.children.push(this.nameTable[t.children[r]].wrapper);o.id="group_container",o.style.fill="none",o.style.strokeColor="none",o.horizontalAlignment="Stretch",o.verticalAlignment="Stretch",o.children=[],n.children.push(o)}else{var s=as(this.setNodeTemplate);s&&(i=s(t,this)),i||(i=t.init(this)),n.children.push(i)}var a;a=as(this.getDescription),(t.children?n:i).description=a||(t.annotations.length?t.annotations[0].content:t.id);var l=t.children?o:n;t.initAnnotations(this.getDescription,l),t.initPorts(this.getDescription,l),t.initIcons(this.getDescription,this.layout,l,e),n.measure(new Al(t.width,t.height)),n.arrange(n.desiredSize)},i.prototype.canExecute=function(){return!0},i.prototype.initViews=function(){this.isLoading||(this.views.push(this.element.id),this.views[this.element.id]=this)},i.prototype.initCommands=function(){var e=this.commandManager.commands,i={copy:{execute:this.copyCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.C,keyModifiers:t.KeyModifiers.Control}},paste:{execute:this.pasteCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.V,keyModifiers:t.KeyModifiers.Control}},cut:{execute:this.cutCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.X,keyModifiers:t.KeyModifiers.Control}},delete:{execute:this.removeCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Delete}},selectAll:{execute:this.selectAll.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.A,keyModifiers:t.KeyModifiers.Control}},undo:{execute:this.undo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Z,keyModifiers:t.KeyModifiers.Control}},redo:{execute:this.redo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Y,keyModifiers:t.KeyModifiers.Control}},nudgeUp:{execute:this.nudgeCommand.bind(this,"Up"),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Up},parameter:"up"},nudgeRight:{execute:this.nudgeCommand.bind(this,"Right"),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Right},parameter:"right"},nudgeDown:{execute:this.nudgeCommand.bind(this,"Down"),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Down},parameter:"down"},nudgeLeft:{execute:this.nudgeCommand.bind(this,"Left"),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Left},parameter:"left"},startEdit:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.F2}},endEdit:{execute:this.endEditCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Escape}},focusToNextItem:{canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Tab}},focusToPreviousItem:{canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Tab,keyModifiers:t.KeyModifiers.Control}},selectFocusedItem:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:t.Keys.Enter}}};this.initCommandManager(e,i)},i.prototype.overrideCommands=function(t,e){for(var i,n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];if(i=e[r],t.gesture.key===i.gesture.key&&t.gesture.keyModifiers===i.gesture.keyModifiers){delete e[r];break}}},i.prototype.initCommandManager=function(t,e){var i=0;if(t)for(i=0;i<t.length;i++)e[t[i].name]&&t[i]?(t[i].canExecute&&(e[t[i].name].canExecute=t[i].canExecute),t[i].execute&&(e[t[i].name].execute=t[i].execute),(t[i].gesture.key||t[i].gesture.keyModifiers)&&(e[t[i].name].gesture=t[i].gesture),""!==t[i].parameter&&(e[t[i].name].parameter=t[i].parameter)):(this.overrideCommands(t[i],e),e[t[i].name]={execute:t[i].execute,canExecute:t[i].canExecute,gesture:t[i].gesture,parameter:t[i].parameter});this.commands=e},i.prototype.updateNodeEdges=function(t){for(var e=0,i=t.inEdges;e<i.length;e++){r=i[e];this.nameTable[r]&&(this.nameTable[r].targetID="")}for(var n=0,o=t.outEdges;n<o.length;n++){var r=o[n];this.nameTable[r]&&(this.nameTable[r].sourceID="")}t.inEdges=[],t.outEdges=[]},i.prototype.updateIconVisibility=function(t,e){for(var i=0;i<t.wrapper.children.length;i++){var n=t.wrapper.children[i],o=n.id.split(t.id)[1];n.id&&o&&o.match("^_icon")&&(n.visible=e,this.updateDiagramContainerVisibility(n,e))}},i.prototype.updateEdges=function(t){if(void 0!==t.sourceID&&""!==t.sourceID&&((e=this.nameTable[t.sourceID])&&e.outEdges&&0===e.outEdges.length&&(e.outEdges=[]),e&&e.outEdges&&-1===e.outEdges.indexOf(t.id)&&e.outEdges.push(t.id)),void 0!==t.targetID&&""!==t.targetID){var e=this.nameTable[t.targetID];if(e&&e.inEdges&&0===e.inEdges.length&&(e.inEdges=[]),e&&e.inEdges&&-1===e.inEdges.indexOf(t.id)&&e.inEdges.push(t.id),e&&e.visible&&e.outEdges){var i=0!==e.outEdges.length;this.updateIconVisibility(e,i)}}},i.prototype.refreshDiagram=function(){this.initLayerObjects(),this.doLayout(),this.updateBridging(),this.scroller.setSize()},i.prototype.updateDiagramObject=function(t){for(var e,i=0,n=this.views;i<n.length;i++){var o=n[i];if("SVG"===(e=this.views[o]).mode&&this.diagramActions){var r=Dr(this.element.id),s=document.getElementById(e.element.id+"_diagramLayer");this.diagramRenderer.updateNode(t.wrapper,s,r,void 0)}else this.refreshCanvasDiagramLayer(e)}},i.prototype.getObjectsOfLayer=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var o=n[i];this.nameTable[o]&&e.push(this.nameTable[o])}return e},i.prototype.refreshDiagramLayer=function(){for(var t,e=0,i=this.views;e<i.length;e++){var n=i[e];switch((t=this.views[n]).mode){case"SVG":this.refreshSvgDiagramLayer(t);break;case"Canvas":this.refreshCanvasLayers()}}},i.prototype.refreshCanvasLayers=function(){for(var t=0,e=this.views;t<e.length;t++){var i=e[t],n=this.views[i];this.refreshCanvasDiagramLayer(n)}},i.prototype.renderBasicElement=function(t){for(var e=Dr(t.element.id),i=0;i<this.basicElements.length;i++){var n=this.basicElements[i];n instanceof oh&&(n.prevRotateAngle=0),n.measure(new Al(n.width,n.height)),n.arrange(n.desiredSize),t.diagramRenderer.renderElement(n,t.diagramLayer,e)}},i.prototype.refreshElements=function(t){if(!this.isDestroyed){this.clearCanvas(t),t instanceof i&&(t.diagramLayer.getContext("2d").setTransform(t.scroller.currentZoom,0,0,t.scroller.currentZoom,0,0),t.diagramLayer.getContext("2d").scale(1.5,1.5));var e=Dr(t.element.id);this.spatialSearch.getPageBounds();this.renderDiagramElements(t.diagramLayer,t.diagramRenderer,e),t instanceof i&&(t.diagramLayer.style.transform="scale("+2/3+")",t.diagramLayer.style.transformOrigin="0 0"),this.renderTimer=null}},i.prototype.refreshCanvasDiagramLayer=function(e){var i=this;"SVG"===e.mode||this.isDestroyed||(this.basicElements.length>0&&this.renderBasicElement(e),this.diagramActions&&0!=(this.diagramActions&t.DiagramAction.Render)?this.renderTimer||(this.renderTimer=setTimeout(function(){i.refreshElements(e)},40)):this.refreshElements(e))},i.prototype.updatePortVisibility=function(e,i,n){var o,r=!this.drawingObject||!this.drawingObject.shape;if(e instanceof fd&&r&&In(e)){for(var s=e.ports,a=!1,l=0;l<s.length;l++)o=this.getWrapper(e.wrapper,s[l].id),(i&t.PortVisibility.Hover||i&t.PortVisibility.Connect)&&Zo(s[l],i)&&(o.visible=!n,a=!0);a&&this.updateDiagramObject(e)}},i.prototype.refreshSvgDiagramLayer=function(t){document.getElementById(t.element.id).getBoundingClientRect();for(var e,i=document.getElementById(t.element.id+"_diagramLayer"),n=Dr(t.element.id),o=0;o<this.basicElements.length;o++)(e=this.basicElements[o]).measure(new Al(e.width,e.height)),e.arrange(e.desiredSize),this.diagramRenderer.renderElement(e,i,n);this.renderDiagramElements(i,this.diagramRenderer,n)},i.prototype.renderDiagramElements=function(t,e,i,n){void 0===n&&(n=!0);for(var o=0,r=Object.keys(this.layerZIndexTable);o<r.length;o++)for(var s=r[o],a=this.commandHandler.getLayer(this.layerZIndexTable[s]),l=0,h=Object.keys(a.zIndexTable);l<h.length;l++){var c=h[l],d=this.nameTable[a.zIndexTable[c]].wrapper;this.nameTable[a.zIndexTable[c]].parentId||this.nameTable[a.zIndexTable[c]].processId||e.renderElement(d,t,i,!e.isSvgMode&&n?this.scroller.transform:void 0)}},i.prototype.updateBridging=function(t){if(this.bridgingModule)for(var e=0;e<this.connectors.length;e++){var i=this.connectors[e];this.bridgingModule.updateBridging(i,this);var n=this.connectors[e].wrapper,o=n.children[0],r=o.data;i.getSegmentElement(i,o),o.data!==r&&(n.measure(new Al),n.arrange(n.desiredSize),"SVG"!==this.mode||t||this.updateDiagramObject(i))}},i.prototype.setCursor=function(t){this.diagramRenderer.setCursor(this.diagramCanvas,t)},i.prototype.clearCanvas=function(t){var e,i;e=t.contentWidth||t.diagramLayer.width,i=t.contentHeight||t.diagramLayer.height,"SVG"!==t.mode&&xd.getContext(t.diagramLayer).clearRect(0,0,e,i)},i.prototype.updateScrollOffset=function(){this.scroller.setScrollOffset(this.diagramCanvas.scrollLeft,this.diagramCanvas.scrollTop),co(this)},i.prototype.setOffset=function(t,e){var i=document.getElementById(this.element.id+"content");i&&(i.scrollLeft=t,i.scrollTop=e)},i.prototype.setSize=function(t,e){if(this.diagramLayer&&!this.preventUpdate){var i=uo(this);t-=i.width,e-=i.height;var n=this.spatialSearch.getPageBounds();n.x*=this.scroller.currentZoom,n.y*=this.scroller.currentZoom,n.width*=this.scroller.currentZoom,n.height*=this.scroller.currentZoom;var o="SVG"===this.mode?1:1.5,r="SVG"===this.mode?vr(this.element.id):this.diagramLayer;r.setAttribute("width",(o*t).toString()),r.setAttribute("height",(o*e).toString());var s={width:t.toString(),height:e.toString()};this.diagramLayerDiv.style.width=t+"px",this.diagramLayerDiv.style.height=e+"px",_r(Er(this.element.id),s),_r(Sr(this.element.id),s);var a=br(this.element.id);_r(a,s),a.parentNode.style.width=t+"px",a.parentNode.style.height=e+"px";var l=Pr(this.element.id);_r(l,s),this.diagramRenderer.updateGrid(this.snapSettings,l,this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),_r(Lr(this.element.id),s),this.htmlLayer.style.width=t+"px",this.htmlLayer.style.height=e+"px",this.diagramRenderer.transformLayers(this.scroller.transform,"SVG"===this.mode),"SVG"!==this.mode&&this.refreshDiagramLayer(),this.updateSelector(),this.renderPageBreaks(n)}},i.prototype.removePageBreaks=function(){if(this.diagramLayer){var t=kr(this.element.id);if(t&&t.childNodes)for(var e=t.childNodes.length,i=0;i<e;i++)t.removeChild(t.childNodes[0])}},i.prototype.renderPageBreaks=function(t){this.removePageBreaks();var e=kr(this.element.id);if(e){var i=0;t=this.scroller.getPageBounds(!0);var n=(this.scroller.transform.tx+t.x)*this.scroller.currentZoom,o=(this.scroller.transform.ty+t.y)*this.scroller.currentZoom,r=t.height*this.scroller.currentZoom,s=t.width*this.scroller.currentZoom;Sd.renderSvgBackGroundImage(this.pageSettings.background,this.element,n,o,s,r);var a={id:e.id+"rect",x:n,y:o,height:r,width:s,angle:0,stroke:"",strokeWidth:1,fill:this.pageSettings.background.color,opacity:1,pivotX:0,pivotY:0,visible:!0,dashArray:"0"};if(this.diagramRenderer.drawRect(e,a),this.pageSettings.showPageBreaks){var l=this.scroller.getPageBreak(t);for(i=0;i<l.length;i++)this.diagramRenderer.drawLine(e,{class:"e-diagram-page-break",fill:"none",stroke:"#aaaaaa",strokeWidth:1,dashArray:"10 10",opacity:2,x:0,y:0,width:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,startPoint:{x:(l[i].x1+this.scroller.transform.tx)*this.scroller.currentZoom,y:(l[i].y1+this.scroller.transform.ty)*this.scroller.currentZoom},endPoint:{x:(l[i].x2+this.scroller.transform.tx)*this.scroller.currentZoom,y:(l[i].y2+this.scroller.transform.ty)*this.scroller.currentZoom},id:l[i].y1===l[i].y2?"HorizontalLines":"VerticalLines"})}}},i.prototype.validatePageSize=function(){var t=0;"Portrait"===this.pageSettings.orientation?this.pageSettings.width>this.pageSettings.height&&(t=this.pageSettings.height,this.pageSettings.height=this.pageSettings.width,this.pageSettings.width=t):this.pageSettings.height>this.pageSettings.width&&(t=this.pageSettings.width,this.pageSettings.width=this.pageSettings.height,this.pageSettings.height=t)},i.prototype.setOverview=function(t,e){if(t)t&&(this.views.push(t.id),this.views[t.id]=t,t.renderDocument(t),t.diagramRenderer.setLayers(),t.updateView(t),this.renderNodes(t));else{for(var i=0;i<this.views.length;i++)this.views[i]===e&&(t=this.views[e]);this.views[e]=void 0;var n=this.views.indexOf(e);this.views.splice(n,1)}},i.prototype.renderNodes=function(t){if(t){var e=new Sd(t.id,new Cd,!1),i=document.getElementById(t.element.id+"_diagramLayer"),n=Dr(t.element.id);this.renderDiagramElements(i,t.diagramRenderer||e,n)}},i.prototype.updateThumbConstraints=function(e,i){for(var n=e.length,o=0;o<n;o++){var r=e[o],s=!1,a=!1,l=i.thumbsConstraints;r instanceof fd?(s="Bpmn"===r.shape.type&&"Activity"===r.shape.shape&&!1===r.shape.activity.subProcess.collapsed||"TextAnnotation"===r.shape.shape,a="Bpmn"===r.shape.type&&"TextAnnotation"===r.shape.shape,jn(r)&&l&t.ThumbsConstraints.Rotate&&!s||(l&=~t.ThumbsConstraints.Rotate),Wn(r,"SouthEast")&&l&t.ThumbsConstraints.ResizeSouthEast&&!a||(l&=~t.ThumbsConstraints.ResizeSouthEast),Wn(r,"NorthWest")&&l&t.ThumbsConstraints.ResizeNorthWest&&!a||(l&=~t.ThumbsConstraints.ResizeNorthWest),Wn(r,"East")&&l&t.ThumbsConstraints.ResizeEast&&!a||(l&=~t.ThumbsConstraints.ResizeEast),Wn(r,"West")&&l&t.ThumbsConstraints.ResizeWest&&!a||(l&=~t.ThumbsConstraints.ResizeWest),Wn(r,"North")&&l&t.ThumbsConstraints.ResizeNorth&&!a||(l&=~t.ThumbsConstraints.ResizeNorth),Wn(r,"South")&&l&t.ThumbsConstraints.ResizeSouth&&!a||(l&=~t.ThumbsConstraints.ResizeSouth),Wn(r,"NorthEast")&&l&t.ThumbsConstraints.ResizeNorthEast&&!a||(l&=~t.ThumbsConstraints.ResizeNorthEast),Wn(r,"SouthWest")&&l&t.ThumbsConstraints.ResizeSouthWest&&!a||(l&=~t.ThumbsConstraints.ResizeSouthWest)):(l|=t.ThumbsConstraints.Default,Bn(r)?l|=t.ThumbsConstraints.ConnectorSource:l&=~t.ThumbsConstraints.ConnectorSource,Hn(r)?l|=t.ThumbsConstraints.ConnectorTarget:l&=~t.ThumbsConstraints.ConnectorTarget),i.thumbsConstraints=l}},i.prototype.renderSelector=function(e){var i=new Al,n=this.selectedItems;n.constraints;if(this.clearSelectorLayer(),this.commandHandler.hasSelection()){if(1===n.nodes.length&&0===n.connectors.length&&(n.rotateAngle=n.nodes[0].rotateAngle,n.pivot=n.nodes[0].pivot),n.wrapper.measure(i),n.wrapper.arrange(n.wrapper.desiredSize),n.width=n.wrapper.actualSize.width,n.height=n.wrapper.actualSize.height,n.offsetX=n.wrapper.offsetX,n.offsetY=n.wrapper.offsetY,0!==n.rotateAngle){for(var o=0,r=n.nodes;o<r.length;o++){var s=r[o];s.offsetX=s.wrapper.offsetX,s.offsetY=s.wrapper.offsetY}for(var a=0,l=n.connectors;a<l.length;a++)l[a]}this.spatialSearch.getPageBounds();var h=void 0;if(h=wr(this.element.id),n.thumbsConstraints=t.ThumbsConstraints.Default,this.updateThumbConstraints(n.nodes,n),this.updateThumbConstraints(n.connectors,n),n.nodes.length+n.connectors.length===1){if(n.nodes[0]instanceof fd)this.diagramRenderer.renderResizeHandle(n.nodes[0].wrapper,h,n.thumbsConstraints,this.scroller.currentZoom,n.constraints,this.scroller.transform,void 0,In(n.nodes[0]));else if(n.connectors[0]instanceof _c){var c=n.connectors[0];this.diagramRenderer.renderEndPointHandle(c,h,n.thumbsConstraints,n.constraints,this.scroller.transform,void 0!==c.sourceWrapper,void 0!==c.targetWrapper,!(!this.connectorEditingToolModule||!zn(c)))}}else this.diagramRenderer.renderResizeHandle(n.wrapper,h,n.thumbsConstraints,this.scroller.currentZoom,n.constraints,this.scroller.transform,void 0,In(n));this.diagramRenderer.renderUserHandler(n,h,this.scroller.transform)}},i.prototype.updateSelector=function(){this.spatialSearch.getPageBounds();var e=new Al,i=this.selectedItems,n=i.constraints;if(this.diagramActions&t.DiagramAction.ToolAction||1!==this.selectedItems.nodes.length||(this.selectedItems.rotateAngle=this.selectedItems.nodes[0].rotateAngle,this.selectedItems.wrapper.rotateAngle=this.selectedItems.nodes[0].rotateAngle),void 0!==this.selectedItems&&(this.clearSelectorLayer(),null!==i.wrapper&&i.wrapper.children.length)){if(i.wrapper.measure(e),i.wrapper.arrange(i.wrapper.desiredSize),0!==i.rotateAngle||i.rotateAngle!==i.wrapper.prevRotateAngle)for(var o=0,r=i.nodes;o<r.length;o++){var s=r[o];s.offsetX=s.wrapper.offsetX,s.offsetY=s.wrapper.offsetY}i.width=i.wrapper.actualSize.width,i.height=i.wrapper.actualSize.height,i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY;var a=void 0;a=wr(this.element.id);var l=this.eventHandler.canHideResizers();if(i.thumbsConstraints=t.ThumbsConstraints.Default,this.updateThumbConstraints(i.nodes,i),this.updateThumbConstraints(i.connectors,i),this.selectedItems.constraints&t.SelectorConstraints.UserHandle&&this.diagramRenderer.renderUserHandler(i,a,this.scroller.transform),i.nodes.length+i.connectors.length===1)if(i.connectors[0]instanceof _c){var h=i.connectors[0];this.diagramRenderer.renderEndPointHandle(h,a,i.thumbsConstraints,n,this.scroller.transform,void 0!==h.sourceWrapper,void 0!==h.targetWrapper,!(!this.connectorEditingToolModule||!zn(h)))}else i.nodes[0]instanceof fd&&this.diagramRenderer.renderResizeHandle(i.nodes[0].wrapper,a,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,l,In(i.nodes[0]));else this.diagramRenderer.renderResizeHandle(i.wrapper,a,i.thumbsConstraints,this.scroller.currentZoom,i.constraints,this.scroller.transform,l,In(i))}},i.prototype.drawSelectionRectangle=function(t,e,i,n){this.clearSelectorLayer(),this.diagramRenderer.drawSelectionRectangle(t,e,i,n,this.adornerLayer,this.scroller.transform)},i.prototype.renderHighlighter=function(t){var e=br(this.element.id);this.diagramRenderer.renderHighlighter(t,e,this.scroller.transform)},i.prototype.clearHighlighter=function(){var t=br(this.element.id),e=t.getElementById(t.id+"_highlighter");e&&e.parentNode.removeChild(e)},i.prototype.getNodesConnectors=function(t){for(i=0;i<this.nodes.length;i++){var e=this.nodes[i];t.push(e)}for(var i=0;i<this.connectors.length;i++){var n=this.connectors[i];t.push(n)}return t},i.prototype.clearSelectorLayer=function(){var t=br(this.element.id),e=(t.getElementById(t.id+"_highlighter"),t.getElementById(this.adornerLayer.id+"_selected_region"));e&&e.parentNode.removeChild(e),this.clearHighlighter();for(var i,n=wr(this.element.id).childNodes,o=n.length;o>0;o--)(i=n[o-1]).parentNode.removeChild(i)},i.prototype.getWrapper=function(t,e){var i;e=t.id+"_"+e;for(var n=t instanceof gh?t:this.getPortContainer(this.nameTable[t.id]),o=0;o<n.children.length;o++)e===n.children[o].id&&(i=n.children[o]);return i},i.prototype.getEndNodeWrapper=function(t,e,i){if("Bpmn"===t.shape.type&&t.wrapper.children[0]instanceof gh){if("Activity"===t.shape.shape){if(i&&"Transaction"===t.shape.activity.subProcess.type&&e.sourcePortID){var n=e.sourcePortID,o=t.wrapper.children[0].children[0].children[2];if(o.children)for(var r=0,s=o.children;r<s.length;r++){var a=s[r];if(a.visible&&a.id===t.id+"_"+n)return a.children[0]}}return t.wrapper.children[0].children[0].children[0]}return t.wrapper.children[0].children[0]}return this.containsMargin(t.wrapper.children[0])||t.children?t.wrapper:t.wrapper.children[0]},i.prototype.containsMargin=function(t){return t.margin&&(0!==t.margin.left||0!==t.margin.top||0!==t.margin.right||0!==t.margin.bottom)},i.prototype.focusOutEdit=function(){this.endEdit(!0)},i.prototype.endEditCommand=function(){this.endEdit()},i.prototype.endEdit=function(e){if(this.diagramActions&t.DiagramAction.TextEdit){var i=document.getElementById(this.element.id+"_editBox"),n=i.value;ha.remove(i,"input",this.eventHandler.inputChange),ha.remove(i,"focusout",this.focusOutEdit);var o=document.getElementById(this.element.id+"_editTextBoxDiv"),r={oldValue:o.textContent,newValue:n,cancel:!1},s=!1,a=void 0;o.parentNode.removeChild(o);var l=void 0;if(this.bpmnModule&&(a=this.bpmnModule.isBpmnTextAnnotation(this.activeLabel,this),l=this.bpmnModule.getTextAnnotationWrapper(a,this.activeLabel.id),(s=!!a)&&o.textContent!==n&&(this.triggerEvent(t.DiagramEvent.textEdit,r),r.cancel||this.bpmnModule.updateTextAnnotationContent(a,this.activeLabel,n,this))),!s){a=this.nameTable[this.activeLabel.parentId];var h=this.eventHandler.isAddTextNode(a,!0);h||o.textContent===n||this.triggerEvent(t.DiagramEvent.textEdit,r),l||(l=this.getWrapper(a.wrapper,this.activeLabel.id));var c=Ko(a,this.activeLabel.id);if(c.content===n||r.cancel||(c.content=n,this.dataBind(),this.updateSelector()),h&&(this.removeObjectsFromLayer(a),this.removeFromAQuad(a),delete this.nameTable[this.activeLabel.parentId],""!==n)){this.clearSelection();var d=Yr(a);a=this.add(d),this.updateDiagramObject(a),this.commandHandler.select(this.nameTable[a.id])}}l.visible=!0,this.updateDiagramObject(a),this.diagramActions=this.diagramActions&~t.DiagramAction.TextEdit,this.activeLabel.isGroup&&this.endGroupAction(),this.activeLabel={id:"",parentId:"",isGroup:!1}}},i.prototype.canLogChange=function(){return!(!(this.diagramActions&t.DiagramAction.Render)||this.diagramActions&t.DiagramAction.ToolAction||this.diagramActions&t.DiagramAction.UndoRedo||this.diagramActions&t.DiagramAction.PublicMethod)},i.prototype.modelChanged=function(t,e){return!!(t.connectors||e.connectors||t.nodes||e.connectors||t.pageSettings||e.pageSettings||t.bridgeDirection||e.bridgeDirection)},i.prototype.resetDiagramActions=function(e){var i=!!e;this.diagramActions&t.DiagramAction.UndoRedo&&(!i||e===t.DiagramAction.UndoRedo)&&(this.diagramActions=this.diagramActions&~t.DiagramAction.UndoRedo),this.diagramActions&t.DiagramAction.PublicMethod&&(!i||e===t.DiagramAction.PublicMethod)&&(this.diagramActions=this.diagramActions&~t.DiagramAction.PublicMethod)},i.prototype.removeNode=function(t){this.removeObjectsFromLayer(t),this.removeFromAQuad(this.nameTable[t.id]),delete this.nameTable[t.id],t.children&&delete this.groupTable[t.id],this.nodes.splice(this.nodes.indexOf(t),1)},i.prototype.deleteGroup=function(t){var e=[],i=[];t.children&&(i=this.commandHandler.getChildren(t,e));for(var n=0,o=i;n<o.length;n++){var r=o[n];this.nameTable[r.id]&&this.remove(r)}},i.prototype.updateObject=function(e,i,n){if(!(this.diagramActions&t.DiagramAction.ToolAction)){var o=e.wrapper.children[0].bounds;if(!this.commandHandler.checkBoundaryConstraints(void 0,void 0,o))if(e instanceof fd){for(var r=i,s=0,a=Object.keys(n);s<a.length;s++)switch(c=a[s]){case"width":e.width=r.width;break;case"height":e.height=r.height;break;case"offsetX":e.offsetX=r.offsetX;break;case"offsetY":e.offsetY=r.offsetY;break;case"rotateAngle":e.rotateAngle=r.rotateAngle}this.nodePropertyChange(e,n,i)}else{for(var l=0,h=Object.keys(n);l<h.length;l++){var c=h[l],d=i,p=e.sourcePoint,u=e.targetPoint;switch(c){case"sourcePoint":p.x=d.sourcePoint.x||p.x,p.y=d.sourcePoint.y||p.y;break;case"targetPoint":u.x=d.targetPoint.x||u.x,u.y=d.targetPoint.y||u.y}}this.connectorPropertyChange(e,n,i)}}},i.prototype.nodePropertyChangeExtend=function(t,e,i,n){return void 0!==i.style&&"Bpmn"!==t.shape.type&&(jo(i.style,t.wrapper.children[0]),n=!0),void 0!==i.constraints&&(this.updateThumbConstraints(this.selectedItems.nodes,this.selectedItems),this.updateSelector(),n=!0),n},i.prototype.connectorSegmentChange=function(t,e){var i,n,o=!0;if(!1===e.equals(e,t.wrapper.bounds)&&t.outEdges.length>0)for(var r=0;r<t.outEdges.length;r++){var s=this.nameTable[t.outEdges[r]];if(o=""!==s.targetID?!this.commandHandler.isSelected(this.nameTable[s.targetID]):!this.commandHandler.isSelected(this.nameTable[s.id]),"Orthogonal"===s.type&&s.segments&&s.segments.length>1&&o){switch(s.segments[0].direction){case"Bottom":i=t.wrapper.bounds.bottomCenter.x-e.bottomCenter.x,n=t.wrapper.bounds.bottomCenter.y-e.bottomCenter.y;break;case"Top":i=t.wrapper.bounds.topCenter.x-e.topCenter.x,n=t.wrapper.bounds.topCenter.y-e.topCenter.y;break;case"Left":i=t.wrapper.bounds.middleLeft.x-e.middleLeft.x,n=t.wrapper.bounds.middleLeft.y-e.middleLeft.y;break;case"Right":i=t.wrapper.bounds.middleRight.x-e.middleRight.x,n=t.wrapper.bounds.middleRight.y-e.middleRight.y}this.commandHandler.dragSourceEnd(s,i,n,!0,null,"ConnectorSourceEnd",void 0,void 0,void 0,!0)}}},i.prototype.nodePropertyChange=function(e,i,n,o){var r,s=e.wrapper.outerBounds,a=e.wrapper.bounds,l=!1;if(void 0===n.width||e.children||(e.wrapper.children[0].width=n.width,r=!0,l=!0),void 0===n.height||e.children||(e.wrapper.children[0].height=n.height,r=!0,l=!0),r=this.nodePropertyChangeExtend(e,i,n,r),void 0!==n.constraints&&Fn(i)!==Fn(n)&&(e.wrapper.children[0].shadow=Fn(e)?e.shadow:null),void 0!==n.offsetX&&(e.wrapper.offsetX=n.offsetX,r=!0,l=!0),void 0!==n.offsetY&&(e.wrapper.offsetY=n.offsetY,r=!0,l=!0),void 0!==n.pivot&&(e.wrapper.pivot=n.pivot,r=!0),void 0!==n.minWidth&&(e.wrapper.minWidth=n.minWidth,r=!0,l=!0),void 0!==n.minHeight&&(e.wrapper.minHeight=n.minHeight,r=!0,l=!0),void 0!==n.maxWidth&&(e.wrapper.maxWidth=n.maxWidth,r=!0,l=!0),void 0!==n.maxHeight&&(e.wrapper.maxHeight=n.maxHeight,r=!0,l=!0),void 0!==n.rotateAngle&&(e.wrapper.rotateAngle=n.rotateAngle,r=!0,l=!0),void 0!==n.backgroundColor&&(e.wrapper.style.fill=n.backgroundColor),void 0!==n.visible&&this.updateElementVisibility(e.wrapper,e,e.visible),void 0!==n.shape&&"Bpmn"!==e.shape.type&&(r=!0,_o(n,e,i,this),l=!0),n.margin&&(r=!0,this.updateMargin(e,n),l=!0),(void 0!==n.shape&&void 0===n.shape.type||void 0!==n.width||void 0!==n.height||void 0!==n.style)&&"Bpmn"===e.shape.type&&this.bpmnModule&&(r=!0,l=!0,this.bpmnModule.updateBPMN(n,i,e,this)),void 0!==n.ports)for(var h=0,c=Object.keys(n.ports);h<c.length;h++){var d=c[h],p=Number(d);r=!0;var u=n.ports[d],g=e.ports[p];this.updatePort(u,g,e.wrapper)}if(void 0!==n.annotations||void 0!==n.width)for(var m=0,f=Object.keys(n.annotations||e.annotations);m<f.length;m++){var d=f[m],p=Number(d);r=!0;var u=n.annotations?n.annotations[d]:e.annotations,v=e.annotations[p];if(v){var y=!!e.width;this.updateAnnotation(u,v,e.wrapper,e,y)}}void 0===n.expandIcon&&void 0===n.collapseIcon&&void 0===n.isExpanded||(this.updateIcon(e),this.updateDefaultLayoutIcons(e),void 0!==n.isExpanded&&this.commandHandler.expandNode(e,!0,this),r=!0),void 0!==n.tooltip&&this.updateTooltip(e,n),r&&(this.diagramActions&t.DiagramAction.ToolAction||this.checkSelectedItem(e)&&this.updateSelector(),void 0!==this.bpmnModule&&this.bpmnModule.updateTextAnnotationProp(e,{offsetX:i.offsetX||e.offsetX,offsetY:i.offsetY||e.offsetY},this),e.wrapper.measure(new Al(e.wrapper.bounds.width,e.wrapper.bounds.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateObject(e,i,n),o?e&&e.visible&&e.outEdges&&this.updateIconVisibility(e,0!==e.outEdges.length):(this.connectorSegmentChange(e,a),l&&this.updateConnectorEdges(e)),void 0!==this.bpmnModule&&this.bpmnModule.updateDocks(e,this),this.updateGroupOffset(e),!1===s.equals(s,e.wrapper.outerBounds)&&this.updateQuad(e),!1===a.equals(a,e.wrapper.bounds)&&(this.updateGroupSize(e),e.children&&this.updateGroupOffset(e)),"SVG"===this.mode&&this.updateDiagramObject(e))},i.prototype.updateConnectorEdges=function(t){if(t.inEdges.length>0)for(var e=0;e<t.inEdges.length;e++){var i=this.nameTable[t.inEdges[e]],n={sourcePoint:i.sourcePoint,targetPoint:i.targetPoint,sourceID:i.sourceID,targetID:i.targetID,sourcePortID:i.sourcePortID,targetPortID:i.targetPortID};this.connectorPropertyChange(i,{},n)}if(t.outEdges.length>0)for(var o=0;o<t.outEdges.length;o++){var r=this.nameTable[t.outEdges[o]],n={sourcePoint:r.sourcePoint,targetPoint:r.targetPoint,sourceID:r.sourceID,targetID:r.targetID,sourcePortID:r.sourcePortID,targetPortID:r.targetPortID};this.connectorPropertyChange(r,{},n)}t.parentId&&this.updateConnectorEdges(this.nameTable[t.parentId])},i.prototype.connectorProprtyChangeExtend=function(t,e,i,n){return void 0!==i.type&&i.type!==e.type&&t.segments.length>0&&void 0===i.segments&&(t.segments=[]),void 0!==i.shape&&void 0!==t.shape&&t.shape&&"Bpmn"===t.shape.type&&this.bpmnModule&&this.bpmnModule.updateBPMNConnector(t,e,i,this),void 0!==t.constraints?(this.updateThumbConstraints(this.selectedItems.connectors,this.selectedItems),n=!0):n},i.prototype.connectorPropertyChange=function(e,i,n,o){var r=e.wrapper.bounds,s=!1,a=[];if(s=this.connectorProprtyChangeExtend(e,i,n,s),void 0!==n.visible&&this.updateElementVisibility(e.wrapper,n,e.visible),void 0!==n.sourcePoint||void 0!==n.targetPoint||void 0!==n.sourceID||void 0!==n.targetID||void 0!==n.sourcePortID||void 0!==n.targetPortID||void 0!==n.type||void 0!==n.segments){if(void 0!==n.sourceID&&n.sourceID!==i.sourceID||n.sourcePortID){var l=this.nameTable[e.sourceID];if(l&&!_n(l)||(e.sourceWrapper=l?this.getEndNodeWrapper(l,e,!0):void 0),void 0!==n.sourceID&&void 0!==i.sourceID&&""!==i.sourceID){var h=this.nameTable[i.sourceID];void 0!==h&&h.outEdges&&-1!==h.outEdges.indexOf(e.id)&&Uo(h.outEdges,e.id)}this.updateEdges(e)}if(void 0!==n.targetID&&n.targetID!==i.targetID){var c=this.nameTable[n.targetID];if(c&&!Vn(c)||(e.targetWrapper=c?this.getEndNodeWrapper(c,e,!1):void 0),void 0!==i&&void 0!==i.targetID&&""!==i.targetID){var d=this.nameTable[i.targetID];void 0!==d&&d.inEdges&&-1!==d.inEdges.indexOf(e.id)&&Uo(d.inEdges,e.id)}this.updateEdges(e)}if(void 0!==n.sourcePortID&&n.sourcePortID!==i.sourcePortID){var p=void 0;e.sourceID&&this.nameTable[e.sourceID]&&(p=this.nameTable[e.sourceID].wrapper),e.sourcePortWrapper=p?this.getWrapper(p,n.sourcePortID):void 0}if(void 0!==n.targetPortID&&n.targetPortID!==i.targetPortID){var u=void 0;e.targetID&&this.nameTable[e.targetID]&&(u=this.nameTable[e.targetID].wrapper),e.targetPortWrapper=u?this.getWrapper(u,n.targetPortID):void 0}a=this.getPoints(e)}if(void 0!==n.style&&jo(n.style,e.wrapper.children[0]),(a.length>0||void 0!==n.sourceDecorator||void 0!==n.targetDecorator||void 0!==n.cornerRadius)&&(qo(e,a.length>0?a:e.intermediatePoints),void 0!==n.type&&(s=!0),a.length>0)){if(e.wrapper.measure(new Al(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),e.annotations.length)for(var g=0,m=e.annotations;g<m.length;g++){var f=m[g],v=void 0;v=this.getWrapper(e.wrapper,f.id),e.updateAnnotation(f,e.intermediatePoints,e.wrapper.bounds,v)}e.wrapper.measure(new Al(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),this.updateObject(e,i,n)}(n.sourcePoint||n.targetPoint||n.segments)&&this.diagramActions===t.DiagramAction.Render&&(s=!0),o||this.updateBridging(),this.updateAnnotations(n,e),e.wrapper.measure(new Al(e.wrapper.width,e.wrapper.height)),e.wrapper.arrange(e.wrapper.desiredSize),!1===r.equals(r,e.wrapper.bounds)&&(this.updateQuad(e),this.updateGroupSize(e)),!0===s&&this.checkSelectedItem(e)&&this.updateSelector(),"SVG"===this.mode&&this.updateDiagramObject(e)},i.prototype.getPoints=function(t,e){return t.getConnectorPoints(t.type,e,"ComplexHierarchicalTree"===this.layout.type||"HierarchicalTree"===this.layout.type?this.layout.orientation:void 0)},i.prototype.updateNodeProperty=function(t,e,i){if(void 0===e)this.updateElementVisibility(t,this.nameTable[t.id],e);else{t.style.opacity=i;for(var n=0;n<t.children.length;n++)t.children[n]instanceof oh&&this.updateNodeProperty(t.children[n],void 0,i),t.children[n].style.opacity=i}},i.prototype.checkSelectedItem=function(t){var e=this.selectedItems,i=!1,n=[];return(n=n.concat(e.nodes,e.connectors)).length>0&&t.id===n[n.length-1].id&&(i=!0),i},i.prototype.updateDiagramContainerVisibility=function(t,e){if(t instanceof oh)for(var i=0;i<t.children.length;i++)this.updateDiagramContainerVisibility(t.children[i],e);t.visible=e},i.prototype.updateElementVisibility=function(e,i,n){if(void 0!==n){if(e.visible=n,i instanceof fd){if(i.children)for(var o=0,r=i.children;o<r.length;o++){var s=r[o];this.updateElementVisibility(this.nameTable[s].wrapper,this.nameTable[s],n)}else e.children[0].visible=n,this.updateDiagramContainerVisibility(e.children[0],n),"Bpmn"===i.shape.type&&this.bpmnModule&&this.bpmnModule.updateElementVisibility(i,n,this);if(i.ports)for(var a=0,l=i.ports;a<l.length;a++){var h=l[a];h.visibility&t.PortVisibility.Visible&&((m=this.getWrapper(e,h.id)).visible=n)}if(i.annotations)for(var c=0,d=i.annotations;c<d.length;c++){g=d[c];(m=this.getWrapper(e,g.id)).visible=n}}else for(f=0;f<3;f++)e.children[f].visible=n;if(i.annotations)for(var p=0,u=i.annotations;p<u.length;p++){var g=u[p];(m=this.getWrapper(e,g.id)).visible=n}if(i.expandIcon||i.collapseIcon){var m=this.getWrapper(e,"icon_content");if(m){for(var f=0;f<m.children.length;f++)m.children[f].visible=n;m.visible=n}}!1===n&&this.unSelect(this.nameTable[e.id]),this.updateDiagramObject(this.nameTable[e.id])}},i.prototype.updateAnnotations=function(t,e){if(void 0!==t.annotations)for(var i=0,n=Object.keys(t.annotations);i<n.length;i++){var o=n[i],r=Number(o),s=t.annotations[o],a=e.annotations[r];this.updateAnnotation(s,a,e.wrapper,e)}},i.prototype.updateAnnotation=function(t,e,i,n,o){var r,s=!1;if(void 0!==(r=this.getWrapper(i,e.id))){if(void 0!==t.width&&void 0!==t.height&&(r.width=t.width,r.height=t.height,s=!0),o&&r.refreshTextElement(),e instanceof Eh&&void 0!==t.offset){var a=t.offset;s=!0;var l=void 0!==a.x?a.x:e.offset.x,h=void 0!==a.y?a.y:e.offset.y;r.setOffsetWithRespectToBounds(l,h,"Fraction"),r.relativeMode="Point"}else e instanceof Ph&&void 0!==t.offset&&n.updateAnnotation(e,n.intermediatePoints,n.wrapper.bounds,r);e instanceof Ph&&t.displacement&&(void 0===t.displacement.x&&void 0===t.displacement.y||(s=!0)),void 0!==t.margin&&(s=!0,void 0!==t.margin.bottom&&(r.margin.bottom=t.margin.bottom),void 0!==t.margin.top&&(r.margin.top=t.margin.top),void 0!==t.margin.left&&(r.margin.left=t.margin.left),void 0!==t.margin.right&&(r.margin.right=t.margin.right)),(s||o)&&(r.width=(e.width||n.width)-r.margin.left-r.margin.right),void 0!==t.horizontalAlignment&&(r.horizontalAlignment=t.horizontalAlignment,s=!0),void 0!==t.verticalAlignment&&(r.verticalAlignment=t.verticalAlignment,s=!0),void 0!==t.visibility&&(r.visible=!(!i.visible||!t.visibility)),void 0!==t.constraints&&(r.constraints=t.constraints),void 0!==t.style&&jo(t.style,r),void 0!==t.hyperlink&&Fo(t.hyperlink,r,e),void 0!==t.content&&r&&(s=!0,r.content=t.content),!0===s&&(r.measure(new Al(r.width,r.height)),r.arrange(r.desiredSize)),r.refreshTextElement()}},i.prototype.updatePort=function(e,i,n){var o,r=!1;if(void 0!==(o=this.getWrapper(n,i.id))){if(void 0!==e.offset){r=!0;var s=void 0!==e.offset.x?e.offset.x:i.offset.x,a=void 0!==e.offset.y?e.offset.y:i.offset.y;o.setOffsetWithRespectToBounds(s,a,"Fraction"),o.relativeMode="Point"}if(void 0!==e.width&&(r=!0,o.width=e.width),void 0!==e.height&&(r=!0,o.height=e.height),void 0!==e.visibility&&(o.visible=!(!n.visible||!Zo(i,t.PortVisibility.Visible))),void 0!==e.margin&&(r=!0,void 0!==e.margin.bottom&&(o.margin.bottom=e.margin.bottom),void 0!==e.margin.top&&(o.margin.top=e.margin.top),void 0!==e.margin.right&&(o.margin.right=e.margin.right),void 0!==e.margin.right&&(o.margin.left=e.margin.left)),void 0!==e.horizontalAlignment&&(r=!0,o.horizontalAlignment=e.horizontalAlignment),void 0!==e.verticalAlignment&&(r=!0,o.verticalAlignment=e.verticalAlignment),void 0!==e.style&&(void 0!==e.style.fill&&(o.style.fill=e.style.fill),void 0!==e.style.opacity&&(o.style.opacity=e.style.opacity),void 0!==e.style.strokeColor&&(o.style.strokeColor=e.style.strokeColor),void 0!==e.style.strokeWidth&&(o.style.strokeWidth=e.style.strokeWidth),void 0!==e.style.strokeDashArray&&(o.style.strokeDashArray=e.style.strokeDashArray)),void 0!==e.shape&&o)if("Custom"===e.shape&&e.pathData)o.data=String(e.pathData),r=!0;else{var l=Ht(e.shape);o.data=l}!0===r&&(o.measure(new Al(o.width,o.height)),o.arrange(o.desiredSize))}},i.prototype.updateIcon=function(t){var e=this.getWrapper(t.wrapper,"icon_content");if(e){if("SVG"===this.mode){var i=yr(t.wrapper.id+"_icon_content");if(i){var n=yr(i.id+"_rect"),o=yr(i.id+"_shape"),r=yr(o.id+"_native_element");r&&r.parentNode.removeChild(r),o.parentNode.removeChild(o),n.parentNode.removeChild(n),i.parentNode.removeChild(i)}}var s=t.wrapper.children.indexOf(e);t.wrapper.children.splice(s,1)}var a=this.getPortContainer(t);t.initIcons(this.getDescription,this.layout,a,this.element.id)},i.prototype.getPortContainer=function(t){if(t.children)for(var e=0;e<t.wrapper.children.length;e++)if("group_container"===t.wrapper.children[e].id)return t.wrapper.children[e];return t.wrapper},i.prototype.updateTooltip=function(t,e){void 0!==e.tooltip.content&&(t.tooltip.content=e.tooltip.content),void 0!==e.tooltip.position&&(t.tooltip.position=e.tooltip.position),void 0!==e.tooltip.height&&(t.tooltip.height=e.tooltip.height),void 0!==e.tooltip.width&&(t.tooltip.width=e.tooltip.width),void 0!==e.tooltip.showTipPointer&&(t.tooltip.showTipPointer=e.tooltip.showTipPointer)},i.prototype.updateQuad=function(t){this.spatialSearch.updateQuad(t.wrapper)&&!this.preventUpdate&&this.updatePage()},i.prototype.removeFromAQuad=function(t){this.spatialSearch.removeFromAQuad(t.wrapper),this.spatialSearch.updateBounds(t.wrapper)&&!this.preventUpdate&&this.updatePage()},i.prototype.updateGroupSize=function(t){var e;t.parentId&&((e=this.nameTable[t.parentId]).parentId?this.updateGroupSize(e):(e.wrapper.measure(new Al),e.wrapper.arrange(e.wrapper.desiredSize),this.updateGroupOffset(e),this.updateDiagramObject(e)))},i.prototype.updatePage=function(){if(this.diagramActions&t.DiagramAction.Render){this.scroller.setSize(),this.scroller.updateScrollOffsets();for(var e=0,n=this.views;e<n.length;e++){var o=n[e],r=this.views[o];r instanceof i||r.updateView(r)}}},i.prototype.protectPropertyChange=function(t){this.isProtectedOnChange=t},i.prototype.updateMargin=function(t,e){void 0!==e.margin.top&&(t.margin.top=e.margin.top),void 0!==e.margin.bottom&&(t.margin.bottom=e.margin.bottom),void 0!==e.margin.left&&(t.margin.left=e.margin.left),void 0!==e.margin.right&&(t.margin.right=e.margin.right)},i.prototype.initDroppables=function(){var e=this;this.droppable=new ol(this.element),this.droppable.accept=".e-dragclone",this.droppable.over=function(i){if(e.currentSymbol)i.event.touches&&i.event.touches.length&&e.eventHandler.mouseMove(i.event,i.event.touches);else if(i.dragData){var n=void 0,o=e.eventHandler.getMousePosition(i.event),r=void 0,s=i.dragData.helper,a=s.getAttribute("paletteId");if(a){var l=document.getElementById(a).ej2_instances[0];e.droppable.sourceElement=l;if(l){var h=l.selectedSymbols;r=Yr(l.selectedSymbols);var c=h.wrapper.children[0].children[0];if(l.selectedSymbols instanceof fd){r.offsetX=o.x+5+(r.width||c.actualSize.width)/2,r.offsetY=o.y+(r.height||c.actualSize.height)/2;var d=new fd(e,"nodes",r,!0);"Bpmn"===d.shape.type&&d.shape.activity.subProcess.processes&&d.shape.activity.subProcess.processes.length&&(d.shape.activity.subProcess.processes=[]),n=d}else if(l.selectedSymbols instanceof _c){n=new _c(e,"connectors",r,!0);var p=Rl.toBounds([n.sourcePoint,n.targetPoint]),u=o.x-p.center.x,g=o.y-p.center.y;n.sourcePoint.x+=u,n.sourcePoint.y+=g,n.targetPoint.x+=u,n.targetPoint.y+=g}n.id+=qr();var m={source:l,element:n,cancel:!1,diagram:e};e.triggerEvent(t.DiagramEvent.dragEnter,m),e.activeLayer.lock||m.cancel||(e.enterObject=n,e.preventUpdate=!0,e.initObject(n),e.currentSymbol=n,"SVG"!==e.mode&&e.refreshDiagramLayer(),delete e.enterObject,e.commandHandler.select(n),e.eventHandler.mouseDown(i.event),e.eventHandler.mouseMove(i.event,i),e.preventUpdate=!1,e.updatePage(),s.style.opacity="0")}e.droppable.selectedSymbols=s}}},this.droppable.drop=function(i){if(e.currentSymbol){i.event.touches&&e.eventHandler.mouseUp(i.event);var n=void 0,o={source:e.droppable.sourceElement,element:e.currentSymbol,target:e,cancel:!1,position:{x:e.currentSymbol.wrapper.offsetX,y:e.currentSymbol.wrapper.offsetY}};e.triggerEvent(t.DiagramEvent.drop,o);var r=void 0;r=Yr(e.currentSymbol),e.removeFromAQuad(e.currentSymbol),e.removeObjectsFromLayer(e.nameTable[e.currentSymbol.id]),delete e.nameTable[e.currentSymbol.id],e.currentSymbol=null,e.protectPropertyChange(!0),o.cancel||(e.startGroupAction(),e.add(r),Xn(e)&&e.select([e.nameTable[r.id]])),e.protectPropertyChange(!1),n=e.nameTable[r.id],e.bpmnModule&&n instanceof fd&&r.processId&&(n.processId=r.processId,e.bpmnModule.dropBPMNchild(e.nameTable[n.processId],n,e)),e.endGroupAction(),"SVG"!==e.mode&&e.refreshDiagramLayer(),delete e.droppable.sourceElement}T(e.droppable.selectedSymbols)},this.droppable.out=function(i){if(e.currentSymbol&&!e.eventHandler.focus){e.unSelect(e.currentSymbol),e.removeFromAQuad(e.currentSymbol),"SVG"!==e.mode&&"Native"===e.currentSymbol.shape.type&&e.removeElements(e.currentSymbol),e.removeObjectsFromLayer(e.nameTable[e.currentSymbol.id]),delete e.nameTable[e.currentSymbol.id],e.triggerEvent(t.DiagramEvent.dragLeave,{element:e.currentSymbol,diagram:e}),"SVG"!==e.mode?e.refreshDiagramLayer():e.removeElements(e.currentSymbol),e.currentSymbol=null;e.droppable.selectedSymbols.style.opacity="1";delete e.droppable.sourceElement}}},Sp([Y("100%")],i.prototype,"width",void 0),Sp([Y("SVG")],i.prototype,"mode",void 0),Sp([Y("100%")],i.prototype,"height",void 0),Sp([G({},xp)],i.prototype,"contextMenuSettings",void 0),Sp([Y(t.DiagramConstraints.Default)],i.prototype,"constraints",void 0),Sp([Y(t.DiagramTools.Default)],i.prototype,"tool",void 0),Sp([Y("Top")],i.prototype,"bridgeDirection",void 0),Sp([Y("transparent")],i.prototype,"backgroundColor",void 0),Sp([G({},Dd)],i.prototype,"snapSettings",void 0),Sp([G({},Hd)],i.prototype,"rulerSettings",void 0),Sp([G({},Td)],i.prototype,"pageSettings",void 0),Sp([K([],fd)],i.prototype,"nodes",void 0),Sp([Y()],i.prototype,"drawingObject",void 0),Sp([K([],_c)],i.prototype,"connectors",void 0),Sp([Y([])],i.prototype,"basicElements",void 0),Sp([G({},Lc)],i.prototype,"tooltip",void 0),Sp([G({},Fd)],i.prototype,"dataSourceSettings",void 0),Sp([Y()],i.prototype,"addInfo",void 0),Sp([Y()],i.prototype,"getNodeDefaults",void 0),Sp([Y()],i.prototype,"getConnectorDefaults",void 0),Sp([Y()],i.prototype,"setNodeTemplate",void 0),Sp([Y()],i.prototype,"getDescription",void 0),Sp([Y()],i.prototype,"getCustomProperty",void 0),Sp([Y()],i.prototype,"getCustomTool",void 0),Sp([Y()],i.prototype,"getCustomCursor",void 0),Sp([G({},Xc)],i.prototype,"selectedItems",void 0),Sp([G({},kd)],i.prototype,"scrollSettings",void 0),Sp([G({},Wd)],i.prototype,"layout",void 0),Sp([G({},wp)],i.prototype,"commandManager",void 0),Sp([J()],i.prototype,"dataLoaded",void 0),Sp([J()],i.prototype,"dragEnter",void 0),Sp([J()],i.prototype,"dragLeave",void 0),Sp([J()],i.prototype,"dragOver",void 0),Sp([J()],i.prototype,"click",void 0),Sp([J()],i.prototype,"historyChange",void 0),Sp([J()],i.prototype,"doubleClick",void 0),Sp([J()],i.prototype,"textEdit",void 0),Sp([J()],i.prototype,"scrollChange",void 0),Sp([J()],i.prototype,"selectionChange",void 0),Sp([J()],i.prototype,"sizeChange",void 0),Sp([J()],i.prototype,"connectionChange",void 0),Sp([J()],i.prototype,"sourcePointChange",void 0),Sp([J()],i.prototype,"targetPointChange",void 0),Sp([J()],i.prototype,"propertyChange",void 0),Sp([J()],i.prototype,"positionChange",void 0),Sp([J()],i.prototype,"animationComplete",void 0),Sp([J()],i.prototype,"rotateChange",void 0),Sp([J()],i.prototype,"collectionChange",void 0),Sp([J()],i.prototype,"created",void 0),Sp([J()],i.prototype,"mouseEnter",void 0),Sp([J()],i.prototype,"mouseLeave",void 0),Sp([J()],i.prototype,"mouseOver",void 0),Sp([J()],i.prototype,"contextMenuOpen",void 0),Sp([J()],i.prototype,"contextMenuClick",void 0),Sp([K([],dp)],i.prototype,"layers",void 0),Sp([J()],i.prototype,"drop",void 0),i}(Ka),Pp=function(){function t(t){this.diagram=t}return t.prototype.exportDiagram=function(t){var e,i,n,o,r="data",s=[],a=t.margin||{},l=t&&t.region?t.region:"Content";o=t&&t.mode?t.mode:"Download";var h=this.getDiagramBounds(l,t);t.bounds&&(i=!0,h.x=t.bounds.x?t.bounds.x:h.x,h.y=t.bounds.y?t.bounds.y:h.y,h.width=t.bounds.width||h.width,h.height=t.bounds.height||h.height),a={top:void 0!==a.top?a.top:25,bottom:void 0!==a.bottom?a.bottom:25,right:void 0!==a.right?a.right:25,left:void 0!==a.left?a.left:25};this.diagram.nodes;"PageSettings"!==l&&(h.x-=a.left,h.y-=a.top,h.width+=a.left+a.right,h.height+=a.top+a.bottom);var c=t.fileName||"diagram";if("SVG"!==t.format){if(null!==(r=this.setCanvas(t,h,a,o,i,l,c)))return r}else{e=t.format,t.bounds=h,t.margin=a;var d=n=this.diagramAsSvg(t,a);if("Data"===o)return n;var p=(new XMLSerializer).serializeToString(d);s.push(p)}if("Download"===o&&null!==r)for(var u=0;u<s.length;u++){var g=new Blob([s[u]],{type:"application/octet-stream"});if("msie"===ma.info.name)window.navigator.msSaveOrOpenBlob(g,c+"."+e);else{var m=document.createElement("a"),f=URL.createObjectURL(g);m.href=f,m.setAttribute("download",c+"."+e);var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),m.dispatchEvent(v)}}return null},t.prototype.setCanvas=function(t,e,i,n,o,r,s){var a,l,h=this;t.bounds=e,t.region=r;var c=[];this.setScaleValueforCanvas(t,e);var d=this.diagramAsCanvas({bounds:e,margin:i,region:r,scaleX:t.scaleX,scaleY:t.scaleY},o);a=t.format||"JPG";var p=l=d.toDataURL();if("Data"===n)return l;if(t.multiplePage){if(t.pageHeight=t.pageHeight?t.pageHeight:this.diagram.pageSettings.height,t.pageWidth=t.pageWidth?t.pageWidth:this.diagram.pageSettings.width,t.pageHeight=t.pageHeight?t.pageHeight:d.width,t.pageWidth=t.pageWidth?t.pageWidth:d.height,i=t.margin||{},t.pageOrientation&&("Landscape"===t.pageOrientation&&t.pageHeight>t.pageWidth||"Portrait"===t.pageOrientation&&t.pageWidth>t.pageHeight)){var u=t.pageWidth;t.pageWidth=t.pageHeight,t.pageHeight=u}t.margin={top:isNaN(i.top)?0:i.top,bottom:isNaN(i.bottom)?0:i.bottom,left:isNaN(i.left)?0:i.left,right:isNaN(i.right)?0:i.right};var g=document.createElement("img"),m={id:this.diagram.element.id+"_printImage",src:p};g.setAttribute("id",this.diagram.element.id+"_printImage"),Wr(g,m),g.onload=function(){c=h.getMultipleImage(g,t,!0),h.exportImage(c,s,a,p)}}else c=[p],this.exportImage(c,s,a,p);return null},t.prototype.exportImage=function(t,e,i,n){for(var o=[],r=t instanceof HTMLElement?0:t.length,s=0;s<r;s++){for(var a=(n=(n=t[s]).replace(/^data:[a-z]*;,/,"")).split(","),l=atob(a[1]),h=new ArrayBuffer(l.length),c=new Uint8Array(h),d=0;d<l.length;d++)c[d]=l.charCodeAt(d);o.push(h)}for(var p=0;p<o.length;p++)!function(t){var n=new Blob([o[t]],{type:"application/octet-stream"});if("msie"===ma.info.name)window.navigator.msSaveOrOpenBlob(n,e+"."+i);else{var r=document.createElement("a"),s=URL.createObjectURL(n);r.href=s,r.setAttribute("download",e+"."+i);var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),setTimeout(function(){r.dispatchEvent(a)},5*(t+1))}}(p)},t.prototype.getObjectsBound=function(t){for(var e,i=0,n=this.diagram.nodes;i<n.length;i++){var o=n[i];o.visible&&(("SVG"===t.format||o instanceof lh||o instanceof Gc)&&("SVG"!==t.format||o instanceof Gc)||(e=e?e.uniteRect(o.wrapper.outerBounds):o.wrapper.outerBounds))}for(var r=0,s=this.diagram.connectors;r<s.length;r++){var a=s[r];a.visible&&(e=e?e.uniteRect(a.wrapper.outerBounds):a.wrapper.outerBounds)}return e||new Rl(0,0,0,0)},t.prototype.getDiagramBounds=function(t,e){var i=this.getObjectsBound(e),n=i.left,o=i.top,r=i.right-i.left,s=i.bottom-i.top;"Content"!==t&&(this.diagram.pageSettings&&this.diagram.pageSettings.multiplePage?(n=i.left,o=i.top,this.diagram.pageSettings.width&&(n=Math.floor(n/this.diagram.pageSettings.width)*this.diagram.pageSettings.width,r=Math.ceil(i.right/this.diagram.pageSettings.width)*this.diagram.pageSettings.width-n),this.diagram.pageSettings.height&&(o=Math.floor(o/this.diagram.pageSettings.height)*this.diagram.pageSettings.height,s=Math.ceil(i.bottom/this.diagram.pageSettings.height)*this.diagram.pageSettings.height-o),0===i.width&&null!==this.diagram.pageSettings.width&&(r=this.diagram.pageSettings.width),0===i.height&&null!==this.diagram.pageSettings.height&&(s=this.diagram.pageSettings.height)):(this.diagram.pageSettings.width&&(n=0,r=this.diagram.pageSettings.width),this.diagram.pageSettings.height&&(o=0,s=this.diagram.pageSettings.height)));var a=new Rl;return a.x=n,a.y=o,a.width=r,a.height=s,a},t.prototype.setScaleValueforCanvas=function(t,e){t.scaleX=1,t.scaleY=1,t.pageHeight=t.pageHeight||this.diagram.pageSettings.height,t.pageWidth=t.pageWidth||this.diagram.pageSettings.width;var i=t.pageHeight||e.height,n=t.pageWidth||e.width;"Stretch"!==t.stretch&&"Meet"!==t.stretch&&"Slice"!==t.stretch||(t.scaleX=n/e.width,t.scaleY=i/e.height,"Meet"===t.stretch?t.scaleX=t.scaleY=Math.min(t.scaleX,t.scaleY):"Slice"===t.stretch&&(t.scaleX=t.scaleY=Math.max(t.scaleX,t.scaleY)),e.width=n,e.height=i),e.x*=t.scaleX,e.y*=t.scaleY},t.prototype.diagramAsSvg=function(t,e){var i=this.diagram.createSvg(this.diagram.element.id+"_diagram_svg",t.bounds.width,t.bounds.height);document.body.appendChild(i);var n=Nr("g",{id:this.diagram.element.id+"_pageBackground"}),o=t&&t.region?t.region:"Content",r=this.getDiagramBounds(o,t),s=r.x,a=r.y,l=r.width,h=r.height;i.appendChild(n);var c={transform:"translate("+(-t.bounds.x+e.left)+", "+(-t.bounds.y+e.top)+")",x:String(s),y:String(a),width:String(l),height:String(h)};_r(n,c);var d=document.getElementById(this.diagram.element.id+"_backgroundLayerrect").cloneNode(!0);if(c={x:0,y:0,width:String(l+e.left+e.right),height:String(h+e.top+e.bottom)},_r(d,c),i.appendChild(d),"SVG"===this.diagram.mode){var p=vr(this.diagram.element.id);i.appendChild(p.getElementById(this.diagram.diagramLayer.id).cloneNode(!0));for(var u=0;u<i.childNodes.length;u++){var g=i.childNodes[u];"diagram_diagramLayer"===g.id&&g.setAttribute("transform","translate("+(-r.x+e.left)+", "+(-r.y+e.top)+")")}}else{n=Nr("g",{id:this.diagram.element.id+"_diagramLayer"}),i.appendChild(n),n.setAttribute("transform","translate("+(-t.bounds.x+e.left)+", "+(-t.bounds.y+e.top)+")");this.diagram.nodes;var m=new Sd("",null,!0),f=Dr(this.diagram.element.id);this.diagram.renderDiagramElements(i,m,f,!1)}return document.body.removeChild(i),i},t.prototype.diagramAsCanvas=function(t,e){var i=t.bounds,n=t.margin,o=t&&t.region?t.region:"Content",r=this.getDiagramBounds(o,t),s=this.diagram.pageSettings.background.color,a=xd.createCanvas(this.diagram.element.id+"_diagram",t.bounds.width,t.bounds.height),l=a.getContext("2d");l.translate(-i.x,-i.y),l.save(),l.fillStyle=this.diagram.pageSettings.background.color,i="Content"===o?r:i,l.fillRect(i.x,i.y,i.width,i.height);var h=this.diagram.pageSettings.background;if(h&&h.source){r=this.getDiagramBounds(o,t);var c=new Image;c.src=h.source;var d=r.width/c.width,p=r.height/c.height,u=r.x,g=r.y,m=r.width,f=r.height,v=this.isImageExportable(h);if("None"!==h.scale&&"None"!==h.align){var y="Meet"===h.scale?Math.min(d,p):Math.max(d,p);m=y*c.width,f=y*c.height,h.align.indexOf("xmid")>-1?u+=(r.width-m)/2:h.align.indexOf("xmax")>-1&&(u=u+r.width-m),h.align.indexOf("ymid")>-1?g+=(r.height-f)/2:h.align.indexOf("ymax")>-1&&(g=g+r.height-f),"none"!==this.diagram.pageSettings.background.color&&"transparent"!==this.diagram.pageSettings.background.color||(l.fillStyle="white",l.fillRect(r.x*t.scaleX,r.y*t.scaleY,r.width*t.scaleX,r.height*t.scaleY)),v&&l.drawImage(c,u,g,y*c.width,y*c.height)}else v&&l.drawImage(c,u,g,r.width,r.height)}else l.fillStyle="transparent"===s?"white":s,l.fillRect(r.x*t.scaleX-n.left,r.y*t.scaleY-n.top,r.width*t.scaleX+n.left+n.right,t.scaleY*r.height+n.top+n.bottom);var b=this.diagram.pageSettings.background.color,w=this.diagram.pageSettings.width;w&&(l.strokeStyle="none"===b?"transparent":b,l.lineWidth=w,l.strokeRect(r.x*t.scaleX,r.y*t.scaleY,r.width*t.scaleX,r.height*t.scaleY)),l.restore();var x=Dr(this.diagram.element.id),C=new Sd("",null,!1);return this.diagram.renderDiagramElements(a,C,x,!1),a},t.prototype.isImageExportable=function(t){var e,i=!0;if(t.source)try{var n=(e=xd.createCanvas(this.diagram.element.id+"temp_canvas",100,100)).getContext("2d");n.save();var o=new Image;o.src=t.source,n.drawImage(o,0,0,100,100),n.restore(),e.toDataURL()}catch(t){i=!1}return i},t.prototype.getPrintCanvasStyle=function(t,e){var i=0,n=0,o=new Al;if(i=t.width,n=t.height,(e.pageHeight||e.pageWidth)&&(n=e.pageHeight?e.pageHeight:n,i=e.pageWidth?e.pageWidth:i),e.pageOrientation&&("Landscape"===e.pageOrientation&&n>i||"Portrait"===e.pageOrientation&&i>n)){var r=i;i=n,n=r}return o.height=n,o.width=i,o},t.prototype.getMultipleImage=function(t,e,i){var n,o,r=[],s=document.createElement("div"),a=this.getPrintCanvasStyle(t,e),l=e.margin,h=l.left,c=l.top,d=l.right,p=l.bottom,u=0;n=a.width+u,o=a.height+0;var g=0,m=0;if(e&&e.multiplePage&&"Content"!==e.region){s.style.height="auto",s.style.width="auto";var f=t.height,v=t.width,y=0,b=0,w=void 0,x=0,C=0,S=void 0,E=void 0;do{do{x=a.width,C=a.height,g+a.width>=v&&(x=v-g),m+a.height>=f&&(C=f-m),(S=(E=xd.createCanvas(this.diagram.element.id+"_multiplePrint",a.width,a.height)).getContext("2d")).drawImage(t,u+g+h,0+m+c,x-d-h,C-p-c,0+h,0+c,x-d-h,C-p-c),g+a.width>=v&&(g-=g-v),w=E.toDataURL(),S.restore(),g+=n,i?r.push(w):this.printImage(s,w,y+""+b,n+"px;",o+"px;"),y++}while(g<v);b++,y=u=g=0,m+a.height>=f&&(m-=m-f),m+=o}while(m<f)}else{var P,L,T=this.getPrintCanvasStyle(t,e);P=T.width,L=T.height;var S=void 0,E=void 0,w=void 0;(S=(E=xd.createCanvas(this.diagram.element.id+"_diagram",P,L)).getContext("2d")).drawImage(t,0+h,0+c,t.width-(d+h),t.height-(c+p),0+h,0+c,P-(d+h),L-(c+p)),w=E.toDataURL(),S.restore(),this.printImage(s,w,0)}return i?r:s},t.prototype.printImage=function(t,e,i,n,o){var r,s=document.createElement("img"),a=document.createElement("div");Wr(s,r={class:"e-diagram-print-page",style:"width:"+n+"height:"+o}),Wr(a,r),Wr(s,r={id:this.diagram.element.id+"_multiplePrint_img"+i,style:"float:left",src:e}),a.appendChild(s),t.appendChild(a)},t.prototype.print=function(t){var e=this;t.mode="Data",t.margin={top:0,bottom:0,right:0,left:0};var i=this.exportDiagram(t),n=document.createElement("img"),o={id:this.diagram.element.id+"_printImage",src:i};Wr(n,o),n.onload=function(){var i=e.getMultipleImage(n,t),o=window.open("");null!=o&&i instanceof HTMLElement&&(o.document.write("<html><head><style> body{margin:0px;}  @media print { .e-diagram-print-page{page-break-after: left; }.e-diagram-print-page:last-child {page-break-after: avoid;}}</style><title></title></head>"),o.document.write('<BODY onload="setTimeout(function(){window.print();}, 100)">'),o.document.write("<center>"+i.innerHTML+"</center>"),o.document.close())}},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"PrintandExport"},t}(),Lp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Tp=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.orientation="Vertical",e.measureChildren=void 0,e}return Lp(e,t),e.prototype.measure=function(t){var e="Horizontal"===this.orientation?this.updateHorizontalStack:this.updateVerticalStack;return this.desiredSize=this.measureStackPanel(t,e),this.desiredSize},e.prototype.arrange=function(t){var e="Horizontal"===this.orientation?this.arrangeHorizontalStack:this.arrangeVerticalStack;return this.actualSize=this.arrangeStackPanel(t,e),this.updateBounds(),this.actualSize},e.prototype.measureStackPanel=function(e,i){var n=void 0;if(void 0!==this.children&&this.children.length>0)for(var o=0,r=this.children;o<r.length;o++){var s=r[o];s.parentTransform=this.rotateAngle+this.parentTransform,s.measure(e);var a=s.desiredSize.clone();this.applyChildMargin(s,a),0!==s.rotateAngle&&(a=os(a,s.rotateAngle)),void 0===n?n=a:i(a,n)}return n=t.prototype.validateDesiredSize.call(this,n,e),this.stretchChildren(n),this.applyPadding(n),n},e.prototype.arrangeStackPanel=function(e,i){if(void 0!==this.children&&this.children.length>0){var n=void 0,o=void 0;n=this.offsetX-e.width*this.pivot.x+this.padding.left,o=this.offsetY-e.height*this.pivot.y+this.padding.top;for(var r=0,s=this.children;r<s.length;r++){var a=s[r],l=a.desiredSize.clone(),h=l;"Vertical"===this.orientation?o+=a.margin.top:n+=a.margin.left,0!==a.rotateAngle&&(h=os(l,a.rotateAngle));var c=i(n,o,a,this,e,h);t.prototype.findChildOffsetFromCenter.call(this,a,c),a.arrange(l),"Vertical"===this.orientation?o+=h.height+a.margin.bottom:n+=h.width+a.margin.right}}return e},e.prototype.updateHorizontalStack=function(t,e){e.height=Math.max(t.height,e.height),e.width+=t.width},e.prototype.updateVerticalStack=function(t,e){e.width=Math.max(t.width,e.width),e.height+=t.height},e.prototype.arrangeHorizontalStack=function(t,e,i,n,o,r){var s=0;return s="Top"===i.verticalAlignment?e+i.margin.top+r.height/2:"Bottom"===i.verticalAlignment?n.offsetY+o.height*(1-n.pivot.y)-n.padding.bottom-i.margin.bottom-r.height/2:n.offsetY-o.height*n.pivot.y+o.height/2,{x:t+r.width/2,y:s}},e.prototype.arrangeVerticalStack=function(t,e,i,n,o,r){var s=0;return s="Left"===i.horizontalAlignment?t+i.margin.left+r.width/2:"Right"===i.horizontalAlignment?n.offsetX+o.width*(1-n.pivot.x)-n.padding.right-i.margin.right-r.width/2:n.offsetX-o.width*n.pivot.x+o.width/2,{x:s,y:e+r.height/2}},e.prototype.stretchChildren=function(t){if(void 0!==this.children&&this.children.length>0)for(var e=0,i=this.children;e<i.length;e++){var n=i[e];"Vertical"===this.orientation?"Stretch"===n.horizontalAlignment&&(n.desiredSize.width=t.width):"Stretch"===n.verticalAlignment&&(n.desiredSize.height=t.height)}},e.prototype.applyChildMargin=function(t,e){e.height+=t.margin.top+t.margin.bottom,e.width+=t.margin.left+t.margin.right},e}(oh),kp=function(){function t(t){return this.subQuery=null,this.isChild=!1,this.queries=[],this.key="",this.fKey="","string"==typeof t?this.fromTable=t:t&&t instanceof Array&&(this.lookups=t),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this}return t.prototype.setKey=function(t){return this.key=t,this},t.prototype.using=function(t){return this.dataManager=t,this},t.prototype.execute=function(t,e,i,n){return t=t||this.dataManager,t?t.executeQuery(this,e,i,n):Mp.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},t.prototype.executeLocal=function(t){return t=t||this.dataManager,t?t.executeLocal(this):Mp.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},t.prototype.clone=function(){var e=new t;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e},t.prototype.from=function(t){return this.fromTable=t,this},t.prototype.addParams=function(t,e){return"function"==typeof e?this.params.push({key:t,fn:e}):this.params.push({key:t,value:e}),this},t.prototype.expand=function(t){return this.expands="string"==typeof t?[].slice.call([t],0):t.slice(0),this},t.prototype.where=function(t,e,i,n,o){e=e?e.toLowerCase():null;var r=null;return"string"==typeof t?r=new Op(t,e,i,n,o):t instanceof Op&&(r=t),this.queries.push({fn:"onWhere",e:r}),this},t.prototype.search=function(t,e,i,n,o){"string"==typeof e&&(e=[e]),i=i||"contains";var r=Mp.fnOperators[i];return this.queries.push({fn:"onSearch",e:{fieldNames:e,operator:i,searchKey:t,ignoreCase:n,ignoreAccent:o,comparer:r}}),this},t.prototype.sortBy=function(e,i,n){var o,r,s="ascending";if("string"==typeof e&&Mp.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),i="descending"),i&&"string"!=typeof i||(s=i?i.toLowerCase():"ascending",i=Mp.fnSort(i)),n){o=t.filterQueries(this.queries,"onSortBy");for(var a=0;a<o.length;a++)if("string"==typeof(r=o[a].e.fieldName)){if(r===e)return this}else if(r instanceof Array)for(var l=0;l<r.length;l++)if(r[l]===e||e.toLowerCase()===r[l]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:i,direction:s}}),this},t.prototype.sortByDesc=function(t){return this.sortBy(t,"descending")},t.prototype.group=function(t,e,i){return this.sortBy(t,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:t,comparer:e||null,format:i||null}}),this},t.prototype.page=function(t,e){return this.queries.push({fn:"onPage",e:{pageIndex:t,pageSize:e}}),this},t.prototype.range=function(t,e){return this.queries.push({fn:"onRange",e:{start:t,end:e}}),this},t.prototype.take=function(t){return this.queries.push({fn:"onTake",e:{nos:t}}),this},t.prototype.skip=function(t){return this.queries.push({fn:"onSkip",e:{nos:t}}),this},t.prototype.select=function(t){return"string"==typeof t&&(t=[].slice.call([t],0)),this.queries.push({fn:"onSelect",e:{fieldNames:t}}),this},t.prototype.hierarchy=function(t,e){return this.subQuerySelector=e,this.subQuery=t,this},t.prototype.foreignKey=function(t){return this.fKey=t,this},t.prototype.requiresCount=function(){return this.isCountRequired=!0,this},t.prototype.aggregate=function(t,e){return this.queries.push({fn:"onAggregates",e:{field:e,type:t}}),this},t.filterQueries=function(t,e){return t.filter(function(t){return t.fn===e})},t.filterQueryLists=function(t,e){for(var i=t.filter(function(t){return-1!==e.indexOf(t.fn)}),n={},o=0;o<i.length;o++)n[i[o].fn]||(n[i[o].fn]=i[o].e);return n},t}(),Op=function(){function t(e,i,n,o,r){return void 0===o&&(o=!1),this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof e?(this.field=e,this.operator=i.toLowerCase(),this.value=n,this.ignoreCase=o,this.ignoreAccent=r,this.isComplex=!1,this.comparer=Mp.fnOperators.processOperator(this.operator)):(e instanceof t&&n instanceof t||n instanceof Array)&&(this.isComplex=!0,this.condition=i.toLowerCase(),this.predicates=[e],n instanceof Array?[].push.apply(this.predicates,n):this.predicates.push(n)),this}return t.and=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.combinePredicates([].slice.call(e,0),"and")},t.prototype.and=function(e,i,n,o,r){return t.combine(this,e,i,n,"and",o,r)},t.or=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.combinePredicates([].slice.call(e,0),"or")},t.prototype.or=function(e,i,n,o,r){return t.combine(this,e,i,n,"or",o,r)},t.fromJson=function(t){if(t instanceof Array){for(var e=[],i=0,n=t.length;i<n;i++)e.push(this.fromJSONData(t[i]));return e}var o=t;return this.fromJSONData(o)},t.prototype.validate=function(t){var e,i,n=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,Mp.getObject(this.field,t),this.value,this.ignoreCase,this.ignoreAccent);e="and"===this.condition;for(var o=0;o<n.length;o++)if(i=n[o].validate(t),e){if(!i)return!1}else if(i)return!0;return e},t.prototype.toJson=function(){var t,e;if(this.isComplex){t=[],e=this.predicates;for(var i=0;i<e.length;i++)t.push(e[i].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:t}},t.combinePredicates=function(e,i){if(1===e.length){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new t(e[0],i,e.slice(1))},t.combine=function(e,i,n,o,r,s,a){return i instanceof t?t[r](e,i):"string"==typeof i?t[r](e,new t(i,n,o,s,a)):Mp.throwError("Predicate - "+r+" : invalid arguments")},t.fromJSONData=function(e){for(var i=e.predicates||[],n=i.length,o=[],r=0;r<n;r++)o.push(this.fromJSONData(i[r]));return e.isComplex?new t(o[0],e.condition,o.slice(1)):new t(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)},t}(),Ap={GroupGuid:"{271bbba0-1ee7}"},Mp=function(){function t(){}return t.getValue=function(t,e){return"function"==typeof t?t.call(e||{}):t},t.endsWith=function(t,e){return t.slice(-e.length)===e},t.startsWith=function(t,e){return t.slice(0,e.length)===e},t.fnSort=function(e){return e=e?t.toLowerCase(e):"ascending","ascending"===e?this.fnAscending:this.fnDescending},t.fnAscending=function(t,e){return null===e||void 0===e?-1:"string"==typeof t?t.localeCompare(e):null===t||void 0===t?1:t-e},t.fnDescending=function(t,e){return null===e||void 0===e?1:"string"==typeof t?-1*t.localeCompare(e):null===t||void 0===t?-1:e-t},t.extractFields=function(t,e){for(var i={},n=0;n<e.length;n++)i=this.setValue(e[n],this.getObject(e[n],t),i);return i},t.select=function(t,e){for(var i=[],n=0;n<t.length;n++)i.push(this.extractFields(t[n],e));return i},t.group=function(e,i,n,o,r,s){o=o||1;var a=e;if(a.GroupGuid===Ap.GroupGuid){for(var l=this,c=0;c<a.length;c++)!function(t){if(h(r))a[t].items=l.group(a[t].items,i,n,a.level+1,null,s),a[t].count=a[t].items.length;else{var e=-1,o=r.filter(function(e){return e.key===a[t].key});e=r.indexOf(o[0]),a[t].items=l.group(a[t].items,i,n,a.level+1,r[e].items,s),a[t].count=r[e].count}}(c);return a.childLevels+=1,a}var d={},p=[];p.GroupGuid=Ap.GroupGuid,p.level=o,p.childLevels=0,p.records=a;for(var u=this,g=0;g<a.length;g++)!function(t){var e=u.getVal(a,t,i);if(h(s)||(e=s(e,i)),!d[e]&&(d[e]={key:e,count:0,items:[],aggregates:{},field:i},p.push(d[e]),!h(r))){var n=r.filter(function(t){return t.key===d[e].key});d[e].count=n[0].count}d[e].count=h(r)?d[e].count+=1:d[e].count,d[e].items.push(a[t])}(g);if(n&&n.length)for(g=0;g<p.length;g++)!function(e){for(var i={},o=void 0,s=n,a=0;a<n.length;a++)if(o=t.aggregates[n[a].type],h(r))o&&(i[s[a].field+" - "+s[a].type]=o(p[e].items,s[a].field));else{var l=r.filter(function(t){return t.key===p[e].key});o&&(i[s[a].field+" - "+s[a].type]=o(l[0].items,s[a].field))}p[e].aggregates=i}(g);return a.length&&p||a},t.buildHierarchy=function(t,e,i,n,o){var r,s={};for(n.result&&(n=n.result),n.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),r=0;r<n.length;r++)(s[a=this.getObject(t,n[r])]||(s[a]=[])).push(n[r]);for(r=0;r<i.length;r++){var a=this.getObject(o||t,i[r]);i[r][e]=s[a]}},t.getFieldList=function(t,e,i){if(void 0===i&&(i=""),void 0===e||null===e)return this.getFieldList(t,[],i);for(var n=t,o=0,r=Object.keys(t);o<r.length;o++){var s=r[o];"object"!=typeof n[s]||n[s]instanceof Array?e.push(i+s):this.getFieldList(n[s],e,i+s+".")}return e},t.getObject=function(t,e){if(!t)return e;if(e){if(-1===t.indexOf("."))return e[t];for(var i=e,n=t.split("."),o=0;o<n.length&&null!=i;o++)i=i[n[o]];return i}},t.setValue=function(t,e,i){var n,o,r=t.toString().split("."),s=i||{},a=s,l=r.length;for(n=0;n<l;n++)o=r[n],n+1===l?a[o]=void 0===e?void 0:e:h(a[o])&&(a[o]={}),a=a[o];return s},t.sort=function(t,e,i){if(t.length<=1)return t;var n=parseInt((t.length/2).toString(),10),o=t.slice(0,n),r=t.slice(n);return o=this.sort(o,e,i),r=this.sort(r,e,i),this.merge(o,r,e,i)},t.ignoreDiacritics=function(e){return"string"!=typeof e?e:e.split("").map(function(e){return e in t.diacritics?t.diacritics[e]:e}).join("")},t.merge=function(t,e,i,n){for(var o,r=[];t.length>0||e.length>0;)o=t.length>0&&e.length>0?n?n(this.getVal(t,0,i),this.getVal(e,0,i))<=0?t:e:t[0][i]<t[0][i]?t:e:t.length>0?t:e,r.push(o.shift());return r},t.getVal=function(t,e,i){return i?this.getObject(i,t[e]):t[e]},t.toLowerCase=function(t){return t?"string"==typeof t?t.toLowerCase():t.toString():0===t||!1===t?t.toString():""},t.callAdaptorFunction=function(t,e,i,n){if(e in t){var o=t[e](i,n);h(o)||(i=o)}return i},t.isPlainObject=function(t){return!!t&&t.constructor===Object},t.isCors=function(){var t=null;try{t=new window.XMLHttpRequest}catch(t){}return!!t&&"withCredentials"in t},t.getGuid=function(t){var e;return(t||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function(t,i){if("crypto"in window&&"getRandomValues"in crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),e=n[0]%16|0}else e=16*Math.random()|0;return"0123456789abcdef"[19===i?3&e|8:e]})},t.isNull=function(t){return void 0===t||null===t},t.getItemFromComparer=function(e,i,n){var o,r,s,a=0,l="string"==typeof t.getVal(e,0,i);if(e.length)for(;h(o)&&a<e.length;)o=t.getVal(e,a,i),s=e[a++];for(;a<e.length;a++)h(r=t.getVal(e,a,i))||(l&&(o=+o,r=+r),n(o,r)>0&&(o=r,s=e[a]));return s},t.distinct=function(e,i,n){n=!h(n)&&n;var o,r=[],s={};return e.forEach(function(a,l){(o=t.getVal(e,l,i))in s||(r.push(n?e[l]:o),s[o]=1)}),r},t.serverTimezoneOffset=null,t.throwError=function(t){try{throw new Error(t)}catch(t){throw t.message+"\n"+t.stack}},t.aggregates={sum:function(e,i){for(var n,o=0,r="number"!=typeof t.getVal(e,0,i),s=0;s<e.length;s++)n=t.getVal(e,s,i),isNaN(n)||null===n||(r&&(n=+n),o+=n);return o},average:function(e,i){return t.aggregates.sum(e,i)/e.length},min:function(e,i){var n;return"function"==typeof i&&(n=i,i=null),t.getObject(i,t.getItemFromComparer(e,i,n||t.fnAscending))},max:function(e,i){var n;return"function"==typeof i&&(n=i,i=null),t.getObject(i,t.getItemFromComparer(e,i,n||t.fnDescending))},truecount:function(t,e){return new jp(t).executeLocal((new kp).where(e,"equal",!0,!0)).length},falsecount:function(t,e){return new jp(t).executeLocal((new kp).where(e,"equal",!1,!0)).length},count:function(t,e){return t.length}},t.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},t.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},t.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},t.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},t.diacritics={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"},t.fnOperators={equal:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?t.toLowerCase(e)===t.toLowerCase(i):e===i},notequal:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),!t.fnOperators.equal(e,i,n)},lessthan:function(e,i,n){return n?t.toLowerCase(e)<t.toLowerCase(i):e<i},greaterthan:function(e,i,n){return n?t.toLowerCase(e)>t.toLowerCase(i):e>i},lessthanorequal:function(e,i,n){return n?t.toLowerCase(e)<=t.toLowerCase(i):e<=i},greaterthanorequal:function(e,i,n){return n?t.toLowerCase(e)>=t.toLowerCase(i):e>=i},contains:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?!h(e)&&!h(i)&&-1!==t.toLowerCase(e).indexOf(t.toLowerCase(i)):!h(e)&&!h(i)&&-1!==e.toString().indexOf(i)},notnull:function(t){return null!==t},isnull:function(t){return null===t},startswith:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?e&&i&&t.startsWith(t.toLowerCase(e),t.toLowerCase(i)):e&&i&&t.startsWith(e,i)},endswith:function(e,i,n,o){return o&&(e=t.ignoreDiacritics(e),i=t.ignoreDiacritics(i)),n?e&&i&&t.endsWith(t.toLowerCase(e),t.toLowerCase(i)):e&&i&&t.endsWith(e,i)},processSymbols:function(e){var i=t.operatorSymbols[e];return i?t.fnOperators[i]:t.throwError("Query - Process Operator : Invalid operator")},processOperator:function(e){var i=t.fnOperators[e];return i||t.fnOperators.processSymbols(e)}},t.parse={parseJson:function(e){return"string"==typeof e?e=JSON.parse(e,t.parse.jsonReviver):e instanceof Array?t.parse.iterateAndReviveArray(e):"object"==typeof e&&t.parse.iterateAndReviveJson(e),e},iterateAndReviveArray:function(e){for(var i=0;i<e.length;i++)"object"==typeof e[i]?t.parse.iterateAndReviveJson(e[i]):"string"!=typeof e[i]||/^[\s]*\[|^[\s]*\{|\"/g.test(e[i])?e[i]=t.parse.parseJson(e[i]):e[i]=t.parse.jsonReviver("",e[i])},iterateAndReviveJson:function(e){for(var i,n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];t.startsWith(r,"__")||("object"==typeof(i=e[r])?i instanceof Array?t.parse.iterateAndReviveArray(i):i&&t.parse.iterateAndReviveJson(i):e[r]=t.parse.jsonReviver(e[r],i))}},jsonReviver:function(e,i){var n=i;if("string"==typeof i){var o=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(i);if(o)return t.dateParse.toTimeZone(new Date(parseInt(o[1],10)),t.serverTimezoneOffset,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(i)){var r=n.split(/[^0-9]/);i=t.dateParse.toTimeZone(new Date(parseInt(r[0],10),parseInt(r[1],10)-1,parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10)),t.serverTimezoneOffset,!0)}}return i},isJson:function(e){return"string"==typeof e[0]?e:t.parse.parseJson(e)},isGuid:function(t){return null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(t)},replacer:function(e,i){return t.isPlainObject(e)?t.parse.jsonReplacer(e,i):e instanceof Array?t.parse.arrayReplacer(e):e instanceof Date?t.parse.jsonReplacer({val:e},i).val:e},jsonReplacer:function(e,i){for(var n,o=0,r=Object.keys(e);o<r.length;o++){var s=r[o];if((n=e[s])instanceof Date){var a=n;e[s]=t.dateParse.toTimeZone(t.dateParse.addSelfOffset(a),t.serverTimezoneOffset).toJSON()}}return e},arrayReplacer:function(e){for(var i=0;i<e.length;i++)t.isPlainObject(e[i])?e[i]=t.parse.jsonReplacer(e[i]):e[i]instanceof Date&&(e[i]=t.parse.jsonReplacer({date:e[i]}).date);return e}},t.dateParse={addSelfOffset:function(t){return new Date(+t-6e4*t.getTimezoneOffset())},toUTC:function(t){return new Date(+t+6e4*t.getTimezoneOffset())},toTimeZone:function(e,i,n){if(null===i)return e;var o=n?t.dateParse.toUTC(e):e;return new Date(+o-36e5*i)},toLocalTime:function(t){var e=t,i=-e.getTimezoneOffset(),n=i>=0?"+":"-",o=function(t){var e=Math.floor(Math.abs(t));return(e<10?"0":"")+e};return e.getFullYear()+"-"+o(e.getMonth()+1)+"-"+o(e.getDate())+"T"+o(e.getHours())+":"+o(e.getMinutes())+":"+o(e.getSeconds())+n+o(i/60)+":"+o(i%60)}},t}(),Ip=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Dp=function(){function t(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates"},this.type=t,this.dataSource=e,this.pvt={}}return t.prototype.processResponse=function(t,e,i,n){return t},t}(),Rp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ip(e,t),e.prototype.processQuery=function(t,e){for(var i,n,o=t.dataSource.json.slice(0),r=o.length,s=!0,a={},l=0;l<e.queries.length;l++)i=this[(n=e.queries[l]).fn].call(this,o,n.e,e),"onAggregates"===n.fn?a[n.e.field+" - "+n.e.type]=i:o=void 0!==i?i:o,"onPage"!==n.fn&&"onSkip"!==n.fn&&"onTake"!==n.fn&&"onRange"!==n.fn||(s=!1),s&&(r=o.length);return e.isCountRequired&&(o={result:o,count:r,aggregates:a}),o},e.prototype.batchRequest=function(t,e,i){var n;for(n=0;n<e.addedRecords.length;n++)this.insert(t,e.addedRecords[n]);for(n=0;n<e.changedRecords.length;n++)this.update(t,i.key,e.changedRecords[n]);for(n=0;n<e.deletedRecords.length;n++)this.remove(t,i.key,e.deletedRecords[n]);return e},e.prototype.onWhere=function(t,e){return t&&t.length?t.filter(function(t){if(e)return e.validate(t)}):t},e.prototype.onAggregates=function(t,e){var i=Mp.aggregates[e.type];return t&&i&&0!==t.length?i(t,e.field):null},e.prototype.onSearch=function(t,e){return t&&t.length?(0===e.fieldNames.length&&Mp.getFieldList(t[0],e.fieldNames),t.filter(function(t){for(var i=0;i<e.fieldNames.length;i++)if(e.comparer.call(t,Mp.getObject(e.fieldNames[i],t),e.searchKey,e.ignoreCase,e.ignoreAccent))return!0;return!1})):t},e.prototype.onSortBy=function(t,e,i){if(!t||!t.length)return t;var n,o=Mp.getValue(e.fieldName,i);if(!o)return t.sort(e.comparer);if(o instanceof Array){for(var r=(o=o.slice(0)).length-1;r>=0;r--)o[r]&&(n=e.comparer,Mp.endsWith(o[r]," desc")&&(n=Mp.fnSort("descending"),o[r]=o[r].replace(" desc","")),t=Mp.sort(t,o[r],n));return t}return Mp.sort(t,o,e.comparer)},e.prototype.onGroup=function(t,e,i){if(!t||!t.length)return t;var n=kp.filterQueries(i.queries,"onAggregates"),o=[];if(n.length)for(var r=void 0,s=0;s<n.length;s++)r=n[s].e,o.push({type:r.type,field:Mp.getValue(r.field,i)});return Mp.group(t,Mp.getValue(e.fieldName,i),o,null,null,e.comparer)},e.prototype.onPage=function(t,e,i){var n=Mp.getValue(e.pageSize,i),o=(Mp.getValue(e.pageIndex,i)-1)*n,r=o+n;return t&&t.length?t.slice(o,r):t},e.prototype.onRange=function(t,e){return t&&t.length?t.slice(Mp.getValue(e.start),Mp.getValue(e.end)):t},e.prototype.onTake=function(t,e){return t&&t.length?t.slice(0,Mp.getValue(e.nos)):t},e.prototype.onSkip=function(t,e){return t&&t.length?t.slice(Mp.getValue(e.nos)):t},e.prototype.onSelect=function(t,e){return t&&t.length?Mp.select(t,Mp.getValue(e.fieldNames)):t},e.prototype.insert=function(t,e,i,n,o){return h(o)?t.dataSource.json.push(e):t.dataSource.json.splice(o,0,e)},e.prototype.remove=function(t,e,i,n){var o,r=t.dataSource.json;for("object"==typeof i&&(i=i[e]),o=0;o<r.length&&r[o][e]!==i;o++);return o!==r.length?r.splice(o,1):null},e.prototype.update=function(t,e,i,n){var o,r=t.dataSource.json,s=i[e];for(o=0;o<r.length&&r[o][e]!==s;o++);return o<r.length?a(r[o],i):null},e}(Dp),Np=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ip(e,t),e.prototype.processQuery=function(t,e,i){var n,o,r=this.getQueryRequest(e),s=kp.filterQueryLists(e.queries,["onSelect","onPage","onSkip","onTake","onRange"]),a=e.params,l=t.dataSource.url,h=null,c=this.options,d={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in s?(n=s.onPage,o=((o=Mp.getValue(n.pageIndex,e))-1)*(h=Mp.getValue(n.pageSize,e))):"onRange"in s&&(o=(n=s.onRange).start,h=n.end-n.start);for(g=0;g<r.sorts.length;g++)n=Mp.getValue(r.sorts[g].e.fieldName,e),d.sorts.push(Mp.callAdaptorFunction(this,"onEachSort",{name:n,direction:r.sorts[g].e.direction},e));i&&(n=this.getFiltersFrom(i,e))&&d.filters.push(Mp.callAdaptorFunction(this,"onEachWhere",n.toJson(),e));for(g=0;g<r.filters.length;g++){d.filters.push(Mp.callAdaptorFunction(this,"onEachWhere",r.filters[g].e.toJson(),e));for(var p=0,u="object"==typeof d.filters[g]?Object.keys(d.filters[g]):[];p<u.length;p++){y=u[p];Mp.isNull(d[y])&&delete d[y]}}for(g=0;g<r.searches.length;g++)n=r.searches[g].e,d.searches.push(Mp.callAdaptorFunction(this,"onEachSearch",{fields:n.fieldNames,operator:n.operator,key:n.searchKey,ignoreCase:n.ignoreCase},e));for(g=0;g<r.groups.length;g++)d.groups.push(Mp.getValue(r.groups[g].e.fieldName,e));for(var g=0;g<r.aggregates.length;g++)n=r.aggregates[g].e,d.aggregates.push({type:n.type,field:Mp.getValue(n.field,e)});var m={};this.getRequestQuery(c,e,s,d,m),Mp.callAdaptorFunction(this,"addParams",{dm:t,query:e,params:a,reqParams:m});for(var f=0,v=Object.keys(m);f<v.length;f++){var y=v[f];(Mp.isNull(m[y])||""===m[y]||0===m[y].length)&&delete m[y]}c.skip in m&&c.take in m||null===h||(m[c.skip]=Mp.callAdaptorFunction(this,"onSkip",o,e),m[c.take]=Mp.callAdaptorFunction(this,"onTake",h,e));var b=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(m),url:l,pvtData:b,type:"POST",contentType:"application/json; charset=utf-8"}:(n=this.convertToQueryString(m,e,t),n=(-1!==t.dataSource.url.indexOf("?")?"&":"/")+n,{type:"GET",url:n.length?l.replace(/\/*$/,n):l,pvtData:b})},e.prototype.getRequestQuery=function(t,e,i,n,o){var r=o;r[t.from]=e.fromTable,t.expand&&(r[t.expand]=e.expands),r[t.select]="onSelect"in i?Mp.callAdaptorFunction(this,"onSelect",Mp.getValue(i.onSelect.fieldNames,e),e):"",r[t.count]=e.isCountRequired?Mp.callAdaptorFunction(this,"onCount",e.isCountRequired,e):"",r[t.search]=n.searches.length?Mp.callAdaptorFunction(this,"onSearch",n.searches,e):"",r[t.skip]="onSkip"in i?Mp.callAdaptorFunction(this,"onSkip",Mp.getValue(i.onSkip.nos,e),e):"",r[t.take]="onTake"in i?Mp.callAdaptorFunction(this,"onTake",Mp.getValue(i.onTake.nos,e),e):"",r[t.where]=n.filters.length||n.searches.length?Mp.callAdaptorFunction(this,"onWhere",n.filters,e):"",r[t.sortBy]=n.sorts.length?Mp.callAdaptorFunction(this,"onSortBy",n.sorts,e):"",r[t.group]=n.groups.length?Mp.callAdaptorFunction(this,"onGroup",n.groups,e):"",r[t.aggregates]=n.aggregates.length?Mp.callAdaptorFunction(this,"onAggregates",n.aggregates,e):"",r.param=[]},e.prototype.convertToQueryString=function(t,e,i){return""},e.prototype.processResponse=function(t,e,i,n,o,r){var s=o,a=s.pvtData||{},l=t.groupDs;if(n&&n.getResponseHeader("Content-Type")&&-1!==n.getResponseHeader("Content-Type").indexOf("xml"))return i.isCountRequired?{result:[],count:0}:[];var h=JSON.parse(s.data);if(h&&"batch"===h.action&&t.addedRecords)return r.addedRecords=t.addedRecords,r;t.d&&(t=t.d);var c={};return"count"in t&&(c.count=t.count),c.result=t.result?t.result:t,this.getAggregateResult(a,t,c,l,i),Mp.isNull(c.count)?c.result:{result:c.result,count:c.count,aggregates:c.aggregates}},e.prototype.onGroup=function(t){return this.pvt.groups=t,t},e.prototype.onAggregates=function(t){this.pvt.aggregates=t},e.prototype.batchRequest=function(t,e,i){return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.removeUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({changed:e.changedRecords,added:e.addedRecords,deleted:e.deletedRecords,action:"batch",table:i[void 0],key:i[void 0]})}},e.prototype.beforeSend=function(t,e){},e.prototype.insert=function(t,e,i){return{url:t.dataSource.insertUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify({value:e,table:i,action:"insert"})}},e.prototype.remove=function(t,e,i,n){return{type:"POST",url:t.dataSource.removeUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify({key:i,keyColumn:e,table:n,action:"remove"})}},e.prototype.update=function(t,e,i,n){return{type:"POST",url:t.dataSource.updateUrl||t.dataSource.crudUrl||t.dataSource.url,data:JSON.stringify({value:i,action:"update",keyColumn:e,key:i[e],table:n})}},e.prototype.getFiltersFrom=function(t,e){var i,n=e.fKey,o=n,r=e.key,s=[];"object"!=typeof t[0]&&(o=null);for(var a=0;a<t.length;a++)i="object"==typeof t[0]?Mp.getObject(r||o,t[a]):t[a],s.push(new Op(n,"equal",i));return Op.or(s)},e.prototype.getAggregateResult=function(t,e,i,n,o){var r=e;if(e&&e.result&&(r=e.result),t&&t.aggregates&&t.aggregates.length){var s=t.aggregates,a=void 0,l=r,c={};e.aggregate&&(l=e.aggregate);for(p=0;p<s.length;p++)(a=Mp.aggregates[s[p].type])&&(c[s[p].field+" - "+s[p].type]=a(l,s[p].field));i.aggregates=c}if(t&&t.groups&&t.groups.length){for(var d=t.groups,p=0;p<d.length;p++){h(n)||(n=Mp.group(n,d[p]));var u=kp.filterQueries(o.queries,"onGroup")[p].e;r=Mp.group(r,d[p],t.aggregates,null,n,u.comparer)}i.result=r}return i},e.prototype.getQueryRequest=function(t){var e={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return e.sorts=kp.filterQueries(t.queries,"onSortBy"),e.groups=kp.filterQueries(t.queries,"onGroup"),e.filters=kp.filterQueries(t.queries,"onWhere"),e.searches=kp.filterQueries(t.queries,"onSearch"),e.aggregates=kp.filterQueries(t.queries,"onAggregates"),e},e.prototype.addParams=function(t){var e=t.reqParams;t.params.length&&(e.params={});for(var i=0,n=t.params;i<n.length;i++){var o=n[i];if(e[o.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");e[o.key]=o.value,o.fn&&(e[o.key]=o.fn.call(t.query,o.key,t.query,t.dm)),e.params[o.key]=e[o.key]}},e}(Dp),Bp=function(t){function e(e){var i=t.call(this)||this;return i.options=l({},i.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),i.getModuleName=n("getModulename",i),l(i.options,e||{}),i}return Ip(e,t),e.prototype.onPredicate=function(t,i,n){var o,r,s="",a=t.value,l=typeof a,c=t.field?e.getField(t.field):null;if(a instanceof Date&&(a="datetime'"+Mp.parse.replacer(a)+"'"),"string"===l&&(a="'"+a+"'",n&&(c="cast("+c+", 'Edm.String')"),Mp.parse.isGuid(a)&&(r="guid"),t.ignoreCase&&(r||(c="tolower("+c+")"),a=a.toLowerCase())),o=Mp.odBiOperator[t.operator])return s+=c,s+=o,r&&(s+=r),s+a;if(h(this.getModuleName)?o=Mp.odUniOperator[t.operator]:"ODataV4Adaptor"===this.getModuleName()&&(o=Mp.odv4UniOperator[t.operator]),"substringof"===o){var d=a;a=c,c=d}return s+=o+"(",s+=c+",",r&&(s+=r),s+=a+")"},e.prototype.addParams=function(e){t.prototype.addParams.call(this,e),delete e.reqParams.params},e.prototype.onComplexPredicate=function(t,e,i){for(var n=[],o=0;o<t.predicates.length;o++)n.push("("+this.onEachWhere(t.predicates[o],e,i)+")");return n.join(" "+t.condition+" ")},e.prototype.onEachWhere=function(t,e,i){return t.isComplex?this.onComplexPredicate(t,e,i):this.onPredicate(t,e,i)},e.prototype.onWhere=function(t){return this.pvt.search&&t.push(this.onEachWhere(this.pvt.search,null,!0)),t.join(" and ")},e.prototype.onEachSearch=function(t){t.fields&&0===t.fields.length&&Mp.throwError("Query() - Search : oData search requires list of field names to search");for(var e=this.pvt.search||[],i=0;i<t.fields.length;i++)e.push(new Op(t.fields[i],t.operator,t.key,t.ignoreCase));this.pvt.search=e},e.prototype.onSearch=function(t){return this.pvt.search=Op.or(this.pvt.search),""},e.prototype.onEachSort=function(t){var i=[];if(t.name instanceof Array)for(var n=0;n<t.name.length;n++)i.push(e.getField(t.name[n])+("descending"===t.direction?" desc":""));else i.push(e.getField(t.name)+("descending"===t.direction?" desc":""));return i.join(",")},e.prototype.onSortBy=function(t){return t.reverse().join(",")},e.prototype.onGroup=function(t){return this.pvt.groups=t,[]},e.prototype.onSelect=function(t){for(var i=0;i<t.length;i++)t[i]=e.getField(t[i]);return t.join(",")},e.prototype.onAggregates=function(t){return this.pvt.aggregates=t,""},e.prototype.onCount=function(t){return!0===t?"allpages":""},e.prototype.beforeSend=function(t,e,i){Mp.endsWith(i.url,this.options.batch)&&"post"===i.type.toLowerCase()?(e.setRequestHeader("Accept",this.options.multipartAccept),e.setRequestHeader("DataServiceVersion","2.0"),e.overrideMimeType("text/plain; charset=x-user-defined")):e.setRequestHeader("Accept",this.options.accept),e.setRequestHeader("DataServiceVersion","2.0"),e.setRequestHeader("MaxDataServiceVersion","2.0")},e.prototype.processResponse=function(t,e,i,n,o,r){if(!h(t.d)){var s=i&&i.isCountRequired?t.d.results:t.d;if(!h(s))for(var a=0;a<s.length;a++)h(s[a].__metadata)||delete s[a].__metadata}var l=o&&o.pvtData,c=this.processBatchResponse(t,i,n,o,r);if(c)return c;var d=n&&o.getResponseHeader("DataServiceVersion"),p=null,u=d&&parseInt(d,10)||2;if(i&&i.isCountRequired){(t.__count||t["odata.count"])&&(p=t.__count||t["odata.count"]),t.d&&(t=t.d),(t.__count||t["odata.count"])&&(p=t.__count||t["odata.count"])}3===u&&t.value&&(t=t.value),t.d&&(t=t.d),u<3&&t.results&&(t=t.results);var g={};return g.count=p,g.result=t,this.getAggregateResult(l,t,g,null,i),Mp.isNull(p)?g.result:{result:g.result,count:g.count,aggregates:g.aggregates}},e.prototype.convertToQueryString=function(t,e,i){var n=[],o=t.table||"";delete t.table,i.dataSource.requiresFormat&&(t.$format="json");for(var r=0,s=Object.keys(t);r<s.length;r++){var a=s[r];n.push(a+"="+t[a])}return n=n.join("&"),i.dataSource.url&&-1!==i.dataSource.url.indexOf("?")&&!o?n:n.length?o+"?"+n:o||""},e.prototype.localTimeReplacer=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var o=n[i];e[o]instanceof Date&&(e[o]=Mp.dateParse.toLocalTime(e[o]))}return e},e.prototype.insert=function(t,e,i){return{url:t.dataSource.url.replace(/\/*$/,i?"/"+i:""),data:JSON.stringify(e,this.options.localTime?this.localTimeReplacer:null)}},e.prototype.remove=function(t,e,i,n){return{type:"DELETE",url:t.dataSource.url.replace(/\/*$/,n?"/"+n:"")+"("+i+")"}},e.prototype.update=function(t,e,i,n){return{type:this.options.updateType,url:t.dataSource.url.replace(/\/*$/,n?"/"+n:"")+"("+i[e]+")",data:JSON.stringify(i,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},e.prototype.batchRequest=function(t,e,i){var n=i.guid=Mp.getGuid(this.options.batchPre),o=t.dataSource.url.replace(/\/*$/,"/"+this.options.batch),r={url:i.url,key:i.key,cid:1,cSet:Mp.getGuid(this.options.changeSet)},s="--"+n+"\n";return s+="Content-Type: multipart/mixed; boundary="+r.cSet.replace("--","")+"\n",this.pvt.changeSet=0,s+=this.generateInsertRequest(e.addedRecords,r),s+=this.generateUpdateRequest(e.changedRecords,r),s+=this.generateDeleteRequest(e.deletedRecords,r),s+=r.cSet+"--\n",s+="--"+n+"--",{type:"POST",url:o,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+n,data:s}},e.prototype.generateDeleteRequest=function(t,e){if(!t)return"";var i={method:"DELETE ",url:function(t,e,i){return"("+t[e][i]+")"},data:function(t,e){return""}};return this.generateBodyContent(t,e,i)+"\n"},e.prototype.generateInsertRequest=function(t,e){if(!t)return"";var i={method:"POST ",url:function(t,e,i){return""},data:function(t,e){return JSON.stringify(t[e])+"\n\n"}};return this.generateBodyContent(t,e,i)},e.prototype.generateUpdateRequest=function(t,e){if(!t)return"";var i={method:this.options.updateType,url:function(t,e,i){return"("+t[e][i]+")"},data:function(t,e){return JSON.stringify(t[e])+"\n\n"}};return this.generateBodyContent(t,e,i)},e.getField=function(t){return t.replace(/\./g,"/")},e.prototype.generateBodyContent=function(t,e,i){for(var n="",o=0;o<t.length;o++)n+="\n"+e.cSet+"\n",n+=this.options.changeSetContent+"\n\n",n+=i.method,n+=e.url+i.url(t,o,e.key)+" HTTP/1.1\n",n+="Accept: "+this.options.accept+"\n",n+="Content-Id: "+this.pvt.changeSet+++"\n",n+=this.options.batchChangeSetContentType+"\n",h(t[o]["@odata.etag"])?n+="\n":n+="If-Match: "+t[o]["@odata.etag"]+"\n\n",n+=i.data(t,o);return n},e.prototype.processBatchResponse=function(t,e,i,n,o){if(i&&i.getResponseHeader("Content-Type")&&-1!==i.getResponseHeader("Content-Type").indexOf("xml"))return e.isCountRequired?{result:[],count:0}:[];if(n&&this.options.batch&&Mp.endsWith(n.url,this.options.batch)&&"post"===n.type.toLowerCase()){var r=i.getResponseHeader("Content-Type"),s=void 0,a=void 0,h=t+"";if(r=r.substring(r.indexOf("=batchresponse")+1),(h=h.split(r)).length<2)return{};h=h[1];var c=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(h);c&&h.replace(c[0],"");for(var d=c?c[1]:"",p=(h=h.split(d)).length;p>-1;p--)/\bContent-ID:/i.test(h[p])&&/\bHTTP.+201/.test(h[p])&&(s=parseInt(/\bContent-ID: (\d+)/i.exec(h[p])[1],10),o.addedRecords[s]&&(a=Mp.parse.parseJson(/^\{.+\}/m.exec(h[p])[0]),l({},o.addedRecords[s],this.processResponse(a))));return o}return null},e}(Np),Hp=(function(t){function e(e){var i=t.call(this,e)||this;return i.options=l({},i.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1}),n("getModulename",i.getModulename()),l(i.options,e||{}),i}Ip(e,t),e.prototype.getModulename=function(){return"ODataV4Adaptor"},e.prototype.onCount=function(t){return!0===t?"true":""},e.prototype.onPredicate=function(e,i,n){var o="",r=e.value instanceof Date;return o=t.prototype.onPredicate.call(this,e,i,n),r&&(o=o.replace(/datetime'(.*)'$/,"$1")),o},e.prototype.onEachSearch=function(t){var e=this.pvt.searches||[];e.push(t.key),this.pvt.searches=e},e.prototype.onSearch=function(t){return this.pvt.searches.join(" OR ")},e.prototype.onSelect=function(t){for(var e="",i=0;i<t.length;i++)e+=this.getSelectStr(t[i]);return e.slice(1)},e.prototype.getSelectStr=function(t){var e=t.split(".");if(e.length>1){for(var i="&"+this.options.expand+"=",n=0;n<=e.length-1;n++)0===n?i+=e[n]:n===e.length-1?i+="("+this.options.select+"="+e[n]:i+="("+this.options.expand+"="+e[n];for(;--e.length;)i+=")";return i}return","+e},e.prototype.beforeSend=function(t,e,i){"POST"!==i.type&&"PUT"!==i.type&&"PATCH"!==i.type||e.setRequestHeader("Prefer","return=representation"),e.setRequestHeader("Accept",this.options.accept)},e.prototype.processResponse=function(e,i,n,o,r,s){var a=r&&r.pvtData,l=t.prototype.processBatchResponse.call(this,e,n,o,r,s);if(l)return l;var c=null;n&&n.isCountRequired&&"@odata.count"in e&&(c=e["@odata.count"]),e=h(e.value)?e:e.value;var d={};return d.count=c,d.result=e,this.getAggregateResult(a,e,d,null,n),Mp.isNull(c)?d.result:{result:d.result,count:c,aggregates:d.aggregates}}}(Bp),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ip(e,t),e.prototype.insert=function(t,e,i){return{type:"POST",url:t.dataSource.url,data:JSON.stringify(e)}},e.prototype.remove=function(t,e,i,n){return{type:"DELETE",url:t.dataSource.url+"/"+i,data:JSON.stringify(i)}},e.prototype.update=function(t,e,i,n){return{type:"PUT",url:t.dataSource.url,data:JSON.stringify(i)}},e.prototype.beforeSend=function(t,e,i){e.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01")},e.prototype.processResponse=function(t,e,i,n,o,r){var s=o&&o.pvtData,a=null,l={};if(o&&"post"!==o.type.toLowerCase()){var h=n&&o.getResponseHeader("DataServiceVersion"),c=h&&parseInt(h,10)||2;i&&i.isCountRequired&&(Mp.isNull(t.Count)||(a=t.Count)),c<3&&t.Items&&(t=t.Items),l.count=a,l.result=t,this.getAggregateResult(s,t,l,null,i)}return l.result=l.result||t,Mp.isNull(a)?l.result:{result:l.result,count:l.count,aggregates:l.aggregates}}}(Bp),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ip(e,t),e.prototype.processQuery=function(t,e,i){var n=(new Np).processQuery(t,e,i),o=Mp.parse.parseJson(n.data),r={};if(o.param)for(var s=0;s<o.param.length;s++){var a=o.param[s],l=Object.keys(a)[0];r[l]=a[l]}r.value=o;return{data:JSON.stringify(r),url:n.url,pvtData:n.pvtData,type:"POST",contentType:"application/json; charset=utf-8"}}}(Np),function(t){function e(){var e=t.call(this)||this;return o("beforeSend",Np.prototype.beforeSend,e),e}return Ip(e,t),e.prototype.insert=function(e,i,n){return t.prototype.insert.call(this,e,i,null,null,0),{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify({value:i,table:n,action:"insert"})}},e.prototype.remove=function(e,i,n,o){return t.prototype.remove.call(this,e,i,n),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify({key:n,keyColumn:i,table:o,action:"remove"})}},e.prototype.update=function(e,i,n,o){return t.prototype.update.call(this,e,i,n),{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify({value:n,action:"update",keyColumn:i,key:n[i],table:o})}},e.prototype.batchRequest=function(t,e,i){var n;for(n=0;n<e.addedRecords.length;n++)Rp.prototype.insert(t,e.addedRecords[n]);for(n=0;n<e.changedRecords.length;n++)Rp.prototype.update(t,i.key,e.changedRecords[n]);for(n=0;n<e.deletedRecords.length;n++)Rp.prototype.remove(t,i.key,e.deletedRecords[n]);return{type:"POST",url:t.dataSource.batchUrl||t.dataSource.crudUrl||t.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({changed:e.changedRecords,added:e.addedRecords,deleted:e.deletedRecords,action:"batch",table:i.url,key:i.key})}},e}(Rp)),zp=function(t){function e(e,i,n){var o=t.call(this)||this;o.isCrudAction=!1,o.isInsertAction=!1,h(e)||(o.cacheAdaptor=e),o.pageSize=n,o.guidId=Mp.getGuid("cacheAdaptor");var r={keys:[],results:[]};window.localStorage.setItem(o.guidId,JSON.stringify(r));var s=o.guidId;return h(i)||setInterval(function(){var t;t=Mp.parse.parseJson(window.localStorage.getItem(s));for(var e=[],n=0;n<t.results.length;n++){var o=+new Date,r=+new Date(t.results[n].timeStamp);t.results[n].timeStamp=o-r,o-r>i&&e.push(n)}for(n=0;n<e.length;n++)t.results.splice(e[n],1),t.keys.splice(e[n],1);window.localStorage.removeItem(s),window.localStorage.setItem(s,JSON.stringify(t))},i),o}return Ip(e,t),e.prototype.generateKey=function(t,e){var i=this.getQueryRequest(e),n=kp.filterQueryLists(e.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=t;"onPage"in n&&(o+=n.onPage.pageIndex),i.sorts.forEach(function(t){o+=t.e.direction+t.e.fieldName}),i.groups.forEach(function(t){o+=t.e.fieldName}),i.searches.forEach(function(t){o+=t.e.searchKey});for(var r=0;r<i.filters.length;r++){var s=i.filters[r];if(s.e.isComplex){var a=e.clone();a.queries=[];for(var l=0;l<s.e.predicates.length;l++)a.queries.push({fn:"onWhere",e:s.e.predicates[l],filter:e.queries.filter});o+=s.e.condition+this.generateKey(t,a)}else o+=s.e.field+s.e.operator+s.e.value}return o},e.prototype.processQuery=function(t,e,i){var n,o=this.generateKey(t.dataSource.url,e),r=(n=Mp.parse.parseJson(window.localStorage.getItem(this.guidId)))?n.results[n.keys.indexOf(o)]:null;return null==r||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):r},e.prototype.processResponse=function(t,e,i,n,o,r){if(this.isInsertAction||o&&this.cacheAdaptor.options.batch&&Mp.endsWith(o.url,this.cacheAdaptor.options.batch)&&"post"===o.type.toLowerCase())return this.cacheAdaptor.processResponse(t,e,i,n,o,r);t=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var s=i?this.generateKey(e.dataSource.url,i):e.dataSource.url,a={},l=(a=Mp.parse.parseJson(window.localStorage.getItem(this.guidId))).keys.indexOf(s);for(-1!==l&&(a.results.splice(l,1),a.keys.splice(l,1)),a.results[a.keys.push(s)-1]={keys:s,result:t.result,timeStamp:new Date,count:t.count};a.results.length>this.pageSize;)a.results.splice(0,1),a.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(a)),t},e.prototype.beforeSend=function(t,e,i){Mp.endsWith(i.url,this.cacheAdaptor.options.batch)&&"post"===i.type.toLowerCase()&&e.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),t.dataSource.crossDomain||e.setRequestHeader("Accept",this.cacheAdaptor.options.accept)},e.prototype.update=function(t,e,i,n){return this.isCrudAction=!0,this.cacheAdaptor.update(t,e,i,n)},e.prototype.insert=function(t,e,i){return this.isInsertAction=!0,this.cacheAdaptor.insert(t,e,i)},e.prototype.remove=function(t,e,i,n){return this.isCrudAction=!0,this.cacheAdaptor.remove(t,e,i,n)},e.prototype.batchRequest=function(t,e,i){return this.cacheAdaptor.batchRequest(t,e,i)},e}(Np),jp=function(){function t(t,e,i){var n=this;this.dateParse=!0,this.requests=[],t||this.dataSource||(t=[]),i=i||t.adaptor;var o;return t instanceof Array?o={json:t,offline:!0}:"object"==typeof t?(t.json||(t.json=[]),o={url:t.url,insertUrl:t.insertUrl,removeUrl:t.removeUrl,updateUrl:t.updateUrl,crudUrl:t.crudUrl,batchUrl:t.batchUrl,json:t.json,headers:t.headers,accept:t.accept,data:t.data,timeTillExpiration:t.timeTillExpiration,cachingPageSize:t.cachingPageSize,enableCaching:t.enableCaching,requestType:t.requestType,key:t.key,crossDomain:t.crossDomain,jsonp:t.jsonp,dataType:t.dataType,offline:void 0!==t.offline?t.offline:!(t.adaptor instanceof Hp)&&!t.url,requiresFormat:t.requiresFormat}):Mp.throwError("DataManager: Invalid arguments"),void 0!==o.requiresFormat||Mp.isCors()||(o.requiresFormat=!!h(o.crossDomain)||o.crossDomain),void 0===o.dataType&&(o.dataType="json"),this.dataSource=o,this.defaultQuery=e,o.url&&o.offline&&!o.json.length?(this.isDataAvailable=!1,this.adaptor=i||new Bp,this.dataSource.offline=!1,this.ready=this.executeQuery(e||new kp),this.ready.then(function(t){n.dataSource.offline=!0,n.isDataAvailable=!0,o.json=t.result,n.adaptor=new Rp})):this.adaptor=o.offline?new Rp:new Bp,!o.jsonp&&this.adaptor instanceof Bp&&(o.jsonp="callback"),this.adaptor=i||this.adaptor,o.enableCaching&&(this.adaptor=new zp(this.adaptor,o.timeTillExpiration,o.cachingPageSize)),this}return t.prototype.setDefaultQuery=function(t){return this.defaultQuery=t,this},t.prototype.executeLocal=function(e){this.defaultQuery||e instanceof kp||Mp.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||Mp.throwError("DataManager - executeLocal() : Json data is required to execute"),e=e||this.defaultQuery;var i=this.adaptor.processQuery(this,e);if(e.subQuery){var n=e.subQuery.fromTable,o=e.subQuery.lookups,r=e.isCountRequired?i.result:i;o&&o instanceof Array&&Mp.buildHierarchy(e.subQuery.fKey,n,r,o,e.subQuery.key);for(var s=0;s<r.length;s++)r[s][n]instanceof Array&&(r[s]=l({},{},r[s]),r[s][n]=this.adaptor.processResponse(e.subQuery.using(new t(r[s][n].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(i,this,e)},t.prototype.executeQuery=function(e,i,n,o){var r=this;"function"==typeof e&&(o=n,n=i,i=e,e=null),e||(e=this.defaultQuery),e instanceof kp||Mp.throwError("DataManager - executeQuery() : A query is required to execute");var s=new Fp,a={query:e};if(this.dataSource.offline||void 0===this.dataSource.url||""===this.dataSource.url)t.nextTick(function(){var i=r.executeLocal(e);a=t.getDeferedArgs(e,i,a),s.resolve(a)});else{var l=this.adaptor.processQuery(this,e);this.makeRequest(l,s,a,e)}return(i||n)&&s.promise.then(i,n),o&&s.promise.then(o,o),s.promise},t.getDeferedArgs=function(t,e,i){return t.isCountRequired?(i.result=e.result,i.count=e.count,i.aggregates=e.aggregates):i.result=e,i},t.nextTick=function(t){(window.setImmediate||window.setTimeout)(t,0)},t.prototype.extendRequest=function(t,e,i){return l({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:e,onFailure:i},t)},t.prototype.makeRequest=function(t,e,i,n){var o=this,r=!!n.subQuerySelector,s=function(t){i.error=t,e.reject(i)},a=function(t,n,o,r,s,a,l){i.xhr=o,i.count=n?parseInt(n.toString(),10):0,i.result=t,i.request=r,i.aggregates=a,i.actual=s,i.virtualSelectRecords=l,e.resolve(i)},l=function(t,e){var l=new Fp,h={parent:i};n.subQuery.isChild=!0;var c=o.adaptor.processQuery(o,n.subQuery,t?o.adaptor.processResponse(t):e),d=o.makeRequest(c,l,h,n.subQuery);return r||l.then(function(e){t&&(Mp.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,t,e,n.subQuery.key),a(t,e.count,e.xhr))},s),d},h=function(t,e){-1===e.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&o.dateParse&&(t=Mp.parse.parseJson(t));var i=o.adaptor.processResponse(t,o,n,e.httpRequest,e),s=0,h=null,c=t.virtualSelectRecords;if(n.isCountRequired&&(s=i.count,h=i.aggregates,i=i.result),!n.subQuery)return void a(i,s,e.httpRequest,e.type,t,h,c);r||l(i,e)},c=this.extendRequest(t,h,s),d=new la(c);if(d.beforeSend=function(){o.beforeSend(d.httpRequest,d)},(c=d.send()).catch(function(t){return!0}),this.requests.push(d),r){var p=n.subQuerySelector.call(this,{query:n.subQuery,parent:n});p&&p.length?Promise.all([c,l(null,p)]).then(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],s=o.adaptor.processResponse(i[0],o,n,o.requests[0].httpRequest,o.requests[0]),l=0;n.isCountRequired&&(l=s.count,s=s.result);var h=o.adaptor.processResponse(i[1],o,n.subQuery,o.requests[1].httpRequest,o.requests[1]);l=0,n.subQuery.isCountRequired&&(l=h.count,h=h.result),Mp.buildHierarchy(n.subQuery.fKey,n.subQuery.fromTable,s,h,n.subQuery.key),r=!1,a(s,l,o.requests[0].httpRequest)}):r=!1}return c},t.prototype.beforeSend=function(t,e){this.adaptor.beforeSend(this,t,e);for(var i,n=this.dataSource.headers,o=0;n&&o<n.length;o++){i=[];for(var r=0,s=Object.keys(n[o]);r<s.length;r++){var a=s[r];i.push(a),t.setRequestHeader(a,n[o][a])}}},t.prototype.saveChanges=function(t,e,i,n){var o=this;i instanceof kp&&(n=i,i=null);var r={url:i,key:e||this.dataSource.key},s=this.adaptor.batchRequest(this,t,r,n);if(this.dataSource.offline)return s;var a=new Fp,l=new la(s);return l.beforeSend=function(){o.beforeSend(l.httpRequest,l)},l.onSuccess=function(e,i){a.resolve(o.adaptor.processResponse(Mp.parse.parseJson(e),o,null,i.httpRequest,i,t))},l.onFailure=function(t){a.reject([{error:t}])},l.send().catch(function(t){return!0}),a.promise},t.prototype.insert=function(t,e,i,n){e instanceof kp&&(i=e,e=null);var o=this.adaptor.insert(this,t,e,i,n);return this.dataSource.offline?o:this.doAjaxRequest(o)},t.prototype.remove=function(t,e,i,n){"object"==typeof e&&(e=e[t]),i instanceof kp&&(n=i,i=null);var o=this.adaptor.remove(this,t,e,i,n);return this.dataSource.offline?o:this.doAjaxRequest(o)},t.prototype.update=function(t,e,i,n){i instanceof kp&&(n=i,i=null);var o=this.adaptor.update(this,t,e,i,n);return this.dataSource.offline?o:this.doAjaxRequest(o)},t.prototype.doAjaxRequest=function(t){var e=this,i=new Fp;t=l({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},t);var n=new la(t);return n.beforeSend=function(){e.beforeSend(n.httpRequest,n)},n.onSuccess=function(t,n){try{Mp.parse.parseJson(t)}catch(e){t=[]}t=e.adaptor.processResponse(Mp.parse.parseJson(t),e,null,n.httpRequest,n),i.resolve(t)},n.onFailure=function(t){i.reject([{error:t}])},n.send().catch(function(t){return!0}),i.promise},t}(),Fp=function(){function t(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return t}(),Vp=function(){function t(){this.dataTable={}}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"DataBinding"},t.prototype.initData=function(t,e){var i,n=t.dataManager||{};(i=t.data||n.data||n.json||(n.dataSource?n.dataSource.json:void 0))&&i.length&&this.applyDataSource(t,i,e)},t.prototype.initSource=function(t,e){var i,n=this,o=t;if(t.dataManager instanceof jp){var r=o.dataManager.defaultQuery;t.dataManager.executeQuery(r).then(function(o){i=o.result,e.isDestroyed||(n.applyDataSource(t,i,e),e.refreshDiagram(),e.trigger("dataLoaded",{diagram:e}))})}},t.prototype.applyDataSource=function(t,e,i){this.dataTable={};var n,o,r,s,a=[],l=[];if(void 0!==e){for(var h=0;h<e.length;h++)void 0===(n=e[h])[t.parentId]||null===n[t.parentId]||"object"!=typeof n[t.parentId]?void 0!==a[n[t.parentId]]?a[n[t.parentId]].items.push(n):a[n[t.parentId]]={items:[n]}:a=this.updateMultipleRootNodes(n,a,t,e),t.root===n[t.id]&&(o={items:[n]});if(o)l.push(o);else for(var c=0,d=Object.keys(a);c<d.length;c++){var p=d[c];p&&"undefined"!==p&&"''"!==p&&"null"!==p||l.push(a[p])}for(var u=0;u<l.length;u++)for(var g=0;g<l[u].items.length;g++){r=l[u].items[g];var m=this.applyNodeTemplate(t,r,i);i.nodes.push(m),this.dataTable[r[t.id]]=m,void 0!==(s=a[m.data[t.id]])&&this.renderChildNodes(t,s,m.id,a,i)}}this.dataTable=null},t.prototype.updateMultipleRootNodes=function(t,e,i,n){for(var o,r=t[i.parentId],s=0;s<r.length;s++)e[o=r[s]]?e[o].items.push(t):e[o]={items:[t]};return e},t.prototype.applyNodeTemplate=function(t,e,i){var n={id:qr(),data:e},o=as(t.doBinding);o&&o(n,e,i);var r=new fd(i,"nodes",n,!0);return this.collectionContains(r,i,t.id,t.parentId)?this.dataTable[e[t.id]]:r},t.prototype.renderChildNodes=function(t,e,i,n,o){for(var r,s,a,l=0;l<e.items.length;l++){r=e.items[l],a=this.applyNodeTemplate(t,r,o);var h=!1;this.collectionContains(a,o,t.id,t.parentId)?h=!0:(this.dataTable[r[t.id]]=a,o.nodes.push(a)),this.containsConnector(o,i,a.id)||o.connectors.push(this.applyConnectorTemplate(i,a.id,o)),h||void 0!==(s=n[a.data[t.id]])&&this.renderChildNodes(t,s,a.id,n,o)}},t.prototype.containsConnector=function(t,e,i){if(""!==e&&""!==i)for(var n=0;n<t.connectors.length;n++){var o=t.connectors[n];if(void 0!==o&&o.sourceID===e&&o.targetID===i)return!0}return!1},t.prototype.collectionContains=function(t,e,i,n){var o=this.dataTable[t.data[i]];return void 0!==o&&o.data[i]===t.data[i]&&o.data[n]===t.data[n]},t.prototype.applyConnectorTemplate=function(t,e,i){var n={id:qr(),sourceID:t,targetID:e};return new _c(i,"connectors",n,!0)},t}(),_p=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Wp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Up=function(t){function e(e,i){return t.call(this,e,i)||this}return _p(e,t),e.prototype.preRender=function(){this.browser=ma.info.name,this.browserCheck="mozilla"===this.browser,this.isDevice=ma.isDevice;var t=this.element;this.ieCheck="edge"===this.browser||"msie"===this.browser,this.initialize(),""===t.id&&(t.id=d("hscroll"),this.uniqueId=!0),t.style.display="block",this.enableRtl&&t.classList.add("e-rtl")},e.prototype.render=function(){this.touchModule=new gl(this.element,{scroll:this.touchHandler.bind(this)}),this.isDevice?this.element.classList.add("e-scroll-device"):(this.createNavIcon(this.element),ha.add(this.scrollEle,"scroll",this.scrollHandler,this))},e.prototype.initialize=function(){var t=this.createElement("div",{className:"e-hscroll-content"}),e=this.createElement("div",{className:"e-hscroll-bar"});e.setAttribute("tabindex","-1");for(var i=this.element,n=0,o=[].slice.call(i.children);n<o.length;n++){var r=o[n];t.appendChild(r)}e.appendChild(t),i.appendChild(e),e.style.overflowX="hidden",this.scrollEle=e,this.scrollItems=t},e.prototype.getPersistData=function(){var t=["scrollStep"];return this.addOnPersist(t)},e.prototype.getModuleName=function(){return"hScroll"},e.prototype.destroy=function(){var e=this.element;e.style.display="",e.classList.remove("e-hscroll");for(var i=A(".e-"+e.id+"_nav.e-scroll-nav",e),n=0,o=[].slice.call(this.scrollItems.children);n<o.length;n++){var r=o[n];e.appendChild(r)}this.uniqueId&&this.element.removeAttribute("id"),L(this.scrollEle),i.length>0&&(L(i[0]),L(i[1])),ha.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,t.prototype.destroy.call(this)},e.prototype.disable=function(t){var e=A(".e-scroll-nav:not(.e-overlay)",this.element);t?this.element.classList.add("e-overlay"):this.element.classList.remove("e-overlay"),e.forEach(function(e){e.setAttribute("tabindex",t?"-1":"0")})},e.prototype.createNavIcon=function(t){var e=t.id.concat("_nav"),i="e-"+t.id.concat("_nav e-scroll-nav e-scroll-right-nav"),n=this.createElement("div",{id:e.concat("_right"),className:i});n.setAttribute("aria-disabled","false");var o=this.createElement("div",{className:"e-nav-right-arrow e-nav-arrow e-icons"}),r="e-"+t.id.concat("_nav e-scroll-nav e-scroll-left-nav"),s=this.createElement("div",{id:e.concat("_left"),className:r+" e-overlay"});s.setAttribute("aria-disabled","true");var a=this.createElement("div",{className:"e-nav-left-arrow e-nav-arrow e-icons"});s.appendChild(a),n.appendChild(o),n.setAttribute("tabindex","0"),t.appendChild(n),t.insertBefore(s,t.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),s.classList.add("e-ie-align")),this.eventBinding([n,s])},e.prototype.onKeyPress=function(t){var e=this;if("Enter"===t.key){var i=function(){e.keyTimeout=!0,e.eleScrolling(10,t.target)};this.keyTimer=window.setTimeout(function(){i()},100)}},e.prototype.onKeyUp=function(t){"Enter"===t.key&&(this.keyTimeout?this.keyTimeout=!1:t.target.click(),clearTimeout(this.keyTimer))},e.prototype.eventBinding=function(t){var e=this;t.forEach(function(t){new gl(t,{tapHold:e.tabHoldHandler.bind(e),tapHoldThreshold:500}),t.addEventListener("keydown",e.onKeyPress.bind(e)),t.addEventListener("keyup",e.onKeyUp.bind(e)),t.addEventListener("mouseup",e.repeatScroll.bind(e)),t.addEventListener("touchend",e.repeatScroll.bind(e)),t.addEventListener("contextmenu",function(t){t.preventDefault()}),ha.add(t,"click",e.clickEventHandler,e)})},e.prototype.repeatScroll=function(){clearInterval(this.timeout)},e.prototype.tabHoldHandler=function(t){var e=this,i=t.originalEvent.target;i=this.contains(i,"e-scroll-nav")?i.firstElementChild:i;var n=function(){e.eleScrolling(10,i)};this.timeout=window.setInterval(function(){n()},50)},e.prototype.contains=function(t,e){return t.classList.contains(e)},e.prototype.eleScrolling=function(t,e){var i=this.scrollEle,n=this.element,o=e.classList;o.contains("e-scroll-nav")&&(o=e.querySelector(".e-nav-arrow").classList),this.contains(n,"e-rtl")&&this.browserCheck&&(t=-t);var r=i.scrollLeft;!this.contains(n,"e-rtl")||this.browserCheck||this.ieCheck?o.contains("e-nav-right-arrow")?i.scrollLeft=r+t:i.scrollLeft=r-t:o.contains("e-nav-left-arrow")?i.scrollLeft=r+t:i.scrollLeft=r-t},e.prototype.clickEventHandler=function(t){this.eleScrolling(this.scrollStep,t.target)},e.prototype.touchHandler=function(t){var e,i=this.scrollEle;e=t.distanceX,this.ieCheck&&this.contains(this.element,"e-rtl")&&(e=-e),"Left"===t.scrollDirection?i.scrollLeft=i.scrollLeft+e:"Right"===t.scrollDirection&&(i.scrollLeft=i.scrollLeft-e)},e.prototype.arrowDisabling=function(t,e){t.classList.add("e-overlay"),t.setAttribute("aria-disabled","true"),t.removeAttribute("tabindex"),clearInterval(this.timeout),e.classList.remove("e-overlay"),e.setAttribute("aria-disabled","false"),e.setAttribute("tabindex","0"),this.repeatScroll()},e.prototype.scrollHandler=function(t){var e=t.target,i=e.offsetWidth,n=this.element,o=this.element.querySelector(".e-scroll-left-nav"),r=this.element.querySelector(".e-scroll-right-nav"),s=e.scrollLeft;if(s<=0&&(s=-s),0===s)!this.contains(n,"e-rtl")||this.browserCheck||this.ieCheck?this.arrowDisabling(o,r):this.arrowDisabling(r,o);else if(Math.ceil(i+s+.1)>=e.scrollWidth)!this.contains(n,"e-rtl")||this.browserCheck||this.ieCheck?this.arrowDisabling(r,o):this.arrowDisabling(o,r);else{var a=this.element.querySelector(".e-scroll-nav.e-overlay");a&&(a.classList.remove("e-overlay"),a.setAttribute("aria-disabled","false"),a.setAttribute("tabindex","0"))}},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"scrollStep":break;case"enableRtl":t.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")}},Wp([Y(40)],e.prototype,"scrollStep",void 0),e=Wp([$],e)}(Ka),qp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Xp=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Yp="e-toolbar-items",Gp="e-toolbar-item",Zp="e-toolbar-popup",Kp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qp(e,t),Xp([Y("")],e.prototype,"id",void 0),Xp([Y("")],e.prototype,"text",void 0),Xp([Y("auto")],e.prototype,"width",void 0),Xp([Y("")],e.prototype,"cssClass",void 0),Xp([Y(!1)],e.prototype,"showAlwaysInPopup",void 0),Xp([Y("")],e.prototype,"prefixIcon",void 0),Xp([Y("")],e.prototype,"suffixIcon",void 0),Xp([Y("None")],e.prototype,"overflow",void 0),Xp([Y("")],e.prototype,"template",void 0),Xp([Y("Button")],e.prototype,"type",void 0),Xp([Y("Both")],e.prototype,"showTextOn",void 0),Xp([Y(null)],e.prototype,"htmlAttributes",void 0),Xp([Y("")],e.prototype,"tooltipText",void 0),Xp([Y("Left")],e.prototype,"align",void 0),e}(xa),Qp=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},n}return qp(e,t),e.prototype.destroy=function(){var e=this,i=this.element;for(t.prototype.destroy.call(this),this.unwireEvents(),this.tempId.forEach(function(t){h(e.element.querySelector(t))||(document.body.appendChild(e.element.querySelector(t)).style.display="none")});i.firstChild;)i.removeChild(i.firstChild);this.trgtEle&&i.appendChild(this.ctrlTem),this.clearProperty(),this.popObj=null,this.tbarAlign=null,this.remove(this.element,"e-toolpop"),i.removeAttribute("style"),["aria-disabled","aria-orientation","aria-haspopup","role"].forEach(function(t){e.element.removeAttribute(t)})},e.prototype.preRender=function(){var t={enableCollision:!0,scrollStep:this.scrollStep};this.trigger("beforeCreate",t),this.enableCollision=t.enableCollision,this.scrollStep=t.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.popupPriCount=0,this.enableRtl&&this.add(this.element,"e-rtl")},e.prototype.wireEvents=function(){ha.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resize.bind(this)),this.keyModule=new ll(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),ha.add(this.element,"keydown",this.docKeyDown,this),this.element.setAttribute("tabIndex","0")},e.prototype.docKeyDown=function(t){if("INPUT"!==t.target.tagName){var e=!h(this.popObj)&&S(this.popObj.element)&&"Extended"!==this.overflowMode;9===t.keyCode&&!0===t.target.classList.contains("e-hor-nav")&&e&&this.popObj.hide({name:"FadeOut",duration:100}),(40===t.keyCode||38===t.keyCode||35===t.keyCode||36===t.keyCode)&&t.preventDefault()}},e.prototype.unwireEvents=function(){ha.remove(this.element,"click",this.clickHandler),this.destroyHScroll(),this.keyModule.destroy(),ha.remove(document,"scroll",this.docEvent),ha.remove(this.element,"keydown",this.docKeyDown),ha.remove(document,"click",this.docEvent)},e.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},e.prototype.docEvent=function(t){var e=M(t.target,".e-popup");this.popObj&&S(this.popObj.element)&&!e&&"Popup"===this.overflowMode&&this.popObj.hide({name:"FadeOut",duration:100})},e.prototype.destroyHScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,"e-tbar-pos"),this.scrollModule.destroy(),this.scrollModule=null)},e.prototype.destroyItems=function(){[].slice.call(this.element.querySelectorAll("."+Gp)).forEach(function(t){L(t)});var t=this.element.querySelector("."+Yp);this.tbarAlign&&([].slice.call(t.children).forEach(function(t){L(t)}),this.tbarAlign=!1,this.remove(t,"e-tbar-pos")),this.clearProperty()},e.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,"e-rtl"),this.destroyHScroll()),this.remove(this.element,"e-tbar-extended"),this.popObj&&this.popupRefresh(this.popObj.element,!0)},e.prototype.add=function(t,e){t.classList.add(e)},e.prototype.remove=function(t,e){t.classList.remove(e)},e.prototype.elementFocus=function(t){var e=t.firstElementChild;e?(e.focus(),this.activeEleSwitch(t)):t.focus()},e.prototype.clstElement=function(t,e){return t&&this.popObj&&S(this.popObj.element)?this.popObj.element.querySelector("."+Gp):this.element===e||t?this.element.querySelector("."+Gp+":not(.e-overlay ):not(.e-separator )"):M(e,"."+Gp)},e.prototype.keyHandling=function(t,e,i,n,o){var r=this.popObj,s=this.element,a={name:"FadeOut",duration:100};switch(e.action){case"moveRight":s===i?this.elementFocus(t):n||this.eleFocus(t,"next");break;case"moveLeft":n||this.eleFocus(t,"previous");break;case"home":case"end":var l=void 0,h=void 0;if(t){var c=M(t,".e-popup");c?S(this.popObj.element)&&(h=c.children,l="home"===e.action?h[0]:h[h.length-1]):(h=this.element.querySelectorAll("."+Yp+" ."+Gp),l="home"===e.action?h[0]:h[h.length-1]),l&&this.elementFocus(l)}break;case"moveUp":case"moveDown":var d="moveUp"===e.action?"previous":"next";if(r&&M(i,".e-popup")){var p=r.element,u=p.firstElementChild;if("previous"===d&&u===t||"next"===d&&p.lastElementChild===t)return;this.eleFocus(t,d)}else"moveDown"===e.action&&r&&S(r.element)&&this.elementFocus(t);break;case"tab":if(!o&&!n){var g=t.firstElementChild;s===i&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(g),g.focus()),this.element.removeAttribute("tabindex"))}break;case"popupClose":r&&"Extended"!==this.overflowMode&&r.hide(a);break;case"popupOpen":if(!n)return;r&&!S(r.element)?(r.element.style.top=s.offsetHeight+"px",r.show({name:"FadeIn",duration:100})):r.hide(a)}},e.prototype.keyActionHandler=function(t){var e=t.target;if("INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&!this.element.classList.contains("e-overlay")){t.preventDefault();var i,n=e.classList.contains("e-hor-nav"),o=e.classList.contains("e-scroll-nav");((i=this.clstElement(n,e))||o)&&this.keyHandling(i,t,e,n,o)}},e.prototype.disable=function(t){var e=this.element;t?e.classList.add("e-overlay"):e.classList.remove("e-overlay"),e.setAttribute("tabindex",t?"-1":"0"),this.activeEle&&this.activeEle.setAttribute("tabindex",t?"-1":"0"),this.scrollModule&&this.scrollModule.disable(t),this.popObj&&(S(this.popObj.element)&&"Extended"!==this.overflowMode&&this.popObj.hide(),e.querySelector("#"+e.id+"_nav").setAttribute("tabindex",t?"-1":"0"))},e.prototype.eleFocus=function(t,e){var i=Object(t)[e+"ElementSibling"],n=function(t){return t.classList.contains("e-separator")||t.classList.contains("e-overlay")};if(i){var o=n(i);if(o){if(!Object(i)[e+"ElementSibling"])return;if(i=Object(i)[e+"ElementSibling"],o=n(i))return void this.eleFocus(i,e)}this.elementFocus(i)}else if(this.tbarAlign){var r=Object(t.parentElement)[e+"ElementSibling"];if(h(r)||0!==r.children.length||(r=Object(r)[e+"ElementSibling"]),!h(r)&&r.children.length>0)if("next"===e)n(s=r.querySelector("."+Gp))?this.eleFocus(s,e):(s.firstElementChild.focus(),this.activeEleSwitch(s));else{var s=r.lastElementChild;n(s)?this.eleFocus(s,e):this.elementFocus(s)}}},e.prototype.clickHandler=function(t){var e=t.target,i=e.classList,n=this.element,o=!h(M(e,".e-toolbar-pop")),r=M(e,".e-hor-nav");r||(r=e),!n.children[0].classList.contains("e-hscroll")&&i.contains("e-hor-nav")&&(i=e.querySelector(".e-icons").classList),(i.contains("e-popup-up-icon")||i.contains("e-popup-down-icon"))&&this.popupClickHandler(n,r,"e-rtl");var s,a=M(t.target,"."+Gp);if(!h(a)&&!a.classList.contains("e-overlay")||r.classList.contains("e-hor-nav")){a&&(s=this.items[this.tbarEle.indexOf(a)]);var l={originalEvent:t,item:s};this.trigger("clicked",l),h(this.popObj)||!o||l.cancel||"Popup"!==this.overflowMode||this.popObj.hide({name:"FadeOut",duration:100})}},e.prototype.popupClickHandler=function(t,e,i){var n=this.popObj;S(n.element)?(e.classList.remove("e-nav-active"),n.hide({name:"FadeOut",duration:100})):(t.classList.contains(i)&&(n.enableRtl=!0,n.position={X:"left",Y:"top"}),0!==n.offsetX||t.classList.contains(i)||(n.enableRtl=!1,n.position={X:"right",Y:"top"}),n.dataBind(),n.refreshPosition(),n.element.style.top=this.element.offsetHeight+"px","Extended"===this.overflowMode&&(n.element.style.minHeight="0px"),e.classList.add("e-nav-active"),n.show({name:"FadeIn",duration:100}))},e.prototype.render=function(){this.initialize(),this.renderControl(),this.separator(),this.wireEvents()},e.prototype.initialize=function(){var t=m(this.width),e=m(this.height);"msie"===ma.info.name&&"auto"===this.height&&"MultiRow"!==this.overflowMode||I(this.element,{height:e}),I(this.element,{width:t});var i={role:"toolbar","aria-disabled":"false","aria-haspopup":"false","aria-orientation":"horizontal"};k(this.element,i)},e.prototype.renderControl=function(){this.trgtEle=this.element.children.length>0?this.element.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1)},e.prototype.initHScroll=function(t,e){!this.scrollModule&&this.checkOverflow(t,e[0])&&(this.tbarAlign&&this.element.querySelector("."+Yp+" .e-toolbar-center").removeAttribute("style"),this.scrollModule=new Up({scrollStep:this.scrollStep,enableRtl:this.enableRtl},e[0]),this.remove(this.scrollModule.element,"e-tbar-pos"),I(this.element,{overflow:"hidden"}))},e.prototype.itemWidthCal=function(t){var e,i=0;return[].slice.call(A("."+Gp,t)).forEach(function(t){S(t)&&(e=window.getComputedStyle(t),i+=t.offsetWidth+parseFloat(e.marginRight)+parseFloat(e.marginLeft))}),i},e.prototype.checkOverflow=function(t,e){if(h(t)||h(e)||!S(t))return!1;var i=t.offsetWidth,n=e.offsetWidth;(this.tbarAlign||this.scrollModule||i===n)&&(n=this.itemWidthCal(this.scrollModule?e.querySelector(".e-hscroll-content"):e));var o=t.querySelector(".e-hor-nav"),r=t.querySelector(".e-scroll-nav");return n>i-(o?o.offsetWidth:r?2*r.offsetWidth:0)},e.prototype.refreshOverflow=function(){this.resize()},e.prototype.renderOverflowMode=function(){var t=this.element,e=t.querySelector("."+Yp),i=this.popupPriCount>0;if(t&&t.children.length>0)switch(this.offsetWid=t.offsetWidth,this.remove(this.element,"e-toolpop"),"msie"===ma.info.name&&"auto"===this.height&&(t.style.height=""),this.overflowMode){case"Scrollable":h(this.scrollModule)&&this.initHScroll(t,t.getElementsByClassName(Yp));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(t,e)||i)&&(this.createPopupEle(t,[].slice.call(A("."+Yp+" ."+Gp,t))),this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0")),this.tbarAlign&&(this.add(e,"e-tbar-pos"),this.itemPositioning());break;case"MultiRow":this.add(e,"e-toolbar-multirow"),"hidden"===t.style.overflow&&(t.style.overflow=""),"msie"!==ma.info.name&&"auto"===t.style.height||(t.style.height="auto");break;case"Extended":this.add(this.element,"e-extended-toolbar"),(this.checkOverflow(t,e)||i)&&(this.createPopupEle(t,[].slice.call(A("."+Yp+" ."+Gp,t))),this.element.querySelector(".e-hor-nav").setAttribute("tabIndex","0"))}},e.prototype.separator=function(){var t,e=this.element,i=[].slice.call(e.querySelectorAll(".e-separator")),n=e.querySelector(".e-multirow-separator"),o=e.querySelector(".e-extended-separator");null!==(t="MultiRow"===this.overflowMode?n:o)&&("MultiRow"===this.overflowMode?t.classList.remove("e-multirow-separator"):"Extended"===this.overflowMode&&t.classList.remove("e-extended-separator"));for(var r=0;r<=i.length-1;r++)i[r].offsetLeft<30&&0!==i[r].offsetLeft&&("MultiRow"===this.overflowMode?i[r].classList.add("e-multirow-separator"):"Extended"===this.overflowMode&&i[r].classList.add("e-extended-separator"))},e.prototype.createPopupEle=function(t,e){var i=t.querySelector(".e-hor-nav");i||this.createPopupIcon(t),i=t.querySelector(".e-hor-nav");var n=t.offsetWidth-i.offsetWidth;this.element.classList.remove("e-rtl"),I(this.element,{direction:"initial"}),this.checkPriority(t,e,n,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},e.prototype.pushingPoppedEle=function(t,e,i,n,o){var r=t.element,s=A(".e-overflow-show",i),a=0,l=0;[].slice.call(A("."+Zp,r.querySelector("."+Yp))).forEach(function(r,h){s=A(".e-overflow-show",i),r.classList.contains("e-overflow-show")&&s.length>0?t.tbResize&&s.length>h?(i.insertBefore(r,s[h]),++l):(i.insertBefore(r,i.children[s.length]),++l):r.classList.contains("e-overflow-show")?(i.insertBefore(r,i.firstChild),++l):t.tbResize&&r.classList.contains("e-overflow-hide")&&i.children.length>0&&0===s.length?(i.insertBefore(r,i.firstChild),++l):r.classList.contains("e-overflow-hide")?e.push(r):t.tbResize?(i.insertBefore(r,i.childNodes[a+l]),++a):i.appendChild(r),r.classList.contains("e-separator")?I(r,{display:"",height:o+"px"}):I(r,{display:"",height:n+"px"})}),e.forEach(function(t){i.appendChild(t)});for(var h=A("."+Gp,r.querySelector("."+Yp)),c=h.length-1;c>=0;c--){var d=h[c];if(!d.classList.contains("e-separator")||"Extended"===this.overflowMode)break;I(d,{display:"none"})}},e.prototype.createPopup=function(){var t,e,i,n,o=this.element;"Extended"===this.overflowMode&&(n=o.querySelector(".e-separator:not(."+Zp+" )"),i="auto"===o.style.height||""===o.style.height?null:n.offsetHeight),e=o.querySelector("."+Gp+":not(.e-separator ):not(."+Zp+" )"),t="auto"===o.style.height||""===o.style.height?null:e.offsetHeight;var r,s=[];if(o.querySelector("#"+o.id+"_popup.e-toolbar-pop"))r=o.querySelector("#"+o.id+"_popup.e-toolbar-pop");else{var a=this.createElement("div",{id:o.id+"_popup",className:"e-toolbar-pop e-toolbar-extended"}),l=this.createElement("div",{id:o.id+"_popup",className:"e-toolbar-pop"});r="Extended"===this.overflowMode?a:l}this.pushingPoppedEle(this,s,r,t,i),this.popupInit(o,r)},e.prototype.popupInit=function(t,e){if(this.popObj){var i=this.popObj.element;I(i,{maxHeight:"",display:"block"}),I(i,{maxHeight:i.offsetHeight+"px",display:""})}else{t.appendChild(e),I(this.element,{overflow:""});var n=window.getComputedStyle(t),o=new Hh(null,{relateTo:this.element,offsetY:parseFloat(n.height),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});"Extended"===this.overflowMode&&(o.width=parseFloat(n.width)+2*parseFloat(n.borderRightWidth),o.offsetX=0),o.appendTo(e),ha.add(document,"scroll",this.docEvent.bind(this)),ha.add(document,"click ",this.docEvent.bind(this)),o.element.style.maxHeight=o.element.offsetHeight+"px",o.hide(),this.popObj=o,this.element.setAttribute("aria-haspopup","true")}},e.prototype.tbarPopupHandler=function(t){"Extended"===this.overflowMode&&(t?this.add(this.element,"e-tbar-extended"):this.remove(this.element,"e-tbar-extended"))},e.prototype.popupOpen=function(t){var e=this.popObj,i=window.getComputedStyle(this.element);e.offsetY=parseFloat(i.height),e.dataBind();var n=this.popObj.element,o=this.popObj.element.parentElement,r=o.querySelector(".e-hor-nav");I(e.element,{height:"auto",maxHeight:""}),e.element.style.maxHeight=e.element.offsetHeight+"px","Extended"===this.overflowMode&&(e.element.style.minHeight="");var s=n.offsetTop+n.offsetHeight+_t(o).top,a=r.firstElementChild;r.classList.add("e-nav-active"),D(a,["e-popup-up-icon"],["e-popup-down-icon"]),this.tbarPopupHandler(!0);var l=h(window.scrollY)?0:window.scrollY;if(window.innerHeight+l<s&&this.element.offsetTop<n.offsetHeight){var c=n.offsetHeight-(s-window.innerHeight-l+5);e.height=c+"px";for(var d=0;d<=n.childElementCount;d++){var p=n.children[d];if(p.offsetTop+p.offsetHeight>c){c=p.offsetTop;break}}I(e.element,{maxHeight:c+"px"})}},e.prototype.popupClose=function(t){var e=this.element.querySelector(".e-hor-nav"),i=e.firstElementChild;e.classList.remove("e-nav-active"),D(i,["e-popup-down-icon"],["e-popup-up-icon"]),this.tbarPopupHandler(!1)},e.prototype.checkPriority=function(t,e,i,n){for(var o=this.popupPriCount>0,r=i,s=0,a=0,l=0,h=function(t,e){var i=!1;return e.forEach(function(e){t.classList.contains(e)&&(i=!0)}),i},c=e.length-1;c>=0;c--){var d=parseFloat(window.getComputedStyle(e[c]).marginRight);d+=parseFloat(window.getComputedStyle(e[c]).marginLeft);var p=e[c]===this.tbarEle[0];p&&(this.tbarEleMrgn=d);var u=p?e[c].offsetWidth+d:e[c].offsetWidth;if(h(e[c],["e-popup-alone"])&&o&&(e[c].classList.add(Zp),I(e[c],{display:"none",minWidth:u+"px"}),l++),e[c].offsetLeft+e[c].offsetWidth+d>i){if(e[c].classList.contains("e-separator")){if("Extended"===this.overflowMode)a===l&&h(g=e[c],["e-separator","e-ignore"])&&(e[c].classList.add(Zp),l++),a++;else if("Popup"===this.overflowMode){if(s>0&&a===l){var g=e[c+a+(s-1)];h(g,["e-separator","e-ignore"])&&I(g,{display:"none"})}s++,a=0,l=0}}else a++;e[c].classList.contains("e-overflow-show")&&n?i-=e[c].offsetWidth+d:h(e[c],["e-separator","e-ignore"])?i-=e[c].offsetWidth+d:(e[c].classList.add(Zp),I(e[c],{display:"none",minWidth:u+"px"}),l++)}}if(n){var m=A("."+Gp+":not(."+Zp+")",this.element);this.checkPriority(t,m,r,!1)}},e.prototype.createPopupIcon=function(t){var e=t.id.concat("_nav"),i="e-"+t.id.concat("_nav e-hor-nav");i="Extended"===this.overflowMode?i+" e-expended-nav":i;var n=this.createElement("div",{id:e,className:i});"msie"!==ma.info.name&&"edge"!==ma.info.name||n.classList.add("e-ie-align");var o=this.createElement("div",{className:"e-popup-down-icon e-icons"});n.appendChild(o),n.setAttribute("tabindex","0"),t.appendChild(n)},e.prototype.tbarPriRef=function(t,e,i,n,o,r,s,a){var l=a,c=this.popObj.element,d=A("."+Zp+":not(.e-overflow-show)",c).length,p=function(t,e){return t.classList.contains(e)};if(0===A(".e-toolbar-item:not(.e-separator):not(.e-overflow-show)",t).length){var u=t.children[e-(e-i)-1],g=!h(u)&&p(u,"e-ignore");if(!h(u)&&p(u,"e-separator")&&!S(u)||g){u.style.display="inherit";var m=u.offsetWidth+2*parseFloat(window.getComputedStyle(u).marginRight),f=u.previousElementSibling;r+m<s||o?(t.insertBefore(n,t.children[e+l-(e-i)]),h(f)||(f.style.display="")):f.classList.contains("e-separator")&&(f.style.display="none"),u.style.display=""}else t.insertBefore(n,t.children[e+l-(e-i)])}else t.insertBefore(n,t.children[e+l-d])},e.prototype.popupRefresh=function(t,e){var i=this,n=this.element,o=n.querySelector(".e-hor-nav"),r=n.querySelector("."+Yp);if(!h(o)){r.removeAttribute("style"),t.style.display="block";var s=n.offsetWidth-(o.offsetWidth+r.offsetWidth),a=0;[].slice.call(t.children).forEach(function(t){a+=i.popupEleWidth(t),I(t,{position:""})}),s+o.offsetWidth>a&&0===this.popupPriCount&&(e=!0),this.popupEleRefresh(s,t,e),t.style.display="",0===t.children.length&&o&&this.popObj&&(L(o),o=null,this.popObj.destroy(),L(this.popObj.element),this.popObj=null,n.setAttribute("aria-haspopup","false"),n.classList.remove("e-toolpop"))}},e.prototype.ignoreEleFetch=function(t,e){var i=[].slice.call(e.querySelectorAll(".e-ignore")),n=[],o=0;return i.length>0?(i.forEach(function(t){n.push([].slice.call(e.children).indexOf(t))}),n.forEach(function(e){e<=t&&o++}),o):0},e.prototype.checkPopupRefresh=function(t,e){e.style.display="block";var i=this.popupEleWidth(e.firstElementChild);e.firstElementChild.style.removeProperty("Position");var n=t.offsetWidth-t.querySelector(".e-hor-nav").offsetWidth,o=t.querySelector("."+Yp).offsetWidth;return e.style.removeProperty("display"),n>i+o},e.prototype.popupEleWidth=function(t){t.style.position="absolute";var e=t.offsetWidth,i=t.querySelector(".e-tbar-btn-text");if(t.classList.contains("e-tbtn-align")||t.classList.contains("e-popup-text")){var n=t.children[0];!h(i)&&t.classList.contains("e-popup-text")?i.style.display="none":!h(i)&&t.classList.contains("e-toolbar-text")&&(i.style.display="block"),n.style.minWidth="0%",e=parseFloat(t.style.minWidth),n.style.minWidth="",h(i)||(i.style.display="")}return e},e.prototype.popupEleRefresh=function(t,e,i){for(var n,o,r=this.popupPriCount>0,s=this.tbarEle,a=this.element.querySelector("."+Yp),l=0,h=this,c=0,d=[].slice.call(e.children);c<d.length&&"break"!==function(e){if(e.classList.contains("e-popup-alone")&&r&&!i)return"continue";var c=h.popupEleWidth(e);if(e===h.tbarEle[0]&&(c+=h.tbarEleMrgn),e.style.position="",!(c<t||i))return"break";if(e.style.minWidth="",e.classList.contains("e-overflow-hide")||e.classList.remove(Zp),o=h.tbarEle.indexOf(e),h.tbarAlign){var d=h.items[o].align;o=h.tbarAlgEle[(d+"s").toLowerCase()].indexOf(e),s=h.tbarAlgEle[(d+"s").toLowerCase()],a=h.element.querySelector("."+Yp+" .e-toolbar-"+d.toLowerCase())}var p=0;"Extended"!==h.overflowMode&&s.slice(0,o).forEach(function(e){(e.classList.contains("e-overflow-show")||e.classList.contains("e-separator"))&&(e.classList.contains("e-separator")&&(e.style.display="",t-=e.offsetWidth),p++)}),l=h.ignoreEleFetch(o,a),e.classList.contains("e-overflow-show")?(h.tbarPriRef(a,o,p,e,i,c,t,l),t-=e.offsetWidth):0===o?(a.insertBefore(e,a.firstChild),t-=e.offsetWidth):(n=A(".e-overflow-show",h.popObj.element).length,a.insertBefore(e,a.children[o+l-n]),t-=e.offsetWidth),e.style.height=""}(d[c]);c++);this.checkOverflow(this.element,this.element.getElementsByClassName(Yp)[0])&&!i&&this.renderOverflowMode()},e.prototype.removePositioning=function(){var t=this.element.querySelector("."+Yp);if(!h(t)&&t.classList.contains("e-tbar-pos")){this.remove(t,"e-tbar-pos");var e=[].slice.call(t.childNodes);e[1].removeAttribute("style"),e[2].removeAttribute("style")}},e.prototype.refreshPositioning=function(){var t=this.element.querySelector("."+Yp);this.add(t,"e-tbar-pos"),this.itemPositioning()},e.prototype.itemPositioning=function(){var t=this.element.querySelector("."+Yp);if(!h(t)&&t.classList.contains("e-tbar-pos")){var e,i=this.element.querySelector(".e-hor-nav"),n=(e=this.scrollModule?[].slice.call(t.querySelector(".e-hscroll-content").children):[].slice.call(t.childNodes))[0].offsetWidth+e[2].offsetWidth,o=this.element.offsetWidth;if(i){o-=i.offsetWidth;var r=i.offsetWidth+"px";e[2].removeAttribute("style"),this.enableRtl?e[2].style.left=r:e[2].style.right=r}if(!(o<=n)){var s=(o-n-e[1].offsetWidth)/2;e[1].removeAttribute("style");var a=e[0].offsetWidth+s+"px";this.enableRtl?e[1].style.marginRight=a:e[1].style.marginLeft=a}}},e.prototype.tbarItemAlign=function(t,e,i){var n=this;if(!t.showAlwaysInPopup||"Show"===t.overflow){var o=[];if(o.push(this.createElement("div",{className:"e-toolbar-left"})),o.push(this.createElement("div",{className:"e-toolbar-center"})),o.push(this.createElement("div",{className:"e-toolbar-right"})),0===i&&"Left"!==t.align)o.forEach(function(t){e.appendChild(t)}),this.tbarAlign=!0,this.add(e,"e-tbar-pos");else if("Left"!==t.align){var r=e.childNodes,s=o[0];[].slice.call(r).forEach(function(t){n.tbarAlgEle.lefts.push(t),s.appendChild(t)}),e.appendChild(s),e.appendChild(o[1]),e.appendChild(o[2]),this.tbarAlign=!0,this.add(e,"e-tbar-pos")}}},e.prototype.ctrlTemplate=function(){var t=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,Yp),this.tbarEle=[],[].slice.call(this.trgtEle.children).forEach(function(e){"DIV"===e.tagName&&(t.tbarEle.push(e),e.setAttribute("aria-disabled","false"),t.add(e,Gp))})},e.prototype.renderItems=function(){var t,e,i,n=this.element,o=this.items;if(n&&n.children.length>0&&(t=n.querySelector("."+Yp)),null!=this.trgtEle)this.ctrlTemplate();else if(n&&o.length>0){t||(t=this.createElement("div",{className:Yp}));for(var r=0;r<o.length;r++)e=this.renderSubComponent(o[r],r),-1===this.tbarEle.indexOf(e)&&this.tbarEle.push(e),this.tbarAlign||this.tbarItemAlign(o[r],t,r),(i=t.querySelector(".e-toolbar-"+o[r].align.toLowerCase()))?(o[r].showAlwaysInPopup&&"Show"!==o[r].overflow||this.tbarAlgEle[(o[r].align+"s").toLowerCase()].push(e),i.appendChild(e)):t.appendChild(e);n.appendChild(t)}},e.prototype.setAttr=function(t,e){for(var i,n=Object.keys(t),o=0;o<n.length;o++)"class"===(i=n[o])?this.add(e,t[i]):e.setAttribute(i,t[i])},e.prototype.enableItems=function(t,e){var i=t,n=i.length;h(e)&&(e=!0);var o=function(t,e){t?(e.classList.remove("e-overlay"),e.setAttribute("aria-disabled","false")):(e.classList.add("e-overlay"),e.setAttribute("aria-disabled","true"))};if(n&&n>1){for(var r=0,s=[].slice.call(i);r<s.length;r++)o(e,s[r]);e?x(i,"e-overlay"):w(i,"e-overlay")}else{o(e,n&&1===n?i[0]:t)}},e.prototype.addItems=function(t,e){var i,n=this.element.querySelector("."+Yp);if(h(n))return void this.itemsRerender(t);var o,r="Left";h(e)&&(e=0),t.forEach(function(t){h(t.align)||"Left"===t.align||"Left"!==r||(r=t.align)});for(var s=0,a=t;s<a.length;s++){var l=a[s];if(h(l.type)&&(l.type="Button"),i=A("."+Gp,this.element),l.align=r,o=this.renderSubComponent(l,e),this.tbarEle.length>=e&&i.length>=0){h(this.scrollModule)&&this.destroyMode();var c="L"===l.align[0]?0:"C"===l.align[0]?1:2,d=void 0;this.tbarAlign||"Left"===r?this.tbarAlign?((d=M(i[0],"."+Yp).children[c]).insertBefore(o,d.children[e]),this.tbarAlgEle[(l.align+"s").toLowerCase()].splice(e,0,o),this.refreshPositioning()):0===i.length?(i=A("."+Yp,this.element))[0].appendChild(o):i[0].parentNode.insertBefore(o,i[e]):(this.tbarItemAlign(l,n,1),this.tbarAlign=!0,(d=M(i[0],"."+Yp).children[c]).appendChild(o),this.tbarAlgEle[(l.align+"s").toLowerCase()].push(o),this.refreshPositioning()),this.items.splice(e,0,l),this.tbarEle.splice(e,0,o),e++,this.offsetWid=n.offsetWidth}}n.style.width="",this.renderOverflowMode()},e.prototype.removeItems=function(t){var e,i=t,n=[].slice.call(A("."+Gp,this.element));if("number"==typeof i)e=parseInt(t.toString(),10),this.removeItemByIndex(e,n);else if(i&&i.length>1)for(var o=0,r=[].slice.call(i);o<r.length;o++){s=r[o];e=this.tbarEle.indexOf(s),this.removeItemByIndex(e,n),n=A("."+Gp,this.element)}else{var s=i&&i.length&&1===i.length?i[0]:t;e=n.indexOf(s),this.removeItemByIndex(e,n)}this.resize()},e.prototype.removeItemByIndex=function(t,e){if(this.tbarEle[t]&&e[t]){var i=this.tbarEle.indexOf(e[t]);if(this.tbarAlign){var n=void 0;n=this.tbarAlgEle[(this.items[i].align+"s").toLowerCase()].indexOf(this.tbarEle[i]),this.tbarAlgEle[(this.items[i].align+"s").toLowerCase()].splice(n,1)}L(e[t]),this.items.splice(i,1),this.tbarEle.splice(i,1)}},e.prototype.templateRender=function(t,e,i,n){var o,r=i.type,s=t;if("object"==typeof t&&(o="function"==typeof s.appendTo),"string"!=typeof t&&o){if("Input"===r){var a=this.createElement("input");i.id?a.id=i.id:a.id=d("tbr-ipt"),e.appendChild(a),s.appendTo(a)}}else{var l=void 0,c=t;c="string"==typeof t?t.trim():t;try{if("object"!=typeof t||h(t.tagName)){if(document.querySelectorAll(c).length){var p=(a=document.querySelector(c)).outerHTML.trim();e.appendChild(a),a.style.display="",h(p)||this.tempId.push(c)}}else e.appendChild(t)}catch(t){l=pt(c)}var u=void 0;h(l)||(u=l({},this,"template")),!h(u)&&u.length>0&&[].slice.call(u).forEach(function(t){h(t.tagName)||(t.style.display=""),e.appendChild(t)})}this.add(e,"e-template"),this.tbarEle.push(e)},e.prototype.buttonRendering=function(t,e){var i=this.createElement("button",{className:"e-tbar-btn"});i.setAttribute("type","button");var n,o,r=t.text;t.id?i.id=t.id:i.id=d("e-tbr-btn");var s=this.createElement("div",{className:"e-tbar-btn-text"});return r?(s.innerHTML=r,i.appendChild(s),i.classList.add("e-tbtn-txt")):this.add(e,"e-tbtn-align"),(t.prefixIcon||t.suffixIcon)&&(t.prefixIcon&&t.suffixIcon||t.prefixIcon?(n=t.prefixIcon+" e-icons",o="Left"):(n=t.suffixIcon+" e-icons",o="Right")),new Vh({iconCss:n,iconPosition:o},i),t.width&&I(i,{width:m(t.width)}),i},e.prototype.renderSubComponent=function(t,e){var i,n;if((i=this.createElement("div",{className:Gp})).setAttribute("aria-disabled","false"),this.tbarEle||(this.tbarEle=[]),t.htmlAttributes&&this.setAttr(t.htmlAttributes,i),t.tooltipText){var o=this.createElement("div",{innerHTML:t.tooltipText});i.setAttribute("title",o.textContent)}if(t.cssClass&&(i.className=i.className+" "+t.cssClass),t.template)this.templateRender(t.template,i,t,e);else switch(t.type){case"Button":(n=this.buttonRendering(t,i)).setAttribute("tabindex","-1"),i.appendChild(n),i.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(i,"e-separator")}if(t.showTextOn){var r=t.showTextOn;"Toolbar"===r?(this.add(i,"e-toolbar-text"),this.add(i,"e-tbtn-align")):"Overflow"===r&&this.add(i,"e-popup-text")}if(t.overflow){var s=t.overflow;"Show"===s?this.add(i,"e-overflow-show"):"Hide"===s&&(i.classList.contains("e-separator")||this.add(i,"e-overflow-hide"))}return"Show"!==t.overflow&&t.showAlwaysInPopup&&!i.classList.contains("e-separator")&&(this.add(i,"e-popup-alone"),this.popupPriCount++),i},e.prototype.itemClick=function(t){this.activeEleSwitch(t.currentTarget)},e.prototype.activeEleSwitch=function(t){this.activeEleRemove(t.firstElementChild),this.activeEle.focus()},e.prototype.activeEleRemove=function(t){h(this.activeEle)||this.activeEle.setAttribute("tabindex","-1"),this.activeEle=t,h(this.trgtEle)&&!t.parentElement.classList.contains("e-template")?t.removeAttribute("tabindex"):this.activeEle.setAttribute("tabindex","0")},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.getModuleName=function(){return"toolbar"},e.prototype.itemsRerender=function(t){this.items=this.tbarItemsCol,this.destroyMode(),this.destroyItems(),this.items=t,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode()},e.prototype.resize=function(){var t=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&"Popup"===this.overflowMode&&this.popObj.hide();var e=this.checkOverflow(t,t.getElementsByClassName(Yp)[0]);if(e||this.destroyHScroll(),!e||!this.scrollModule||this.offsetWid!==t.offsetWidth){if((this.offsetWid>t.offsetWidth||e)&&this.renderOverflowMode(),this.popObj){if("Extended"===this.overflowMode){var i=window.getComputedStyle(this.element);this.popObj.width=parseFloat(i.width)+2*parseFloat(i.borderRightWidth)}this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()}this.offsetWid=t.offsetWidth,this.tbResize=!1,this.separator()}},e.prototype.onPropertyChanged=function(t,e){for(var i=this.element,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"items":if(t.items instanceof Array&&e.items instanceof Array)this.itemsRerender(t.items);else for(var r=Object.keys(t.items),s=0;s<r.length;s++){var a=parseInt(Object.keys(t.items)[s],10),l=Object.keys(t.items[a])[0],c=(Object(e.items[a])[l],Object(t.items[a])[l]);if(this.tbarAlign||"align"===l){this.refresh();break}var d="showAlwaysInPopup"===l&&!c,p="overflow"===l&&0!==this.popupPriCount;(d||this.items[a].showAlwaysInPopup&&p)&&--this.popupPriCount,h(this.scrollModule)&&this.destroyMode(),L([].slice.call(A("."+Yp+" ."+Gp,i))[a]),this.tbarEle.splice(a,1),this.addItems([this.items[a]],a),this.items.splice(a,1),this.items[a].template&&this.tbarEle.splice(this.items.length,1)}break;case"width":var u=i.offsetWidth;I(i,{width:m(t.width)}),this.renderOverflowMode(),this.popObj&&u<i.offsetWidth&&this.popupRefresh(this.popObj.element,!1);break;case"height":I(this.element,{height:m(t.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(i,"e-rtl"),this.refreshOverflow();break;case"enableRtl":t.enableRtl?this.add(i,"e-rtl"):this.remove(i,"e-rtl"),h(this.scrollModule)||(t.enableRtl?this.add(this.scrollModule.element,"e-rtl"):this.remove(this.scrollModule.element,"e-rtl")),h(this.popObj)||(t.enableRtl?this.add(this.popObj.element,"e-rtl"):this.remove(this.popObj.element,"e-rtl")),this.tbarAlign&&this.itemPositioning()}},e.prototype.hideItem=function(t,e){if(this.tbarEle[t]){var i=[].slice.call(A("."+Gp,this.element));!0===e?i[t].classList.add("e-hidden"):i[t].classList.remove("e-hidden"),this.refreshOverflow()}},Xp([K([],Kp)],e.prototype,"items",void 0),Xp([Y("auto")],e.prototype,"width",void 0),Xp([Y("auto")],e.prototype,"height",void 0),Xp([Y("Scrollable")],e.prototype,"overflowMode",void 0),Xp([Y(!1)],e.prototype,"enableRtl",void 0),Xp([J()],e.prototype,"clicked",void 0),Xp([J()],e.prototype,"created",void 0),Xp([J()],e.prototype,"destroyed",void 0),Xp([J()],e.prototype,"beforeCreate",void 0),e=Xp([$],e)}(Ka),Jp=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$p=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},tu="e-acrdn-item",eu="e-acrdn-header",iu="e-acrdn-panel",nu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jp(e,t),$p([Y("SlideDown")],e.prototype,"effect",void 0),$p([Y(400)],e.prototype,"duration",void 0),$p([Y("linear")],e.prototype,"easing",void 0),e}(xa),ou=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jp(e,t),$p([G({effect:"SlideUp",duration:400,easing:"linear"},nu)],e.prototype,"collapse",void 0),$p([G({effect:"SlideDown",duration:400,easing:"linear"},nu)],e.prototype,"expand",void 0),e}(xa),ru=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jp(e,t),$p([Y(void 0)],e.prototype,"content",void 0),$p([Y(void 0)],e.prototype,"header",void 0),$p([Y(void 0)],e.prototype,"cssClass",void 0),$p([Y(void 0)],e.prototype,"iconCss",void 0),$p([Y(!1)],e.prototype,"expanded",void 0),e}(xa),su=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.keyConfigs={moveUp:"uparrow",moveDown:"downarrow",enter:"enter",space:"space",home:"home",end:"end"},n}return Jp(e,t),e.prototype.destroy=function(){var e=this,i=this.element;for(t.prototype.destroy.call(this),this.unwireEvents(),this.isDestroy=!0,this.templateEle.forEach(function(t){h(e.element.querySelector(t))||(document.body.appendChild(e.element.querySelector(t)).style.display="none")});i.firstChild;)i.removeChild(i.firstChild);if(this.trgtEle)for(;this.ctrlTem.firstChild;)i.appendChild(this.ctrlTem.firstChild);i.removeAttribute("style"),["aria-disabled","aria-multiselectable","role"].forEach(function(t){e.element.removeAttribute(t)})},e.prototype.preRender=function(){var t=M(this.element,"."+iu);this.isNested=!1,this.templateEle=[],this.isDestroy||(this.isDestroy=!1),h(t)?this.element.classList.add("e-acrdn-root"):(t.classList.add("e-nested"),this.isNested=!0),this.enableRtl&&this.add(this.element,"e-rtl"),this.enablePersistence&&!h(this.expandedItems)||(this.expandedItems=[])},e.prototype.add=function(t,e){t.classList.add(e)},e.prototype.remove=function(t,e){t.classList.remove(e)},e.prototype.render=function(){this.initialize(),this.renderControl(),this.wireEvents()},e.prototype.initialize=function(){var t=m(this.width),e=m(this.height);I(this.element,{width:t,height:e});var i={"aria-disabled":"false",role:"presentation","aria-multiselectable":"true"};this.expandedItems.length>0&&(this.initExpand=this.expandedItems),k(this.element,i),"Single"===this.expandMode&&this.element.setAttribute("aria-multiselectable","false")},e.prototype.renderControl=function(){this.trgtEle=this.element.children.length>0?O("div",this.element):null,this.renderItems(),this.initItemExpand()},e.prototype.unwireEvents=function(){ha.remove(this.element,"click",this.clickHandler),h(this.keyModule)||this.keyModule.destroy()},e.prototype.wireEvents=function(){ha.add(this.element,"click",this.clickHandler,this),this.isNested||this.isDestroy||it(this.element,{selector:"."+eu}),this.isNested||(this.keyModule=new ll(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}))},e.prototype.focusIn=function(t){t.target.parentElement.classList.add("e-item-focus")},e.prototype.focusOut=function(t){t.target.parentElement.classList.remove("e-item-focus")},e.prototype.ctrlTemplate=function(){var t=this;this.ctrlTem=this.element.cloneNode(!0);var e,i=this.element.children;w(i,[tu]),[].slice.call(i).forEach(function(n){if(n.id=d("acrdn_item"),n.children.length>0){t.add(n.children[0],eu);var o=n.children[0];k(o,{tabindex:"0",role:"heading","aria-level":i.length.toString()}),o.id=d("acrdn_header"),ha.add(o,"focus",t.focusIn,t),ha.add(o,"blur",t.focusOut,t);var r=o.firstElementChild;r&&r.classList.add("e-acrdn-header-content"),(e=n.children[1])&&(e.id=d("acrdn_panel"),o.setAttribute("aria-controls",e.id),e.style.display="",n.classList.add("e-select"),n.children[0].appendChild(t.toggleIconGenerate()),D(e,[iu,"e-content-hide"],[]),k(e,{"aria-labelledby":o.id,"aria-hidden":"true"}),(e=e.firstElementChild)&&(e.classList.add("e-acrdn-content"),e.style.display=""))}})},e.prototype.toggleIconGenerate=function(){var t=this.createElement("div",{className:"e-toggle-icon"}),e=this.createElement("span",{className:"e-tgl-collapse-icon e-icons"});return t.appendChild(e),t},e.prototype.initItemExpand=function(){var t=this.initExpand.length;if(0!==t)if("Single"===this.expandMode)this.expandItem(!0,this.initExpand[t-1]);else for(var e=0;e<t;e++)this.expandItem(!0,this.initExpand[e])},e.prototype.renderItems=function(){var t,e=this,i=this.element;h(this.initExpand)&&(this.initExpand=[]);var n=this.items;h(this.trgtEle)?i&&n.length>0&&n.forEach(function(n,o){t=e.renderInnerItem(n,o),i.appendChild(t),t.childElementCount>0&&(ha.add(t.querySelector("."+eu),"focus",e.focusIn,e),ha.add(t.querySelector("."+eu),"blur",e.focusOut,e))}):this.ctrlTemplate()},e.prototype.clickHandler=function(t){var e,i,n=this,o=t.target,r={};if(M(o,".e-accordion")===this.element){o.classList.add("e-target");var s=M(o,"."+tu),a=M(o,"."+eu),l=M(o,"."+iu);s&&(h(a)||h(l))&&(a=s.children[0],l=s.children[1]),a&&(i=O(".e-toggle-icon",a));var c;l&&(c=M(l,"."+tu));var d=[];e=this.getIndexByItem(s),c&&(r.item=this.items[this.getIndexByItem(c)]),r.originalEvent=t,!(!h(i)&&h(this.trgtEle)&&s.childElementCount<=1)||!h(l)&&h(O(".e-acrdn-header .e-toggle-icon",c))||(s.appendChild(this.contentRendering(e)),this.ariaAttrUpdate(s)),this.trigger("clicked",r);var p=l&&!h(O(".e-target",l));if(p=p&&(h(O(".e-accordion",l))||!(M(o,".e-accordion")===this.element)),o.classList.remove("e-target"),!(o.classList.contains(iu)||o.classList.contains("e-acrdn-content")||p)){[].slice.call(this.element.children).forEach(function(t){t.classList.contains("e-active")&&d.push(t)});var u=[].slice.call(this.element.querySelectorAll(".e-acrdn-item [e-animate]"));if(u.length>0)for(var g=0,m=u;g<m.length;g++){var f=m[g];d.push(f.parentElement)}var v=-1!==d.indexOf(c)&&"true"===l.getAttribute("e-animate"),y=!1;if(!h(s)&&!h(a)){var b=O("."+iu,s),w=M(s,".e-acrdn-root").querySelector(".e-expand-state");if(h(b))return;y=w===s,!S(b)||v&&!c.classList.contains("e-selected")?(d.length>0&&"Single"===this.expandMode&&!v&&d.forEach(function(t){n.collapse(O("."+iu,t)),t.classList.remove("e-expand-state")}),this.expand(b)):this.collapse(b),h(w)||y||w.classList.remove("e-expand-state")}}}},e.prototype.eleMoveFocus=function(t,e,i){var n,o=M(i,"."+tu);i===e?n=("moveUp"===t?i.lastElementChild:i).querySelector("."+eu):i.classList.contains(eu)&&(o="moveUp"===t?o.previousElementSibling:o.nextElementSibling)&&(n=O("."+eu,o)),n&&n.focus()},e.prototype.keyActionHandler=function(t){var e=t.target;if(!h(M(t.target,eu))||e.classList.contains("e-accordion")||e.classList.contains(eu)){var i,n=this.element;switch(t.action){case"moveUp":case"moveDown":this.eleMoveFocus(t.action,n,e);break;case"space":case"enter":!h(i=e.nextElementSibling)&&i.classList.contains(iu)?"true"!==i.getAttribute("e-animate")&&e.click():e.click();break;case"home":case"end":("home"===t.action?n.firstElementChild.children[0]:n.lastElementChild.children[0]).focus()}}},e.prototype.headerEleGenerate=function(){var t=this.createElement("div",{className:eu,id:d("acrdn_header")});return k(t,{tabindex:"0",role:"heading","aria-expanded":"false","aria-selected":"false","aria-disabled":"false","aria-level":this.items.length.toString()}),t},e.prototype.renderInnerItem=function(t,e){var i;if(i=this.createElement("div",{className:tu}),i.id=d("acrdn_item"),t.header){var n=this.headerEleGenerate(),o=this.createElement("div",{className:"e-acrdn-header-content"});n.appendChild(o),n.appendChild(this.fetchElement(o,t.header,e,!0)),i.appendChild(n)}var r=O("."+eu,i);if(!t.expanded||h(e)||this.enablePersistence||-1===this.initExpand.indexOf(e)&&this.initExpand.push(e),t.cssClass&&i.classList.add(t.cssClass),t.iconCss){var s=this.createElement("div",{className:"e-acrdn-header-icon"}),a=this.createElement("span",{className:t.iconCss+" e-icons"});s.appendChild(a),h(r)?((r=this.headerEleGenerate()).appendChild(s),i.appendChild(r)):r.insertBefore(s,r.childNodes[0])}if(t.content){var l=this.toggleIconGenerate();h(r)&&(r=this.headerEleGenerate(),i.appendChild(r)),r.appendChild(l),this.add(i,"e-select")}return i},e.prototype.fetchElement=function(t,e,i,n){var o,r;try{if(document.querySelectorAll(e).length){var s=document.querySelector(e);r=s.outerHTML.trim(),t.appendChild(s),s.style.display=""}}catch(t){o=pt(e)}var a;return h(o)||(a=o()),h(a)||!(a.length>0)||h(a[0].tagName)&&1===a.length?0===t.childElementCount&&(t.innerHTML=e):[].slice.call(a).forEach(function(e){h(e.tagName)||(e.style.display=""),t.appendChild(e)}),h(r)||this.templateEle.push(e),t},e.prototype.ariaAttrUpdate=function(t){var e=O("."+eu,t),i=O("."+iu,t);e.setAttribute("aria-controls",i.id),i.setAttribute("aria-labelledby",e.id)},e.prototype.contentRendering=function(t){var e=this.items[t].content,i=this.createElement("div",{className:iu+" e-content-hide",id:d("acrdn_panel")});k(i,{"aria-hidden":"true"});var n=this.createElement("div",{className:"e-acrdn-content"});return i.appendChild(this.fetchElement(n,e,t,!1)),i},e.prototype.expand=function(t){var e,i=M(t,"."+tu);if(!(h(t)||S(t)&&"true"!==t.getAttribute("e-animate")||i.classList.contains("e-overlay"))){var n=M(i,".e-acrdn-root").querySelector(".e-expand-state"),o={name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing},r=O(".e-toggle-icon",i).firstElementChild;e={element:i,item:this.items[this.getIndexByItem(i)],isExpanded:!0};var s=o.name;if(this.trigger("expanding",e),!e.cancel){if(r.classList.add("e-toggle-animation"),this.expandedItemsPush(i),h(n)||n.classList.remove("e-expand-state"),i.classList.add("e-expand-state"),"None"===o.name)return this.expandProgress("begin",r,t,i,e),void this.expandProgress("end",r,t,i,e);this.expandAnimation(s,r,t,i,o,e)}}},e.prototype.expandAnimation=function(t,e,i,n,o,r){var s,a,l=this;this.lastActiveItemId=n.id,"SlideDown"===t?(o.begin=function(){l.expandProgress("begin",e,i,n,r),i.style.position="absolute",s=n.offsetHeight,a=i.offsetHeight,i.style.maxHeight=i.offsetHeight+"px",n.style.maxHeight=""},o.progress=function(){n.style.minHeight=s+i.offsetHeight+"px"},o.end=function(){I(i,{position:"",maxHeight:""}),n.style.minHeight="",l.expandProgress("end",e,i,n,r)}):(o.begin=function(){l.expandProgress("begin",e,i,n,r)},o.end=function(){l.expandProgress("end",e,i,n,r)}),new ya(o).animate(i)},e.prototype.expandProgress=function(t,e,i,n,o){this.remove(i,"e-content-hide"),this.add(n,"e-selected"),this.add(e,"e-expand-icon"),"end"===t&&(this.add(n,"e-active"),i.setAttribute("aria-hidden","false"),k(i.previousElementSibling,{"aria-selected":"true","aria-expanded":"true"}),e.classList.remove("e-toggle-animation"),this.trigger("expanded",o))},e.prototype.expandedItemsPush=function(t){var e=this.getIndexByItem(t);-1===this.expandedItems.indexOf(e)&&this.expandedItems.push(e)},e.prototype.getIndexByItem=function(t){return[].slice.call(this.element.children).indexOf(t)},e.prototype.expandedItemsPop=function(t){var e=this.getIndexByItem(t);this.expandedItems.splice(this.expandedItems.indexOf(e),1)},e.prototype.collapse=function(t){var e,i=M(t,"."+tu);if(!h(t)&&S(t)&&!i.classList.contains("e-overlay")){var n={name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing},o=O(".e-toggle-icon",i).firstElementChild;e={element:i,item:this.items[this.getIndexByItem(i)],isExpanded:!1};var r=n.name;if(this.trigger("expanding",e),!e.cancel){if(this.expandedItemsPop(i),i.classList.add("e-expand-state"),o.classList.add("e-toggle-animation"),"None"===n.name)return this.collapseProgress("begin",o,t,i,e),void this.collapseProgress("end",o,t,i,e);this.collapseAnimation(r,t,i,o,n,e)}}},e.prototype.collapseAnimation=function(t,e,i,n,o,r){var s,a,l,h,c=this;this.lastActiveItemId=i.id,"SlideUp"===t?(o.begin=function(){l=i.offsetHeight,i.style.minHeight=l+"px",e.style.position="absolute",s=i.offsetHeight,a=e.offsetHeight,e.style.maxHeight=a+"px",c.collapseProgress("begin",n,e,i,r)},o.progress=function(){(h=s-(a-e.offsetHeight))<l&&(i.style.minHeight=h+"px")},o.end=function(){e.style.display="none",c.collapseProgress("end",n,e,i,r),i.style.minHeight="",I(e,{position:"",maxHeight:"",display:""})}):(o.begin=function(){c.collapseProgress("begin",n,e,i,r)},o.end=function(){c.collapseProgress("end",n,e,i,r)}),new ya(o).animate(e)},e.prototype.collapseProgress=function(t,e,i,n,o){this.remove(e,"e-expand-icon"),this.remove(n,"e-selected"),"end"===t&&(this.add(i,"e-content-hide"),e.classList.remove("e-toggle-animation"),this.remove(n,"e-active"),i.setAttribute("aria-hidden","true"),k(i.previousElementSibling,{"aria-selected":"false","aria-expanded":"false"}),this.trigger("expanded",o))},e.prototype.getModuleName=function(){return"accordion"},e.prototype.itemAttribUpdate=function(){var t=[].slice.call(this.element.children),e=this.items.length;t.forEach(function(t){O("."+eu,t).setAttribute("aria-level",""+e)})},e.prototype.addItem=function(t,e){var i=this.element;if(h(e)&&(e=this.items.length),i.childElementCount>=e){this.items.splice(e,0,t);var n=this.renderInnerItem(t,e);i.childElementCount===e?i.appendChild(n):i.insertBefore(n,i.children[e]),ha.add(n.querySelector("."+eu),"focus",this.focusIn,this),ha.add(n.querySelector("."+eu),"blur",this.focusOut,this),this.itemAttribUpdate()}this.expandedItems=[],this.expandedItemRefresh(i),t.expanded&&this.expandItem(!0,e)},e.prototype.expandedItemRefresh=function(t){var e=this;[].slice.call(t.children).forEach(function(t){t.classList.contains("e-selected")&&e.expandedItemsPush(t)})},e.prototype.removeItem=function(t){var e=this.element.children[t];h(e)||(L(e),this.items.splice(t,1),this.itemAttribUpdate(),this.expandedItems=[],this.expandedItemRefresh(this.element))},e.prototype.select=function(t){var e=this.element.children[t];h(e)||h(O("."+eu,e))||e.children[0].focus()},e.prototype.hideItem=function(t,e){var i=this.element.children[t];h(i)||(h(e)&&(e=!0),e?this.add(i,"e-hide"):this.remove(i,"e-hide"))},e.prototype.enableItem=function(t,e){var i=this.element.children[t];if(!h(i)){var n=i.firstElementChild;e?(this.remove(i,"e-overlay"),k(n,{tabindex:"0","aria-disabled":"false"}),n.focus()):(i.classList.contains("e-active")&&(this.expandItem(!1,t),this.eleMoveFocus("movedown",this.element,n)),this.add(i,"e-overlay"),n.setAttribute("aria-disabled","true"),n.removeAttribute("tabindex"))}},e.prototype.expandItem=function(t,e){var i=this,n=this.element;if(h(e))if("Single"===this.expandMode&&t){var o=n.children[n.childElementCount-1];this.itemExpand(t,o,this.getIndexByItem(o))}else{var r=O("#"+this.lastActiveItemId,this.element);[].slice.call(this.element.children).forEach(function(e){i.itemExpand(t,e,i.getIndexByItem(e)),e.classList.remove("e-expand-state")});var s=O(".e-expand-state",this.element);s&&s.classList.remove("e-expand-state"),r&&r.classList.add("e-expand-state")}else{if(h(o=this.element.children[e])||!o.classList.contains("e-select")||o.classList.contains("e-active")&&t)return;"Single"===this.expandMode&&this.expandItem(!1),this.itemExpand(t,o,e)}},e.prototype.itemExpand=function(t,e,i){var n=e.children[1];if(!e.classList.contains("e-overlay")){if(h(n)&&t)n=this.contentRendering(i),e.appendChild(n),this.ariaAttrUpdate(e);else if(h(n))return;t?this.expand(n):this.collapse(n)}},e.prototype.destroyItems=function(){[].slice.call(this.element.querySelectorAll("."+tu)).forEach(function(t){L(t)})},e.prototype.updateItem=function(t,e){if(!h(t)){var i=this.items[e];this.items.splice(e,1),L(t),this.addItem(i,e)}},e.prototype.getPersistData=function(){var t=["expandedItems"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=this.element,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"items":if(t.items instanceof Array&&e.items instanceof Array)this.destroyItems(),this.renderItems(),this.initItemExpand();else for(var r=Object.keys(t.items),s=0;s<r.length;s++){var a=parseInt(Object.keys(t.items)[s],10),l=Object.keys(t.items[a])[0],c=A("."+tu,this.element)[a],d=Object(e.items[a])[l],p=Object(t.items[a])[l];"header"!==l&&"iconCss"!==l&&"expanded"!==l||this.updateItem(c,a),"cssClass"!==l||h(c)||(c.classList.remove(d),c.classList.add(p)),"content"!==l||h(c)||2!==c.children.length||(c.classList.contains("e-selected")&&this.expandItem(!1,a),L(c.querySelector("."+iu)))}break;case"enableRtl":t.enableRtl?this.add(i,"e-rtl"):this.remove(i,"e-rtl");break;case"height":I(this.element,{height:m(t.height)});break;case"width":I(this.element,{width:m(t.width)});break;case"expandMode":"Single"===t.expandMode?(this.element.setAttribute("aria-multiselectable","false"),this.expandedItems.length>1&&this.expandItem(!1)):this.element.setAttribute("aria-multiselectable","true")}},$p([K([],ru)],e.prototype,"items",void 0),$p([Y("100%")],e.prototype,"width",void 0),$p([Y("auto")],e.prototype,"height",void 0),$p([Y("Multiple")],e.prototype,"expandMode",void 0),$p([G({},ou)],e.prototype,"animation",void 0),$p([J()],e.prototype,"clicked",void 0),$p([J()],e.prototype,"expanding",void 0),$p([J()],e.prototype,"expanded",void 0),$p([J()],e.prototype,"created",void 0),$p([J()],e.prototype,"destroyed",void 0),e=$p([$],e)}(Ka),au={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper"};!function(t){function e(t,e,n,o){var s=l({},R,n),a=l({},D,s.ariaAttributes),h=m(e).typeof;return"string"===h||"number"===h?i(t,e,o,n):r(t,e,n,a.level,o)}function i(t,e,i,o){return M(t,n(t,e,i,o),null,o)}function n(t,e,i,n){var o=[],r=l({},R,n);au=T(r.moduleName);for(var s=x(),a=0;a<e.length;a++)if(!h(e[a])){var c=void 0;if(r.itemCreating&&"function"==typeof r.itemCreating){d={dataSource:e,curData:e[a],text:e[a],options:r};r.itemCreating(d)}if(c=i?L(t,e[a],void 0,null,null,[],null,s,a,n):A(t,e[a],void 0,null,null,n),r.itemCreated&&"function"==typeof r.itemCreated){var d={dataSource:e,curData:e[a],text:e[a],item:c,options:r};r.itemCreated(d)}o.push(c)}return o}function o(e,i,n,o,r){var s=l({},R,n);au=T(s.moduleName);var c,d=l({},t.defaultMappedFields,s.fields),p=l({},D,s.ariaAttributes);o&&(p.level=o);var u,g=[];i.length&&!m(i).item.hasOwnProperty(d.id)&&(c=x());for(var v=0;v<i.length;v++){var y=vs(i[v],d);if(!h(i[v])){if(s.itemCreating&&"function"==typeof s.itemCreating){P={dataSource:i,curData:i[v],text:y[d.text],options:s,fields:d};s.itemCreating(P)}var b=i[v];s.itemCreating&&"function"==typeof s.itemCreating&&(y=vs(i[v],d)),y.hasOwnProperty(d.id)&&!h(y[d.id])&&(c=y.id);var w=[];if(s.showCheckBox&&w.push(e("input",{className:au.check,attrs:{type:"checkbox"}})),!0===r)s.showIcon&&y.hasOwnProperty(d.iconCss)&&(h(y[d.iconCss])||w.push(e("span",{className:au.icon+" "+y[d.iconCss]}))),u=L(e,b,y,d,s.itemClass,w,!(!b.hasOwnProperty("isHeader")||!b.isHeader),c,v,n);else{if((u=A(e,b,y,d,s.itemClass,n)).classList.add(au.level+"-"+p.level),u.setAttribute("aria-level",p.level.toString()),y.hasOwnProperty(d.tooltip)&&u.setAttribute("title",y[d.tooltip]),y.hasOwnProperty(d.htmlAttributes)&&y[d.htmlAttributes]&&f(u,y[d.htmlAttributes]),y.hasOwnProperty(d.enabled)&&!1===y[d.enabled]&&u.classList.add(au.disabled),y.hasOwnProperty(d.isVisible)&&!1===y[d.isVisible]&&(u.style.display="none"),y.hasOwnProperty(d.imageUrl)&&!h(y[d.imageUrl])){var S={src:y[d.imageUrl]};y.hasOwnProperty(d.imageUrl)&&a(S,y[d.imageAttributes]),E([e("img",{className:au.image,attrs:S})],u.firstElementChild)}s.showIcon&&y.hasOwnProperty(d.iconCss)&&!s.template&&(h(y[d.iconCss])||E([e("div",{className:au.icon+" "+y[d.iconCss]})],u.firstElementChild)),w.length&&E(w,u.firstElementChild),C(e,y,d,i,s,u,p.level)}if(s.itemCreated&&"function"==typeof s.itemCreated){var P={dataSource:i,curData:i[v],text:y[d.text],item:u,options:s,fields:d};s.itemCreated(P)}g.push(u)}}return g}function r(t,e,i,n,r){var s=l({},R,i);return M(t,o(t,e,i,n,r),s.listClass,i)}function s(t,e,i){if(au=T(R.moduleName),t&&t.length){var n,o,r=Array.prototype.slice.call(t);for(n=r[(o=e?c(e,r):!0===i?r.length:-1)+(!0===i?-1:1)];n&&(!S(n)||n.classList.contains(au.disabled));)n=r[o+=!0===i?-1:1];return n}}function c(t,e){if(e&&t){return Array.prototype.slice.call(e).indexOf(t)}}function d(t,e,i){void 0===i&&(i="None");var n=(new kp).group(e.groupBy),o=u(t,n=p(i,"key",n));t=[];for(var r=0;r<o.length;r++){var s=o[r].items,a={};a[e.text]=o[r].key,a.isHeader=!0,a.id="group-list-item-"+(o[r].key?o[r].key.toString().trim():"undefined"),a.items=s,t.push(a);for(var l=0;l<s.length;l++)t.push(s[l])}return t}function p(t,e,i){if(void 0===i&&(i=new kp),"Ascending"===t)i.sortBy(e,"ascending",!0);else if("Descending"===t)i.sortBy(e,"descending",!0);else for(var n=0;n<i.queries.length;n++)"onSortBy"===i.queries[n].fn&&i.queries.splice(n,1);return i}function u(t,e){return new jp(t).executeLocal(e)}function g(e,i){var n=l({},R,i),o=l({},t.defaultMappedFields,n.fields),r=e.cloneNode(!0),s=[];r.classList.add("json-parent");var a=r.querySelectorAll(".json-parent>li");r.classList.remove("json-parent");for(var h=0;h<a.length;h++){for(var c=a[h],d=c.querySelector("a"),p=c.querySelector("ul"),u={},m=d?d.childNodes:c.childNodes,f=Object.keys(m),y=0;y<m.length;y++)m[Number(f[y])].hasChildNodes()||(u[o.text]=m[Number(f[y])].textContent);u[o.id]=x();var b=v(c);Object.keys(b).length&&(u[o.htmlAttributes]=b),d&&(b=v(d),Object.keys(b).length&&(u[o.urlAttributes]=b)),p&&(u[o.child]=g(p,i)),s.push(u)}return s}function m(t){for(var e={typeof:null,item:null},i=0;i<t.length;i++)if(!h(t[i]))return e={typeof:typeof t[i],item:t[i]};return e}function f(t,e){var i={};a(i,e),i.class&&(w([t],i.class.split(" ")),delete i.class),k(t,i)}function v(t){for(var e={},i=t.attributes,n=0;n<i.length;n++)e[i[n].nodeName]=i[n].nodeValue;return e}function y(t,e,i,n,o){for(var r=t("ul",{className:(au=T(R.moduleName)).ul,attrs:{role:"presentation"}}),s=l({},R,o),a=pt(e),h=[],c=x(),d=0;d<i.length;d++){var p=vs(i[d],n),u=i[d],g=u.isHeader,m="string"==typeof u||"number"==typeof u?u:p[n.value];if(s.itemCreating&&"function"==typeof s.itemCreating){v={dataSource:i,curData:u,text:m,options:s,fields:n};s.itemCreating(v)}s.itemCreating&&"function"==typeof s.itemCreating&&(m=(p=vs(i[d],n))[n.value]);var f=t("li",{id:c+"-"+d,className:g?au.group:au.li,attrs:{role:"presentation"}});if(g?f.innerText=p[n.text]:(P(a(u),f),f.setAttribute("data-value",m),f.setAttribute("role","option")),s.itemCreated&&"function"==typeof s.itemCreated){var v={dataSource:i,curData:u,text:m,item:f,options:s,fields:n};s.itemCreated(v)}h.push(f)}return P(h,r),r}function b(t,e,i,n){for(var o=pt(t),r=i.groupBy,s=0,a=n;s<a.length;s++){var l=a[s],h={};h[r]=l.textContent,l.innerHTML="",P(o(h),l)}return n}function x(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function C(t,e,i,n,o,s,a){var l=e[i.child]||[],h=e[i.hasChildren];if(l.length&&(h=!0,s.classList.add(au.hasChild),o.processSubChild)){var c=r(t,l,o,++a);s.appendChild(c)}o.expandCollapse&&h&&!o.template&&(s.firstElementChild.classList.contains(au.textContent)&&s.firstElementChild.classList.add(au.iconWrapper),("Left"===o.expandIconPosition?E:P)([t("div",{className:"e-icons "+o.expandIconClass})],s.querySelector("."+au.textContent)))}function L(t,e,i,n,o,r,s,a,c,d){var p,u=l({},R,d),g=l({},D,u.ariaAttributes),m=e,v=e;"string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e&&(p=e,m="boolean"==typeof i[n.text]||"number"==typeof i[n.text]?i[n.text]:i[n.text]||"",v=i[n.value]);var y;y=h(p)||h(i[n.id])||""===i[n.id]?a+"-"+c:a;var b=t("li",{className:(!0===s?au.group:au.li)+" "+(h(o)?"":o),id:y,attrs:""!==g.groupItemRole&&""!==g.itemRole?{role:!0===s?g.groupItemRole:g.itemRole}:{}});return p&&i.hasOwnProperty(n.enabled)&&"false"===i[n.enabled].toString()&&b.classList.add(au.disabled),s?b.innerText=m:(h(v)||b.setAttribute("data-value",v),b.setAttribute("role","option"),p&&i.hasOwnProperty(n.htmlAttributes)&&i[n.htmlAttributes]&&f(b,i[n.htmlAttributes]),r.length&&P(r,b),p&&i.hasOwnProperty(n.url)&&i[n.url]?b.appendChild(O(t,p,n,m)):b.appendChild(document.createTextNode(m))),b}function T(t){return{li:"e-"+t+"-item",ul:"e-"+t+"-parent e-ul",group:"e-"+t+"-group-item",icon:"e-"+t+"-icon",text:"e-"+t+"-text",check:"e-"+t+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+t+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+t+"-img",iconWrapper:"e-icon-wrapper"}}function O(t,e,i,n){var o=vs(e,i),r={href:o[i.url]};o.hasOwnProperty(i.urlAttributes)&&o[i.urlAttributes]&&a(r,o[i.urlAttributes]);var s=t("a",{className:au.text+" "+au.url,innerHTML:n});return f(s,r),s}function A(t,e,i,n,o,r){var s,a,c,d=l({},R,r),p=l({},D,d.ariaAttributes),u=e;"string"!=typeof e&&"number"!=typeof e&&(c=e,u=i[n.text]||"",s=i[n.id],a=!(!e.hasOwnProperty("isHeader")||!e.isHeader));var g=t("li",{className:(!0===a?au.group:au.li)+" "+(h(o)?"":o),attrs:""!==p.groupItemRole&&""!==p.itemRole?{role:!0===a?p.groupItemRole:p.itemRole}:{}});if(h(s)?g.setAttribute("data-uid",x()):g.setAttribute("data-uid",s),a&&r&&r.groupTemplate)P((m=pt(r.groupTemplate))(e),g);else if(!a&&r&&r.template){var m=pt(r.template);P(m(e),g)}else{var f=t("div",{className:au.textContent,attrs:""!==p.wrapperRole?{role:p.wrapperRole}:{}});c&&i.hasOwnProperty(n.url)&&i[n.url]?f.appendChild(O(t,c,n,u)):f.appendChild(t("span",{className:au.text,innerHTML:u,attrs:""!==p.itemText?{role:p.itemText}:{}})),g.appendChild(f)}return g}function M(t,e,i,n){var o=l({},R,n),r=l({},D,o.ariaAttributes),s=t("ul",{className:(au=T(o.moduleName)).ul+" "+(h(i)?"":i),attrs:""!==r.listRole?{role:r.listRole}:{}});return P(e,s),s}function I(t,e,i,n){var o=l({},R,n);return au=T(o.moduleName),("Left"===o.expandIconPosition?E:P)([t("div",{className:"e-icons "+o.expandIconClass+" "+(h(i)?"":i)})],e.querySelector("."+au.textContent)),e}t.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null};var D={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},R={showCheckBox:!1,showIcon:!1,expandCollapse:!1,fields:t.defaultMappedFields,ariaAttributes:D,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right"};t.createList=e,t.createListFromArray=i,t.createListItemFromArray=n,t.createListItemFromJson=o,t.createListFromJson=r,t.getSiblingLI=s,t.indexOf=c,t.groupDataSource=d,t.addSorting=p,t.getDataSource=u,t.createJsonFromElement=g,t.renderContentTemplate=y,t.renderGroupTemplate=b,t.generateId=x,t.generateUL=M,t.generateIcon=I}(_l||(_l={}));var lu,hu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),cu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},du={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},pu={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},uu={root:"e-listview",hover:"e-hover",selected:"e-active",focused:"e-focused",parentItem:"e-list-parent",listItem:"e-list-item",listIcon:"e-list-icon",textContent:"e-text-content",listItemText:"e-list-text",groupListItem:"e-list-group-item",hasChild:"e-has-child",view:"e-view",header:"e-list-header",headerText:"e-headertext",headerTemplateText:"e-headertemplate-text",text:"e-text",disable:"e-disabled",content:"e-content",icon:"e-icons",backIcon:"e-icon-back",checkboxWrapper:"e-checkbox-wrapper",checkbox:"e-checkbox",checked:"e-check",checklist:"e-checklist",checkboxIcon:"e-frame",checkboxRight:"e-checkbox-right",checkboxLeft:"e-checkbox-left",listviewCheckbox:"e-listview-checkbox",itemCheckList:"e-checklist"},gu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return hu(e,t),cu([Y("id")],e.prototype,"id",void 0),cu([Y("text")],e.prototype,"text",void 0),cu([Y("isChecked")],e.prototype,"isChecked",void 0),cu([Y("isVisible")],e.prototype,"isVisible",void 0),cu([Y("enabled")],e.prototype,"enabled",void 0),cu([Y("iconCss")],e.prototype,"iconCss",void 0),cu([Y("child")],e.prototype,"child",void 0),cu([Y("tooltip")],e.prototype,"tooltip",void 0),cu([Y("groupBy")],e.prototype,"groupBy",void 0),cu([Y("text")],e.prototype,"sortBy",void 0),cu([Y("htmlAttributes")],e.prototype,"htmlAttributes",void 0),cu([Y("tableName")],e.prototype,"tableName",void 0),e}(xa),mu=(function(t){function e(e,i){return t.call(this,e,i)||this}hu(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"htmlAttributes":this.setHTMLAttribute();break;case"cssClass":this.setCSSClass(e.cssClass);break;case"enable":this.setEnable();break;case"width":case"height":this.setSize();break;case"enableRtl":this.setEnableRTL();break;case"fields":this.listBaseOption.fields=this.fields.properties,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"headerTitle":this.curDSLevel.length||this.header(this.headerTitle,!1);break;case"showHeader":this.header(this.headerTitle,!1);break;case"enableVirtualization":L(this.contentContainer),this.refresh();break;case"showCheckBox":case"checkBoxPosition":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.setCheckbox();break;case"dataSource":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"sortOrder":case"showIcon":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():(this.listBaseOption.showIcon=this.showIcon,this.curViewDS=this.getSubDS(),this.resetCurrentList())}},e.prototype.setHTMLAttribute=function(){Object.keys(this.htmlAttributes).length&&k(this.element,this.htmlAttributes)},e.prototype.setCSSClass=function(t){this.cssClass&&w([this.element],this.cssClass.split(" ")),t&&x([this.element],t.split(" "))},e.prototype.setSize=function(){this.element.style.height=m(this.height),this.element.style.width=m(this.width),this.isWindow=!this.element.getBoundingClientRect().height},e.prototype.setEnable=function(){this.enableElement(this.element,this.enable)},e.prototype.setEnableRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},e.prototype.enableElement=function(t,e){e?t.classList.remove(uu.disable):t.classList.add(uu.disable)},e.prototype.header=function(t,e){if(void 0===this.headerEle&&this.showHeader){this.headerEle=this.createElement("div",{className:uu.header});var i=this.createElement("span",{className:uu.headerText,innerHTML:this.headerTitle}),n=this.createElement("div",{className:uu.text,innerHTML:i.outerHTML}),o=this.createElement("div",{className:uu.icon+" "+uu.backIcon+" e-but-back",attrs:{style:"display:none;"}});if(this.headerEle.appendChild(o),this.headerEle.appendChild(n),this.headerTemplate){var r=pt(this.headerTemplate),s=this.createElement("div",{className:uu.headerTemplateText});P(r({}),s),P([s],this.headerEle)}this.headerTemplate&&this.headerTitle&&n.classList.add("header"),this.element.classList.add("e-has-header"),E([this.headerEle],this.element)}else if(this.headerEle)if(this.showHeader){this.headerEle.style.display="";var n=this.headerEle.querySelector("."+uu.headerText),o=this.headerEle.querySelector("."+uu.backIcon);n.innerHTML=t,this.headerTemplate&&e&&(n.parentElement.classList.remove("header"),this.headerEle.querySelector("."+uu.headerTemplateText).classList.add("nested-header")),this.headerTemplate&&!e&&(n.parentElement.classList.add("header"),this.headerEle.querySelector("."+uu.headerTemplateText).classList.remove("nested-header"),this.headerEle.querySelector("."+uu.headerTemplateText).classList.add("header")),o.style.display=!0===e?"":"none"}else this.headerEle.style.display="none"},e.prototype.switchView=function(t,e,i){var n=this;if(t&&e){var o=t.style.position,r="hidden"!==this.element.style.overflow?this.element.style.overflow:"";t.style.position="absolute",t.classList.add("e-view");var s=void 0,a=this.animation.duration;if(this.animation.effect)s=this.enableRtl?pu[this.animation.effect]:du[this.animation.effect];else{s=du.SlideLeft,i=this.enableRtl,a=0}this.element.style.overflow="hidden",this.aniObj.animate(t,{name:!0===i?s[0]:s[1],duration:a,timingFunction:this.animation.easing,end:function(e){t.style.display="none",n.element.style.overflow=r,t.style.position=o,t.classList.remove("e-view")}}),e.style.display="",this.aniObj.animate(e,{name:!0===i?s[2]:s[3],duration:a,timingFunction:this.animation.easing,end:function(){n.trigger("actionComplete")}}),this.curUL=e}},e.prototype.preRender=function(){this.listBaseOption={template:this.template,headerTemplate:this.headerTemplate,groupTemplate:this.groupTemplate,expandCollapse:!0,listClass:"",ariaAttributes:{itemRole:"listitem",listRole:"list",itemText:"",groupItemRole:"group",wrapperRole:"presentation"},fields:this.fields.properties,sortOrder:this.sortOrder,showIcon:this.showIcon,itemCreated:this.renderCheckbox.bind(this)},this.initialization()},e.prototype.initialization=function(){this.curDSLevel=[],this.animateOptions={},this.curViewDS=[],this.currentLiElements=[],this.isNestedList=!1,this.selectedData=[],this.selectedId=[],this.aniObj=new ya(this.animateOptions)},e.prototype.renderCheckbox=function(t){if(t.item.classList.contains(uu.hasChild)&&(this.isNestedList=!0),this.showCheckBox&&this.isValidLI(t.item)){var e=void 0;(e=ke(!1,{checked:!1,enableRtl:this.enableRtl,cssClass:uu.listviewCheckbox})).setAttribute("role","checkbox");var i=e.querySelector("."+uu.checkboxIcon);t.item.classList.add(uu.itemCheckList),t.item.firstElementChild.classList.add(uu.checkbox),"string"!=typeof this.dataSource[0]&&"number"!=typeof this.dataSource[0]?vs(t.curData,this.listBaseOption.fields)[this.listBaseOption.fields.isChecked]&&this.checkInternally(t,e):"string"!=typeof this.dataSource[0]&&"number"!=typeof this.dataSource[0]||-1===this.selectedData.indexOf(t.text)||this.checkInternally(t,e),e.setAttribute("aria-checked",i.classList.contains(uu.checked)?"true":"false"),"Left"===this.checkBoxPosition?(e.classList.add(uu.checkboxLeft),t.item.firstElementChild.classList.add(uu.checkboxLeft),t.item.firstElementChild.insertBefore(e,t.item.firstElementChild.childNodes[0])):(e.classList.add(uu.checkboxRight),t.item.firstElementChild.classList.add(uu.checkboxRight),t.item.firstElementChild.appendChild(e)),this.currentLiElements.push(t.item)}},e.prototype.checkInternally=function(t,e){t.item.classList.add(uu.selected),t.item.setAttribute("aria-selected","true"),e.querySelector("."+uu.checkboxIcon).classList.add(uu.checked),e.setAttribute("aria-checked","true")},e.prototype.checkItem=function(t){this.toggleCheckBase(t,!0)},e.prototype.toggleCheckBase=function(t,e){if(this.showCheckBox){var i=t;if(t instanceof Object&&t.constructor!==HTMLLIElement&&(i=this.getLiFromObjOrElement(t)),!h(i)){var n=i.querySelector("."+uu.checkboxIcon);e?i.classList.add(uu.selected):i.classList.remove(uu.selected),i.setAttribute("aria-selected",e?"true":"false"),e?n.classList.add(uu.checked):n.classList.remove(uu.checked),n.parentElement.setAttribute("aria-checked",e?"true":"false")}this.setSelectedItemData(i)}},e.prototype.uncheckItem=function(t){this.toggleCheckBase(t,!1)},e.prototype.checkAllItems=function(){this.toggleAllCheckBase(!0)},e.prototype.uncheckAllItems=function(){this.toggleAllCheckBase(!1)},e.prototype.toggleAllCheckBase=function(t){if(this.showCheckBox){for(var e=0;e<this.liCollection.length;e++){var i=this.liCollection[e].querySelector("."+uu.checkboxIcon);i&&(t?i.classList.contains(uu.checked)||this.checkItem(this.liCollection[e]):i.classList.contains(uu.checked)&&this.uncheckItem(this.liCollection[e]))}this.enableVirtualization&&this.virtualizationModule.checkedItem(t)}},e.prototype.setCheckbox=function(){var t=this;if(this.showCheckBox){var e={item:void 0,curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:""};(i=Array.prototype.slice.call(this.element.querySelectorAll("."+uu.listItem))).forEach(function(i){e.item=i,e.curData=t.getItemData(i),i.querySelector("."+uu.checkboxWrapper)&&t.removeElement(i.querySelector("."+uu.checkboxWrapper)),t.renderCheckbox(e),e.item.classList.contains(uu.selected)&&t.checkInternally(e,e.item.querySelector("."+uu.checkboxWrapper))})}else{var i=Array.prototype.slice.call(this.element.querySelectorAll("."+uu.itemCheckList));i.forEach(function(e){e.classList.remove(uu.selected),e.firstElementChild.classList.remove(uu.checkbox),t.removeElement(e.querySelector("."+uu.checkboxWrapper))}),this.selectedItems&&this.selectedItems.item.classList.add(uu.selected)}},e.prototype.clickHandler=function(t){var e=t.target,i=e.classList;if(i.contains(uu.backIcon)||i.contains(uu.headerText))this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();else{var n=M(e.parentNode,"."+uu.listItem);if(null===n&&(n=e),this.removeFocus(),this.enable&&this.showCheckBox&&this.isValidLI(n))if(t.target.classList.contains(uu.checkboxIcon)){if(n.classList.add(uu.focused),h(n.querySelector("."+uu.checked))){var o={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:n};this.checkInternally(o,o.item.querySelector("."+uu.checkboxWrapper))}else this.uncheckItem(n),n.classList.add(uu.focused);if(t){var r=this.selectEventData(n,t);a(r,{isChecked:n.querySelector("."+uu.checkboxIcon).classList.contains(uu.checked)}),this.trigger("select",r)}}else n.classList.contains(uu.hasChild)?(this.removeHover(),this.removeSelect(),this.removeSelect(n),this.setSelectLI(n,t),n.classList.remove(uu.selected)):this.setCheckboxLI(n,t);else this.setSelectLI(n,t)}},e.prototype.removeElement=function(t){return t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.hoverHandler=function(t){var e=M(t.target.parentNode,"."+uu.listItem);this.setHoverLI(e)},e.prototype.leaveHandler=function(t){this.removeHover()},e.prototype.homeKeyHandler=function(t,e){if(Object.keys(this.dataSource).length&&this.curUL){var i=this.curUL.querySelectorAll("."+uu.listItem),n=this.curUL.querySelector("."+uu.focused)||this.curUL.querySelector("."+uu.selected);n&&(n.classList.remove(uu.focused),this.showCheckBox||n.classList.remove(uu.selected));var o=e?i.length-1:0;i[o].classList.contains(uu.hasChild)||this.showCheckBox?i[o].classList.add(uu.focused):this.setSelectLI(i[o],t)}},e.prototype.onArrowKeyDown=function(t,e){var i,n;return!h(this.curUL.querySelector("."+uu.hasChild))||this.showCheckBox?(n=this.curUL.querySelector("."+uu.focused)||this.curUL.querySelector("."+uu.selected),h(i=_l.getSiblingLI(this.curUL.querySelectorAll("."+uu.listItem),n,e))||(n&&(n.classList.remove(uu.focused),this.showCheckBox||n.classList.remove(uu.selected)),i.classList.contains(uu.hasChild)||this.showCheckBox?i.classList.add(uu.focused):this.setSelectLI(i,t))):(n=this.curUL.querySelector("."+uu.selected),i=_l.getSiblingLI(this.curUL.querySelectorAll("."+uu.listItem),n,e),this.setSelectLI(i,t)),i},e.prototype.arrowKeyHandler=function(t,e){var i=this;if(Object.keys(this.dataSource).length&&this.curUL){var n=this.onArrowKeyDown(t,e),o=this.element.getBoundingClientRect().top,r=this.element.getBoundingClientRect().height,s=this.curUL.querySelector("."+uu.listItem).getBoundingClientRect(),a=void 0,l=void 0;if(this.fields.groupBy&&(l=this.curUL.querySelector("."+uu.groupListItem).getBoundingClientRect()),n){var h=n.getBoundingClientRect().top,c=n.getBoundingClientRect().height;if(e)(a=this.isWindow?h:h-o)<0&&(this.isWindow?window.scrollTo(0,pageYOffset+a):this.element.scrollTo(0,this.element.scrollTop+a));else{var d=this.isWindow?window.innerHeight:r;(a=this.isWindow?h+c:h-o+c)>d&&(this.isWindow?window.scrollTo(0,pageYOffset+(a-d)):this.element.scrollTo(0,this.element.scrollTop+(a-d)))}}else if(this.enableVirtualization&&e&&this.virtualizationModule.uiFirstIndex)this.onUIScrolled=function(){i.onArrowKeyDown(t,e),i.onUIScrolled=void 0},a=this.virtualizationModule.listItemHeight,this.isWindow?window.scrollTo(0,pageYOffset-a):this.element.scrollTo(0,this.element.scrollTop-a);else if(e)if(this.showHeader&&this.headerEle){var p=l?l.top:s.top,u=this.headerEle.getBoundingClientRect();a=u.top<0?u.height-p:0,this.isWindow?window.scrollTo(0,pageYOffset-a):this.element.scrollTo(0,0)}else this.fields.groupBy&&(a=this.isWindow?l.top<0?l.top:0:o-s.top+l.height,this.isWindow?window.scrollTo(0,pageYOffset+a):this.element.scrollTo(0,this.element.scrollTop-a))}},e.prototype.enterKeyHandler=function(t){if(Object.keys(this.dataSource).length&&this.curUL){var e=!h(this.curUL.querySelector("."+uu.hasChild)),i=this.curUL.querySelector("."+uu.focused);e&&i&&(i.classList.remove(uu.focused),this.showCheckBox&&(this.removeSelect(),this.removeSelect(i),this.removeHover()),this.setSelectLI(i,t))}},e.prototype.spaceKeyHandler=function(t){if(this.enable&&this.showCheckBox&&Object.keys(this.dataSource).length&&this.curUL){var e=this.curUL.querySelector("."+uu.focused);if(!h(e)&&h(e.querySelector("."+uu.checked))){var i={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:e};this.checkInternally(i,i.item.querySelector("."+uu.checkboxWrapper))}else this.uncheckItem(e)}},e.prototype.keyActionHandler=function(t){switch(t.preventDefault(),t.keyCode){case 36:this.homeKeyHandler(t);break;case 35:this.homeKeyHandler(t,!0);break;case 40:this.arrowKeyHandler(t);break;case 38:this.arrowKeyHandler(t,!0);break;case 13:this.enterKeyHandler(t);break;case 8:this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();break;case 9:this.tabFocus(t);break;case 32:this.spaceKeyHandler(t)}},e.prototype.swipeActionHandler=function(t){"Right"===t.swipeDirection&&(this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back())},e.prototype.focusout=function(){if(Object.keys(this.dataSource).length&&this.curUL){var t=this.curUL.querySelector("."+uu.focused),e=this.curUL.querySelector("[aria-selected = true]");t&&!this.showCheckBox&&(t.classList.remove(uu.focused),e&&e.classList.add(uu.selected))}},e.prototype.wireEvents=function(){ha.add(this.element,"keydown",this.keyActionHandler,this),ha.add(this.element,"click",this.clickHandler,this),this.enableVirtualization||(ha.add(this.element,"mouseover",this.hoverHandler,this),ha.add(this.element,"mouseout",this.leaveHandler,this)),ha.add(this.element,"focusout",this.focusout,this),this.touchModule=new gl(this.element,{swipe:this.swipeActionHandler.bind(this)})},e.prototype.unWireEvents=function(){ha.remove(this.element,"click",this.clickHandler),this.enableVirtualization||(ha.remove(this.element,"mouseover",this.hoverHandler),ha.remove(this.element,"mouseout",this.leaveHandler)),ha.remove(this.element,"mouseover",this.hoverHandler),ha.remove(this.element,"mouseout",this.leaveHandler),this.touchModule.destroy()},e.prototype.tabFocus=function(t){if(Object.keys(this.dataSource).length&&this.curUL&&(!this.curUL.querySelector("."+uu.selected)&&this.curUL||this.showCheckBox)){var e=this.curUL.querySelector("."+uu.listItem);e.classList.contains(uu.hasChild)||this.showCheckBox?h(this.curUL.querySelector("."+uu.focused))&&e.classList.add(uu.focused):this.setSelectLI(e,t)}},e.prototype.removeFocus=function(){for(var t=0,e=this.element.querySelectorAll("."+uu.focused);t<e.length;t++)e[t].classList.remove(uu.focused)},e.prototype.removeHover=function(){var t=this.element.querySelector("."+uu.hover);t&&t.classList.remove(uu.hover)},e.prototype.removeSelect=function(t){if(h(t))for(var e=0,i=this.element.querySelectorAll("."+uu.selected);e<i.length;e++){var n=i[e];this.showCheckBox&&n.querySelector("."+uu.checked)||(n.setAttribute("aria-selected","false"),n.classList.remove(uu.selected))}else t.classList.remove(uu.selected),t.setAttribute("aria-selected","false")},e.prototype.isValidLI=function(t){return t&&t.classList.contains(uu.listItem)&&!t.classList.contains(uu.groupListItem)&&!t.classList.contains(uu.disable)},e.prototype.setCheckboxLI=function(t,e){if(this.isValidLI(t)&&this.enable&&this.showCheckBox){this.curUL.querySelector("."+uu.focused)&&this.curUL.querySelector("."+uu.focused).classList.remove(uu.focused),t.classList.add(uu.focused);var i=t.querySelector("."+uu.checkboxWrapper),n=i.querySelector("."+uu.checkboxIcon+"."+uu.icon);if(this.removeHover(),n.classList.contains(uu.checked)?(n.classList.remove(uu.checked),t.classList.remove(uu.selected),t.setAttribute("aria-selected","false")):(n.classList.add(uu.checked),t.classList.add(uu.selected),t.setAttribute("aria-selected","true")),i.setAttribute("aria-checked",n.classList.contains(uu.checked)?"true":"false"),e){var o=this.selectEventData(t,e);a(o,{isChecked:n.classList.contains(uu.checked)}),this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(t,e),this.trigger("select",o)}this.setSelectedItemData(t),this.renderSubList(t)}},e.prototype.selectEventData=function(t,e){var i,n=this.getItemData(t),o=vs(n,this.listBaseOption.fields);try{i=!h(n)&&"string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0]?{item:t,text:t.innerText.trim(),data:this.dataSource}:{item:t,text:o[this.listBaseOption.fields.text],data:n}}catch(e){}var r={};return a(r,i),e&&a(r,{isInteracted:!0,event:e,index:Array.prototype.indexOf.call(this.curUL.children,t)}),r},e.prototype.setSelectedItemData=function(t){var e=this.getItemData(t),i=vs(e,this.listBaseOption.fields);try{h(e)||"string"!=typeof this.dataSource[0]&&"number"!=typeof this.dataSource[0]?this.selectedItems={item:t,text:i[this.listBaseOption.fields.text],data:e}:this.selectedItems={item:t,text:t.innerText.trim(),data:this.dataSource}}catch(t){}},e.prototype.setSelectLI=function(t,e){if(this.isValidLI(t)&&!t.classList.contains(uu.selected)&&this.enable){this.showCheckBox||this.removeSelect(),t.classList.add(uu.selected),t.setAttribute("aria-selected","true"),this.removeHover(),this.setSelectedItemData(t),this.enableVirtualization&&this.virtualizationModule.setSelectLI(t,e);var i=this.selectEventData(t,e);this.trigger("select",i),this.selectedLI=t,this.renderSubList(t)}},e.prototype.setHoverLI=function(t){if(this.isValidLI(t)&&!t.classList.contains(uu.hover)&&this.enable){var e=this.element.querySelectorAll("."+uu.hover);e&&e.length&&x(e,uu.hover),t.classList.contains(uu.selected)&&!this.showCheckBox||t.classList.add(uu.hover)}},e.prototype.hoverSiblingLI=function(t){var e,i=this.curUL.querySelector("."+uu.hover);if(i||(i=this.curUL.querySelector("."+uu.selected)),i)e=_l.getSiblingLI(this.curUL.querySelectorAll("."+uu.listItem),i,t);else if(t){var n=this.curUL.querySelectorAll("."+uu.listItem);e=n[n.length-1]}else e=this.curUL.querySelector("."+uu.listItem);this.setHoverLI(e)},e.prototype.getSubDS=function(){var t=this.curDSLevel;if(t.length){for(var e=this.localData,i=0,n=t;i<n.length;i++){var o=n[i],r={};r[this.fields.id]=o,this.curDSJSON=this.findItemFromDS(e,r);var s=vs(this.curDSJSON,this.listBaseOption.fields);e=this.curDSJSON?s[this.fields.child]:e}return e}return this.localData},e.prototype.getItemData=function(t){var e,i=this.getElementUID(t);return e=h(this.curUL.querySelector("."+uu.hasChild))&&this.fields.groupBy?this.curViewDS:this.dataSource,this.findItemFromDS(e,i)},e.prototype.findItemFromDS=function(t,e,i){var n,o=this;return t&&t.length&&e?t.some(function(r){var s=vs(r,o.listBaseOption.fields);if(!e[o.fields.id]&&!e[o.fields.text]||e[o.fields.id]&&(!h(s[o.fields.id])&&s[o.fields.id].toString())!==e[o.fields.id].toString()||e[o.fields.text]&&s[o.fields.text]!==e[o.fields.text])if("object"!=typeof r&&-1!==t.indexOf(r))n=i?t:r;else if(!h(e[o.fields.id])&&h(s[o.fields.id])){var a=o.element.querySelector('[data-uid="'+e[o.fields.id]+'"]');a&&a.innerText.trim()===s[o.fields.text]&&(n=r)}else s.hasOwnProperty(o.fields.child)&&s[o.fields.child].length&&(n=o.findItemFromDS(s[o.fields.child],e,i));else n=i?t:r;return!!n}):n=t,n},e.prototype.getQuery=function(){var t=[],e=this.query?this.query:new kp;if(!this.query){for(var i=0,n=Object.keys(this.fields.properties);i<n.length;i++){var o=n[i];"tableName"!==o&&this.fields[o]&&this.fields[o]!==_l.defaultMappedFields[o]&&-1===t.indexOf(this.fields[o])&&t.push(this.fields[o])}e.select(t),this.fields.properties.hasOwnProperty("tableName")&&e.from(this.fields.tableName)}return e},e.prototype.setViewDataSource=function(t){void 0===t&&(t=this.localData),t&&this.fields.groupBy?this.curViewDS=_l.groupDataSource(t,this.fields,this.sortOrder):t&&"None"!==this.sortOrder?this.curViewDS=_l.getDataSource(t,_l.addSorting(this.sortOrder,this.fields.sortBy)):this.curViewDS=t},e.prototype.isInAnimation=function(){return this.curUL.classList.contains(".e-animate")},e.prototype.setLocalData=function(){var t=this;if(this.trigger("actionBegin"),this.dataSource instanceof jp)this.dataSource.executeQuery(this.getQuery()).then(function(e){t.isDestroyed||(t.localData=e.result,t.renderList(),t.trigger("actionComplete",e))}).catch(function(e){t.isDestroyed||t.trigger("actionFailure",e)});else if(this.dataSource&&this.dataSource.length)this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData});else{var e=this.element.querySelector("ul");e&&(T(e),this.setProperties({dataSource:_l.createJsonFromElement(e)},!0),this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData}))}},e.prototype.reRender=function(){this.element.innerHTML="",this.headerEle=this.ulElement=this.liCollection=void 0,this.setLocalData(),this.header()},e.prototype.resetCurrentList=function(){this.setViewDataSource(this.curViewDS),this.contentContainer.innerHTML="",this.createList(),this.renderIntoDom(this.curUL)},e.prototype.createList=function(){this.currentLiElements=[],this.isNestedList=!1,this.ulElement=this.curUL=_l.createList(this.createElement,this.curViewDS,this.listBaseOption),this.liCollection=this.curUL.querySelectorAll("."+uu.listItem)},e.prototype.renderSubList=function(t){var e=t.getAttribute("data-uid");if(t.classList.contains(uu.hasChild)&&e){var i=M(t.parentNode,"."+uu.parentItem),n=this.element.querySelector("[pid='"+e+"']");if(this.curDSLevel.push(e),this.setViewDataSource(this.getSubDS()),!n){var o=this.curViewDS;(n=_l.createListFromJson(this.createElement,o,this.listBaseOption,this.curDSLevel.length)).setAttribute("pID",e),n.style.display="none",this.renderIntoDom(n)}if(this.switchView(i,n),this.liCollection=this.curUL.querySelectorAll("."+uu.listItem),this.selectedItems){var r=vs(this.selectedItems.data,this.listBaseOption.fields);this.header(r[this.listBaseOption.fields.text],!0)}this.selectedLI=void 0}},e.prototype.renderIntoDom=function(t){this.contentContainer.appendChild(t)},e.prototype.renderList=function(t){this.setViewDataSource(t),this.enableVirtualization&&Object.keys(this.dataSource).length?((this.template||this.groupTemplate)&&(this.listBaseOption.template=null,this.listBaseOption.groupTemplate=null,this.listBaseOption.itemCreated=this.virtualizationModule.createUIItem.bind(this.virtualizationModule)),this.virtualizationModule.uiVirtualization()):(this.createList(),this.contentContainer=this.createElement("div",{className:uu.content}),this.element.appendChild(this.contentContainer),this.renderIntoDom(this.ulElement))},e.prototype.getElementUID=function(t){var e={};return t instanceof Element?e[this.fields.id]=t.getAttribute("data-uid"):e=t,e},e.prototype.render=function(){this.element.classList.add(uu.root),k(this.element,{role:"list",tabindex:"0"}),this.setCSSClass(),this.setEnableRTL(),this.setEnable(),this.setSize(),this.wireEvents(),this.header(),this.setLocalData(),this.setHTMLAttribute(),this.rippleFn=it(this.element,{selector:"."+uu.listItem})},e.prototype.destroy=function(){this.unWireEvents();var e=[uu.root,this.cssClass,uu.disable,"e-rtl","e-has-header","e-control"];x([this.element],e),this.rippleFn(),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex"),this.element.innerHTML="",this.curUL=this.ulElement=this.liCollection=this.headerEle=void 0,t.prototype.destroy.call(this)},e.prototype.back=function(){var t=this.curDSLevel[this.curDSLevel.length-1];if(void 0!==t&&!this.isInAnimation()){this.curDSLevel.pop(),this.setViewDataSource(this.getSubDS());var e=this.element.querySelector("[data-uid='"+t+"']"),i=this.curUL;e?e=e.parentElement:(this.createList(),this.renderIntoDom(this.ulElement),e=this.curUL);var n=vs(this.curDSJSON,this.listBaseOption.fields)[this.fields.text];this.switchView(i,e,!0),this.removeFocus();var o=this.element.querySelector("[data-uid='"+t+"']");o.classList.add(uu.focused),this.showCheckBox&&o.querySelector("."+uu.checkboxIcon).classList.contains(uu.checked)?o.setAttribute("aria-selected","true"):(o.classList.remove(uu.selected),o.setAttribute("aria-selected","false")),this.liCollection=this.curUL.querySelectorAll("."+uu.listItem),this.header(this.curDSLevel.length?n:this.headerTitle,!!this.curDSLevel.length)}},e.prototype.selectItem=function(t){h(t)||(this.enableVirtualization?this.virtualizationModule.selectItem(t):this.showCheckBox?this.setCheckboxLI(this.getLiFromObjOrElement(t)):this.setSelectLI(this.getLiFromObjOrElement(t)))},e.prototype.getLiFromObjOrElement=function(t){var e;if(!h(t))if("string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0])if(t instanceof Element){for(var i=t.getAttribute("data-uid").toString(),n=0;n<this.liCollection.length;n++)if(this.liCollection[n].getAttribute("data-uid").toString()===i){e=this.liCollection[n];break}}else Array.prototype.some.call(this.curUL.querySelectorAll("."+uu.listItem),function(i){return i.innerText.trim()===t.toString()&&(e=i,!0)});else{var o=this.getItemData(t),r=vs(o,this.listBaseOption.fields);if(o&&(e=this.element.querySelector('[data-uid="'+r[this.fields.id]+'"]'),h(e)))for(var s=this.element.querySelectorAll("."+uu.listItem),n=0;n<s.length;n++)s[n].innerText.trim()===o.text&&(e=s[n])}return e},e.prototype.selectMultipleItems=function(t){if(!h(t))for(var e=0;e<t.length;e++)h(t[e])||this.selectItem(t[e])},e.prototype.getParentId=function(){var t=[];if(this.isNestedList)for(var e=this.curDSLevel.length-1;e>=0;e--)t.push(this.curDSLevel[e]);return t},e.prototype.getSelectedItems=function(){if(this.selectedId=[],this.enableVirtualization)return this.virtualizationModule.getSelectedItems();if(this.showCheckBox){var t=this.curUL.getElementsByClassName(uu.selected),e=[],i=[];this.selectedId=[];for(var n=[],o=0;o<t.length;o++)if("string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0])e.push(t[o].innerText.trim());else{var r=this.getItemData(t[o]),s=vs(r,this.listBaseOption.fields);this.isNestedList?n.push({data:r,parentId:this.getParentId()}):i.push(r),s?(e.push(s[this.listBaseOption.fields.text]),this.selectedId.push(s[this.listBaseOption.fields.id])):(e.push(void 0),this.selectedId.push(void 0))}return"string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0]?{item:t,data:this.dataSource,text:e}:this.isNestedList?{item:t,data:n,text:e}:{item:t,data:i,text:e}}var a=this.element.getElementsByClassName(uu.selected)[0],s=vs(this.getItemData(a),this.listBaseOption.fields);return"string"==typeof this.dataSource[0]||"number"==typeof this.dataSource[0]?h(a)?void 0:{item:a,data:this.dataSource,text:a.innerText.trim()}:h(s)||h(a)?void 0:(this.selectedId.push(s[this.listBaseOption.fields.id]),{text:s[this.listBaseOption.fields.text],item:a,data:this.getItemData(a)})},e.prototype.findItem=function(t){return this.getItemData(t)},e.prototype.enableItem=function(t){this.setItemState(t,!0),this.enableVirtualization&&this.virtualizationModule.enableItem(t)},e.prototype.disableItem=function(t){this.setItemState(t,!1),this.enableVirtualization&&this.virtualizationModule.disableItem(t)},e.prototype.setItemState=function(t,e){var i=this.getItemData(t),n=vs(i,this.listBaseOption.fields);if(i){var o=this.element.querySelector('[data-uid="'+n[this.fields.id]+'"]');e?(o&&o.classList.remove(uu.disable),delete i[this.fields.enabled]):e||(o&&o.classList.add(uu.disable),i[this.fields.enabled]=!1)}},e.prototype.showItem=function(t){this.showHideItem(t,!1,""),this.enableVirtualization&&this.virtualizationModule.showItem(t)},e.prototype.hideItem=function(t){this.showHideItem(t,!0,"none"),this.enableVirtualization&&this.virtualizationModule.hideItem(t)},e.prototype.showHideItem=function(t,e,i){var n=this.getItemData(t),o=vs(n,this.listBaseOption.fields);if(n){var r=this.element.querySelector('[data-uid="'+o[this.fields.id]+'"]');r&&(r.style.display=i),e?n[this.fields.isVisible]=!1:delete n[this.fields.isVisible]}},e.prototype.addItem=function(t,e){var i=this;if(void 0===e&&(e=void 0),t instanceof Array)if(this.enableVirtualization)this.virtualizationModule.addItem(t,e);else{var n=this.findItemFromDS(this.dataSource,e),o=vs(n,this.listBaseOption.fields)[this.fields.child];o||(o=[]),o=o.concat(t),n instanceof Array?(t.forEach(function(t){if(i.dataSource.push(t),i.setViewDataSource(i.dataSource),i.ulElement){var e=i.curViewDS.indexOf(t);i.addListItem(t,e);var n=i.curViewDS[e-1];n&&n.isHeader&&1===n.items.length&&i.addListItem(n,e-1)}else i.reRender()}),this.liCollection=this.curUL.querySelectorAll("."+uu.listItem)):(n[this.fields.child]=o,this.reRender())}},e.prototype.addListItem=function(t,e){var i=this.getLiFromObjOrElement(this.curViewDS[e+1])||this.getLiFromObjOrElement(this.curViewDS[e+2])||null,n=_l.createListItemFromJson(this.createElement,[t],this.listBaseOption);this.ulElement.insertBefore(n[0],i)},e.prototype.removeItem=function(t){this.enableVirtualization?this.virtualizationModule.removeItem(t):this.removeItemFromList(t)},e.prototype.removeItemFromList=function(t){var e,i=t instanceof Element?this.getElementUID(t):t;if(e=this.findItemFromDS(this.dataSource,i,!0)){var n=void 0;n=this.findItemFromDS(e,i);var o=this.curViewDS.indexOf(n);this.fields.groupBy&&this.curViewDS[o-1]&&this.curViewDS[o-1].isHeader&&1===this.curViewDS[o-1].items.length&&L(this.getLiFromObjOrElement(this.curViewDS[o-1])),this.getLiFromObjOrElement(t)&&L(this.getLiFromObjOrElement(t));var r=e.indexOf(n);e.splice(r,1),this.setViewDataSource(this.dataSource),this.liCollection=Array.prototype.slice.call(this.element.querySelectorAll("."+uu.listItem))}},e.prototype.removeMultipleItems=function(t){if(t.length)for(var e=0;e<t.length;e++)this.enableVirtualization?this.removeItem(t[e]):this.removeItemFromList(t[e])},e.prototype.getModuleName=function(){return"listview"},e.prototype.requiredModules=function(){var t=[];return this.enableVirtualization&&t.push({args:[this],member:"virtualization"}),t},e.prototype.getPersistData=function(){return this.addOnPersist(["cssClass","enableRtl","htmlAttributes","enable","fields","animation","headerTitle","sortOrder","showIcon","height","width","showCheckBox","checkBoxPosition"])},cu([Y()],e.prototype,"cssClass",void 0),cu([Y(!1)],e.prototype,"enableVirtualization",void 0),cu([Y({})],e.prototype,"htmlAttributes",void 0),cu([Y(!0)],e.prototype,"enable",void 0),cu([Y([])],e.prototype,"dataSource",void 0),cu([Y()],e.prototype,"query",void 0),cu([G(_l.defaultMappedFields,gu)],e.prototype,"fields",void 0),cu([Y({effect:"SlideLeft",duration:400,easing:"ease"})],e.prototype,"animation",void 0),cu([Y("None")],e.prototype,"sortOrder",void 0),cu([Y(!1)],e.prototype,"showIcon",void 0),cu([Y(!1)],e.prototype,"showCheckBox",void 0),cu([Y("Left")],e.prototype,"checkBoxPosition",void 0),cu([Y("")],e.prototype,"headerTitle",void 0),cu([Y(!1)],e.prototype,"showHeader",void 0),cu([Y("")],e.prototype,"height",void 0),cu([Y("")],e.prototype,"width",void 0),cu([Y(null)],e.prototype,"template",void 0),cu([Y(null)],e.prototype,"headerTemplate",void 0),cu([Y(null)],e.prototype,"groupTemplate",void 0),cu([J()],e.prototype,"select",void 0),cu([J()],e.prototype,"actionBegin",void 0),cu([J()],e.prototype,"actionComplete",void 0),cu([J()],e.prototype,"actionFailure",void 0),e=cu([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),fu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},vu="e-focused",yu="e-menu-header",bu="e-selected",wu="e-contextmenu-wrapper",xu="e-menu-hide",Cu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return mu(e,t),fu([Y("")],e.prototype,"iconCss",void 0),fu([Y("")],e.prototype,"id",void 0),fu([Y(!1)],e.prototype,"separator",void 0),fu([K([],e)],e.prototype,"items",void 0),fu([Y("")],e.prototype,"text",void 0),fu([Y("")],e.prototype,"url",void 0),e}(xa),Su=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.animation=new ya({}),n.navIdx=[],n.isTapHold=!1,n}return mu(e,t),e.prototype.preRender=function(){if("EJS-CONTEXTMENU"===this.element.tagName){this.element.style.display="none",this.element.classList.remove("e-"+this.getModuleName()),this.element.classList.remove("e-control");var t=n("ej2_instances",this.element),e=this.createElement("ul");this.ngElement=this.element,this.element=e,this.element.classList.add("e-control"),this.element.classList.add("e-"+this.getModuleName()),o("ej2_instances",t,this.element),this.element.id||(this.element.id=d(this.getModuleName()))}},e.prototype.render=function(){this.initWrapper(),this.renderItems(),this.wireEvents()},e.prototype.initWrapper=function(){var t=this.getWrapper();t||(t=this.createElement("div",{className:wu}),document.body.appendChild(t)),this.cssClass&&t.classList.add(this.cssClass),this.enableRtl&&t.classList.add("e-rtl"),k(this.element,{role:"menu",tabindex:"0"}),t.appendChild(this.element)},e.prototype.renderItems=function(){this.items.length||(this.items=_l.createJsonFromElement(this.element),this.element.innerHTML="");var t=this.createItems(this.items);P(Array.prototype.slice.call(t.children),this.element),this.element.classList.add("e-menu-parent")},e.prototype.wireEvents=function(){var t=this.getWrapper();if(this.target){for(var e=void 0,i=A(this.target),n=0,o=i.length;n<o;n++)e=i[n],ma.isIos?new gl(e,{tapHold:this.touchHandler.bind(this)}):ha.add(e,"contextmenu",this.cmenuHandler,this);this.targetElement=e;for(var r=0,s=Ce(this.targetElement);r<s.length;r++){var a=s[r];ha.add(a,"scroll",this.scrollHandler,this)}}ma.isDevice||(ha.add(t,"mouseover",this.moverHandler,this),ha.add(document,"mousedown",this.mouseDownHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),ha.add(document,"click",this.delegateClickHandler,this),new ll(t,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:{downarrow:"downarrow",uparrow:"uparrow",enter:"enter",leftarrow:"leftarrow",rightarrow:"rightarrow",escape:"escape"}}),it(t,{selector:".e-menu-item"})},e.prototype.mouseDownHandler=function(t){M(t.target,"."+wu)!==this.getWrapper()&&this.closeMenu(this.navIdx.length,t)},e.prototype.keyBoardHandler=function(t){switch(t.preventDefault(),t.action){case"downarrow":case"uparrow":this.upDownKeyHandler(t);break;case"rightarrow":this.rightEnterKeyHandler(t);break;case"leftarrow":this.leftEscKeyHandler(t);break;case"enter":this.rightEnterKeyHandler(t);break;case"escape":this.leftEscKeyHandler(t)}},e.prototype.upDownKeyHandler=function(t){var e=this.getWrapper().children[this.navIdx.length],i="downarrow"===t.action?0:e.childElementCount-1,n=i,o=this.getLIByClass(e,vu);o&&(n=this.getIdx(e,o),o.classList.remove(vu),"downarrow"===t.action?n++:n--,n===("downarrow"===t.action?e.childElementCount:-1)&&(n=i));var r=e.children[n];n=this.isValidLI(r,n,t.action),e.children[n].classList.add(vu),e.children[n].focus()},e.prototype.isValidLI=function(t,e,i){var n=this.getWrapper().children[this.navIdx.length];return(t.classList.contains("e-separator")||t.classList.contains("e-disabled")||t.classList.contains(xu))&&("downarrow"===i||"rightarrow"===i?e++:e--),((t=n.children[e]).classList.contains("e-separator")||t.classList.contains("e-disabled")||t.classList.contains(xu))&&(e=this.isValidLI(t,e,i)),e},e.prototype.rightEnterKeyHandler=function(t){var e,i=this.getWrapper(),n=i.children[this.navIdx.length],o=this.getLIByClass(n,vu);if(o){var r=this.getIdx(n,o),s=this.navIdx.concat(r),a=void 0,l=this.getItem(s);l.items.length?(this.navIdx.push(r),this.openMenu(o,l,null,null,t),o.classList.remove(vu),o.classList.add(bu),"enter"===t.action&&(e={element:o,item:l},this.trigger("select",e)),o.focus(),n=i.children[this.navIdx.length],a=this.isValidLI(n.children[0],0,t.action),n.children[a].classList.add(vu),n.children[a].focus()):"enter"===t.action&&(o.classList.remove(vu),o.classList.add(bu),e={element:o,item:l},this.trigger("select",e),this.closeMenu(null,t))}},e.prototype.leftEscKeyHandler=function(t){if(this.navIdx.length){var e=this.getWrapper();this.closeMenu(this.navIdx.length,t);var i=e.children[this.navIdx.length],n=this.getLIByClass(i,bu);n&&(n.setAttribute("aria-expanded","false"),n.classList.remove(bu),n.classList.add(vu),n.focus())}else"escape"===t.action&&this.closeMenu(null,t)},e.prototype.scrollHandler=function(t){this.closeMenu(null,t)},e.prototype.touchHandler=function(t){this.isTapHold=!0,this.cmenuHandler(t.originalEvent)},e.prototype.cmenuHandler=function(t){t.preventDefault(),this.closeMenu(null,t),this.canOpen(t.target)&&(t.changedTouches?this.openMenu(null,null,t.changedTouches[0].pageY+1,t.changedTouches[0].pageX+1,t):this.openMenu(null,null,t.pageY+1,t.pageX+1,t))},e.prototype.close=function(){this.closeMenu()},e.prototype.closeMenu=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=null),this.isMenuVisible())for(var i=void 0,n=void 0,o=void 0,r=void 0,s=void 0,a=this.getWrapper(),l=a.childElementCount;l>t;l--)o=(n=this.navIdx.length?this.getItem(this.navIdx):null)?n.items:this.items,s={element:i=a.children[l-1],parentItem:n,items:o,event:e,cancel:!1},this.trigger("beforeClose",s),s.cancel||(this.toggleAnimation(i,!1),this.navIdx.length=t?t-1:t,r={element:i,parentItem:n,items:o},this.trigger("onClose",r))},e.prototype.isMenuVisible=function(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&S(this.element).valueOf()},e.prototype.canOpen=function(t){var e=!0;if(this.filter){e=!1;for(var i=this.filter.split(" "),n=0,o=t.classList.length;n<o;n++)if(i.indexOf(t.classList[n])>-1){e=!0;break}}return e},e.prototype.open=function(t,e,i){this.openMenu(null,null,t,e,null,i)},e.prototype.openMenu=function(t,e,i,n,o,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=null),void 0===r&&(r=this.targetElement);var s,a=this.getWrapper();if(t){if(s=this.createItems(e.items),ma.isDevice){a.lastChild.style.display="none";var l={text:e.text,iconCss:"e-icons e-previous"},h=new Cu(this.items[0],null,l,!0),c=this.createItems([h]).children[0];c.classList.add(yu),s.insertBefore(c,s.children[0])}s.style.zIndex=this.element.style.zIndex,a.appendChild(s)}else(s=this.element).style.zIndex=Se(r||this.element).toString();this.getIndex(t?t.id:null,!0);var d={element:s,items:t?e.items:this.items,parentItem:e,event:o,cancel:!1};this.trigger("beforeOpen",d),d.cancel?this.navIdx.pop():(this.setPosition(t,s,i,n),this.toggleAnimation(s))},e.prototype.setPosition=function(t,e,i,n){if(this.toggleVisiblity(e),e===this.element)(r=ee(e,null,n,i)).indexOf("right")>-1&&(n-=e.offsetWidth),r.indexOf("bottom")>-1&&(i=(o=te(e,null,{X:!1,Y:!0},{top:i,left:n})).top-20),(r=ee(e,null,n,i)).indexOf("left")>-1&&(n=(o=te(e,null,{X:!0,Y:!1},{top:i,left:n})).left);else if(ma.isDevice)i=Number(this.element.style.top.replace("px","")),n=Number(this.element.style.left.replace("px",""));else{var o=_t(t,this.enableRtl?"left":"right","top");i=o.top,n=o.left;var r=ee(e,null,this.enableRtl?n-e.offsetWidth:n,i),s=r.indexOf("left")>-1||r.indexOf("right")>-1;s&&(n=(o=_t(t,this.enableRtl?"right":"left","top")).left),(this.enableRtl||s)&&(n=this.enableRtl&&s?n:n-e.offsetWidth),r.indexOf("bottom")>-1&&(i=(o=te(e,null,{X:!1,Y:!0},{top:i,left:n})).top)}this.toggleVisiblity(e,!1),e.style.top=i+"px",e.style.left=n+"px"},e.prototype.toggleVisiblity=function(t,e){void 0===e&&(e=!0),t.style.visibility=e?"hidden":"",t.style.display=e?"block":"none"},e.prototype.createItems=function(t){var e=this,i=this.hasField(t,"iconCss"),n={showIcon:i,moduleName:"menu",itemCreating:function(t){t.curData.id||(t.curData.id=d("menuitem")),t.curData.htmlAttributes={role:"menuitem",tabindex:"-1"}},itemCreated:function(t){if(t.curData.separator&&(t.item.classList.add("e-separator"),t.item.removeAttribute("role")),!i||t.curData.iconCss||t.curData.separator||t.item.classList.add("e-blankicon"),t.curData.items&&t.curData.items.length){var n=e.createElement("span",{className:"e-icons e-caret"});t.item.appendChild(n),t.item.setAttribute("aria-haspopup","true"),t.item.setAttribute("aria-expanded","false"),t.item.removeAttribute("role"),t.item.classList.add("e-menu-caret-icon")}var o={item:t.curData,element:t.item};e.trigger("beforeItemRender",o)}},o=_l.createList(this.createElement,this.toRawObject(t.slice()),n,!0);return o.setAttribute("tabindex","0"),o},e.prototype.toRawObject=function(t){for(var e,i=[],n=0,o=t.length;n<o;n++)e=t[n].properties,i.push(e);return i},e.prototype.moverHandler=function(t){var e=this.getWrapper(),i=t.target,n=this.getLI(i);if(n&&M(n,"."+wu)){var o=O("."+vu,e);o&&o.classList.remove(vu),n.classList.add(vu),this.showItemOnClick||this.clickHandler(t)}},e.prototype.hasField=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i][e])return!0;return!1},e.prototype.getWrapper=function(){return M(this.element,"."+wu)},e.prototype.clickHandler=function(t){if(this.isTapHold)this.isTapHold=!1;else{var e=this.getWrapper(),i=t.target,n=this.getLI(i),o=n?M(n,"."+wu):null,r=n&&o&&e.firstElementChild.id===o.firstElementChild.id;if(r&&"click"===t.type&&!n.classList.contains(yu)){this.setLISelected(n);var s=this.getIndex(n.id,!0),a={element:n,item:m=this.getItem(s)};this.trigger("select",a)}if(r&&("mouseover"===t.type||ma.isDevice||this.showItemOnClick)){var l=void 0;if(n.classList.contains(yu))l=e.children[this.navIdx.length-1],this.toggleAnimation(l),(u=this.getLIByClass(l,bu))&&u.classList.remove(bu),L(n.parentNode),this.navIdx.pop();else if(!n.classList.contains("e-separator")){var h=!0,c=n.parentNode,d=this.getIdx(c,n);if(!ma.isDevice){var p=this.getIdx(e,c);if(this.navIdx[p]===d&&(h=!1),p!==this.navIdx.length&&("mouseover"!==t.type||h)){var u=this.getLIByClass(c,bu);u&&u.classList.remove(bu),this.closeMenu(p+1,t)}}if(h){var g=this.navIdx.concat(d),m=this.getItem(g);m.items.length?("mouseover"===t.type&&this.setLISelected(n),n.setAttribute("aria-expanded","true"),this.navIdx.push(d),this.openMenu(n,m,null,null,t)):"mouseover"!==t.type&&this.closeMenu(null,t)}}}else"UL"===i.tagName&&i.parentElement===e||n&&n.querySelector(".e-caret")||this.closeMenu(null,t)}},e.prototype.setLISelected=function(t){var e=this.getLIByClass(t.parentElement,bu);e&&e.classList.remove(bu),t.classList.remove(vu),t.classList.add(bu)},e.prototype.getLIByClass=function(t,e){for(var i=0,n=t.children.length;i<n;i++)if(t.children[i].classList.contains(e))return t.children[i];return null},e.prototype.getItem=function(t){var e=(t=t.slice()).pop();return this.getItems(t)[e]},e.prototype.getItems=function(t){for(var e=this.items,i=0;i<t.length;i++)e=e[t[i]].items;return e},e.prototype.getIdx=function(t,e,i){void 0===i&&(i=!0);var n=Array.prototype.indexOf.call(t.children,e);return i&&t.children[0].classList.contains(yu)&&n--,n},e.prototype.getLI=function(t){return"LI"===t.tagName?t:M(t,"li")},e.prototype.onPropertyChanged=function(t,e){for(var i=this.getWrapper(),n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"cssClass":e.cssClass&&i.classList.remove(e.cssClass),t.cssClass&&i.classList.add(t.cssClass);break;case"enableRtl":i.classList.toggle("e-rtl");break;case"filter":this.closeMenu(),this.filter=t.filter;break;case"showItemOnClick":this.unWireEvents(),this.showItemOnClick=t.showItemOnClick,this.wireEvents();break;case"target":this.unWireEvents(),this.target=t.target,this.wireEvents();break;case"items":for(var r=void 0,s=void 0,a=void 0,l=Object.keys(t.items),h=0;h<l.length;h++)(s=this.getChangedItemIndex(t,[],Number(l[h]))).length<=this.getWrapper().children.length&&(r=s.pop(),a=this.getItems(s),this.insertAfter([a[r]],a[r].text),this.removeItem(a,s,r)),s.length=0}},e.prototype.getChangedItemIndex=function(t,e,i){e.push(i);var n=Object.keys(t.items[i]).pop();if("items"===n){var o=t.items[i];this.getChangedItemIndex(o,e,Number(Object.keys(o.items).pop()))}else"isParentArray"===n&&e.length>1&&e.pop();return e},e.prototype.removeItem=function(t,e,i){t.splice(i,1);var n=this.getWrapper().children;e.length<n.length&&L(n[e.length].children[i])},e.prototype.unWireEvents=function(){var t=this.getWrapper();if(this.target){for(var e=void 0,i=void 0,n=A(this.target),o=0,r=n.length;o<r;o++)e=n[o],ma.isIos?(i=f(e,gl))&&i.destroy():ha.remove(e,"contextmenu",this.cmenuHandler);for(var s=0,a=Ce(this.targetElement);s<a.length;s++){var l=a[s];ha.remove(l,"scroll",this.scrollHandler)}}ma.isDevice||(ha.remove(t,"mouseover",this.moverHandler),ha.remove(document,"mousedown",this.mouseDownHandler)),ha.remove(document,"click",this.delegateClickHandler);var h=f(t,ll);h&&h.destroy()},e.prototype.toggleAnimation=function(t,e){var i=this;void 0===e&&(e=!0),"None"!==this.animationSettings.effect&&e?this.animation.animate(t,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:function(t){t.element.style.display="block",t.element.style.maxHeight=t.element.getBoundingClientRect().height+"px"},end:function(t){i.end(t.element,e)}}):this.end(t,e)},e.prototype.end=function(t,e){if(e){t.style.display="block",t.style.maxHeight="";var i=this.navIdx.length?this.getItem(this.navIdx):null,n={element:t,parentItem:i,items:i?i.items:this.items};if(this.trigger("onOpen",n),t.querySelector("."+vu))t.querySelector("."+vu).focus();else{var o=void 0;(o=this.getWrapper().children[this.getIdx(this.getWrapper(),t)-1])?o.querySelector("."+bu).focus():this.element.focus()}}else if(t===this.element){var r=this.getLIByClass(this.element,vu);r&&r.classList.remove(vu);var s=this.getLIByClass(this.element,bu);s&&s.classList.remove(bu),t.style.display="none"}else L(t)},e.prototype.getPersistData=function(){return""},e.prototype.getModuleName=function(){return"contextmenu"},e.prototype.getIndex=function(t,e,i,n,o){void 0===i&&(i=this.items),void 0===n&&(n=[]),void 0===o&&(o=!1);for(var r,s=0,a=i.length;s<a;s++){if(r=i[s],(e?r.id:r.text)===t){n.push(s);break}if(r.items.length){if(-1!==(n=this.getIndex(t,e,r.items,n,!0))[n.length-1]){n.unshift(s);break}s!==a-1&&n.pop()}else s===a-1&&n.push(-1)}return o||-1!==n[0]?n:[]},e.prototype.enableItems=function(t,e,i){void 0===e&&(e=!0);for(var n,o,r,s=this.getWrapper(),a=0;a<t.length;a++)o=(r=this.getIndex(t[a],i)).pop(),(n=s.children[r.length])&&(e?ma.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.remove("e-disabled"):n.children[o].classList.remove("e-disabled"):ma.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.add("e-disabled"):n.children[o].classList.add("e-disabled"))},e.prototype.showItems=function(t,e){this.showHideItems(t,!1,e)},e.prototype.hideItems=function(t,e){this.showHideItems(t,!0,e)},e.prototype.showHideItems=function(t,e,i){for(var n,o,r,s=this.getWrapper(),a=0;a<t.length;a++)o=(r=this.getIndex(t[a],i)).pop(),(n=s.children[r.length])&&(e?ma.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.add(xu):n.children[o].classList.add(xu):ma.isDevice&&!n.classList.contains("e-contextmenu")?n.children[o+1].classList.remove(xu):n.children[o].classList.remove(xu))},e.prototype.removeItems=function(t,e){for(var i,n,o,r=0;r<t.length;r++)i=(n=this.getIndex(t[r],e)).pop(),o=this.getItems(n),this.removeItem(o,n,i)},e.prototype.insertAfter=function(t,e,i){this.insertItems(t,e,i)},e.prototype.insertBefore=function(t,e,i){this.insertItems(t,e,i,!1)},e.prototype.insertItems=function(t,e,i,n){void 0===n&&(n=!0);for(var o,r,s,a,l,h=0;h<t.length;h++){r=(s=this.getIndex(e,i)).pop(),a=this.getItems(s),l=new Cu(a[0],"items",t[h],!0),a.splice(n?r+1:r,0,l);var c=this.getWrapper().children;s.length<c.length&&(r=n?r+1:r,this.hasField(a,"iconCss"),o=this.createItems(a).children[r],c[s.length].insertBefore(o,c[s.length].children[r]))}},e.prototype.destroy=function(){var e=this,i=this.getWrapper();i&&(t.prototype.destroy.call(this),this.unWireEvents(),this.ngElement?this.ngElement.style.display="block":(this.closeMenu(),this.element.innerHTML="",["top","left","display","z-index"].forEach(function(t){e.element.style.removeProperty(t)}),["role","tabindex","class","style"].forEach(function(t){-1!==["class","style"].indexOf(t)&&e.element.getAttribute(t)||e.element.removeAttribute(t)}),i.parentNode.insertBefore(this.element,i)),L(i))},fu([Y("")],e.prototype,"cssClass",void 0),fu([Y("")],e.prototype,"filter",void 0),fu([Y(!1)],e.prototype,"showItemOnClick",void 0),fu([K([],Cu)],e.prototype,"items",void 0),fu([Y("")],e.prototype,"target",void 0),fu([Y({duration:400,easing:"ease",effect:"SlideDown"})],e.prototype,"animationSettings",void 0),fu([J()],e.prototype,"beforeItemRender",void 0),fu([J()],e.prototype,"beforeOpen",void 0),fu([J()],e.prototype,"onOpen",void 0),fu([J()],e.prototype,"beforeClose",void 0),fu([J()],e.prototype,"onClose",void 0),fu([J()],e.prototype,"select",void 0),e=fu([$],e)}(Ka),Eu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Lu="e-tab-header",Tu="e-toolbar-items",ku="e-toolbar-item",Ou="e-toolbar-popup",Au=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Eu(e,t),Pu([Y("SlideLeftIn")],e.prototype,"effect",void 0),Pu([Y(600)],e.prototype,"duration",void 0),Pu([Y("ease")],e.prototype,"easing",void 0),e}(xa),Mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Eu(e,t),Pu([G({effect:"SlideLeftIn",duration:600,easing:"ease"},Au)],e.prototype,"previous",void 0),Pu([G({effect:"SlideRightIn",duration:600,easing:"ease"},Au)],e.prototype,"next",void 0),e}(xa),Iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Eu(e,t),Pu([Y("")],e.prototype,"text",void 0),Pu([Y("")],e.prototype,"iconCss",void 0),Pu([Y("left")],e.prototype,"iconPosition",void 0),e}(xa),Du=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Eu(e,t),Pu([G({},Iu)],e.prototype,"header",void 0),Pu([Y("")],e.prototype,"content",void 0),Pu([Y("")],e.prototype,"cssClass",void 0),Pu([Y(!1)],e.prototype,"disabled",void 0),e}(xa),Ru=(function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.show={name:"SlideDown",duration:100},n.hide={name:"SlideUp",duration:100},n.animateOptions={},n.animObj=new ya(n.animateOptions),n.maxHeight=0,n.title="Close",n.lastIndex=0,n.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},n}Eu(e,t),e.prototype.destroy=function(){var e=this;if(h(this.tbObj)||this.tbObj.destroy(),this.unWireEvents(),["role","aria-disabled","aria-activedescendant","tabindex","aria-orientation"].forEach(function(t){e.element.removeAttribute(t)}),this.expTemplateContent(),this.isTemplate){var i=O(".e-tab > .e-content",this.element);this.element.classList.remove("e-template"),h(i)||(i.innerHTML=this.cnt)}else this.element.innerHTML="";t.prototype.destroy.call(this),this.trigger("destroyed")},e.prototype.preRender=function(){var t=M(this.element,".e-content");this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwipeed=!1,this.itemIndexArray=[],this.templateEle=[],h(t)||(t.parentElement.classList.add("e-nested"),this.isNested=!0);var e=ma.info.name,i="msie"===e?"e-ie":"edge"===e?"e-edge":"safari"===e?"e-safari":"";I(this.element,{width:m(this.width),height:m(this.height)}),this.setCssClass(this.element,this.cssClass,!0),k(this.element,{role:"tablist","aria-disabled":"false","aria-activedescendant":""}),this.setCssClass(this.element,i,!0)},e.prototype.render=function(){this.btnCls=this.createElement("span",{className:"e-icons e-close-icon",attrs:{title:this.title}}),this.renderContainer(),this.wireEvents(),this.initRender=!1},e.prototype.renderContainer=function(){var t=this.element;if(this.items.length>0&&0===t.children.length)t.appendChild(this.createElement("div",{className:"e-content"})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:Lu})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,t.classList.add("e-template");var e=t.querySelector(".e-tab-header");e&&"Bottom"===this.headerPlacement&&this.setOrientation(this.headerPlacement,e)}if(!h(O(".e-tab-header",this.element))&&!h(O(".e-content",this.element))){if(this.renderHeader(),this.tbItems=O(".e-tab-header ."+Tu,this.element),h(this.tbItems)||it(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),A("."+ku,this.element).length>0){this.tbItems=O(".e-tab-header ."+Tu,this.element),this.bdrLine=this.createElement("div",{className:"e-indicator e-hidden e-ignore"});var i=O(".e-hscroll-content",this.tbItems);h(i)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):i.insertBefore(this.bdrLine,i.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}this.setRTL(this.enableRtl)}},e.prototype.renderHeader=function(){var t=this,e=[];if(this.hdrEle=O(".e-tab-header",this.element),this.isTemplate){for(var i=this.hdrEle.children.length,n=[],o=0;o<i;o++)n.push(this.hdrEle.children.item(o).innerHTML);i>0&&(this.hdrEle.innerHTML="",this.hdrEle.appendChild(this.createElement("div",{className:"e-items"})),n.forEach(function(e,i){t.lastIndex=i;var n={className:"e-item",id:"e-item_"+i,attrs:{role:"tab","aria-controls":"e-content_"+i,"aria-selected":"false"}},o=t.createElement("span",{className:"e-tab-text",innerHTML:e,attrs:{role:"presentation"}}).outerHTML,r=t.createElement("div",{className:"e-text-wrap",innerHTML:o+t.btnCls.outerHTML}).outerHTML,s=t.createElement("div",{className:"e-tab-wrap",innerHTML:r,attrs:{tabIndex:"-1"}});O(".e-items",t.element).appendChild(t.createElement("div",n)),A(".e-item",t.element)[i].appendChild(s)}))}else e=this.parseObject(this.items,0);this.tbObj=new Qp({width:"100%",overflowMode:this.overflowMode,items:0!==e.length?e:[],clicked:this.clickHandler.bind(this)}),this.tbObj.appendTo(this.hdrEle),k(this.element,{"aria-orientation":"horizontal"}),this.setCloseButton(this.showCloseButton),this.setProperties({headerPlacement:this.element.children.item(0).classList.contains(Lu)?"Top":"Bottom"},!0)},e.prototype.renderContent=function(){this.cntEle=O(".e-content",this.element);var t=A("."+ku,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var e=this.cntEle.children,i=0;i<t.length;i++)e.length-1>=i&&(e.item(i).className+="e-item",k(e.item(i),{role:"tabpanel","aria-labelledby":"e-item_"+i}),e.item(i).id="e-content_"+i)}},e.prototype.reRenderItems=function(){this.renderContainer(),h(this.cntEle)||(this.touchModule=new gl(this.cntEle,{swipe:this.swipeHandler.bind(this)}))},e.prototype.parseObject=function(t,e){var i,n=this,o=A("."+ku,this.element).length,r=[];return t.forEach(function(t,s){if(h(t.header)||h(t.header.text))return void n.items.splice(s,0);var a=h(t.header.iconPosition)?"":t.header.iconPosition,l=h(t.header.iconCss)?"":t.header.iconCss,c=t.header.text;n.lastIndex=0===o?s:n.isReplace?e+s:n.lastIndex+1;var d=t.disabled?" e-disable e-overlay":"";i=n.createElement("div",{className:"e-tab-text",attrs:{role:"presentation"}});var p=c instanceof Object?c.outerHTML:c,u=!h(p)&&""!==p;h(c.tagName)?n.headerTextCompile(i,c):i.appendChild(c);var g=n.createElement("span",{className:"e-icons e-tab-icon e-icon-"+a+" "+l}),m=n.createElement("div",{className:"e-text-wrap"});if(m.appendChild(i),""!==c&&void 0!==c||""!==l){""!==c&&void 0!==c&&""!==l?("left"===a||"top"===a?m.insertBefore(g,m.firstElementChild):m.appendChild(g),i):(""===l?i:g)===g&&(L(i),m.appendChild(g));var f=t.disabled?{}:{tabIndex:"-1"};m.appendChild(n.btnCls.cloneNode(!0));var v=n.createElement("div",{className:"e-tab-wrap",attrs:f});v.appendChild(m),n.itemIndexArray===[]?n.itemIndexArray.push("e-item_"+n.lastIndex):n.itemIndexArray.splice(e+s,0,"e-item_"+n.lastIndex);var y={htmlAttributes:{id:"e-item_"+n.lastIndex,role:"tab","aria-selected":"false"},template:v};y.cssClass=t.cssClass+" "+d+" "+(""!==l?"e-i"+a:"")+" "+(u?"":"e-icon"),"top"!==a&&"bottom"!==a||n.element.classList.add("e-vertical-icon"),r.push(y)}}),r},e.prototype.removeActiveClass=function(t){var e=A(":root .e-tab-header .e-toolbar-item.e-active",this.element)[0];if("Bottom"===this.headerPlacement&&(e=A(":root .e-tab-header .e-toolbar-item.e-active",this.element.children[1])[0]),!h(e)){e.classList.remove("e-active");var i=this.extIndex(e.id);this.findEle(O(".e-content",this.element).children,"e-content_"+i)}},e.prototype.checkPopupOverflow=function(t){this.tbPop=O(".e-toolbar-pop",this.element);var e=O(".e-hor-nav",this.element),i=O("."+Tu,this.element);return(this.enableRtl&&e.offsetLeft+e.offsetWidth>i.offsetLeft||!this.enableRtl&&e.offsetLeft<i.offsetWidth)&&(t.classList.add(Ou),this.tbPop.insertBefore(t.cloneNode(!0),A("."+Ou,this.tbPop)[0]),t.outerHTML=""),!0},e.prototype.popupHandler=function(t){var e=t.querySelector(".e-ripple-element");h(e)||(e.outerHTML="",t.querySelector(".e-tab-wrap").classList.remove("e-ripple")),this.tbItem=A(".e-toolbar-items ."+ku,this.hdrEle);var i=this.tbItem[this.tbItem.length-1];if(0!==this.tbItem.length){if(t.classList.remove(Ou),this.tbItems.appendChild(t.cloneNode(!0)),this.actEleId=t.id,t.outerHTML="",this.checkPopupOverflow(i)){var n=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(n)}this.isPopup=!0}return A("."+ku,this.tbItems).length-1},e.prototype.setCloseButton=function(t){var e=O(".e-tab-header",this.element);!0===t?e.classList.add("e-close-show"):e.classList.remove("e-close-show"),this.tbObj.refreshOverflow(),this.refreshActElePosition()},e.prototype.prevCtnAnimation=function(t,e){this.enableRtl||this.element.classList.contains("e-rtl");return this.isPopup||t<=e?"SlideLeftIn"===this.animation.previous.effect?{name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:null:"SlideRightIn"===this.animation.next.effect?{name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:null},e.prototype.triggerPrevAnimation=function(t,e){var i=this,n=this.prevCtnAnimation(e,this.selectedItem);h(n)?t.classList.remove("e-active"):(n.begin=function(){I(t,{position:"absolute"}),t.classList.add("e-progress"),t.classList.add("e-view")},n.end=function(){t.style.display="none",t.classList.remove("e-active"),t.classList.remove("e-progress"),t.classList.remove("e-view"),I(t,{display:"",position:""}),0!==t.childNodes.length||i.isTemplate||L(t)},new ya(n).animate(t))},e.prototype.triggerAnimation=function(t,e){var i,n=this,o=this.prevIndex;[].slice.call(this.element.querySelector(".e-content").children).forEach(function(t){t.id===n.prevActiveEle&&(i=t)});var r=this.tbItem[o],s=this.extIndex(this.tbItem[this.selectedItem].id),a=this.getTrgContent(this.cntEle,s);if(h(i)&&!h(r)){var l=this.extIndex(r.id);i=this.getTrgContent(this.cntEle,l)}if(this.prevActiveEle=a.id,this.initRender||!1===e||this.animation==={}||h(this.animation))return void(i&&i!==a&&i.classList.remove("e-active"));var c,d=O(".e-content",this.element);if(this.prevIndex>this.selectedItem&&!this.isPopup){var p=this.animation.previous.effect;c={name:"None"===p?"":"SlideLeftIn"!==p?p:"SlideLeftIn",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var u=this.animation.next.effect;c={name:"None"===u?"":"SlideRightIn"!==u?u:"SlideRightIn",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}}c.progress=function(){d.classList.add("e-progress"),n.setActiveBorder()},c.end=function(){d.classList.remove("e-progress"),a.classList.add("e-active")},this.initRender||h(i)||this.triggerPrevAnimation(i,o),this.isPopup=!1,""===c.name?a.classList.add("e-active"):new ya(c).animate(a)},e.prototype.keyPressed=function(t){var e=M(t,".e-tab-header ."+ku),i=this.getEleIndex(e);!h(this.popEle)&&t.classList.contains("e-hor-nav")?this.popEle.classList.contains("e-popup-open")?this.popObj.hide(this.hide):this.popObj.show(this.show):t.classList.contains("e-scroll-nav")?t.click():h(e)||!1!==e.classList.contains("e-active")||(this.select(i),h(this.popEle)||this.popObj.hide(this.hide))},e.prototype.getEleIndex=function(t){return Array.prototype.indexOf.call(A(".e-tab-header ."+ku,this.element),t)},e.prototype.extIndex=function(t){return t.replace("e-item_","")},e.prototype.expTemplateContent=function(){var t=this;this.templateEle.forEach(function(e){h(t.element.querySelector(e))||(document.body.appendChild(t.element.querySelector(e)).style.display="none")})},e.prototype.templateCompile=function(t,e){var i=this.createElement("div");this.compileElement(i,e,"content"),0!==i.childNodes.length&&t.appendChild(i)},e.prototype.compileElement=function(t,e,i){"string"==typeof e&&(e=e.trim());var n,o=pt(e);h(o)||(n=o({},this,i)),!h(o)&&n.length>0&&[].slice.call(n).forEach(function(e){t.appendChild(e)})},e.prototype.headerTextCompile=function(t,e){this.compileElement(t,e,"headerText")},e.prototype.getContent=function(t,e,i){var n;if("string"==typeof e||h(e.innerHTML))if("."===e[0]||"#"===e[0])if(document.querySelectorAll(e).length){var o=document.querySelector(e);n=o.outerHTML.trim(),"clone"===i?t.appendChild(o.cloneNode(!0)):(t.appendChild(o),o.style.display="")}else this.templateCompile(t,e);else this.templateCompile(t,e);else t.appendChild(e);h(n)||-1===this.templateEle.indexOf(e.toString())&&this.templateEle.push(e.toString())},e.prototype.getTrgContent=function(t,e){return this.element.classList.contains("e-nested")?O(".e-nested> .e-content > #e-content_"+e,this.element):this.findEle(t.children,"e-content_"+e)},e.prototype.findEle=function(t,e){for(var i,n=0;n<t.length;n++)if(t[n].id===e){i=t[n];break}return i},e.prototype.setOrientation=function(t,e){"Bottom"===t?this.element.appendChild(e):this.element.insertBefore(e,O(".e-content",this.element))},e.prototype.setCssClass=function(t,e,i){if(""!==e)for(var n=e.split(" "),o=0;o<n.length;o++)i?t.classList.add(n[o]):t.classList.remove(n[o])},e.prototype.setContentHeight=function(t){if(!h(this.cntEle)){var e=O(".e-tab-header",this.element);if("None"===this.heightAdjustMode){if("auto"===this.height)return;I(this.cntEle,{height:this.element.offsetHeight-e.offsetHeight+"px"})}else if("Fill"===this.heightAdjustMode)I(this.element,{height:"100%"}),I(this.cntEle,{height:"auto"});else if("Auto"===this.heightAdjustMode){var i=A(".e-content > .e-item",this.element);if(!0===this.isTemplate)for(o=0;o<i.length;o++)i[o].setAttribute("style","display:block; visibility: visible"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(i[o])),i[o].style.removeProperty("display"),i[o].style.removeProperty("visibility");else{this.cntEle=O(".e-content",this.element),!0===t&&this.cntEle.appendChild(this.createElement("div",{id:"e-content_0",className:"e-item e-active",attrs:{role:"tabpanel","aria-labelledby":"e-item_0"}}));for(var n=this.cntEle.children.item(0),o=0;o<this.items.length;o++)this.getContent(n,this.items[o].content,"clone"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(n)),n.innerHTML="";this.templateEle=[],this.getContent(n,this.items[0].content,"render"),n.classList.remove("e-active")}I(this.cntEle,{height:this.maxHeight+"px"})}else I(this.cntEle,{height:"auto"})}},e.prototype.getHeight=function(t){var e=window.getComputedStyle(t);return t.offsetHeight+parseFloat(e.getPropertyValue("padding-top"))+parseFloat(e.getPropertyValue("padding-bottom"))+parseFloat(e.getPropertyValue("margin-top"))+parseFloat(e.getPropertyValue("margin-bottom"))},e.prototype.setActiveBorder=function(){var t=O(".e-toolbar-item.e-active",this.element);if("Bottom"===this.headerPlacement&&(t=O(".e-toolbar-item.e-active",this.element.children[1])),null!==t){var e=M(t,".e-tab");if(this.element===e){var i=O(".e-tab-header .e-toolbar-items .e-hscroll-content",this.element.children[0]);this.tbItems=O(".e-tab-header ."+Tu,this.element);var n=O(".e-tab-header .e-indicator",this.element);"Bottom"===this.headerPlacement&&(i=O(".e-tab-header .e-toolbar-items .e-hscroll-content",this.element.children[1]));var o=h(i)?this.tbItems.offsetWidth:i.offsetWidth;0!==o?I(n,{left:t.offsetLeft+"px",right:o-(t.offsetLeft+t.offsetWidth)+"px"}):I(n,{left:"auto",right:"auto"}),h(this.bdrLine)||this.bdrLine.classList.remove("e-hidden")}}},e.prototype.setActive=function(t){this.tbItem=A(".e-tab-header ."+ku,this.element);var e=this.tbItem[t];if(t>=0&&this.setProperties({selectedItem:t},!0),!(t<0||isNaN(t)||0===this.tbItem.length)){if(e.classList.contains("e-active"))return void this.setActiveBorder();if(!this.isTemplate){var i=this.tbItem[this.prevIndex];h(i)||i.removeAttribute("aria-controls"),k(e,{"aria-controls":"e-content_"+t})}var n=e.id;this.removeActiveClass(n),e.classList.add("e-active"),e.setAttribute("aria-selected","true");var o=Number(this.extIndex(n));if(h(this.prevActiveEle)&&(this.prevActiveEle="e-content_"+o),k(this.element,{"aria-activedescendant":n}),this.isTemplate){if(O(".e-content",this.element).children.length>0){var r=this.findEle(O(".e-content",this.element).children,"e-content_"+o);h(r)||r.classList.add("e-active"),this.triggerAnimation(n,this.enableAnimation)}}else{this.cntEle=O(".e-tab > .e-content",this.element);var s=this.getTrgContent(this.cntEle,this.extIndex(n));if(h(s)){this.cntEle.appendChild(this.createElement("div",{id:"e-content_"+this.extIndex(n),className:"e-item e-active",attrs:{role:"tabpanel","aria-labelledby":"e-item_"+this.extIndex(n)}}));var a=this.getTrgContent(this.cntEle,this.extIndex(n)),l=Array.prototype.indexOf.call(this.itemIndexArray,e.id);this.getContent(a,this.items[l].content,"render")}else s.classList.add("e-active");this.triggerAnimation(n,this.enableAnimation)}this.setActiveBorder();var c=O(".e-tab-header #"+n,this.element);this.refreshItemVisibility(c),c.firstChild.focus();var d={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:e,selectedIndex:t,isSwiped:this.isSwipeed};this.initRender&&0===this.selectedItem||this.trigger("selected",d)}},e.prototype.setItems=function(t){this.isReplace=!0,this.tbItems=O(".e-tab-header ."+Tu,this.element),this.tbObj.items=this.parseObject(t,0),this.tbObj.dataBind(),this.isReplace=!1},e.prototype.setRTL=function(t){this.tbObj.enableRtl=t,this.tbObj.dataBind(),this.setCssClass(this.element,"e-rtl",t),this.refreshActiveBorder()},e.prototype.refreshActiveBorder=function(){h(this.bdrLine)||this.bdrLine.classList.add("e-hidden"),this.setActiveBorder()},e.prototype.wireEvents=function(){window.addEventListener("resize",this.refreshActElePosition.bind(this)),ha.add(this.element,"mouseover",this.hoverHandler,this),ha.add(this.element,"keydown",this.spaceKeyDown,this),h(this.cntEle)||(this.touchModule=new gl(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new ll(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new ll(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},e.prototype.unWireEvents=function(){this.keyModule.destroy(),this.tabKeyModule.destroy(),h(this.cntEle)||this.touchModule.destroy(),window.removeEventListener("resize",this.refreshActElePosition.bind(this)),this.element.removeEventListener("mouseover",this.hoverHandler.bind(this))},e.prototype.clickHandler=function(t){this.element.classList.remove("e-focused");var e=t.originalEvent.target,i=M(e,"."+ku),n=this.getEleIndex(i);e.classList.contains("e-close-icon")?this.removeTab(n):(this.isPopup=!1,h(i)||n===this.selectedItem||this.select(n))},e.prototype.swipeHandler=function(t){if(!(t.velocity<3&&h(t.originalEvent.changedTouches))){if(this.isSwipeed=!0,"Right"===t.swipeDirection&&0!==this.selectedItem){for(var e=this.selectedItem-1;e>=0;e--)if(!this.tbItem[e].classList.contains("e-hidden")){this.select(e);break}}else if("Left"===t.swipeDirection&&this.selectedItem!==A("."+ku,this.element).length-1)for(var i=this.selectedItem+1;i<this.tbItem.length;i++)if(!this.tbItem[i].classList.contains("e-hidden")){this.select(i);break}this.isSwipeed=!1}},e.prototype.spaceKeyDown=function(t){(32===t.keyCode&&32===t.which||35===t.keyCode&&35===t.which)&&(h(M(t.target,".e-tab-header"))||t.preventDefault())},e.prototype.keyHandler=function(t){if(!this.element.classList.contains("e-disable")){this.element.classList.add("e-focused");var e=t.target,i=O(".e-tab-header .e-active",this.element);A(".e-toolbar-item:not(.e-toolbar-popup)",this.element);switch(this.popEle=O(".e-toolbar-pop",this.element),h(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]),t.action){case"space":case"enter":if(e.parentElement.classList.contains("e-disable"))return;if("enter"===t.action&&e.classList.contains("e-hor-nav"))break;this.keyPressed(e);break;case"tab":case"shiftTab":e.classList.contains("e-tab-wrap")&&!1===M(e,"."+ku).classList.contains("e-active")&&e.setAttribute("tabindex","-1"),this.popObj&&S(this.popObj.element)&&this.popObj.hide(this.hide),i.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":var n=M(document.activeElement,"."+ku);h(n)||this.refreshItemVisibility(n);break;case"openPopup":t.preventDefault(),!h(this.popEle)&&this.popEle.classList.contains("e-popup-close")&&this.popObj.show(this.show);break;case"delete":var o=M(e,"."+ku);if(!0===this.showCloseButton&&!h(o)){var r=o.nextSibling;!h(r)&&r.classList.contains(ku)&&r.firstChild.focus(),this.removeTab(this.getEleIndex(o))}this.setActiveBorder()}}},e.prototype.refreshActElePosition=function(){var t=O(".e-toolbar-item.e-toolbar-popup.e-active",this.element);h(t)||this.select(this.getEleIndex(t)),this.refreshActiveBorder()},e.prototype.refreshItemVisibility=function(t){if(!h(O(".e-hscroll-content",this.tbItems))){var e=O(".e-hscroll-bar",this.tbItems),i=e.scrollLeft,n=i+e.offsetWidth,o=t.offsetLeft,r=t.offsetWidth,s=t.offsetLeft+t.offsetWidth;if(i<o&&n<s){a=n-o;e.scrollLeft=i+(r-a)}else if(i>o&&n>s){var a=s-i;e.scrollLeft=i-(r-a)}}},e.prototype.hoverHandler=function(t){var e=t.target;!h(e.classList)&&e.classList.contains("e-close-icon")&&e.setAttribute("title",new hl("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},e.prototype.enableTab=function(t,e){var i=A("."+ku,this.element)[t];h(i)||(!0===e?(i.classList.remove("e-disable","e-overlay"),i.firstChild.setAttribute("tabindex","-1")):(i.classList.add("e-disable","e-overlay"),i.firstChild.removeAttribute("tabindex"),i.classList.contains("e-active")&&this.select(t+1)),i.setAttribute("aria-disabled",!0===e?"false":"true"))},e.prototype.addTab=function(t,e){var i=this,n=0;if(this.isReplace||this.trigger("adding",{addedItems:t}),this.hdrEle=O(".e-tab-header",this.element),h(this.hdrEle))return this.items=t,void this.reRenderItems();var o=A("."+ku,this.element).length;if(0!==o&&(n=this.lastIndex+1),h(e)&&(e=o-1),!(o<e||e<0||isNaN(e))){0!==o||h(this.hdrEle)||(this.hdrEle.style.display=""),h(this.bdrLine)||this.bdrLine.classList.add("e-hidden"),this.tbItems=O(".e-tab-header ."+Tu,this.element);var r=this.parseObject(t,e);t.forEach(function(t,o){if(i.items.splice(e+o,0,t),i.isTemplate&&!h(t.header)&&!h(t.header.text)){var r=n+o,s=i.createElement("div",{id:"e-content_"+r,className:"e-item",attrs:{role:"tabpanel","aria-labelledby":"e-item_"+r}});i.cntEle.insertBefore(s,i.cntEle.children[e+o]);var a=i.getTrgContent(i.cntEle,r.toString());i.getContent(a,t.content,"render")}}),this.tbObj.addItems(r,e),this.isReplace||this.trigger("added",{addedItems:t}),this.selectedItem===e?this.select(e):this.setActiveBorder()}},e.prototype.removeTab=function(t){var e=A("."+ku,this.element)[t],i={removedItem:e,removedIndex:t};if(this.trigger("removing",i),!h(e)){this.tbObj.removeItems(t),this.items.splice(t,1),this.itemIndexArray.splice(t,1),this.refreshActiveBorder();var n=O("#e-content_"+this.extIndex(e.id),O(".e-content",this.element));h(n)||L(n),this.trigger("removed",i),e.classList.contains("e-active")&&(t=t>A(".e-toolbar-item:not(.e-toolbar-popup)",this.element).length-1?t-1:t,this.enableAnimation=!1,this.selectedItem=t,this.select(t)),0===A("."+ku,this.element).length&&(this.hdrEle.style.display="none"),this.enableAnimation=!0}},e.prototype.hideTab=function(t,e){var i=A("."+ku,this.element)[t];if(!h(i)){if(h(e)&&(e=!0),this.bdrLine.classList.add("e-hidden"),!0===e){if(i.classList.add("e-hidden"),i.classList.contains("e-active"))if(0!==t)for(var n=t-1;n>=0;n--){if(!this.tbItem[n].classList.contains("e-hidden")){this.select(n);break}if(0===n)for(o=t+1;o<this.tbItem.length;o++)if(!this.tbItem[o].classList.contains("e-hidden")){this.select(o);break}}else for(var o=t+1;o<this.tbItem.length;o++)if(!this.tbItem[o].classList.contains("e-hidden")){this.select(o);break}}else i.classList.remove("e-hidden");this.setActiveBorder(),i.setAttribute("aria-hidden",""+e)}},e.prototype.select=function(t){this.tbItems=O(".e-tab-header ."+Tu,this.element),this.tbItem=A(".e-tab-header ."+ku,this.element),this.prevItem=this.tbItem[this.prevIndex];var e=this.tbItem[t];h(this.prevItem)||this.prevItem.classList.contains("e-disable")||this.prevItem.children.item(0).setAttribute("tabindex","-1");var i={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectingItem:e,selectingIndex:t,isSwiped:this.isSwipeed};if(this.initRender&&0===this.selectedItem||this.trigger("selecting",i),!i.cancel)if("number"==typeof t){if(!h(this.tbItem[t])&&this.tbItem[t].classList.contains("e-disable"))for(n=t+1;n<this.items.length;n++){if(!1===this.items[n].disabled){t=n;break}t=0}if(this.tbItem.length>t&&t>=0&&!isNaN(t)){if(this.tbItem[this.selectedItem].classList.contains("e-hidden")){for(var n=this.selectedItem;n>=0;n--)if(!this.tbItem[n].classList.contains("e-hidden")){this.prevIndex=n;break}}else this.prevIndex=this.selectedItem;this.tbItem[t].classList.contains(Ou)?this.setActive(this.popupHandler(this.tbItem[t])):this.setActive(t)}else this.setActive(0)}else t instanceof HTMLElement&&this.setActive(this.getEleIndex(t))},e.prototype.disable=function(t){this.setCssClass(this.element,"e-disable",t),this.element.setAttribute("aria-disabled",""+t)},e.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},e.prototype.getModuleName=function(){return"tab"},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"width":I(this.element,{width:m(t.width)});break;case"height":I(this.element,{height:m(t.height)}),this.setContentHeight(!1);break;case"cssClass":this.setCssClass(this.element,t.cssClass,!0);break;case"items":if(t.items instanceof Array&&e.items instanceof Array)this.lastIndex=0,h(this.tbObj)?this.reRenderItems():(this.setItems(t.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[],O(".e-tab > .e-content",this.element).innerHTML="",this.select(this.selectedItem));else for(var o=Object.keys(t.items),r=0;r<o.length;r++){var s=parseInt(Object.keys(t.items)[r],10),a=Object.keys(t.items[s])[0],l=Object(e.items[s])[a],c=Object(t.items[s])[a],d=O(".e-toolbar-items #e-item_"+s,this.element),p=O(".e-content #e-content_"+s,this.element);if("header"===a){var u=[];u.push(this.items[s]),this.items.splice(s,1),this.itemIndexArray.splice(s,1),this.tbObj.items.splice(s,1);var g=d.classList.contains("e-hidden");L(d),this.isReplace=!0,this.addTab(u,s),g&&this.hideTab(s),this.isReplace=!1}if("content"===a&&!h(p))if(("string"==typeof c||h(c.innerHTML))&&("."===c[0]||"#"===c[0])&&c.length){var f=document.querySelector(c);p.appendChild(f),f.style.display=""}else""===c&&"#"===l[0]?(document.body.appendChild(this.element.querySelector(l)).style.display="none",p.innerHTML=c):p.innerHTML=c;"cssClass"===a&&(h(d)||(d.classList.remove(l),d.classList.add(c)),h(p)||(p.classList.remove(l),p.classList.add(c))),"disabled"===a&&this.enableTab(s,!0!==c)}break;case"showCloseButton":this.setCloseButton(t.showCloseButton);break;case"selectedItem":this.selectedItem=e.selectedItem,this.select(t.selectedItem);break;case"headerPlacement":var v=O(".e-tab-header",this.element);this.setOrientation(t.headerPlacement,v),this.select(this.selectedItem);break;case"enableRtl":this.setRTL(t.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=t.overflowMode,this.tbObj.dataBind(),this.refreshActElePosition();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem)}},Pu([K([],Du)],e.prototype,"items",void 0),Pu([Y("100%")],e.prototype,"width",void 0),Pu([Y("auto")],e.prototype,"height",void 0),Pu([Y("")],e.prototype,"cssClass",void 0),Pu([Y(0)],e.prototype,"selectedItem",void 0),Pu([Y("Top")],e.prototype,"headerPlacement",void 0),Pu([Y("Content")],e.prototype,"heightAdjustMode",void 0),Pu([Y("Scrollable")],e.prototype,"overflowMode",void 0),Pu([Y(!1)],e.prototype,"enableRtl",void 0),Pu([Y(!1)],e.prototype,"enablePersistence",void 0),Pu([Y(!1)],e.prototype,"showCloseButton",void 0),Pu([G({},Mu)],e.prototype,"animation",void 0),Pu([J()],e.prototype,"created",void 0),Pu([J()],e.prototype,"adding",void 0),Pu([J()],e.prototype,"added",void 0),Pu([J()],e.prototype,"selecting",void 0),Pu([J()],e.prototype,"selected",void 0),Pu([J()],e.prototype,"removing",void 0),Pu([J()],e.prototype,"removed",void 0),Pu([J()],e.prototype,"destroyed",void 0),e=Pu([$],e)}(Ka),{RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"});!function(t){function e(t,e){var i=h(e)?b:e,n={container:null,buttons:[],clearButton:null};if(h(t.floatLabelType)||"Never"===t.floatLabelType?(n.container=m(t,Ru.INPUTGROUP,Ru.INPUTCUSTOMTAG,"span",i),t.element.parentNode.insertBefore(n.container,t.element),w([t.element],Ru.INPUT),n.container.appendChild(t.element)):s(t,n,i),t.element.addEventListener("focus",function(){var t=d(this);t.classList.contains("e-input-group")&&t.classList.add("e-input-focus")}),t.element.addEventListener("blur",function(){var t=d(this);t.classList.contains("e-input-group")&&t.classList.remove("e-input-focus")}),h(t.properties)||h(t.properties.showClearButton)||!t.properties.showClearButton||(P(t.properties.showClearButton,t.element,n,!0,i),n.container.classList.contains(Ru.FLOATINPUT)&&w([n.container],Ru.INPUTGROUP)),!h(t.buttons))for(var o=0;o<t.buttons.length;o++)n.buttons.push(j(t.buttons[o],n.container,i));return n=a(t,n)}function i(){var t=d(this).getElementsByClassName("e-float-text")[0];w([t],Ru.LABELTOP),t.classList.contains(Ru.LABELBOTTOM)&&x([t],Ru.LABELBOTTOM)}function n(){var t=d(this);if(""===t.getElementsByTagName("input")[0].value){var e=t.getElementsByClassName("e-float-text")[0];e.classList.contains(Ru.LABELTOP)&&x([e],Ru.LABELTOP),w([e],Ru.LABELBOTTOM)}}function o(t){t.addEventListener("focus",i),t.addEventListener("blur",n)}function r(t){t.removeEventListener("focus",i),t.removeEventListener("blur",n)}function s(t,e,i){var n,r,s=h(i)?b:i;"Auto"===t.floatLabelType&&o(t.element),h(e.container)?(e.container=m(t,Ru.FLOATINPUT,Ru.FLOATCUSTOMTAG,"div",s),t.element.parentNode.insertBefore(e.container,t.element)):(h(t.customTag)||e.container.classList.add(Ru.FLOATCUSTOMTAG),e.container.classList.add(Ru.FLOATINPUT)),n=s("span",{className:Ru.FLOATLINE}),r=s("label",{className:Ru.FLOATTEXT}),h(t.element.id)||""===t.element.id||(r.id="label_"+t.element.id.replace(/ /g,"_"),k(t.element,{"aria-labelledby":r.id})),h(t.element.placeholder)||""===t.element.placeholder||(r.innerHTML=t.element.placeholder,t.element.removeAttribute("placeholder")),h(t.properties)||h(t.properties.placeholder)||""===t.properties.placeholder||(r.innerHTML=t.properties.placeholder),r.innerHTML||e.container.classList.add(Ru.NOFLOATLABEL),e.container.appendChild(t.element),e.container.appendChild(n),e.container.appendChild(r),c(t.element.value,r),"Always"===t.floatLabelType&&(r.classList.contains(Ru.LABELBOTTOM)&&x([r],Ru.LABELBOTTOM),w([r],Ru.LABELTOP)),"Auto"===t.floatLabelType&&(t.element.addEventListener("input",function(e){c(t.element.value,r)}),t.element.addEventListener("blur",function(e){c(t.element.value,r)}))}function a(t,e){if(!h(t.properties))for(var i=0,n=Object.keys(t.properties);i<n.length;i++)switch(n[i]){case"cssClass":v(t.properties.cssClass,[e.container]);break;case"enabled":E(t.properties.enabled,t.element);break;case"enableRtl":S(t.properties.enableRtl,[e.container]);break;case"placeholder":y(t.properties.placeholder,t.element);break;case"readonly":C(t.properties.readonly,t.element)}return e}function l(t,e){t?x([e],Ru.CLEARICONHIDE):w([e],Ru.CLEARICONHIDE)}function c(t,e){t?(w([e],Ru.LABELTOP),e.classList.contains(Ru.LABELBOTTOM)&&x([e],Ru.LABELBOTTOM)):(e.classList.contains(Ru.LABELTOP)&&x([e],Ru.LABELTOP),w([e],Ru.LABELBOTTOM))}function d(t){return t.parentNode}function p(t,e,i,n){var o=(h(n)?b:n)("span",{className:Ru.CLEARICON}),r=e.container;return h(i)?(e.container.classList.contains(Ru.FLOATINPUT)?e.container.querySelector("."+Ru.FLOATTEXT):t).insertAdjacentElement("afterend",o):r.appendChild(o),!h(r)&&r.classList.contains(Ru.FLOATINPUT)&&w([r],Ru.INPUTGROUP),w([o],Ru.CLEARICONHIDE),u(t,o,r),o}function u(t,e,i){e.addEventListener("click",function(i){t.classList.contains(Ru.DISABLE)||t.readOnly||(i.preventDefault(),t!==document.activeElement&&t.focus(),t.value="",w([e],Ru.CLEARICONHIDE))}),t.addEventListener("input",function(i){l(t.value,e)}),t.addEventListener("focus",function(i){l(t.value,e)}),t.addEventListener("blur",function(t){setTimeout(function(){w([e],Ru.CLEARICONHIDE)},200)})}function g(t,e){if(d(t).classList.contains(Ru.FLOATINPUT)&&"Auto"===e){var i=d(t).getElementsByClassName("e-float-text")[0];c(t.value,i)}}function m(t,e,i,n,o){var r,s=h(o)?b:o;return h(t.customTag)?r=s(n,{className:e}):(r=s(t.customTag,{className:e})).classList.add(i),r.classList.add("e-control-wrapper"),r}function f(t,e,i,n){if(e.value=t,h(i)||"Auto"!==i||g(e,i),!h(n)&&n){var o=d(e),r=o.getElementsByClassName(Ru.CLEARICON)[0];e.value&&o.classList.contains("e-input-focus")?x([r],Ru.CLEARICONHIDE):w([r],Ru.CLEARICONHIDE)}}function v(t,e,i){h(i)||""===i||x(e,i),h(t)||""===t||w(e,t)}function y(t,e){var i;(i=d(e)).classList.contains(Ru.FLOATINPUT)?h(t)||""===t?(i.classList.add(Ru.NOFLOATLABEL),i.getElementsByClassName(Ru.FLOATTEXT)[0].textContent=""):(i.getElementsByClassName(Ru.FLOATTEXT)[0].textContent=t,i.classList.remove(Ru.NOFLOATLABEL)):h(t)||""===t?(e.removeAttribute("placeholder"),e.removeAttribute("aria-placeholder")):k(e,{placeholder:t,"aria-placeholder":t})}function C(t,e,i){t?k(e,{readonly:""}):e.removeAttribute("readonly"),h(i)||g(e,i)}function S(t,e){t?w(e,Ru.RTL):x(e,Ru.RTL)}function E(t,e,i){var n={disabled:"disabled","aria-disabled":"true"};t?(e.classList.remove(Ru.DISABLE),T(n,e)):(e.classList.add(Ru.DISABLE),O(n,e)),h(i)||g(e,i)}function P(t,e,i,n,o){var r=h(o)?b:o;t?i.clearButton=p(e,i,n,r):(i.clearButton.remove(),i.clearButton=null)}function T(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i],r=void 0;r=d(e),"disabled"===o&&e.classList.remove(Ru.DISABLE),"disabled"===o&&r.classList.contains(Ru.INPUTGROUP)&&r.classList.remove(Ru.DISABLE),"placeholder"===o&&r.classList.contains(Ru.FLOATINPUT)?r.getElementsByClassName(Ru.FLOATTEXT)[0].textContent="":e.removeAttribute(o)}}function O(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++){var o=n[i],r=void 0;r=d(e),"disabled"===o&&e.classList.add(Ru.DISABLE),"disabled"===o&&r.classList.contains(Ru.INPUTGROUP)&&r.classList.add(Ru.DISABLE),"placeholder"===o&&r.classList.contains(Ru.FLOATINPUT)?r.getElementsByClassName(Ru.FLOATTEXT)[0].textContent=t[o]:e.setAttribute(o,t[o])}}function A(t){var e=t.container;if(!h(e)&&e.classList.contains(Ru.FLOATINPUT)){var i=e.querySelector("input"),n=e.querySelector("."+Ru.FLOATTEXT).textContent,o=null!==e.querySelector(".e-clear-icon");L(e.querySelector("."+Ru.FLOATLINE)),L(e.querySelector("."+Ru.FLOATTEXT)),D(e,[Ru.INPUTGROUP],[Ru.FLOATINPUT]),r(i),k(i,{placeholder:n}),i.classList.add(Ru.INPUT),o||i.removeAttribute("required")}}function I(t,e,i,n){var o=h(n)?b:n,r=M(t,"."+Ru.INPUTGROUP);if("Never"!==e){var a=r.tagName,l={element:t,floatLabelType:e,customTag:a="DIV"!==a&&"SPAN"!==a?a:null,properties:{placeholder:i}},c=r.querySelector(".e-clear-icon"),d={container:r};if(t.classList.remove(Ru.INPUT),s(l,d,o),h(c)&&(c=r.querySelector(".e-input-group-icon")),h(c))r.classList.remove(Ru.INPUTGROUP);else{var p=r.querySelector("."+Ru.FLOATLINE),u=r.querySelector("."+Ru.FLOATTEXT);r.insertBefore(t,c),r.insertBefore(p,c),r.insertBefore(u,c)}}}function R(t,e){for(var i=0;i<e.length;i++)N(t,e[i].container)}function N(t,e,i){var n=[];n.push(i);var o=h(i)?e.querySelectorAll(".e-input-group-icon"):n;if(t&&o.length>0)for(r=0;r<o.length;r++)o[r].addEventListener("mousedown",H,!1),o[r].addEventListener("mouseup",z,!1);else if(o.length>0)for(var r=0;r<o.length;r++)o[r].removeEventListener("mousedown",H,this),o[r].removeEventListener("mouseup",z,this)}function B(t,e){t.classList.contains("e-disabled")||t.querySelector("input").readOnly||e.classList.add("e-input-btn-ripple")}function H(){for(var t=this,e=this.parentElement;!e.classList.contains("e-input-group");)e=e.parentElement;B(e,t)}function z(){var t=this;setTimeout(function(){t.classList.remove("e-input-btn-ripple")},500)}function j(t,e,i){var n=(h(i)?b:i)("span",{className:t});return n.classList.add("e-input-group-icon"),e.appendChild(n),e.classList.contains(Ru.INPUTGROUP)||e.classList.add(Ru.INPUTGROUP),N(!0,e,n),n}t.createInput=e,t.setValue=f,t.setCssClass=v,t.setPlaceholder=y,t.setReadonly=C,t.setEnableRtl=S,t.setEnabled=E,t.setClearButton=P,t.removeAttributes=T,t.addAttributes=O,t.removeFloating=A,t.addFloating=I,t.setRipple=R,t.appendSpan=j}(lu||(lu={}));var Nu,Bu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Hu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},zu="e-input-group-icon",ju=new RegExp("^(-)?(\\d*)$"),Fu=function(t){function e(e,i){return t.call(this,e,i)||this}return Bu(e,t),e.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var t=n("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),x([this.cloneElement],["e-control","e-numerictextbox"]),this.angularTagName=null,"EJS-NUMERICTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;var e=this.createElement("input"),i=0;for(i;i<this.element.attributes.length;i++)e.setAttribute(this.element.attributes[i].nodeName,this.element.attributes[i].nodeValue),e.innerHTML=this.element.innerHTML;this.element.hasAttribute("id")&&this.element.removeAttribute("id"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(e),this.element=e,o("ej2_instances",t,this.element)}k(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off","aria-live":"assertive"});var r={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:""};this.l10n=new hl("numerictextbox",r,this.locale),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.checkAttributes(),this.prevValue=this.value,this.validateMinMax(),this.validateStep(),null===this.placeholder&&this.updatePlaceholder()},e.prototype.render=function(){"input"===this.element.tagName.toLowerCase()&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),h(this.width)||I(this.container,{width:m(this.width)}),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(null===this.value||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),null===this.value||isNaN(this.value)||this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0))},e.prototype.checkAttributes=function(){for(var t=0,e=["value","min","max","step","disabled","readonly","style","name"];t<e.length;t++){var i=e[t];if(!h(this.element.getAttribute(i)))switch(i){case"disabled":var n="disabled"!==this.element.getAttribute(i)&&"true"!==this.element.getAttribute(i);this.setProperties({enabled:n},!0);break;case"readonly":var r="readonly"===this.element.getAttribute(i)||"true"===this.element.getAttribute(i);this.setProperties({readonly:r},!0);break;case"style":this.inputStyle=this.element.getAttribute(i);break;case"name":this.inputName=this.element.getAttribute(i);break;default:var s=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(i));(null!==s&&!isNaN(s)||"value"===i)&&this.setProperties(o(i,s,{}),!0)}}},e.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},e.prototype.initCultureFunc=function(){this.instance=new qa(this.locale)},e.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,null!==n("currency",this)&&(o("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},e.prototype.createWrapper=function(){var t=lu.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:this.cssClass,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}});this.inputWrapper=t,this.container=t.container,this.container.setAttribute("class","e-control-wrapper e-numeric "+this.container.getAttribute("class")),this.readonly&&k(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",validateHidden:"true"}}),this.inputName=null!==this.inputName?this.inputName:this.element.id,this.element.removeAttribute("name"),k(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),null!==this.inputStyle&&k(this.container,{style:this.inputStyle})},e.prototype.spinBtnCreation=function(){this.spinDown=lu.appendSpan(zu+" e-spin-down",this.container),k(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),this.spinUp=lu.appendSpan(zu+" e-spin-up",this.container),k(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},e.prototype.validateMinMax=function(){("number"!=typeof this.min||isNaN(this.min))&&this.setProperties({min:-Number.MAX_VALUE},!0),("number"!=typeof this.max||isNaN(this.max))&&this.setProperties({max:Number.MAX_VALUE},!0),null!==this.decimals&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),k(this.element,{"aria-valuemin":this.min.toString(),"aria-valuemax":this.max.toString()})},e.prototype.formattedValue=function(t,e){return this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(e)},e.prototype.validateStep=function(){null!==this.decimals&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},e.prototype.action=function(t,e){this.isInteract=!0;var i=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(i,this.step,t)),this.raiseChangeEvent(e)},e.prototype.checkErrorClass=function(){this.isValidState?x([this.container],"e-error"):w([this.container],"e-error"),k(this.element,{"aria-invalid":this.isValidState?"false":"true"})},e.prototype.bindClearEvent=function(){this.showClearButton&&ha.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},e.prototype.resetHandler=function(t){t.preventDefault(),this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.clear(t)},e.prototype.clear=function(t){this.setProperties({value:null},!0),this.setElementValue("")},e.prototype.wireEvents=function(){ha.add(this.element,"focus",this.focusIn,this),ha.add(this.element,"blur",this.focusOut,this),ha.add(this.element,"keydown",this.keyDownHandler,this),ha.add(this.element,"keyup",this.keyUpHandler,this),ha.add(this.element,"input",this.inputHandler,this),ha.add(this.element,"keypress",this.keyPressHandler,this),ha.add(this.element,"change",this.changeHandler,this),ha.add(this.element,"paste",this.pasteHandler,this),this.enabled&&this.bindClearEvent()},e.prototype.wireSpinBtnEvents=function(){ha.add(this.spinUp,ma.touchStartEvent,this.mouseDownOnSpinner,this),ha.add(this.spinDown,ma.touchStartEvent,this.mouseDownOnSpinner,this),ha.add(this.spinUp,ma.touchEndEvent,this.mouseUpOnSpinner,this),ha.add(this.spinDown,ma.touchEndEvent,this.mouseUpOnSpinner,this),ha.add(this.spinUp,ma.touchMoveEvent,this.touchMoveOnSpinner,this),ha.add(this.spinDown,ma.touchMoveEvent,this.touchMoveOnSpinner,this)},e.prototype.unwireEvents=function(){ha.remove(this.element,"focus",this.focusIn),ha.remove(this.element,"blur",this.focusOut),ha.remove(this.element,"keyup",this.keyUpHandler),ha.remove(this.element,"input",this.inputHandler),ha.remove(this.element,"keydown",this.keyDownHandler),ha.remove(this.element,"keypress",this.keyPressHandler),ha.remove(this.element,"change",this.changeHandler),ha.remove(this.element,"paste",this.pasteHandler)},e.prototype.unwireSpinBtnEvents=function(){ha.remove(this.spinUp,ma.touchStartEvent,this.mouseDownOnSpinner),ha.remove(this.spinDown,ma.touchStartEvent,this.mouseDownOnSpinner),ha.remove(this.spinUp,ma.touchEndEvent,this.mouseUpOnSpinner),ha.remove(this.spinDown,ma.touchEndEvent,this.mouseUpOnSpinner),ha.remove(this.spinUp,ma.touchMoveEvent,this.touchMoveOnSpinner),ha.remove(this.spinDown,ma.touchMoveEvent,this.touchMoveOnSpinner)},e.prototype.changeHandler=function(t){this.element.value.length||this.setProperties({value:null},!0);var e=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(e,t)},e.prototype.raiseChangeEvent=function(t){if(this.prevValue!==this.value){var e={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteraction:this.isInteract,event:t},t&&(this.changeEventArgs.event=t),a(e,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.trigger("change",e)}},e.prototype.pasteHandler=function(){var t=this,e=this.element.value;setTimeout(function(){t.numericRegex().test(t.element.value)||t.setElementValue(e)})},e.prototype.preventHandler=function(){var t=this,e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(t.element.selectionStart>0){var i=t.element.selectionStart,o=t.element.selectionStart-1,r=void 0,s=t.element.value.split("");r=n("decimal",lt(t.locale)).charCodeAt(0)," "===t.element.value[o]&&t.element.selectionStart>0&&!e?(h(t.prevVal)?t.element.value=t.element.value.trim():0!==o?t.element.value=t.prevVal:0===o&&(t.element.value=t.element.value.trim()),t.element.setSelectionRange(o,o)):isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&45!==t.element.value[t.element.selectionStart-1].charCodeAt(0)?(s.indexOf(t.element.value[t.element.selectionStart-1])!==s.lastIndexOf(t.element.value[t.element.selectionStart-1])&&t.element.value[t.element.selectionStart-1].charCodeAt(0)===r||t.element.value[t.element.selectionStart-1].charCodeAt(0)!==r)&&(t.element.value=t.element.value.substring(0,o)+t.element.value.substring(i,t.element.value.length),t.element.setSelectionRange(o,o),isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&t.element.selectionStart>0&&t.element.value.length&&t.preventHandler()):isNaN(parseFloat(t.element.value[t.element.selectionStart-2]))&&t.element.selectionStart>1&&45!==t.element.value[t.element.selectionStart-2].charCodeAt(0)&&(s.indexOf(t.element.value[t.element.selectionStart-2])!==s.lastIndexOf(t.element.value[t.element.selectionStart-2])&&t.element.value[t.element.selectionStart-2].charCodeAt(0)===r||t.element.value[t.element.selectionStart-2].charCodeAt(0)!==r)&&(t.element.setSelectionRange(o,o),t.nextEle=t.element.value[t.element.selectionStart],t.cursorPosChanged=!0,t.preventHandler()),!0===t.cursorPosChanged&&t.element.value[t.element.selectionStart]===t.nextEle&&isNaN(parseFloat(t.element.value[t.element.selectionStart-1]))&&(t.element.setSelectionRange(t.element.selectionStart+1,t.element.selectionStart+1),t.cursorPosChanged=!1,t.nextEle=null),""===t.element.value.trim()&&t.element.setSelectionRange(0,0),t.element.selectionStart>0&&45===t.element.value[t.element.selectionStart-1].charCodeAt(0)&&t.element.selectionStart>1&&(h(t.prevVal)?t.element.value=t.element.value:t.element.value=t.prevVal,t.element.setSelectionRange(t.element.selectionStart,t.element.selectionStart)),t.prevVal=t.element.value}})},e.prototype.keyUpHandler=function(t){!(!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform))&&ma.isDevice&&this.preventHandler()},e.prototype.inputHandler=function(t){!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&ma.isDevice&&this.preventHandler()},e.prototype.keyDownHandler=function(t){if(!this.readonly)switch(t.keyCode){case 38:t.preventDefault(),this.action("increment",t);break;case 40:t.preventDefault(),this.action("decrement",t)}},e.prototype.performAction=function(t,e,i){(null===t||isNaN(t))&&(t=0);var n="increment"===i?t+e:t-e;return n=this.correctRounding(t,e,n),this.strictMode?this.trimValue(n):n},e.prototype.correctRounding=function(t,e,i){var n=new RegExp("[,.](.*)"),o=(t.toString(),e.toString(),n.test(t.toString())),r=n.test(e.toString());if(o||r){var s=o?n.exec(t.toString())[0].length:0,a=r?n.exec(e.toString())[0].length:0,l=Math.max(s,a);return t=this.roundValue(i,l)}return i},e.prototype.roundValue=function(t,e){e=e||0;var i=Math.pow(10,e);return t*=i,t=Math.round(t)/i},e.prototype.updateValue=function(t,e){e&&(this.isInteract=!0),null===t||isNaN(t)||this.decimals&&(t=this.roundNumber(t,this.decimals)),this.changeValue(null===t||isNaN(t)?null:this.strictMode?this.trimValue(t):t),this.raiseChangeEvent(e)},e.prototype.updateCurrency=function(t,e){o(t,e,this.cultureInfo),this.updateValue(this.value)},e.prototype.changeValue=function(t){if(t||0===t){var e=void 0,i=t.toString().split(".")[1];e=i&&i.length?i.length:0,null!==this.decimals&&(e=e<this.decimals?e:this.decimals),this.setProperties({value:this.roundNumber(t,e)},!0)}else t=null,this.setProperties({value:t},!0);this.modifyText(),this.strictMode||this.validateState()},e.prototype.modifyText=function(){if(this.value||0===this.value){var t=this.formatNumber(),e=this.isFocused?t:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(e),k(this.element,{"aria-valuenow":t}),this.hiddenInput.value=t}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},e.prototype.setElementValue=function(t,e){lu.setValue(t,e||this.element,this.floatLabelType,this.showClearButton)},e.prototype.validateState=function(){this.isValidState=!0,(this.value||0===this.value)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},e.prototype.formatNumber=function(){var t,e=this.value.toString().split(".")[1];return t=e&&e.length?e.length:0,null!==this.decimals&&(t=t<this.decimals?t:this.decimals),this.instance.getNumberFormat({maximumFractionDigits:t,minimumFractionDigits:t,useGrouping:!1})(this.value)},e.prototype.trimValue=function(t){return t>this.max?this.max:t<this.min?this.min:t},e.prototype.roundNumber=function(t,e){var i=t,n=e||0,o=i.toString().split("e"),r=(i=Math.round(Number(o[0]+"e"+(o[1]?Number(o[1])+n:n)))).toString().split("e");return i=Number(r[0]+"e"+(r[1]?Number(r[1])-n:-n)),Number(i.toFixed(n))},e.prototype.cancelEvent=function(t){return t.preventDefault(),!1},e.prototype.keyPressHandler=function(t){if(0===t.which||t.metaKey||t.ctrlKey||8===t.keyCode||13===t.keyCode)return!0;var e=String.fromCharCode(t.which),i=this.element.value;return i=i.substring(0,this.element.selectionStart)+e+i.substring(this.element.selectionEnd),!!this.numericRegex().test(i)||(t.preventDefault(),t.stopPropagation(),!1)},e.prototype.numericRegex=function(){var t=n("decimal",lt(this.locale)),e="*";return"."===t&&(t="\\"+t),0===this.decimals&&this.validateDecimalOnType?ju:(this.decimals&&this.validateDecimalOnType&&(e="{0,"+this.decimals+"}"),new RegExp("^(-)?(((\\d+("+t+"\\d"+e+")?)|("+t+"\\d"+e+")))?$"))},e.prototype.mouseWheel=function(t){t.preventDefault();var e,i=t;i.wheelDelta?e=i.wheelDelta/120:i.detail&&(e=-i.detail/3),e>0?this.action("increment",t):e<0&&this.action("decrement",t),this.cancelEvent(t)},e.prototype.focusIn=function(t){var e=this;if(this.enabled&&!this.readonly){if(this.isFocused=!0,x([this.container],"e-error"),this.prevValue=this.value,this.value||0===this.value){var i=this.formatNumber();if(this.setElementValue(i),!this.isPrevFocused){var n=ma.isDevice&&ma.isIos?600:0;setTimeout(function(){e.element.setSelectionRange(0,i.length)},n)}}ma.isDevice||ha.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},e.prototype.focusOut=function(t){var e=this;if(this.isPrevFocused){if(t.preventDefault(),ma.isDevice){var i=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){e.setElementValue(i,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var o=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(o),ma.isDevice||ha.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}},e.prototype.mouseDownOnSpinner=function(t){var e=this;if(this.isFocused&&(this.isPrevFocused=!0,t.preventDefault()),this.getElementData(t)){this.getElementData(t);var i=t.currentTarget,n=i.classList.contains("e-spin-up")?"increment":"decrement";ha.add(i,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){e.isCalled=!0,e.action(n,t)},150),ha.add(document,"mouseup",this.mouseUpClick,this)}},e.prototype.touchMoveOnSpinner=function(t){document.elementFromPoint(t.clientX,t.clientY).classList.contains(zu)||clearInterval(this.timeOut)},e.prototype.mouseUpOnSpinner=function(t){if(this.isPrevFocused&&(this.element.focus(),ma.isDevice||(this.isPrevFocused=!1)),ma.isDevice||t.preventDefault(),this.getElementData(t)){var e=t.currentTarget,i=e.classList.contains("e-spin-up")?"increment":"decrement";ha.remove(e,"mouseleave",this.mouseUpClick),this.isCalled||this.action(i,t),this.isCalled=!1,ha.remove(document,"mouseup",this.mouseUpClick)}},e.prototype.getElementData=function(t){return!(t.which&&3===t.which||t.button&&2===t.button||!this.enabled||this.readonly)&&(clearInterval(this.timeOut),!0)},e.prototype.floatLabelTypeUpdate=function(){lu.removeFloating(this.inputWrapper);var t=this.hiddenInput;this.hiddenInput.remove(),lu.addFloating(this.element,this.floatLabelType,this.placeholder),this.container.insertBefore(t,this.container.childNodes[1])},e.prototype.mouseUpClick=function(t){t.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,ha.remove(this.spinUp,"mouseleave",this.mouseUpClick),ha.remove(this.spinDown,"mouseleave",this.mouseUpClick)},e.prototype.increment=function(t){void 0===t&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,"increment")),this.raiseChangeEvent()},e.prototype.decrement=function(t){void 0===t&&(t=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,t,"decrement")),this.raiseChangeEvent()},e.prototype.destroy=function(){this.unwireEvents(),L(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),L(this.spinUp),L(this.spinDown)),this.container.parentElement.appendChild(this.cloneElement),L(this.container),t.prototype.destroy.call(this)},e.prototype.getText=function(){return this.element.value},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=0,r=Object.keys(t);i<r.length;i++){var s=r[i];switch(s){case"width":I(this.container,{width:m(t.width)});break;case"cssClass":lu.setCssClass(t.cssClass,[this.container],e.cssClass);break;case"enabled":lu.setEnabled(t.enabled,this.element);break;case"enableRtl":lu.setEnableRtl(t.enableRtl,[this.container]);break;case"readonly":lu.setReadonly(t.readonly,this.element),this.readonly?k(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"placeholder":lu.setPlaceholder(t.placeholder,this.element);break;case"step":this.step=t.step,this.validateStep();break;case"showSpinButton":t.showSpinButton?this.spinBtnCreation():(L(this.spinUp),L(this.spinDown));break;case"showClearButton":lu.setClearButton(t.showClearButton,this.element,this.inputWrapper),this.bindClearEvent();break;case"floatLabelType":this.floatLabelType=t.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.updateValue(t.value);break;case"min":case"max":o(s,n(s,t),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=t.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),h(this.spinDown)||k(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),h(this.spinUp)||k(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")}),this.updatePlaceholder(),lu.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":var a=n(s,t);this.setProperties({currencyCode:a},!0),this.updateCurrency(s,a);break;case"currencyCode":var l=n(s,t);this.setProperties({currency:l},!0),this.updateCurrency("currency",l);break;case"format":o(s,n(s,t),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=t.decimals,this.updateValue(this.value)}}},e.prototype.getModuleName=function(){return"numerictextbox"},Hu([Y("")],e.prototype,"cssClass",void 0),Hu([Y(null)],e.prototype,"value",void 0),Hu([Y(-Number.MAX_VALUE)],e.prototype,"min",void 0),Hu([Y(Number.MAX_VALUE)],e.prototype,"max",void 0),Hu([Y(1)],e.prototype,"step",void 0),Hu([Y(null)],e.prototype,"width",void 0),Hu([Y(null)],e.prototype,"placeholder",void 0),Hu([Y(!0)],e.prototype,"showSpinButton",void 0),Hu([Y(!1)],e.prototype,"readonly",void 0),Hu([Y(!0)],e.prototype,"enabled",void 0),Hu([Y(!1)],e.prototype,"enableRtl",void 0),Hu([Y(!1)],e.prototype,"showClearButton",void 0),Hu([Y(!1)],e.prototype,"enablePersistence",void 0),Hu([Y("n2")],e.prototype,"format",void 0),Hu([Y(null)],e.prototype,"decimals",void 0),Hu([Y(null)],e.prototype,"currency",void 0),Hu([Y(null)],e.prototype,"currencyCode",void 0),Hu([Y(!0)],e.prototype,"strictMode",void 0),Hu([Y(!1)],e.prototype,"validateDecimalOnType",void 0),Hu([Y("Never")],e.prototype,"floatLabelType",void 0),Hu([J()],e.prototype,"created",void 0),Hu([J()],e.prototype,"destroyed",void 0),Hu([J()],e.prototype,"change",void 0),e=Hu([$],e)}(Ka),Vu="e-error",_u="e-input-group",Wu="e-float-input",Uu="e-label-top",qu="e-label-bottom",Xu={0:"[0-9]",9:"[0-9 ]","#":"[0-9 +-]",L:"[A-Za-z]","?":"[A-Za-z ]","&":"[^ ]+",C:"[^]+",A:"[A-Za-z0-9]",a:"[A-Za-z0-9 ]"},Yu=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gu=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Zu=(function(t){function e(e,i){return t.call(this,e,i)||this}Yu(e,t),e.prototype.getModuleName=function(){return"maskedtextbox"},e.prototype.preRender=function(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.regExpCollec=Xu,this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.changeEventArgs={},this.focusEventArgs={},this.maskKeyPress=!1,this.isFocus=!1,this.isInitial=!1,this.isIosInvalid=!1;var t=n("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),x([this.cloneElement],["e-control","e-maskedtextbox"]),this.angularTagName=null,"EJS-MASKEDTEXTBOX"===this.element.tagName){this.angularTagName=this.element.tagName;for(var e=this.createElement("input"),i=0;i<this.element.attributes.length;i++)e.setAttribute(this.element.attributes[i].nodeName,this.element.attributes[i].nodeValue),e.innerHTML=this.element.innerHTML;this.element.hasAttribute("id")&&this.element.removeAttribute("id"),this.element.classList.remove("e-control","e-maskedtextbox"),this.element.classList.add("e-mask-container"),this.element.appendChild(e),this.element=e,o("ej2_instances",t,this.element)}},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.render=function(){"input"===this.element.tagName.toLowerCase()&&("Never"===this.floatLabelType&&w([this.element],"e-input"),this.createWrapper(),""===this.element.name&&this.element.setAttribute("name",this.element.id),this.isInitial=!0,this.resetMaskedTextBox(),this.isInitial=!1,this.setMaskPlaceholder(!0,!1),this.setWidth(this.width),this.preEleVal=this.element.value)},e.prototype.resetMaskedTextBox=function(){this.promptMask="",this.hiddenMask="",this.escapeMaskValue="",this.customRegExpCollec=[],this.undoCollec=[],this.redoCollec=[],this.promptChar.length>1&&(this.promptChar=this.promptChar[0]),ys.call(this),bs.call(this),(null===this.mask||""===this.mask&&void 0!==this.value)&&Zs.call(this,this.value);var t=Ls.call(this,this.element);this.prevValue=t,this.value=t,this.isInitial||xs.call(this),ws.call(this)},e.prototype.setMaskPlaceholder=function(t,e){(e||this.placeholder)&&(lu.setPlaceholder(this.placeholder,this.element),this.element.value===this.promptMask&&t&&"Always"!==this.floatLabelType&&Zs.call(this,""),"Never"===this.floatLabelType&&Os.call(this))},e.prototype.setCssClass=function(t,e){t&&w(e,t)},e.prototype.setWidth=function(t){h(t)||(this.element.style.width=m(t),this.inputObj.container.style.width=m(t))},e.prototype.createWrapper=function(){this.inputObj=lu.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{enableRtl:this.enableRtl,cssClass:this.cssClass,enabled:this.enabled,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.inputObj.container.setAttribute("class","e-widget e-control-wrapper e-mask "+this.inputObj.container.getAttribute("class"))},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"value":Gs.call(this,this.value),this.placeholder&&this.setMaskPlaceholder(!1,!1);break;case"placeholder":this.setMaskPlaceholder(!0,!0);break;case"width":this.setWidth(t.width);break;case"cssClass":this.setCssClass(t.cssClass,[this.inputObj.container]);break;case"enabled":lu.setEnabled(t.enabled,this.element);break;case"enableRtl":lu.setEnableRtl(t.enableRtl,[this.inputObj.container]);break;case"customCharacters":this.customCharacters=t.customCharacters,this.resetMaskedTextBox();break;case"showClearButton":lu.setClearButton(t.showClearButton,this.element,this.inputObj),Cs.call(this);break;case"floatLabelType":this.floatLabelType=t.floatLabelType,lu.removeFloating(this.inputObj),lu.addFloating(this.element,this.floatLabelType,this.placeholder);break;case"mask":var o=this.value;this.mask=t.mask,this.updateValue(o);break;case"promptChar":t.promptChar.length>1&&(t.promptChar=t.promptChar[0]),t.promptChar?this.promptChar=t.promptChar:this.promptChar="_";var r=this.element.value.replace(new RegExp("["+e.promptChar+"]","g"),this.promptChar);this.promptMask===this.element.value&&(r=this.promptMask.replace(new RegExp("["+e.promptChar+"]","g"),this.promptChar)),this.promptMask=this.promptMask.replace(new RegExp("["+e.promptChar+"]","g"),this.promptChar),this.undoCollec=this.redoCollec=[],Zs.call(this,r)}},e.prototype.updateValue=function(t){this.resetMaskedTextBox(),Gs.call(this,t)},e.prototype.getMaskedValue=function(){return Ps.call(this,this.element)},e.prototype.destroy=function(){xs.call(this),this.inputObj.container.parentElement.appendChild(this.cloneElement),L(this.inputObj.container),t.prototype.destroy.call(this)},Gu([Y(null)],e.prototype,"cssClass",void 0),Gu([Y(null)],e.prototype,"width",void 0),Gu([Y(null)],e.prototype,"placeholder",void 0),Gu([Y("Never")],e.prototype,"floatLabelType",void 0),Gu([Y(!0)],e.prototype,"enabled",void 0),Gu([Y(!1)],e.prototype,"showClearButton",void 0),Gu([Y(!1)],e.prototype,"enablePersistence",void 0),Gu([Y(!1)],e.prototype,"enableRtl",void 0),Gu([Y(null)],e.prototype,"mask",void 0),Gu([Y("_")],e.prototype,"promptChar",void 0),Gu([Y(null)],e.prototype,"value",void 0),Gu([Y(null)],e.prototype,"customCharacters",void 0),Gu([J()],e.prototype,"created",void 0),Gu([J()],e.prototype,"destroyed",void 0),Gu([J()],e.prototype,"change",void 0),Gu([J()],e.prototype,"focus",void 0),e=Gu([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),Ku=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Qu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zu(e,t),Ku([Y("None")],e.prototype,"placement",void 0),Ku([Y(10)],e.prototype,"largeStep",void 0),Ku([Y(1)],e.prototype,"smallStep",void 0),Ku([Y(!1)],e.prototype,"showSmallTicks",void 0),Ku([Y(null)],e.prototype,"format",void 0),e}(xa),Ju=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zu(e,t),Ku([Y(!1)],e.prototype,"enabled",void 0),Ku([Y(null)],e.prototype,"minStart",void 0),Ku([Y(null)],e.prototype,"minEnd",void 0),Ku([Y(null)],e.prototype,"maxStart",void 0),Ku([Y(null)],e.prototype,"maxEnd",void 0),Ku([Y(!1)],e.prototype,"startHandleFixed",void 0),Ku([Y(!1)],e.prototype,"endHandleFixed",void 0),e}(xa),$u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zu(e,t),Ku([Y("")],e.prototype,"cssClass",void 0),Ku([Y("Before")],e.prototype,"placement",void 0),Ku([Y("Focus")],e.prototype,"showOn",void 0),Ku([Y(!1)],e.prototype,"isVisible",void 0),Ku([Y(null)],e.prototype,"format",void 0),e}(xa),tg={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},eg=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.horDir="left",n.verDir="bottom",n.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},n.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},n.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",n.customAriaText=null,n.drag=!0,n}return Zu(e,t),e.prototype.preRender=function(){var t={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new hl("slider",t,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc()},e.prototype.initCultureFunc=function(){this.internationalization=new qa(this.locale)},e.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=h(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=h(this.ticks.format)?null:this.ticks.format},e.prototype.formatString=function(t,e){var i=null,n=null;if(t||0===t){i=this.formatNumber(t);var o=this.numberOfDecimals(t);n=this.internationalization.getNumberFormat(e)(this.makeRoundNumber(t,o))}return{elementVal:i,formatString:n}},e.prototype.formatNumber=function(t){var e=this.numberOfDecimals(t);return this.internationalization.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(t)},e.prototype.numberOfDecimals=function(t){var e=t.toString().split(".")[1];return e&&e.length?e.length:0},e.prototype.makeRoundNumber=function(t,e){var i=e||0;return Number(t.toFixed(i))},e.prototype.fractionalToInteger=function(t){t=0===this.numberOfDecimals(t)?Number(t).toFixed(this.noOfDecimals):t;for(var e=1,i=0;i<this.noOfDecimals;i++)e*=10;return t=Number((t*e).toFixed(0))},e.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.setZindex()},e.prototype.initialize=function(){w([this.element],tg.root),this.setCSSClass()},e.prototype.setCSSClass=function(t){t&&x([this.element],t.split(" ")),this.cssClass&&w([this.element],this.cssClass.split(" "))},e.prototype.setEnabled=function(){var t="Range"!==this.type?[this.firstTooltipElement]:[this.firstTooltipElement,this.secondTooltipElement];this.enabled?(x([this.sliderContainer],[tg.sliderDisabled]),this.tooltip.isVisible&&"Always"===this.tooltip.showOn&&t.forEach(function(t){t.classList.remove(tg.sliderDisabled)}),this.wireEvents()):(w([this.sliderContainer],[tg.sliderDisabled]),this.tooltip.isVisible&&"Always"===this.tooltip.showOn&&t.forEach(function(t){t.classList.add(tg.sliderDisabled)}),this.unwireEvents())},e.prototype.getTheme=function(t){return window.getComputedStyle(t,":after").getPropertyValue("content").replace(/['"]+/g,"")},e.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:tg.sliderContainer+" "+tg.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:tg.sliderTrack}),this.element.appendChild(this.sliderTrack),this.element.tabIndex=-1,this.isMaterial="material"===this.getTheme(this.sliderContainer),this.isBootstrap="bootstrap"===this.getTheme(this.sliderContainer),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:h(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(1e3*Math.random()).toFixed(0)+"slider",class:tg.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),"Range"===this.type?this.rangeValueUpdate():this.value=h(this.value)?parseFloat(m(this.min.toString())):this.value,this.previousVal="Range"!==this.type?this.checkHandleValue(parseFloat(m(this.value.toString()))):[this.checkHandleValue(parseFloat(m(this.value[0].toString()))),this.checkHandleValue(parseFloat(m(this.value[1].toString())))],this.previousChanged=this.previousVal,h(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?x([this.sliderContainer],[tg.sliderDisabled]):w([this.sliderContainer],[tg.sliderDisabled]),this.readonly?w([this.sliderContainer],[tg.readonly]):x([this.sliderContainer],[tg.readonly])},e.prototype.createRangeBar=function(){"Default"!==this.type&&(this.rangeBar=this.createElement("div",{attrs:{class:tg.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&"Range"===this.type&&("Horizontal"===this.orientation?this.rangeBar.classList.add(tg.dragHorizontal):this.rangeBar.classList.add(tg.dragVertical)))},e.prototype.createLimitBar=function(){var t="Range"!==this.type?tg.limitBarDefault:tg.limitBarFirst;t+=" "+tg.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:t}}),this.element.appendChild(this.limitBarFirst),"Range"===this.type&&(this.limitBarSecond=this.createElement("div",{attrs:{class:tg.limitBarSecond+" "+tg.limits}}),this.element.appendChild(this.limitBarSecond))},e.prototype.setOrientClass=function(){"Vertical"!==this.orientation?(this.sliderContainer.classList.remove(tg.verticalSlider),this.sliderContainer.classList.add(tg.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(tg.horizontalSlider),this.sliderContainer.classList.add(tg.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),"Range"===this.type&&this.secondHandle.setAttribute("aria-orientation","vertical"))},e.prototype.setAriaAttributes=function(t){var e=this,i=this.min,n=this.max;!h(this.customValues)&&this.customValues.length>0&&(i=this.customValues[0],n=this.customValues[this.customValues.length-1]),"Range"!==this.type?k(t,{"aria-valuemin":i.toString(),"aria-valuemax":n.toString()}):(!h(this.customValues)&&this.customValues.length>0?[[i.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),n.toString()]]:[[i.toString(),this.value[1].toString()],[this.value[0].toString(),n.toString()]]).forEach(function(t,i){var n=0===i?e.firstHandle:e.secondHandle;n&&k(n,{"aria-valuemin":t[0],"aria-valuemax":t[1]})})},e.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:tg.sliderHandle,role:"slider","aria-labelledby":this.element.id+"_title",tabIndex:"0"}}),this.secondHandle.classList.add(tg.sliderSecondHandle),this.element.appendChild(this.secondHandle),this.isMaterial&&this.tooltip.isVisible&&(this.secondMaterialHandle=this.createElement("div",{attrs:{class:tg.sliderHandle+" "+tg.sliderMaterialHandle}}),this.element.appendChild(this.secondMaterialHandle))},e.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:tg.sliderHandle,role:"slider","aria-labelledby":this.element.id+"_title",tabIndex:"0"}}),this.firstHandle.classList.add(tg.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterial&&this.tooltip.isVisible&&(this.firstMaterialHandle=this.createElement("div",{attrs:{class:tg.sliderHandle+" "+tg.sliderMaterialHandle}}),this.element.appendChild(this.firstMaterialHandle))},e.prototype.wireFirstHandleEvt=function(t){t?(ha.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),ha.remove(this.firstHandle,"transitionend",this.transitionEnd),ha.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),ha.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(ha.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),ha.add(this.firstHandle,"transitionend",this.transitionEnd,this),ha.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),ha.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.wireSecondHandleEvt=function(t){t?(ha.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),ha.remove(this.secondHandle,"transitionend",this.transitionEnd),ha.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),ha.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(ha.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),ha.add(this.secondHandle,"transitionend",this.transitionEnd,this),ha.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),ha.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},e.prototype.handleStart=function(){var t=1===this.activeHandle?this.handlePos1:this.handlePos2,e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;0===t&&"Range"!==this.type&&(this.getHandle().classList.add(tg.sliderHandleStart),this.isMaterial&&this.tooltip.isVisible&&(this.firstMaterialHandle.classList.add(tg.sliderHandleStart),e&&e.classList.add(tg.sliderTooltipStart)))},e.prototype.transitionEnd=function(t){if(this.handleStart(),this.getHandle().style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),this.tooltip.isVisible){var e=1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj,i=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;this.isMaterial?i.classList.contains(tg.materialTooltipOpen)||"transform"===t.propertyName?("Default"===this.type&&(i.style.transition=this.transition.handle),this.refreshTooltip()):this.openMaterialTooltip():(e.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.tooltipAnimation())}"Always"!==this.tooltip.showOn&&this.closeTooltip()},e.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(tg.sliderHandleFocused)&&this.firstHandle.classList.remove(tg.sliderHandleFocused),"Range"===this.type&&this.secondHandle.classList.contains(tg.sliderHandleFocused)&&this.secondHandle.classList.remove(tg.sliderHandleFocused)},e.prototype.handleFocus=function(t){t.currentTarget===this.firstHandle?this.firstHandle.classList.add(tg.sliderHandleFocused):this.secondHandle.classList.add(tg.sliderHandleFocused)},e.prototype.handleOver=function(t){this.tooltip.isVisible&&"Hover"===this.tooltip.showOn&&(this.tooltipValue(),(t.currentTarget===this.firstHandle?this.firstTooltipObj:this.secondTooltipObj).animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},t.currentTarget===this.firstHandle?this.firstTooltipObj.open(this.firstHandle):this.secondTooltipObj.open(this.secondHandle))},e.prototype.handleLeave=function(t){if(this.tooltip.isVisible&&"Hover"===this.tooltip.showOn&&!t.currentTarget.classList.contains(tg.sliderHandleFocused)&&!t.currentTarget.classList.contains(tg.sliderTabHandle)){this.tooltipValue();var e=t.currentTarget===this.firstHandle?this.firstTooltipObj:this.secondTooltipObj;t.currentTarget===this.firstHandle?this.firstTooltipObj.close():this.secondTooltipObj.close(),e.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}}}},e.prototype.setHandler=function(){this.min>this.max&&(this.min=this.max),this.createFirstHandle(),"Range"===this.type&&this.createSecondHandle()},e.prototype.setEnableRTL=function(){this.enableRtl&&"Vertical"!==this.orientation?w([this.sliderContainer],tg.rtl):x([this.sliderContainer],tg.rtl);var t="Vertical"!==this.orientation?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom"),t!==("Vertical"!==this.orientation?this.horDir:this.verDir)&&"Horizontal"===this.orientation&&(I(this.firstHandle,{right:"",left:"auto"}),"Range"===this.type&&I(this.secondHandle,{top:"",left:"auto"}))},e.prototype.tooltipValue=function(){var t,e={value:this.value,text:""};this.setTooltipContent(),e.text=t=this.firstTooltipObj.content,this.trigger("tooltipChange",e),this.addTooltipClass(e.text),t!==e.text&&(this.customAriaText=e.text,this.firstTooltipObj.content=e.text,this.setAriaAttrValue(this.firstHandle),"Range"===this.type&&(this.secondTooltipObj.content=e.text,this.setAriaAttrValue(this.secondHandle)))},e.prototype.setTooltipContent=function(){var t;"Range"===this.type?(t=this.formatContent(this.tooltipFormatInfo,!1),this.firstTooltipObj.content=t,this.secondTooltipObj.content=t):h(this.handleVal1)||(t=this.formatContent(this.tooltipFormatInfo,!1),this.firstTooltipObj.content=t)},e.prototype.formatContent=function(t,e){var i="",n=this.handleVal1,o=this.handleVal2;return!h(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],o=this.customValues[this.handleVal2]),e?("Range"===this.type?i=this.enableRtl&&"Vertical"!==this.orientation?h(this.tooltip)||h(this.tooltip.format)?o.toString()+" - "+n.toString():this.formatString(o,t).elementVal+" - "+this.formatString(n,t).elementVal:h(this.tooltip)||h(this.tooltip.format)?n.toString()+" - "+o.toString():this.formatString(n,t).elementVal+" - "+this.formatString(o,t).elementVal:h(n)||(i=h(this.tooltip)||h(this.tooltip.format)?n.toString():this.formatString(n,t).elementVal),i):("Range"===this.type?i=this.enableRtl&&"Vertical"!==this.orientation?h(t.format)?o.toString()+" - "+n.toString():this.formatString(o,t).formatString+" - "+this.formatString(n,t).formatString:h(t.format)?n.toString()+" - "+o.toString():this.formatString(n,t).formatString+" - "+this.formatString(o,t).formatString:h(n)||(i=h(t.format)?n.toString():this.formatString(n,t).formatString),i)},e.prototype.addTooltipClass=function(t){var e=this;if(this.isMaterial&&this.tooltip.isVisible){var i=t.toString().length;("Range"!==this.type?[this.firstTooltipElement]:[this.firstTooltipElement,this.secondTooltipElement]).forEach(function(t,n){if(t)i>4?(t.classList.remove(tg.sliderMaterialDefault),t.classList.contains(tg.sliderMaterialRange)||(t.classList.add(tg.sliderMaterialRange),t.style.transform="scale(1)")):(t.classList.remove(tg.sliderMaterialRange),t.classList.contains(tg.sliderMaterialDefault)||(t.classList.add(tg.sliderMaterialDefault),t.style.transform=e.getTooltipTransformProperties(e.previousTooltipClass).rotate));else{var o=i>4?tg.sliderMaterialRange:tg.sliderMaterialDefault;n?e.secondTooltipObj.cssClass=tg.sliderTooltip+" "+o:e.firstTooltipObj.cssClass=tg.sliderTooltip+" "+o}})}},e.prototype.tooltipPlacement=function(){var t;t="Horizontal"===this.orientation?"Before"===this.tooltip.placement?"TopCenter":"BottomCenter":"Before"===this.tooltip.placement?"LeftCenter":"RightCenter",this.firstTooltipObj.position=t,"Range"===this.type&&(this.secondTooltipObj.position=t),this.isMaterial&&(this.firstTooltipObj.showTipPointer=!0,this.setProperties({tooltip:{showOn:"Always"}},!0),this.firstTooltipObj.height=30,"Range"===this.type&&(this.secondTooltipObj.showTipPointer=!0,this.secondTooltipObj.height=30))},e.prototype.tooltipBeforeOpen=function(t){var e=t.target===this.firstHandle?this.firstTooltipElement=t.element:this.secondTooltipElement=t.element;if(""!==this.tooltip.cssClass&&w([e],this.tooltip.cssClass.split(" ")),t.target.removeAttribute("aria-describedby"),this.isMaterial&&this.tooltip.isVisible){var i=this.getTooltipTransformProperties(this.previousTooltipClass);e.firstChild.classList.add(tg.materialTooltipHide),this.handleStart(),e.firstElementChild.innerText.length>4?e.style.transform=i.translate+" scale(0.01)":e.style.transform=i.translate+" "+i.rotate+" scale(0.01)"}if(this.isBootstrap)switch(this.bootstrapCollisionArgs.collidedPosition){case"TopCenter":this.firstTooltipObj.setProperties({offsetY:-6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetY:-6},!1);break;case"BottomCenter":this.firstTooltipObj.setProperties({offsetY:6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetY:6},!1);break;case"LeftCenter":this.firstTooltipObj.setProperties({offsetX:-6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetX:-6},!1);break;case"RightCenter":this.firstTooltipObj.setProperties({offsetX:6},!1),"Range"===this.type&&this.secondTooltipObj.setProperties({offsetX:6},!1)}},e.prototype.wireMaterialTooltipEvent=function(t){this.isMaterial&&this.tooltip.isVisible&&(t?(ha.remove(this.firstTooltipElement,"mousedown touchstart",this.sliderDown),"Range"===this.type&&ha.remove(this.secondTooltipElement,"mousedown touchstart",this.sliderDown)):(ha.add(this.firstTooltipElement,"mousedown touchstart",this.sliderDown,this),"Range"===this.type&&ha.add(this.secondTooltipElement,"mousedown touchstart",this.sliderDown,this)))},e.prototype.tooltipPositionCalculation=function(t){var e;switch(t){case"TopCenter":e=tg.horizontalTooltipBefore;break;case"BottomCenter":e=tg.horizontalTooltipAfter;break;case"LeftCenter":e=tg.verticalTooltipBefore;break;case"RightCenter":e=tg.verticalTooltipAfter}return e},e.prototype.getTooltipTransformProperties=function(t){if(this.firstTooltipElement){var e=void 0;return e="Horizontal"===this.orientation?this.firstTooltipElement.clientHeight+14-this.firstTooltipElement.clientHeight/2:this.firstTooltipElement.clientWidth+14-this.firstTooltipElement.clientWidth/2,"Horizontal"===this.orientation?t===tg.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+e+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-e+"px)"}:t===tg.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+e+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-e+"px)"}}},e.prototype.openMaterialTooltip=function(){var t=this;this.refreshTooltip();var e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement,i=1===this.activeHandle?this.firstMaterialHandle:this.secondMaterialHandle;e.firstChild.classList.contains(tg.materialTooltipHide)&&e.firstChild.classList.remove(tg.materialTooltipHide),e.firstChild.classList.add(tg.materialTooltipShow),this.getHandle().style.cursor="default",e.style.transition=this.scaleTransform,e.classList.add(tg.materialTooltipOpen),i.style.transform="scale(0)",e.firstElementChild.innerText.length>4?e.style.transform="scale(1)":e.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,"Default"===this.type?setTimeout(function(){e.style.transition=t.transition.handle},2500):setTimeout(function(){e.style.transition="none"},2500)},e.prototype.checkTooltipPosition=function(t){var e=t.target===this.firstHandle?this.firstHandleTooltipPosition:this.secondHandleTooltipPosition;if(this.isMaterial&&(void 0===e||e!==t.collidedPosition)){var i=this.tooltipPositionCalculation(t.collidedPosition);t.element.classList.remove(this.previousTooltipClass),t.element.classList.add(i),this.previousTooltipClass=i,t.element.style.transform&&t.element.classList.contains(tg.materialTooltipOpen)&&t.element.firstElementChild.innerText.length<4&&(t.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate),t.target===this.firstHandle?this.firstHandleTooltipPosition=t.collidedPosition:this.secondHandleTooltipPosition=t.collidedPosition}this.bootstrapCollisionArgs=t},e.prototype.renderTooltip=function(){"Auto"===this.tooltip.showOn&&this.setProperties({tooltip:{showOn:"Hover"}},!0);var t=!!this.isBootstrap;this.firstTooltipObj=new rc({showTipPointer:t,cssClass:tg.sliderTooltip,animation:{open:{effect:"None"},close:{effect:"None"}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),afterClose:this.tooltipAfterClose.bind(this)}),this.firstTooltipObj.appendTo(this.firstHandle),"Range"===this.type&&(this.secondTooltipObj=new rc({showTipPointer:t,cssClass:tg.sliderTooltip,animation:{open:{effect:"None"},close:{effect:"None"}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),afterClose:this.tooltipAfterClose.bind(this)}),this.secondTooltipObj.appendTo(this.secondHandle)),this.tooltipPlacement(),this.firstHandle.style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),"Range"===this.type&&(this.secondHandle.style.transition="none"),this.isMaterial&&(this.sliderContainer.classList.add(tg.materialSlider),this.tooltipValue(),this.firstTooltipObj.open(this.firstHandle),"Range"===this.type&&this.secondTooltipObj.open(this.secondHandle))},e.prototype.tooltipAfterClose=function(t){t.element===this.firstTooltipElement?this.firstTooltipElement=void 0:this.secondTooltipElement=void 0},e.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:tg.sliderButton+" "+tg.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:tg.sliderButtonIcon})),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:tg.sliderButton+" "+tg.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:tg.sliderButtonIcon})),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(tg.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},e.prototype.buttonTitle=function(){var t=this.enableRtl&&"Vertical"!==this.orientation;this.l10n.setLocale(this.locale);var e=this.l10n.getConstant("decrementTitle"),i=this.l10n.getConstant("incrementTitle");k(t?this.secondBtn:this.firstBtn,{"aria-label":e,title:e}),k(t?this.firstBtn:this.secondBtn,{"aria-label":i,title:i})},e.prototype.buttonFocusOut=function(){this.isMaterial&&this.getHandle().classList.remove("e-large-thumb-size")},e.prototype.repeatButton=function(t){t.target.parentElement;!(1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement)&&this.tooltip.isVisible&&this.openTooltip();var e,i=this.handleValueUpdate(),n=this.enableRtl&&"Vertical"!==this.orientation;t.target.parentElement.classList.contains(tg.firstButton)||t.target.classList.contains(tg.firstButton)?e=n?this.add(i,parseFloat(this.step.toString()),!0):this.add(i,parseFloat(this.step.toString()),!1):(t.target.parentElement.classList.contains(tg.secondButton)||t.target.classList.contains(tg.secondButton))&&(e=n?this.add(i,parseFloat(this.step.toString()),!1):this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(e=this.getLimitCorrectedValues(e)),e>=this.min&&e<=this.max&&(this.changeHandleValue(e),this.refreshTooltipOnMove())},e.prototype.repeatHandlerMouse=function(t){t.preventDefault(),"mousedown"!==t.type&&"touchstart"!==t.type||(this.buttonClick(t),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,t))},e.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},e.prototype.repeatHandlerUp=function(t){this.changeEvent("changed"),this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&!this.isMaterial&&this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},e.prototype.customTickCounter=function(t){var e=4;return!h(this.customValues)&&this.customValues.length>0&&(t>4&&(e=3),t>7&&(e=2),t>14&&(e=1),t>28&&(e=0)),e},e.prototype.renderScale=function(){var t="Vertical"===this.orientation?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:tg.scale+" e-"+t+"-scale "+tg.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",ma.isAndroid&&"h"===t&&this.ul.classList.add(tg.sliderTickPosition);var e=this.ticks.smallStep;this.ticks.showSmallTicks?e<=0&&(e=parseFloat(m(this.step))):e=this.ticks.largeStep>0?this.ticks.largeStep:parseFloat(m(this.max))-parseFloat(m(this.min));var i=this.fractionalToInteger(this.min),n=this.fractionalToInteger(this.max),o=this.fractionalToInteger(e),r=!h(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,s=this.customTickCounter(r),a=!h(this.customValues)&&this.customValues.length>0?r*s+r:Math.abs((n-i)/o);this.element.appendChild(this.ul);var l,c=parseFloat(this.min.toString());"v"===t&&(c=parseFloat(this.max.toString()));var d,p=0,u=100/a;u===1/0&&(u=5);for(var g=0,f=!h(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,v=0;g<=a;g++){if(l=this.createElement("li",{attrs:{class:tg.tick,role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!h(this.customValues)&&this.customValues.length>0)(d=g%(s+1)==0)&&("h"===t?(c=this.customValues[v],v++):(c=this.customValues[f],f--),l.setAttribute("title",c.toString()));else if(l.setAttribute("title",c.toString()),0===this.numberOfDecimals(this.max)&&0===this.numberOfDecimals(this.min)&&0===this.numberOfDecimals(this.step))d="h"===t?(c-parseFloat(this.min.toString()))%this.ticks.largeStep==0:Math.abs(c-parseFloat(this.max.toString()))%this.ticks.largeStep==0;else{var y=this.fractionalToInteger(this.ticks.largeStep);d=(this.fractionalToInteger(c)-i)%y==0}d&&l.classList.add(tg.large),"h"===t?l.style.width=u+"%":l.style.height=u+"%";var b=d?"Both"===this.ticks.placement?2:1:0;if(d)for(var w=0;w<b;w++)this.createTick(l,c);else h(this.customValues)&&this.formatTicksValue(l,c);this.ul.appendChild(l),this.tickElementCollection.push(l);var x=void 0;h(this.customValues)&&(x=this.numberOfDecimals(e)>this.numberOfDecimals(c)?this.numberOfDecimals(e):this.numberOfDecimals(c),c="h"===t?this.makeRoundNumber(c+e,x):this.makeRoundNumber(c-e,x),p=this.makeRoundNumber(p+e,x))}this.tickesAlignment(t,u)},e.prototype.tickesAlignment=function(t,e){this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(tg.sliderFirstTick),this.lastChild.classList.add(tg.sliderLastTick),this.sliderContainer.classList.add(tg.scale+"-"+this.ticks.placement.toLowerCase()),"h"===t?(this.firstChild.style.width=e/2+"%",this.lastChild.style.width=e/2+"%"):(this.firstChild.style.height=e/2+"%",this.lastChild.style.height=e/2+"%");var i={ticksWrapper:this.ul,tickElements:this.tickElementCollection};this.trigger("renderedTicks",i),this.scaleAlignment()},e.prototype.createTick=function(t,e){var i=this.createElement("span",{className:tg.tickValue+" "+tg.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});t.appendChild(i),i.innerHTML=h(this.customValues)?this.formatTicksValue(t,e):e},e.prototype.formatTicksValue=function(t,e){var i=this.formatNumber(e),n={value:e,text:h(this.ticks)||h(this.ticks.format)?i:this.formatString(e,this.ticksFormatInfo).formatString,tickElement:t};return this.trigger("renderingTicks",n),t.setAttribute("title",n.text.toString()),n.text.toString()},e.prototype.scaleAlignment=function(){this.tickValuePosition();this.orientation;"Vertical"===this.orientation?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(tg.sliderSmallSize):this.sliderContainer.classList.remove(tg.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(tg.sliderSmallSize):this.sliderContainer.classList.remove(tg.sliderSmallSize)},e.prototype.tickValuePosition=function(){var t,e=this.firstChild.getBoundingClientRect(),i=this.ticks.smallStep,n=Math.abs(parseFloat(m(this.max))-parseFloat(m(this.min)))/i;this.firstChild.children.length>0&&(t=this.firstChild.children[0].getBoundingClientRect());var o,r=[this.sliderContainer.querySelectorAll("."+tg.tick+"."+tg.large+" ."+tg.tickValue)];o="Both"===this.ticks.placement?[].slice.call(r[0],2):[].slice.call(r[0],1);for(var s="Vertical"===this.orientation?2*e.height:2*e.width,a=0;a<this.firstChild.children.length;a++)"Vertical"===this.orientation?this.firstChild.children[a].style.top=-t.height/2+"px":this.enableRtl?this.firstChild.children[a].style.left=(s-this.firstChild.children[a].getBoundingClientRect().width)/2+"px":this.firstChild.children[a].style.left=-t.width/2+"px";for(a=0;a<o.length;a++){var l=o[a].getBoundingClientRect();"Vertical"===this.orientation?I(o[a],{top:(s-l.height)/2+"px"}):I(o[a],{left:(s-l.width)/2+"px"})}this.enableRtl&&this.lastChild.children.length&&0!==n&&(this.lastChild.children[0].style.left=-this.lastChild.getBoundingClientRect().width/2+"px","Both"===this.ticks.placement&&(this.lastChild.children[1].style.left=-this.lastChild.getBoundingClientRect().width/2+"px")),0===n&&("Horizontal"===this.orientation&&(this.enableRtl?(this.firstChild.classList.remove(tg.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px","Both"===this.ticks.placement&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(tg.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),"Vertical"===this.orientation&&this.firstChild.classList.remove(tg.sliderLastTick))},e.prototype.setAriaAttrValue=function(t){var e,i=!h(this.ticks)&&!h(this.ticks.format),n=i?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),o=i?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);e=2===(n=this.customAriaText?this.customAriaText:n).split(" - ").length?n.split(" - "):[n,n],this.setAriaAttributes(t),"Range"!==this.type?k(t,{"aria-valuenow":o,"aria-valuetext":n}):this.enableRtl?t===this.firstHandle?k(t,{"aria-valuenow":o.split(" - ")[1],"aria-valuetext":e[1]}):k(t,{"aria-valuenow":o.split(" - ")[0],"aria-valuetext":e[0]}):t===this.firstHandle?k(t,{"aria-valuenow":o.split(" - ")[0],"aria-valuetext":e[0]}):k(t,{"aria-valuenow":o.split(" - ")[1],"aria-valuetext":e[1]})},e.prototype.handleValueUpdate=function(){return"Range"===this.type?1===this.activeHandle?this.handleVal1:this.handleVal2:this.handleVal1},e.prototype.getLimitCorrectedValues=function(t){return t="MinRange"===this.type||"Default"===this.type?this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:1===this.activeHandle?this.getLimitValueAndPosition(t,this.limits.minStart,this.limits.minEnd)[0]:this.getLimitValueAndPosition(t,this.limits.maxStart,this.limits.maxEnd)[0]},e.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},e.prototype.buttonClick=function(t){this.focusSliderElement();var e,i=this.enableRtl&&"Vertical"!==this.orientation,n=this.handleValueUpdate();40===t.keyCode||37===t.keyCode||t.currentTarget.classList.contains(tg.firstButton)?e=i?this.add(n,parseFloat(this.step.toString()),!0):this.add(n,parseFloat(this.step.toString()),!1):38===t.keyCode||39===t.keyCode||t.currentTarget.classList.contains(tg.secondButton)?e=i?this.add(n,parseFloat(this.step.toString()),!1):this.add(n,parseFloat(this.step.toString()),!0):33===t.keyCode||t.currentTarget.classList.contains(tg.firstButton)?e=i?this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):34===t.keyCode||t.currentTarget.classList.contains(tg.secondButton)?e=i?this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):36===t.keyCode?e=parseFloat(this.min.toString()):35===t.keyCode&&(e=parseFloat(this.max.toString())),this.limits.enabled&&(e=this.getLimitCorrectedValues(e)),this.changeHandleValue(e),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(tg.sliderTabHandle)||this.materialChange(),this.tooltipAnimation(),this.getHandle().focus(),t.currentTarget.classList.contains(tg.firstButton)&&ha.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),t.currentTarget.classList.contains(tg.secondButton)&&ha.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},e.prototype.tooltipAnimation=function(){if(this.tooltip.isVisible){var t=1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj,e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;this.isMaterial?e.classList.contains(tg.materialTooltipOpen)?this.refreshTooltip():this.openMaterialTooltip():(t.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.openTooltip())}},e.prototype.buttonUp=function(t){this.tooltip.isVisible&&(this.isMaterial||((1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj).animation={open:{effect:"None"},close:{effect:"None"}})),t.currentTarget.classList.contains(tg.firstButton)&&ha.remove(this.firstBtn,"mouseup touchend",this.buttonUp),t.currentTarget.classList.contains(tg.secondButton)&&ha.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},e.prototype.setRangeBar=function(){"Horizontal"===this.orientation?"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",I(this.rangeBar,{width:h(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",I(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):"MinRange"===this.type?(this.rangeBar.style.bottom="0px",I(this.rangeBar,{height:h(this.handlePos1)?0:this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.handlePos1+"px",I(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))},e.prototype.checkValidValueAndPos=function(t){return t=this.checkHandleValue(t),t=this.checkHandlePosition(t)},e.prototype.setLimitBarPositions=function(t,e,i,n){"Horizontal"===this.orientation?this.enableRtl?(this.limitBarFirst.style.right=t+"px",this.limitBarFirst.style.width=e-t+"px"):(this.limitBarFirst.style.left=t+"px",this.limitBarFirst.style.width=e-t+"px"):(this.limitBarFirst.style.bottom=t+"px",this.limitBarFirst.style.height=e-t+"px"),"Range"===this.type&&("Horizontal"===this.orientation?this.enableRtl?(this.limitBarSecond.style.right=i+"px",this.limitBarSecond.style.width=n-i+"px"):(this.limitBarSecond.style.left=i+"px",this.limitBarSecond.style.width=n-i+"px"):(this.limitBarSecond.style.bottom=i+"px",this.limitBarSecond.style.height=n-i+"px"))},e.prototype.setLimitBar=function(){if("Default"===this.type||"MinRange"===this.type){var t=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];t=this.checkValidValueAndPos(t);var e=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e),this.setLimitBarPositions(t,e)}else if("Range"===this.type){var i=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var o=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];o=this.checkValidValueAndPos(o);var r=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];r=this.checkValidValueAndPos(r),this.setLimitBarPositions(i,n,o,r)}},e.prototype.getLimitValueAndPosition=function(t,e,i,n){return h(e)&&(e=this.min,h(t)&&n&&(t=e)),h(i)&&(i=this.max,h(t)&&n&&(t=i)),t<e&&(t=e),t>i&&(t=i),[t,this.checkHandlePosition(t)]},e.prototype.setValue=function(){if(!h(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1),this.setAriaAttributes(this.firstHandle),this.handleVal1=h(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,h(this.activeHandle)?"Range"===this.type?this.activeHandle=2:this.activeHandle=1:this.activeHandle=this.activeHandle,"Default"===this.type||"MinRange"===this.type){if(this.limits.enabled){var t=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=t[0],this.handlePos1=t[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed")}else this.validateRangeValue();"Default"!==this.type&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},e.prototype.rangeValueUpdate=function(){null!==this.value&&"object"==typeof this.value||(this.value=[parseFloat(m(this.min)),parseFloat(m(this.max))])},e.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},e.prototype.modifyZindex=function(){"Range"===this.type?1===this.activeHandle?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+"",this.isMaterial&&this.tooltip.isVisible&&this.firstTooltipElement&&this.secondTooltipElement&&(this.firstTooltipElement.style.zIndex=this.zIndex+4+"",this.secondTooltipElement.style.zIndex=this.zIndex+3+"")):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+"",this.isMaterial&&this.tooltip.isVisible&&this.firstTooltipElement&&this.secondTooltipElement&&(this.firstTooltipElement.style.zIndex=this.zIndex+3+"",this.secondTooltipElement.style.zIndex=this.zIndex+4+"")):this.isMaterial&&this.tooltip.isVisible&&this.firstTooltipElement&&(this.firstTooltipElement.style.zIndex=this.zIndex+4+"")},e.prototype.setHandlePosition=function(){var t,e,i=this,n=1===this.activeHandle?this.handlePos1:this.handlePos2;1===this.activeHandle?this.handleVal1:this.handleVal2;this.isMaterial&&this.tooltip.isVisible?(e=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement,t=[this.getHandle(),1===this.activeHandle?this.firstMaterialHandle:this.secondMaterialHandle]):t=[this.getHandle()],this.tooltip.isVisible&&0===n&&"Range"!==this.type?(t[0].classList.add(tg.sliderHandleStart),this.isMaterial&&(t[1].classList.add(tg.sliderHandleStart),e&&e.classList.add(tg.sliderTooltipStart))):(t[0].classList.remove(tg.sliderHandleStart),this.tooltip.isVisible&&this.isMaterial&&(t[1].classList.remove(tg.sliderHandleStart),e&&e.classList.remove(tg.sliderTooltipStart))),t.forEach(function(t){"Horizontal"===i.orientation?i.enableRtl?t.style.right=n+"px":t.style.left=n+"px":t.style.bottom=n+"px"}),this.changeEvent("change")},e.prototype.getHandle=function(){return 1===this.activeHandle?this.firstHandle:this.secondHandle},e.prototype.setRangeValue=function(){this.activeHandle;this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(),this.activeHandle=2,this.setHandlePosition(),this.activeHandle=1},e.prototype.changeEvent=function(t){var e="change"===t?this.previousVal:this.previousChanged;if("Range"!==this.type)this.setProperties({value:this.handleVal1},!0),e!==this.value&&(this.trigger(t,this.changeEventArgs(t)),this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.firstHandle);else{var i=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:i},!0),(e.length===this.value.length&&this.value[0]!==e[0]||this.value[1]!==e[1])&&(this.trigger(t,this.changeEventArgs(t)),this.setPreviousVal(t,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},e.prototype.changeEventArgs=function(t){var e;return this.tooltip.isVisible&&this.firstTooltipObj?(this.tooltipValue(),e={value:this.value,previousValue:"change"===t?this.previousVal:this.previousChanged,action:t,text:this.firstTooltipObj.content}):e={value:this.value,previousValue:"change"===t?this.previousVal:this.previousChanged,action:t,text:h(this.ticksFormatInfo.format)?this.value.toString():"Range"!==this.type?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString},e},e.prototype.setPreviousVal=function(t,e){"change"===t?this.previousVal=e:this.previousChanged=e},e.prototype.updateRangeValue=function(){var t=this.value.toString().split(",").map(Number);if(this.enableRtl&&"Vertical"!==this.orientation||this.rtl?this.value=[t[1],t[0]]:this.value=[t[0],t[1]],this.enableRtl&&"Vertical"!==this.orientation?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,e=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=e[0],this.handlePos2=e[1],this.preHandlePos2=this.handlePos2}},e.prototype.checkHandlePosition=function(t){var e;return t=100*(t-parseFloat(m(this.min)))/(parseFloat(m(this.max))-parseFloat(m(this.min))),e="Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(t/100):this.element.getBoundingClientRect().height*(t/100),parseFloat(m(this.max))===parseFloat(m(this.min))&&(e="Horizontal"===this.orientation?this.element.getBoundingClientRect().width:this.element.getBoundingClientRect().height),e},e.prototype.checkHandleValue=function(t){if(this.min>this.max&&(this.min=this.max),this.min===this.max)return parseFloat(m(this.max));var e=this.tempStartEnd();return t<e.start?t=e.start:t>e.end&&(t=e.end),t},e.prototype.onResize=function(){var t=this;this.firstHandle.style.transition="none","Default"!==this.type&&(this.rangeBar.style.transition="none"),"Range"===this.type&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),"Horizontal"===this.orientation?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterial&&this.tooltip.isVisible&&this.firstMaterialHandle&&(this.enableRtl?this.firstMaterialHandle.style.right=this.handlePos1+"px":this.firstMaterialHandle.style.left=this.handlePos1+"px"),"MinRange"===this.type?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",I(this.rangeBar,{width:h(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.enableRtl?this.secondHandle.style.right=this.handlePos2+"px":this.secondHandle.style.left=this.handlePos2+"px",this.isMaterial&&this.tooltip.isVisible&&this.secondMaterialHandle&&(this.enableRtl?this.secondMaterialHandle.style.right=this.handlePos2+"px":this.secondMaterialHandle.style.left=this.handlePos2+"px"),this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",I(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterial&&this.tooltip.isVisible&&this.firstMaterialHandle&&(this.firstMaterialHandle.style.bottom=this.handlePos1+"px"),"MinRange"===this.type?(this.rangeBar.style.bottom="0px",I(this.rangeBar,{height:h(this.handlePos1)?0:this.handlePos1+"px"})):"Range"===this.type&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.isMaterial&&this.tooltip.isVisible&&this.secondMaterialHandle&&(this.secondMaterialHandle.style.bottom=this.handlePos2+"px"),this.rangeBar.style.bottom=this.handlePos1+"px",I(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.renderScale()),this.tooltip.isVisible||setTimeout(function(){t.firstHandle.style.transition=t.scaleTransform,"Range"===t.type&&(t.secondHandle.style.transition=t.scaleTransform)}),this.refreshTooltip()},e.prototype.changeHandleValue=function(t){var e=null;1===this.activeHandle?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(t),this.handlePos1=this.checkHandlePosition(this.handleVal1),"Range"===this.type&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(e=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(t),this.handlePos2=this.checkHandlePosition(this.handleVal2),"Range"===this.type&&this.handlePos2<this.handlePos1&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(e=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),null!==e&&("Default"!==this.type&&this.setRangeBar(),this.setHandlePosition())},e.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},e.prototype.xyToPosition=function(t){if(this.min===this.max)return 100;if("Horizontal"===this.orientation){var e=t.x-this.element.getBoundingClientRect().left,i=this.element.offsetWidth/100;this.val=e/i}else{var n=t.y-this.element.getBoundingClientRect().top,i=this.element.offsetHeight/100;this.val=100-n/i}var o=this.stepValueCalculation(this.val);return o<0?o=0:o>100&&(o=100),this.enableRtl&&"Vertical"!==this.orientation&&(o=100-o),"Horizontal"===this.orientation?this.element.getBoundingClientRect().width*(o/100):this.element.getBoundingClientRect().height*(o/100)},e.prototype.stepValueCalculation=function(t){0===this.step&&(this.step=1);var e=parseFloat(m(this.step))/((parseFloat(m(this.max))-parseFloat(m(this.min)))/100),i=t%Math.abs(e);return 0!==i&&(e/2>i?t-=i:t+=Math.abs(e)-i),t},e.prototype.add=function(t,e,i){var n=Math.pow(10,3);return i?(Math.round(t*n)+Math.round(e*n))/n:(Math.round(t*n)-Math.round(e*n))/n},e.prototype.round=function(t){var e=this.step.toString().split(".");return e[1]?parseFloat(t.toFixed(e[1].length)):Math.round(t)},e.prototype.positionToValue=function(t){var e,i=parseFloat(m(this.max))-parseFloat(m(this.min));return e="Horizontal"===this.orientation?t/this.element.getBoundingClientRect().width*i:t/this.element.getBoundingClientRect().height*i,this.add(e,parseFloat(this.min.toString()),!0)},e.prototype.sliderBarClick=function(t){t.preventDefault();var e;"mousedown"===t.type||"click"===t.type?e={x:t.clientX,y:t.clientY}:"touchstart"===t.type&&(e={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY});var i=this.xyToPosition(e),n=this.positionToValue(i);if("Range"===this.type&&this.handlePos2-i<i-this.handlePos1)this.activeHandle=2,this.limits.enabled&&this.limits.endHandleFixed||(this.limits.enabled&&(n=(o=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd))[0],i=o[1]),this.secondHandle.classList.add(tg.sliderActiveHandle),this.handlePos2=this.preHandlePos2=i,this.handleVal2=n),this.modifyZindex(),this.secondHandle.focus();else{if(this.activeHandle=1,!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){var o=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=o[0],i=o[1]}this.firstHandle.classList.add(tg.sliderActiveHandle),this.handlePos1=this.preHandlePos1=i,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterial&&this.tooltip.isVisible&&(1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement).classList.add(tg.materialTooltipActive);var r=this.element.querySelector("."+tg.sliderTabHandle);r&&this.getHandle()!==r&&r.classList.remove(tg.sliderTabHandle);var s=1===this.activeHandle?this.firstHandle:this.secondHandle;if(t.target===s)return!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(tg.sliderTabHandle)||this.materialChange(),void this.tooltipAnimation();if(this.checkRepeatedValue(n)){var a=this.isMaterial&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=a.handle,"Default"!==this.type&&(this.rangeBar.style.transition=a.rangeBar),this.setHandlePosition(),"Default"!==this.type&&this.setRangeBar()}},e.prototype.refreshTooltipOnMove=function(){this.tooltip.isVisible&&(this.tooltipValue(),1===this.activeHandle?this.firstTooltipObj.refresh(this.firstHandle):this.secondTooltipObj.refresh(this.secondHandle))},e.prototype.sliderDown=function(t){if(t.preventDefault(),this.focusSliderElement(),"Range"===this.type&&this.drag&&t.target===this.rangeBar){var e=void 0,i=void 0;"mousedown"===t.type?(e=(n=[t.clientX,t.clientY])[0],i=n[1]):"touchstart"===t.type&&(e=(o=[t.changedTouches[0].clientX,t.changedTouches[0].clientY])[0],i=o[1]),"Horizontal"===this.orientation?(this.firstPartRemain=e-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-e):(this.firstPartRemain=i-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-i),this.minDiff=this.handleVal2-this.handleVal1,this.getHandle().focus(),ha.add(document,"mousemove touchmove",this.dragRangeBarMove,this),ha.add(document,"mouseup touchend",this.dragRangeBarUp,this)}else this.sliderBarClick(t),ha.add(document,"mousemove touchmove",this.sliderBarMove,this),ha.add(document,"mouseup touchend",this.sliderBarUp,this);var n,o},e.prototype.handleValueAdjust=function(t,e,i){1===i?(this.handleVal1=e,this.handleVal2=this.handleVal1+this.minDiff):2===i&&(this.handleVal2=e,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},e.prototype.dragRangeBarMove=function(t){"touchmove"!==t.type&&t.preventDefault();var e;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var i,n;if("mousemove"===t.type?(i=(r=[t.clientX,t.clientY])[0],n=r[1]):(i=(s=[t.changedTouches[0].clientX,t.changedTouches[0].clientY])[0],n=s[1]),!(this.limits.enabled&&this.limits.startHandleFixed||this.limits.enabled&&this.limits.endHandleFixed)){if(e=this.enableRtl?{x:i+this.secondPartRemain,y:n+this.secondPartRemain}:{x:i-this.firstPartRemain,y:n+this.secondPartRemain},this.handlePos1=this.xyToPosition(e),this.handleVal1=this.positionToValue(this.handlePos1),e=this.enableRtl?{x:i-this.firstPartRemain,y:n-this.firstPartRemain}:{x:i+this.secondPartRemain,y:n-this.firstPartRemain},this.handlePos2=this.xyToPosition(e),this.handleVal2=this.positionToValue(this.handlePos2),this.limits.enabled){var o=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=o[0],this.handlePos1=o[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),o=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=o[0],this.handlePos2=o[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===this.max&&this.handleValueAdjust(this.handleVal2,this.max,2),this.handleVal1===this.min&&this.handleValueAdjust(this.handleVal1,this.min,1)}this.activeHandle=1,this.setHandlePosition(),this.tooltip.isVisible&&(this.isMaterial?this.firstTooltipElement.classList.contains(tg.materialTooltipOpen)?this.refreshTooltipOnMove():this.openMaterialTooltip():this.firstTooltipElement?this.refreshTooltipOnMove():this.openTooltip()),this.activeHandle=2,this.setHandlePosition(),this.tooltip.isVisible&&(this.isMaterial?this.secondTooltipElement.classList.contains(tg.materialTooltipOpen)?this.refreshTooltipOnMove():this.openMaterialTooltip():this.secondTooltipElement?this.refreshTooltipOnMove():this.openTooltip()),this.setRangeBar();var r,s},e.prototype.sliderBarUp=function(){this.changeEvent("changed"),this.handleFocusOut(),this.firstHandle.classList.remove(tg.sliderActiveHandle),"Range"===this.type&&this.secondHandle.classList.remove(tg.sliderActiveHandle),this.tooltip.isVisible&&("Always"!==this.tooltip.showOn&&this.closeTooltip(),this.isMaterial||((1===this.activeHandle?this.firstTooltipObj:this.secondTooltipObj).animation={open:{effect:"None"},close:{effect:"None"}})),this.isMaterial&&(this.getHandle().classList.remove("e-large-thumb-size"),this.tooltip.isVisible&&(1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement).classList.remove(tg.materialTooltipActive)),ha.remove(document,"mousemove touchmove",this.sliderBarMove),ha.remove(document,"mouseup touchend",this.sliderBarUp)},e.prototype.sliderBarMove=function(t){"touchmove"!==t.type&&t.preventDefault();var e;e="mousemove"===t.type?{x:t.clientX,y:t.clientY}:{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};var i=this.xyToPosition(e),n=this.positionToValue(i);if(i=Math.round(i),"Range"!==this.type&&1===this.activeHandle){if(!this.limits.enabled||!this.limits.startHandleFixed){if(this.limits.enabled){var o=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);i=o[1],n=o[0]}this.handlePos1=i,this.handleVal1=n}this.firstHandle.classList.add(tg.sliderActiveHandle)}if("Range"===this.type)if(1===this.activeHandle)this.firstHandle.classList.add(tg.sliderActiveHandle),this.limits.enabled&&this.limits.startHandleFixed||(i>this.handlePos2&&(i=this.handlePos2,n=this.handleVal2),i!==this.preHandlePos1&&(this.limits.enabled&&(n=(r=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd))[0],i=r[1]),this.handlePos1=this.preHandlePos1=i,this.handleVal1=n,this.activeHandle=1));else if(2===this.activeHandle&&(this.secondHandle.classList.add(tg.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed||(i<this.handlePos1&&(i=this.handlePos1,n=this.handleVal1),i===this.preHandlePos2)))){if(this.limits.enabled){var r=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=r[0],i=r[1]}this.handlePos2=this.preHandlePos2=i,this.handleVal2=n,this.activeHandle=2}if(this.checkRepeatedValue(n)){this.getHandle().style.transition=this.scaleTransform,"Default"!==this.type&&(this.rangeBar.style.transition="none"),this.setHandlePosition(),!this.isMaterial||this.tooltip.isVisible||this.getHandle().classList.contains(tg.sliderTabHandle)||this.materialChange();var s=1===this.activeHandle?this.firstTooltipElement:this.secondTooltipElement;this.tooltip.isVisible&&(this.isMaterial?s.classList.contains(tg.materialTooltipOpen)?this.refreshTooltipOnMove():this.openMaterialTooltip():s?this.refreshTooltipOnMove():this.openTooltip()),"Default"!==this.type&&this.setRangeBar()}},e.prototype.dragRangeBarUp=function(t){this.changeEvent("changed"),this.tooltip.isVisible&&("Always"===this.tooltip.showOn||this.isMaterial||(this.activeHandle=1,this.firstTooltipObj.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.closeTooltip(),this.activeHandle=2,this.secondTooltipObj.animation={open:{effect:"None"},close:{effect:"FadeOut",duration:500}},this.closeTooltip())),ha.remove(document,"mousemove touchmove",this.dragRangeBarMove),ha.remove(document,"mouseup touchend",this.dragRangeBarUp)},e.prototype.checkRepeatedValue=function(t){if("Range"===this.type){if(t===(this.enableRtl&&"Vertical"!==this.orientation?1===this.activeHandle?this.previousVal[1]:this.previousVal[0]:1===this.activeHandle?this.previousVal[0]:this.previousVal[1]))return 0}else if(t===this.previousVal)return 0;return 1},e.prototype.refreshTooltip=function(){this.tooltip.isVisible&&this.firstTooltipObj&&(this.tooltipValue(),this.firstTooltipObj.refresh(this.firstHandle),"Range"===this.type&&this.secondTooltipObj.refresh(this.secondHandle))},e.prototype.openTooltip=function(){this.tooltip.isVisible&&this.firstTooltipObj&&(this.tooltipValue(),this.isMaterial?this.openMaterialTooltip():1===this.activeHandle?this.firstTooltipObj.open(this.firstHandle):this.secondTooltipObj.open(this.secondHandle))},e.prototype.keyDown=function(t){switch(t.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:t.preventDefault(),this.buttonClick(t),this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&!this.isMaterial&&this.closeTooltip()}},e.prototype.wireButtonEvt=function(t){t?(ha.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),ha.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),ha.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),ha.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),ha.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),ha.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),ha.remove(this.firstBtn,"focusout",this.sliderFocusOut),ha.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(ha.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),ha.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),ha.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),ha.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),ha.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),ha.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),ha.add(this.firstBtn,"focusout",this.sliderFocusOut,this),ha.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},e.prototype.wireEvents=function(){this.onresize=this.onResize.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(ha.add(this.element,"mousedown touchstart",this.sliderDown,this),ha.add(this.sliderContainer,"keydown",this.keyDown,this),ha.add(this.sliderContainer,"keyup",this.keyUp,this),ha.add(this.element,"focusout",this.sliderFocusOut,this),ha.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1))},e.prototype.unwireEvents=function(){ha.remove(this.element,"mousedown touchstart",this.sliderDown),ha.remove(this.sliderContainer,"keydown",this.keyDown),ha.remove(this.sliderContainer,"keyup",this.keyUp),ha.remove(this.element,"focusout",this.sliderFocusOut),ha.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),"Range"===this.type&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0)},e.prototype.keyUp=function(t){if(9===t.keyCode&&t.target.classList.contains(tg.sliderHandle)&&(this.focusSliderElement(),!t.target.classList.contains(tg.sliderTabHandle))){this.element.querySelector("."+tg.sliderTabHandle)&&this.element.querySelector("."+tg.sliderTabHandle).classList.remove(tg.sliderTabHandle),t.target.classList.add(tg.sliderTabHandle);var e=t.target.parentElement;e===this.element&&(e.querySelector("."+tg.sliderTrack).classList.add(tg.sliderTabTrack),"Range"!==this.type&&"MinRange"!==this.type||e.querySelector("."+tg.rangeBar).classList.add(tg.sliderTabRange)),"Range"===this.type&&(t.target.previousSibling.classList.contains(tg.sliderHandle)?this.activeHandle=2:this.activeHandle=1),this.getHandle().focus(),this.tooltipAnimation(),this.tooltip.isVisible&&"Always"!==this.tooltip.showOn&&!this.isMaterial&&this.closeTooltip()}this.changeEvent("changed")},e.prototype.hover=function(t){h(t)||("mouseover"===t.type||"touchmove"===t.type||"mousemove"===t.type||"pointermove"===t.type||"touchstart"===t.type?this.sliderContainer.classList.add(tg.sliderHover):this.sliderContainer.classList.remove(tg.sliderHover))},e.prototype.sliderFocusOut=function(t){var e=this;if(t.relatedTarget!==this.secondHandle&&t.relatedTarget!==this.firstHandle&&t.relatedTarget!==this.element&&t.relatedTarget!==this.firstBtn&&t.relatedTarget!==this.secondBtn){if(this.isMaterial&&this.tooltip.isVisible){var i=this.getTooltipTransformProperties(this.previousTooltipClass),n="Range"!==this.type?[this.firstTooltipElement]:[this.firstTooltipElement,this.secondTooltipElement],o="Range"!==this.type?[this.firstHandle]:[this.firstHandle,this.secondHandle],r="Range"!==this.type?[this.firstMaterialHandle]:[this.firstMaterialHandle,this.secondMaterialHandle];n.forEach(function(t,n){t&&(t.style.transition=e.scaleTransform,t.firstChild.classList.remove(tg.materialTooltipShow),t.firstChild.classList.add(tg.materialTooltipHide),o[n].style.cursor="-webkit-grab",o[n].style.cursor="grab",r[n].style.transform="scale(1)",t.classList.remove(tg.materialTooltipOpen),t.firstElementChild.innerText.length>4?t.style.transform=i.translate+" scale(0.01)":t.style.transform=i.translate+" "+i.rotate+" scale(0.01)",setTimeout(function(){t.style.transition="none"},2500))})}this.element.querySelector("."+tg.sliderTabHandle)&&this.element.querySelector("."+tg.sliderTabHandle).classList.remove(tg.sliderTabHandle),this.element.querySelector("."+tg.sliderTabTrack)&&(this.element.querySelector("."+tg.sliderTabTrack).classList.remove(tg.sliderTabTrack),"Range"!==this.type&&"MinRange"!==this.type||!this.element.querySelector("."+tg.sliderTabRange)||this.element.querySelector("."+tg.sliderTabRange).classList.remove(tg.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1}},e.prototype.closeTooltip=function(){this.tooltip.isVisible&&(this.tooltipValue(),1===this.activeHandle?this.firstTooltipObj.close():this.secondTooltipObj.close())},e.prototype.removeElement=function(t){t.parentNode&&t.parentNode.removeChild(t)},e.prototype.changeSliderType=function(t){this.isMaterial&&this.firstMaterialHandle&&(this.sliderContainer.classList.remove(tg.materialSlider),this.removeElement(this.firstMaterialHandle),this.firstTooltipElement=void 0,this.firstHandleTooltipPosition=void 0,this.secondMaterialHandle&&(this.removeElement(this.secondMaterialHandle),this.secondTooltipElement=void 0,this.secondHandleTooltipPosition=void 0)),this.tooltip.isVisible&&this.isMaterial&&this.sliderContainer.classList.add(tg.materialSlider),this.removeElement(this.firstHandle),"Default"!==t&&("Range"===t&&this.removeElement(this.secondHandle),this.removeElement(this.rangeBar)),this.tooltip.isVisible&&!h(this.firstTooltipObj)&&(this.firstTooltipObj.destroy(),"Range"!==t||h(this.secondTooltipObj)||this.secondTooltipObj.destroy()),(this.limits.enabled&&"MinRange"===t||"Default"===t)&&(h(this.limitBarFirst)||this.removeElement(this.limitBarFirst)),"Range"===t&&this.limits.enabled&&(h(this.limitBarFirst)||h(this.limitBarSecond)||(this.removeElement(this.limitBarFirst),this.removeElement(this.limitBarSecond))),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),"Range"===this.type&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.updateConfig()},e.prototype.changeRtl=function(){if(this.enableRtl||"Range"!==this.type||(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&(this.firstTooltipObj.refresh(this.firstHandle),"Range"===this.type&&this.secondTooltipObj.refresh(this.secondHandle)),this.showButtons){var t=this.enableRtl&&"Vertical"!==this.orientation;k(t?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),k(t?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},e.prototype.changeOrientation=function(){this.changeSliderType(this.type)},e.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(),"None"!==this.ticks.placement&&this.ul&&(this.removeElement(this.ul),this.renderScale()),this.limitsPropertyChange()},e.prototype.limitsPropertyChange=function(){this.limits.enabled?(h(this.limitBarFirst)&&"Range"!==this.type&&this.createLimitBar(),h(this.limitBarFirst)&&h(this.limitBarSecond)&&"Range"===this.type&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(h(this.limitBarFirst)||L(this.limitBarFirst),h(this.limitBarSecond)||L(this.limitBarSecond))},e.prototype.getPersistData=function(){var t=["value"];return this.addOnPersist(t)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),x([this.sliderContainer],[tg.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),"Range"===this.type&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),L(this.sliderContainer),this.tooltip.isVisible&&(this.firstTooltipObj.destroy(),"Range"!==this.type||h(this.secondTooltipObj)||this.secondTooltipObj.destroy()),this.element.innerHTML=""},e.prototype.onPropertyChanged=function(t,e){for(var i=this,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"cssClass":this.setCSSClass(e.cssClass);break;case"value":h(e.value)||h(t.value)||e.value.toString()!==t.value.toString()&&(this.setValue(),this.refreshTooltip(),"Range"===this.type&&(e.value[0]===t.value[0]?this.activeHandle=2:this.activeHandle=1));break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":h(t.tooltip)||h(e.tooltip)||this.setTooltip();break;case"type":this.changeSliderType(e.type),this.setZindex();break;case"enableRtl":e.enableRtl!==t.enableRtl&&"Vertical"!==this.orientation&&(this.rtl=e.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":h(this.sliderContainer.querySelector("."+tg.scale))||(L(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(t){t.match(/e-scale-/)&&i.sliderContainer.classList.remove(t)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":t.showButtons?(this.setButtons(),this.onResize(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.firstBtn=void 0,this.secondBtn=void 0);break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValue":this.setValue(),this.onResize()}},e.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(tg.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(tg.readonly))},e.prototype.setMinMaxValue=function(){var t=this;this.setValue(),this.refreshTooltip(),h(this.sliderContainer.querySelector("."+tg.scale))||this.ul&&(L(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(e){e.match(/e-scale-/)&&t.sliderContainer.classList.remove(e)})),"None"!==this.ticks.placement&&(this.renderScale(),this.setZindex())},e.prototype.setZindex=function(){this.zIndex=6,h(this.ticks)||"None"===this.ticks.placement||(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),this.isMaterial||h(this.ticks)||"Both"!==this.ticks.placement||(this.element.style.zIndex=this.zIndex+2+""),this.firstHandle.style.zIndex=this.zIndex+3+"","Range"===this.type&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},e.prototype.setTooltip=function(){this.changeSliderType(this.type)},e.prototype.getModuleName=function(){return"slider"},Ku([Y(null)],e.prototype,"value",void 0),Ku([Y(null)],e.prototype,"customValues",void 0),Ku([Y(1)],e.prototype,"step",void 0),Ku([Y(0)],e.prototype,"min",void 0),Ku([Y(100)],e.prototype,"max",void 0),Ku([Y(!1)],e.prototype,"readonly",void 0),Ku([Y("Default")],e.prototype,"type",void 0),Ku([G({},Qu)],e.prototype,"ticks",void 0),Ku([G({},Ju)],e.prototype,"limits",void 0),Ku([Y(!0)],e.prototype,"enabled",void 0),Ku([Y(!1)],e.prototype,"enableRtl",void 0),Ku([G({},$u)],e.prototype,"tooltip",void 0),Ku([Y(!1)],e.prototype,"showButtons",void 0),Ku([Y(!0)],e.prototype,"enableAnimation",void 0),Ku([Y("Horizontal")],e.prototype,"orientation",void 0),Ku([Y("")],e.prototype,"cssClass",void 0),Ku([J()],e.prototype,"created",void 0),Ku([J()],e.prototype,"change",void 0),Ku([J()],e.prototype,"changed",void 0),Ku([J()],e.prototype,"renderingTicks",void 0),Ku([J()],e.prototype,"renderedTicks",void 0),Ku([J()],e.prototype,"tooltipChange",void 0),e=Ku([$],e)}(Ka),ig=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ng=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},og=new RegExp("^[A-Za-z0-9._%+-]{3,}@[a-zA-Z]{3,}([.]{1}[a-zA-Z]{2,5}|[.]{1}[a-zA-Z]{2,4}[.]{1}[a-zA-Z]{2,4})$"),rg=new RegExp("^((ftp|http|https)://)?www.([A-z]{2,}).([A-z]{2,})$"),sg=new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),ag=new RegExp("^[0-9]*$"),lg=new RegExp("^[+]?[0-9]{9,13}$"),hg=new RegExp("^\\d{13,16}$");!function(t){t[t.Message=0]="Message",t[t.Label=1]="Label"}(Nu||(Nu={}));!function(t){function e(e,i){var n=t.call(this,i,e)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},void 0===n.rules&&(n.rules={}),e="string"==typeof e?O(e,document):e,null!=n.element)return n.element.setAttribute("novalidate",""),n.inputElements=A(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents(),n}return ig(e,t),i=e,e.prototype.addRules=function(t,e){t&&(this.rules.hasOwnProperty(t)?l(this.rules[t],e,{}):this.rules[t]=e)},e.prototype.removeRules=function(t,e){if(t||e)if(this.rules[t]&&!e)delete this.rules[t];else{if(h(this.rules[t]&&e))return;for(var i=0;i<e.length;i++)delete this.rules[t][e[i]]}else this.rules={}},e.prototype.validate=function(t){var e=Object.keys(this.rules);if(t&&e.length)return this.validateRules(t),-1!==e.indexOf(t)&&0===this.errorRules.filter(function(e){return e.name===t}).length;for(var i=0,n=e;i<n.length;i++){var o=n[i];this.validateRules(o)}return 0===this.errorRules.length},e.prototype.reset=function(){this.element.reset(),this.clearForm()},e.prototype.getInputElement=function(t){return this.inputElement=O("[name="+t+"]",this.element),this.inputElement},e.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var e=0,i=A("."+this.errorClass+", ."+this.validClass,this.element);e<i.length;e++)i[e].remove();t.prototype.destroy.call(this)},e.prototype.onPropertyChanged=function(t,e){},e.prototype.getModuleName=function(){return"formValidator"},e.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var t=0,e=A(this.selectQuery,this.element);t<e.length;t++){var i=e[t];i.removeAttribute("aria-invalid"),i.classList.remove(this.errorClass),i.name.length>0&&(this.getInputElement(i.name),this.getErrorElement(i.name),this.hideMessage(i.name)),i.classList.remove(this.validClass)}},e.prototype.createHTML5Rules=function(){for(var t=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],e=["hidden","email","url","date","number","tel"],i=0,n=this.inputElements;i<n.length;i++){for(var o=n[i],r={},s=0,a=t;s<a.length;s++){var l=a[s];if(null!==o.getAttribute(l))switch(l){case"required":this.defRule(o,r,l,o.required);break;case"data-validation":l=o.getAttribute(l),this.defRule(o,r,l,!0);break;case"type":-1!==e.indexOf(o.type)&&this.defRule(o,r,o.type,!0);break;case"rangeLength":case"range":this.defRule(o,r,l,JSON.parse(o.getAttribute(l)));break;case"equalTo":var h=o.getAttribute(l);this.defRule(o,r,l,h);break;default:"true"===o.getAttribute("data-val")?this.annotationRule(o,r,l,o.getAttribute(l)):this.defRule(o,r,l,o.getAttribute(l))}}0!==Object.keys(r).length&&this.addRules(o.name,r)}},e.prototype.annotationRule=function(t,e,i,n){var o=i.split("-"),r=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],s=o[o.length-1],a=o[o.length-2];if(-1!==r.indexOf(s))switch(s){case"required":this.defRule(t,e,"required",n);break;case"creditcard":this.defRule(t,e,"creditcard",n);break;case"phone":this.defRule(t,e,"tel",n)}else if(-1!==r.indexOf(a))switch(a){case"maxlength":this.defRule(t,e,"maxLength",n);break;case"minlength":this.defRule(t,e,"minLength",n);break;case"range":var l=t.getAttribute("data-val-range-min"),h=t.getAttribute("data-val-range-max");this.defRule(t,e,"range",[l,h]);break;case"equalto":var c=t.getAttribute(i).split(".");this.defRule(t,e,"equalTo",c[c.length-1]);break;case"regex":this.defRule(t,e,"regex",n)}},e.prototype.defRule=function(t,e,i,n){var o=t.getAttribute("data-"+i+"-message"),r=t.getAttribute("data-val-"+i);o?n=[n,o]:r&&(n=[n,r]),e[i]=n},e.prototype.wireEvents=function(){for(var t=0,e=this.inputElements;t<e.length;t++){var n=e[t];i.isCheckable(n)?ha.add(n,"click",this.clickHandler,this):"SELECT"===n.tagName?ha.add(n,"change",this.changeHandler,this):(ha.add(n,"focusout",this.focusOutHandler,this),ha.add(n,"keyup",this.keyUpHandler,this))}ha.add(this.element,"submit",this.submitHandler,this),ha.add(this.element,"reset",this.resetHandler,this)},e.prototype.unwireEvents=function(){for(var t=0,e=this.inputElements;t<e.length;t++){var i=e[t];ha.clearEvents(i)}ha.remove(this.element,"submit",this.submitHandler),ha.remove(this.element,"reset",this.resetHandler)},e.prototype.focusOutHandler=function(t){this.trigger("focusout",t);var e=t.target;this.rules[e.name]&&(this.rules[e.name][this.required]||e.value.length>0?this.validate(e.name):-1===this.validated.indexOf(e.name)&&this.validated.push(e.name))},e.prototype.keyUpHandler=function(t){this.trigger("keyup",t);var e=t.target,i=[16,17,18,20,35,36,37,38,39,40,45,144,225];(9!==t.which||this.rules[e.name]&&(!this.rules[e.name]||this.rules[e.name][this.required]))&&-1!==this.validated.indexOf(e.name)&&this.rules[e.name]&&-1===i.indexOf(t.which)&&this.validate(e.name)},e.prototype.clickHandler=function(t){this.trigger("click",t);var e=t.target;"submit"!==e.type?this.validate(e.name):null!==e.getAttribute("formnovalidate")&&(this.allowSubmit=!0)},e.prototype.changeHandler=function(t){this.trigger("change",t);var e=t.target;this.validate(e.name)},e.prototype.submitHandler=function(t){this.trigger("submit",t),this.allowSubmit||this.validate()?this.allowSubmit=!1:t.preventDefault()},e.prototype.resetHandler=function(){this.clearForm()},e.prototype.validateRules=function(t){if(this.rules[t]){var e=Object.keys(this.rules[t]),i=!1,n=!1,o=e.indexOf("validateHidden"),r=e.indexOf("hidden");if(this.getInputElement(t),-1!==r&&(i=!0),-1!==o&&(n=!0),!i||i&&n){-1!==o&&e.splice(o,1),-1!==r&&e.splice(r-1,1),this.getErrorElement(t);for(var s=0,a=e;s<a.length;s++){var l=a[s],h=this.getErrorMessage(this.rules[t][l],l),c={name:t,message:h},d={inputName:t,element:this.inputElement,message:h};if(!this.isValid(t,l)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(t),this.errorRules.push(c),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info"),this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.infoElement?this.showMessage(c):this.createErrorElement(t,c.message,this.inputElement),d.errorElement=this.infoElement,d.status="failure",this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.optionalValidationStatus(t,d),this.trigger("validationComplete",d),"required"===l&&this.inputElement.setAttribute("aria-required","true");break}this.hideMessage(t),d.status="success",this.trigger("validationComplete",d)}}}},e.prototype.optionalValidationStatus=function(t,e){this.rules[t][this.required]||this.inputElement.value.length||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),e.status="",this.hideMessage(t))},e.prototype.isValid=function(t,e){var n=this.rules[t][e],o=n instanceof Array&&"string"==typeof n[1]?n[0]:n,r=this.rules[t][e],s={value:this.inputElement.value,param:o,element:this.inputElement,formElement:this.element};return this.trigger("validationBegin",s),r&&"function"==typeof r[0]?r[0].call(this,{element:this.inputElement,value:this.inputElement.value}):i.isCheckable(this.inputElement)?"required"!==e||A("input[name="+t+"]:checked",this.element).length>0:i.checkValidator[e](s)},e.prototype.getErrorMessage=function(t,e){var i=t instanceof Array&&"string"==typeof t[1]?t[1]:this.defaultMessages[e],n=i.match(/{(\d)}/g);if(!h(n))for(var o=0;o<n.length;o++){var r=t instanceof Array?t[o]:t;i=i.replace(n[o],r)}return i},e.prototype.createErrorElement=function(t,e,i){var n=b(this.errorElement,{className:this.errorClass,innerHTML:e,attrs:{for:t}});if(this.errorOption===Nu.Message&&(n.classList.remove(this.errorClass),n.classList.add("e-message"),n=b(this.errorContainer,{className:this.errorClass,innerHTML:n.outerHTML})),n.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+i.id+'"]'))this.element.querySelector('[data-valmsg-for="'+i.id+'"]').appendChild(n);else if(!0===i.hasAttribute("data-msg-containerid")){var o=i.getAttribute("data-msg-containerid");this.element.querySelector("#"+o).appendChild(n)}else null!=this.customPlacement?this.customPlacement.call(this,this.inputElement,n):this.inputElement.parentNode.insertBefore(n,this.inputElement.nextSibling);n.style.display="block",this.getErrorElement(t),this.validated.push(t),this.checkRequired(t)},e.prototype.getErrorElement=function(t){return this.infoElement=O(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=O(this.errorElement+"."+this.errorClass+'[for="'+t+'"]')),this.infoElement},e.prototype.removeErrorRules=function(t){for(var e=0;e<this.errorRules.length;e++)this.errorRules[e].name===t&&this.errorRules.splice(e,1)},e.prototype.showMessage=function(t){this.infoElement.style.display="block",this.infoElement.innerHTML=t.message,this.checkRequired(t.name)},e.prototype.hideMessage=function(t){this.infoElement&&(this.infoElement.style.display="none",this.removeErrorRules(t),this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass),this.inputElement.setAttribute("aria-invalid","false"))},e.prototype.checkRequired=function(t){this.rules[t][this.required]||this.inputElement.value.length||(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(t))},e.isCheckable=function(t){var e=t.getAttribute("type");return e&&("checkbox"===e||"radio"===e||"submit"===e)},e.checkValidator={required:function(t){return t.value.length>0},email:function(t){return og.test(t.value)},url:function(t){return rg.test(t.value)},dateIso:function(t){return sg.test(t.value)},tel:function(t){return lg.test(t.value)},creditcard:function(t){return hg.test(t.value)},number:function(t){return!isNaN(Number(t.value))&&-1===t.value.indexOf(" ")},digits:function(t){return ag.test(t.value)},maxLength:function(t){return t.value.length<=t.param},minLength:function(t){return t.value.length>=t.param},rangeLength:function(t){var e=t.param;return t.value.length>=e[0]&&t.value.length<=e[1]},range:function(t){var e=t.param;return!isNaN(Number(t.value))&&Number(t.value)>=e[0]&&Number(t.value)<=e[1]},date:function(t){return!isNaN(new Date(t.value).getTime())},max:function(t){return isNaN(Number(t.value))?new Date(t.value).getTime()<=new Date(JSON.parse(JSON.stringify(t.param))).getTime():+t.value<=t.param},min:function(t){return isNaN(Number(t.value))?new Date(t.value).getTime()>=new Date(JSON.parse(JSON.stringify(t.param))).getTime():+t.value>=t.param},regex:function(t){return new RegExp(t.param).test(t.value)},equalTo:function(t){var e=t.formElement.querySelector("#"+t.param);return t.param=e.value,t.param===t.value}},ng([Y("e-hidden")],e.prototype,"ignore",void 0),ng([Y()],e.prototype,"rules",void 0),ng([Y("e-error")],e.prototype,"errorClass",void 0),ng([Y("e-valid")],e.prototype,"validClass",void 0),ng([Y("label")],e.prototype,"errorElement",void 0),ng([Y("div")],e.prototype,"errorContainer",void 0),ng([Y(Nu.Label)],e.prototype,"errorOption",void 0),ng([J()],e.prototype,"focusout",void 0),ng([J()],e.prototype,"keyup",void 0),ng([J()],e.prototype,"click",void 0),ng([J()],e.prototype,"change",void 0),ng([J()],e.prototype,"submit",void 0),ng([J()],e.prototype,"validationBegin",void 0),ng([J()],e.prototype,"validationComplete",void 0),ng([J()],e.prototype,"customPlacement",void 0),e=i=ng([$],e);var i}(pa);var cg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),dg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},pg="e-upload-file-list",ug="e-file-status",gg="e-file-remove-btn",mg="e-file-delete-btn",fg="e-file-abort-btn",vg="e-file-reload-btn",yg="e-upload-progress-wrap",bg="e-upload-progress-bar",wg="e-upload-success",xg="e-upload-fails",Cg="e-clear-icon-focus",Sg="e-file-pause-btn",Eg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cg(e,t),dg([Y("")],e.prototype,"name",void 0),dg([Y(null)],e.prototype,"size",void 0),dg([Y("")],e.prototype,"type",void 0),e}(xa),Pg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cg(e,t),dg([Y("Browse...")],e.prototype,"browse",void 0),dg([Y("Upload")],e.prototype,"upload",void 0),dg([Y("Clear")],e.prototype,"clear",void 0),e}(xa),Lg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cg(e,t),dg([Y("")],e.prototype,"saveUrl",void 0),dg([Y("")],e.prototype,"removeUrl",void 0),dg([Y(0)],e.prototype,"chunkSize",void 0),dg([Y(3)],e.prototype,"retryCount",void 0),dg([Y(500)],e.prototype,"retryAfterDelay",void 0),e}(xa),Tg=(function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.initialAttr={accept:null,multiple:!1,disabled:!1},n.fileList=[],n.filesData=[],n.uploadedFilesData=[],n.isForm=!1,n.allTypes=!1,n.pausedData=[],n.uploadMetaData=[],n}cg(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,o=Object.keys(t);i<o.length;i++)switch(o[i]){case"allowedExtensions":this.setExtensions(this.allowedExtensions),this.clearAll();break;case"enabled":this.setControlStatus();break;case"multiple":this.setMultipleSelection();break;case"enableRtl":this.setRTL(),this.reRenderFileList();break;case"buttons":this.buttons.browse=h(this.buttons.browse)?"":this.buttons.browse,this.buttons.clear=h(this.buttons.clear)?"":this.buttons.clear,this.buttons.upload=h(this.buttons.upload)?"":this.buttons.upload,this.renderButtonTemplates();break;case"dropArea":this.unBindDropEvents(),this.setDropArea();break;case"files":this.renderPreLoadFiles();break;case"minFileSize":case"maxFileSize":case"template":case"autoUpload":this.clearAll();break;case"locale":this.l10n.setLocale(this.locale),this.setLocalizedTexts(),this.preLocaleObj=n("currentLocale",this.l10n)}},e.prototype.setLocalizedTexts=function(){h(this.template)&&("string"==typeof this.buttons.browse&&(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText),this.uploadWrapper.querySelector(".e-file-drop").innerHTML=this.localizedTexts("dropFilesHint")),this.updateFileList())},e.prototype.getKeyValue=function(t){for(var e,i=0,n=Object.keys(this.preLocaleObj);i<n.length;i++){var o=n[i];this.preLocaleObj[o]===t&&(e=o)}return e},e.prototype.updateFileList=function(){if(this.fileList.length>0&&!h(this.uploadWrapper.querySelector(".e-upload-files")))for(var t=0;t<this.fileList.length;t++)this.fileList[t].querySelector(".e-file-status").innerHTML=this.localizedTexts(this.getKeyValue(this.filesData[t].status)),this.filesData[t].status=this.localizedTexts(this.getKeyValue(this.filesData[t].status)),this.fileList[t].classList.contains(wg)?this.fileList[t].querySelector(".e-icons").setAttribute("title",this.localizedTexts("remove")):this.fileList[t].querySelector(".e-icons").setAttribute("title",this.localizedTexts("delete")),this.autoUpload||(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear)},e.prototype.reRenderFileList=function(){this.listParent&&(L(this.listParent),this.listParent=null,this.fileList=[],this.createFileList(this.filesData),this.actionButtons&&(this.removeActionButtons(),this.renderActionButtons(),this.checkActionButtonStatus()))},e.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.localeText={Browse:"Browse...",Clear:"Clear",Upload:"Upload",dropFilesHint:"Or drop files here",invalidMaxFileSize:"File size is too large",invalidMinFileSize:"File size is too small",invalidFileType:"File type is not allowed",uploadFailedMessage:"File failed to upload",uploadSuccessMessage:"File uploaded successfully",removedSuccessMessage:"File removed successfully",removedFailedMessage:"Unable to remove file",inProgress:"Uploading",readyToUploadMessage:"Ready to upload",abort:"Abort",remove:"Remove",cancel:"Cancel",delete:"Delete file",pauseUpload:"File upload paused",pause:"Pause",resume:"Resume",retry:"Retry",fileUploadCancel:"File upload canceled"},this.l10n=new hl("uploader",this.localeText,this.locale),this.preLocaleObj=n("currentLocale",this.l10n),this.checkHTMLAttributes(),""===this.asyncSettings.saveUrl&&""===this.asyncSettings.removeUrl&&!this.autoUpload)for(var t=this.element.parentElement;t&&t!==document.documentElement;t=t.parentElement)"FORM"===t.tagName&&(this.isForm=!0,this.formElement=t,t.setAttribute("enctype","multipart/form-data"),t.setAttribute("encoding","multipart/form-data"));var e=n("ej2_instances",this.element);if("EJS-UPLOADER"===this.element.tagName){var i=this.createElement("input",{attrs:{type:"file"}}),r=0;for(r;r<this.element.attributes.length;r++)i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML;i.hasAttribute("name")||i.setAttribute("name","UploadFiles"),this.element.appendChild(i),this.element=i,o("ej2_instances",e,this.element)}e[0].isPureReactComponent&&(h(e[0].props.name)?!h(e[0].props.id)&&h(e[0].props.name)?this.element.setAttribute("name",e[0].props.id):this.element.setAttribute("name","UploadFiles"):this.element.setAttribute("name",e[0].props.name)),h(this.element.getAttribute("name"))&&this.element.setAttribute("name",this.element.getAttribute("id")),this.element.hasAttribute("type")||this.element.setAttribute("type","file"),this.keyConfigs={previous:"shift+tab",enter:"enter",next:"tab"}},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.getModuleName=function(){return"uploader"},e.prototype.render=function(){this.renderBrowseButton(),this.initializeUpload(),this.wireEvents(),this.setMultipleSelection(),this.setExtensions(this.allowedExtensions),this.setRTL(),this.renderPreLoadFiles(),this.setControlStatus()},e.prototype.renderBrowseButton=function(){this.browseButton=this.createElement("button",{className:"e-css e-btn",attrs:{type:"button"}}),"string"==typeof this.buttons.browse?(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):this.browseButton.appendChild(this.buttons.browse),this.element.setAttribute("aria-label","Uploader")},e.prototype.renderActionButtons=function(){this.element.setAttribute("tabindex","-1"),this.actionButtons=this.createElement("div",{className:"e-upload-actions"}),this.uploadButton=this.createElement("button",{className:"e-file-upload-btn e-css e-btn e-flat e-primary",attrs:{type:"button",tabindex:"-1"}}),this.clearButton=this.createElement("button",{className:"e-file-clear-btn e-css e-btn e-flat",attrs:{type:"button",tabindex:"-1"}}),this.actionButtons.appendChild(this.clearButton),this.actionButtons.appendChild(this.uploadButton),this.renderButtonTemplates(),this.uploadWrapper.appendChild(this.actionButtons),this.browseButton.blur(),this.uploadButton.focus(),this.wireActionButtonEvents()},e.prototype.wireActionButtonEvents=function(){ha.add(this.uploadButton,"click",this.uploadButtonClick,this),ha.add(this.clearButton,"click",this.clearButtonClick,this)},e.prototype.unwireActionButtonEvents=function(){ha.remove(this.uploadButton,"click",this.uploadButtonClick),ha.remove(this.clearButton,"click",this.clearButtonClick)},e.prototype.removeActionButtons=function(){this.actionButtons&&(this.unwireActionButtonEvents(),L(this.actionButtons),this.actionButtons=null)},e.prototype.renderButtonTemplates=function(){if("string"==typeof this.buttons.browse?(this.browseButton.innerText="Browse..."===this.buttons.browse?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):(this.browseButton.innerHTML="",this.browseButton.appendChild(this.buttons.browse)),this.uploadButton){var t=void 0;t=h(this.buttons.upload)?"Upload":this.buttons.upload,this.buttons.upload=t,"string"==typeof this.buttons.upload?(this.uploadButton.innerText="Upload"===this.buttons.upload?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.uploadButton.innerText)):(this.uploadButton.innerHTML="",this.uploadButton.appendChild(this.buttons.upload))}if(this.clearButton){var e=void 0;e=h(this.buttons.clear)?"Clear":this.buttons.clear,this.buttons.clear=e,"string"==typeof this.buttons.clear?(this.clearButton.innerText="Clear"===this.buttons.clear?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.clearButton.innerText)):(this.clearButton.innerHTML="",this.clearButton.appendChild(this.buttons.clear))}},e.prototype.initializeUpload=function(){this.element.setAttribute("tabindex","-1");var t=this.createElement("span",{className:"e-file-select"});this.element.parentElement.insertBefore(t,this.element),this.dropAreaWrapper=this.createElement("div",{className:"e-file-select-wrap"}),this.element.parentElement.insertBefore(this.dropAreaWrapper,this.element),t.appendChild(this.element),this.dropAreaWrapper.appendChild(this.browseButton),this.dropAreaWrapper.appendChild(t);var e=this.createElement("span",{className:"e-file-drop"});e.innerHTML=this.localizedTexts("dropFilesHint"),this.dropAreaWrapper.appendChild(e),this.uploadWrapper=this.createElement("div",{className:"e-upload",attrs:{"aria-activedescendant":"li-focused"}}),this.dropAreaWrapper.parentElement.insertBefore(this.uploadWrapper,this.dropAreaWrapper),this.uploadWrapper.appendChild(this.dropAreaWrapper),this.setDropArea()},e.prototype.renderPreLoadFiles=function(){if(!h(this.files[0].size)&&h(this.template)){var t=[].slice.call(this.files),e=[];this.multiple||(this.clearData(),t=[t[0]]);for(var i=0,n=t;i<n.length;i++){var o=n[i],r={name:o.name+"."+o.type.split(".")[o.type.split(".").length-1],rawFile:"",size:o.size,status:this.localizedTexts("uploadSuccessMessage"),type:o.type,validationMessages:{minSize:"",maxSize:""},statusCode:"2"};e.push(r),this.filesData.push(r)}this.createFileList(e),this.autoUpload||!this.listParent||this.actionButtons||this.isForm||!this.showFileList||this.renderActionButtons(),this.checkActionButtonStatus()}},e.prototype.checkActionButtonStatus=function(){if(this.actionButtons){var t=this.uploadWrapper.querySelectorAll(".e-validation-fails").length+this.uploadWrapper.querySelectorAll(".e-upload-fails:not(.e-upload-progress)").length+this.uploadWrapper.querySelectorAll("span."+wg).length+this.uploadWrapper.querySelectorAll("span.e-upload-progress").length;t>0&&t===this.uploadWrapper.querySelectorAll("li").length?this.uploadButton.setAttribute("disabled","disabled"):this.uploadButton.removeAttribute("disabled")}},e.prototype.setDropArea=function(){var t=this.dropAreaWrapper.querySelector(".e-file-drop");if(this.dropArea){this.dropZoneElement="string"!=typeof this.dropArea?this.dropArea:document.querySelector(this.dropArea);for(var e=this.element,i=!1;e.parentNode;)(e=e.parentNode)===this.dropZoneElement&&(i=!0,t.textContent=this.localizedTexts("dropFilesHint"));i||(t.textContent="")}else this.dropZoneElement=this.uploadWrapper,t.textContent=this.localizedTexts("dropFilesHint");this.bindDropEvents()},e.prototype.setMultipleSelection=function(){if(this.multiple&&!this.element.hasAttribute("multiple")){var t=document.createAttribute("multiple");this.element.setAttributeNode(t)}else this.multiple||this.element.removeAttribute("multiple")},e.prototype.checkAutoUpload=function(t){this.autoUpload?(this.upload(t),this.removeActionButtons()):this.actionButtons||this.renderActionButtons(),this.checkActionButtonStatus()},e.prototype.wireEvents=function(){ha.add(this.browseButton,"click",this.browseButtonClick,this),ha.add(this.element,"change",this.onSelectFiles,this),ha.add(document,"click",this.removeFocus,this),this.keyboardModule=new ll(this.uploadWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.isForm&&ha.add(this.formElement,"reset",this.resetForm,this)},e.prototype.unWireEvents=function(){ha.remove(this.browseButton,"click",this.browseButtonClick),ha.remove(this.element,"change",this.onSelectFiles),ha.remove(document,"click",this.removeFocus),this.keyboardModule.destroy()},e.prototype.resetForm=function(){this.clearAll()},e.prototype.keyActionHandler=function(t){var e=t.target;switch(t.action){case"next":t.target===this.browseButton&&h(this.listParent)?this.browseButton.blur():t.target===this.uploadButton?this.uploadButton.blur():(this.setTabFocus(t),t.preventDefault(),t.stopPropagation(),t.target===this.clearButton&&this.uploadButton.hasAttribute("disabled")&&this.clearButton.blur());break;case"previous":t.target===this.browseButton?this.browseButton.blur():(this.setReverseFocus(t),t.preventDefault(),t.stopPropagation());break;case"enter":if(t.target===this.clearButton)this.clearButtonClick();else if(t.target===this.uploadButton)this.uploadButtonClick();else if(t.target===this.browseButton)this.browseButtonClick();else if(e.classList.contains(Sg))(i=this.getCurrentMetaData(null,t)).file.statusCode="4",i.file.status=this.localizedTexts("pauseUpload"),this.abortUpload(i,!1);else if(e.classList.contains("e-file-play-btn"))this.resumeUpload(this.getCurrentMetaData(null,t),t);else if(e.classList.contains(vg)){var i=this.getCurrentMetaData(null,t);i.file.statusCode="1",i.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(i.file)}else this.removeFiles(t),e.classList.contains(fg)||this.browseButton.focus();t.preventDefault(),t.stopPropagation()}},e.prototype.getCurrentMetaData=function(t,e){var i,n;if(h(t)){var o=this.uploadWrapper.querySelector("."+Cg).parentElement;i=this.filesData[this.fileList.indexOf(o)]}else i=t;for(var r=0;r<this.uploadMetaData.length;r++)this.uploadMetaData[r].file.name===i.name&&(n=this.uploadMetaData[r]);return n},e.prototype.setReverseFocus=function(t){var e=t.target;if(e===this.uploadButton)this.uploadButton.blur(),this.clearButton.focus();else if(e===this.clearButton&&this.listParent&&this.listParent.querySelector(".e-icons")){this.clearButton.blur();var i=[].slice.call(this.listParent.querySelectorAll("span.e-icons"));i[i.length-1].classList.add(Cg),i[i.length-1].focus()}else{var n=[].slice.call(this.listParent.querySelectorAll("span.e-icons")),o=n.indexOf(e);o>0?(this.removeFocus(),n[o-1].classList.add(Cg),n[o-1].focus()):(this.removeFocus(),this.browseButton.focus())}},e.prototype.setTabFocus=function(t){var e=t.target;if(e===this.clearButton){if(this.removeFocus(),this.uploadButton.hasAttribute("disabled"))return;this.uploadButton.focus()}else if(e.classList.contains("e-icons")){var i=[].slice.call(this.listParent.querySelectorAll("span.e-icons")),n=i.indexOf(e);n<i.length-1?(this.removeFocus(),i[n+1].classList.add(Cg),i[n+1].focus()):(this.removeFocus(),this.clearButton.focus())}else{this.browseButton.blur();var o=this.listParent.querySelectorAll("span.e-icons")[0];o.focus(),o.classList.add(Cg)}},e.prototype.removeFocus=function(){this.uploadWrapper&&this.listParent&&this.listParent.querySelector("."+Cg)&&(document.activeElement.blur(),this.listParent.querySelector("."+Cg).classList.remove(Cg))},e.prototype.browseButtonClick=function(){this.element.click()},e.prototype.uploadButtonClick=function(){this.upload(this.filesData)},e.prototype.clearButtonClick=function(){this.clearAll()},e.prototype.bindDropEvents=function(){this.dropZoneElement&&(ha.add(this.dropZoneElement,"drop",this.dropElement,this),ha.add(this.dropZoneElement,"dragover",this.dragHover,this),ha.add(this.dropZoneElement,"dragleave",this.onDragLeave,this))},e.prototype.unBindDropEvents=function(){this.dropZoneElement&&(ha.remove(this.dropZoneElement,"drop",this.dropElement),ha.remove(this.dropZoneElement,"dragover",this.dragHover),ha.remove(this.dropZoneElement,"dragleave",this.onDragLeave))},e.prototype.onDragLeave=function(t){this.dropZoneElement.classList.remove("e-upload-drag-hover")},e.prototype.dragHover=function(t){this.enabled&&(this.dropZoneElement.classList.add("e-upload-drag-hover"),t.preventDefault(),t.stopPropagation())},e.prototype.dropElement=function(t){this.dropZoneElement.classList.remove("e-upload-drag-hover"),this.onSelectFiles(t),t.preventDefault(),t.stopPropagation()},e.prototype.removeFiles=function(t){if(this.enabled){var e=t.target.parentElement,i=this.fileList.indexOf(e),n=this.fileList[i],o=this.filesData[i];if(t.target.classList.contains(fg)){if(t.target.classList.contains("e-disabled"))return;if(o.statusCode="5",!h(n)){var r=n.querySelector("."+fg);Ae({target:r,width:"20px"}),li(r)}}else this.remove(o,!1,!1,t);this.element.value="",this.checkActionButtonStatus()}},e.prototype.removeFilesData=function(t,e){var i;if(e)return void(this.showFileList||(i=this.filesData.indexOf(t),this.filesData.splice(i,1)));var n=this.getLiElement(t);h(n)||(L(n),i=this.fileList.indexOf(n),this.fileList.splice(i,1),this.filesData.splice(i,1),0!==this.fileList.length||h(this.listParent)||(L(this.listParent),this.listParent=null,this.removeActionButtons()))},e.prototype.removeUploadedFile=function(t,e,i,n){var o=this,r=t,s=this.element.getAttribute("name"),a=new la(this.asyncSettings.removeUrl,"POST",!0,null),l=new FormData;a.beforeSend=function(t){e.currentRequest=a.httpRequest,i||o.trigger("removing",e),e.cancel&&(t.cancel=!0),e.postRawFile&&!h(r.rawFile)&&""!==r.rawFile?l.append(s,r.rawFile):l.append(s,r.name),o.updateFormData(l,e.customFormData)};var c=this.getLiElement(t);if(a.onLoad=function(t){return o.removeCompleted(t,r,n),{}},a.onError=function(t){return o.removeFailed(t,r,n),{}},a.send(l),!h(c)&&!h(c.querySelector("."+mg))){var d=c.querySelector("."+mg);Ae({target:d,width:"20px"}),li(d)}},e.prototype.updateFormData=function(t,e){if(e.length>0&&e[0])for(var i=0;i<e.length;i++){var n=e[i];t.append(Object.keys(n)[0],Object.values(n)[0])}},e.prototype.removeCompleted=function(t,e,i){var n={e:t,operation:"remove",file:this.updateStatus(e,this.localizedTexts("removedSuccessMessage"),"2")};this.trigger("success",n),this.removeFilesData(e,i);var o=this.uploadedFilesData.indexOf(e);this.uploadedFilesData.splice(o,1),this.trigger("change",{files:this.uploadedFilesData})},e.prototype.removeFailed=function(t,e,i){var n={e:t,operation:"remove",file:this.updateStatus(e,this.localizedTexts("removedFailedMessage"),"0")};if(!i){var o=this.filesData.indexOf(e),r=this.fileList[o];if(r){var s=r.querySelector("."+ug);r.classList.remove(wg),s.classList.remove(wg),r.classList.add(xg),s.classList.add(xg)}this.checkActionButtonStatus()}this.trigger("failure",n);var a=this.getLiElement(e);h(a)||h(a.querySelector("."+mg))||(ci(a.querySelector("."+mg)),L(a.querySelector(".e-spinner-pane")))},e.prototype.onSelectFiles=function(t){if(this.enabled){var e,i=[];if("drop"===t.type){var n=t.dataTransfer.files;e=this.multiple?this.sortFileList(n):[n[0]]}else e=[].slice.call(t.target.files);this.multiple||(this.clearData(!0),e=[e[0]]);for(var o=0;o<e.length;o++){var r=e[o],s={name:r.name,rawFile:r,size:r.size,status:this.localizedTexts("readyToUploadMessage"),type:this.getFileType(r.name),validationMessages:this.validatedFileSize(r.size),statusCode:"1"};s.status=""!==s.validationMessages.minSize?this.localizedTexts("invalidMinFileSize"):""!==s.validationMessages.maxSize?this.localizedTexts("invalidMaxFileSize"):s.status,""===s.validationMessages.minSize&&""===s.validationMessages.maxSize||(s.statusCode="0"),i.push(s)}var a={event:t,cancel:!1,filesData:i,isModified:!1,modifiedFilesData:[],progressInterval:""};if(this.allowedExtensions.indexOf("*")>-1&&(this.allTypes=!0),this.allTypes||(i=this.checkExtension(i)),this.trigger("selected",a),!a.cancel)if(this.showFileList){if(a.isModified&&a.modifiedFilesData.length>0){var l=this.allTypes?a.modifiedFilesData:this.checkExtension(a.modifiedFilesData);this.updateSortedFileList(l),this.filesData=l,this.isForm||this.checkAutoUpload(l)}else this.createFileList(i),this.filesData=this.filesData.concat(i),this.isForm||this.checkAutoUpload(i);h(a.progressInterval)||""===a.progressInterval||(this.progressInterval=a.progressInterval)}else this.filesData=this.filesData.concat(i),this.autoUpload&&this.upload(this.filesData,!0)}},e.prototype.clearData=function(t){h(this.listParent)||(L(this.listParent),this.listParent=null),"msie"===ma.info.name||t||(this.element.value=""),this.fileList=[],this.filesData=[],this.removeActionButtons()},e.prototype.updateSortedFileList=function(t){var e,i=this.createElement("div",{id:"clonewrapper"}),n=-1;if(this.listParent){for(var o=0;o<this.listParent.querySelectorAll("li").length;o++){var r=this.listParent.querySelectorAll("li")[o];i.appendChild(r.cloneNode(!0))}for(var s=0,a=e=this.listParent.querySelectorAll("li");s<a.length;s++)L(a[s]);this.removeActionButtons();var l=[].slice.call(i.childNodes);L(this.listParent),this.listParent=null,this.fileList=[],this.createParentUL();for(var h=0;h<t.length;h++){for(var c=0;c<this.filesData.length;c++)this.filesData[c].name===t[h].name&&(this.listParent.appendChild(l[c]),ha.add(l[c].querySelector(".e-icons"),"click",this.removeFiles,this),this.fileList.push(l[c]),n=h);n!==h&&this.createFileList([t[h]])}}else this.createFileList(t)},e.prototype.checkExtension=function(t){var e=t;if(""!==this.allowedExtensions){for(var i=[],n=0,o=this.allowedExtensions.split(",");n<o.length;n++){var r=o[n];i.push(r.trim().toLocaleLowerCase())}for(var s=0;s<t.length;s++)-1===i.indexOf(("."+t[s].type).toLocaleLowerCase())&&(t[s].status=this.localizedTexts("invalidFileType"),t[s].statusCode="0")}return e},e.prototype.validatedFileSize=function(t){var e="",i="";return t<this.minFileSize?e=this.localizedTexts("invalidMinFileSize"):t>this.maxFileSize?i=this.localizedTexts("invalidMaxFileSize"):(e="",i=""),{minSize:e,maxSize:i}},e.prototype.createCustomfileList=function(t){this.createParentUL();for(var e=0,i=t;e<i.length;e++){var n=i[e],o=this.createElement("li",{className:pg,attrs:{"data-file-name":n.name}});this.uploadTemplateFn=this.templateComplier(this.template),this.listParent.appendChild(o),P([].slice.call(this.uploadTemplateFn(n)),o),this.fileList.push(o)}},e.prototype.createParentUL=function(){h(this.listParent)&&(this.listParent=this.createElement("ul",{className:"e-upload-files"}),this.uploadWrapper.appendChild(this.listParent))},e.prototype.createFileList=function(t){if(this.createParentUL(),""===this.template||h(this.template))for(var e=0,i=t;e<i.length;e++){var n=i[e],o=this.createElement("li",{className:pg,attrs:{"data-file-name":n.name}}),r=this.createElement("span",{className:"e-file-container"}),s=this.createElement("span",{className:"e-file-name",attrs:{title:n.name}});s.innerHTML=this.getFileNameOnly(n.name);var a=this.createElement("span",{className:"e-file-type"});if(a.innerHTML="."+this.getFileType(n.name),this.enableRtl){var l=this.createElement("span",{className:"e-rtl-container"});l.appendChild(a),l.appendChild(s),r.appendChild(l)}else r.appendChild(s),r.appendChild(a);var c=this.createElement("span",{className:"e-file-size"});c.innerHTML=this.bytesToSize(n.size),r.appendChild(c);var d=this.createElement("span",{className:ug});r.appendChild(d),d.innerHTML=n.status,o.appendChild(r);var p=this.createElement("span",{className:" e-icons",attrs:{tabindex:"-1"}});"msie"===ma.info.name&&p.classList.add("e-msie"),p.setAttribute("title",this.localizedTexts("remove")),o.appendChild(p),ha.add(p,"click",this.removeFiles,this),"2"===n.statusCode?(d.classList.add(wg),p.classList.add(mg),p.setAttribute("title",this.localizedTexts("delete"))):"1"!==n.statusCode&&(d.classList.remove(wg),d.classList.add("e-validation-fails")),this.autoUpload&&"1"===n.statusCode&&""!==this.asyncSettings.saveUrl&&(d.innerHTML=""),p.classList.contains(mg)||p.classList.add(gg),this.listParent.appendChild(o),this.fileList.push(o),this.truncateName(s)}else this.createCustomfileList(t)},e.prototype.truncateName=function(t){var e,i=t;i.offsetWidth<i.scrollWidth&&(e=i.textContent,i.dataset.tail=e.slice(e.length-10))},e.prototype.getFileType=function(t){var e,i=t.lastIndexOf(".");return i>=0&&(e=t.substring(i+1)),e||""},e.prototype.getFileNameOnly=function(t){var e=this.getFileType(t);return e=t.split("."+e)[0]},e.prototype.setInitialAttributes=function(){if(this.initialAttr.accept&&this.element.setAttribute("accept",this.initialAttr.accept),this.initialAttr.disabled&&this.element.setAttribute("disabled","disabled"),this.initialAttr.multiple){var t=document.createAttribute("multiple");this.element.setAttributeNode(t)}},e.prototype.filterfileList=function(t){for(var e=[],i=0;i<t.length;i++)this.getLiElement(t[i]).classList.contains(wg)||e.push(t[i]);return e},e.prototype.updateStatus=function(t,e,i){""===e||h(e)||""===i||h(i)||(t.status=e,t.statusCode=i);var n=this.getLiElement(t);return h(n)||h(n.querySelector("."+ug))||""===e||h(e)||(n.querySelector("."+ug).textContent=e),t},e.prototype.getLiElement=function(t){var e=this.filesData.indexOf(t);return this.fileList[e]},e.prototype.createProgressBar=function(t){var e=this.createElement("span",{className:yg}),i=this.createElement("progressbar",{className:bg,attrs:{value:"0",max:"100"}}),n=this.createElement("span",{className:"e-progress-inner-wrap"});i.setAttribute("style","width: 0%");var o=this.createElement("span",{className:"e-progress-bar-text"});o.textContent="0%",n.appendChild(i),e.appendChild(n),e.appendChild(o),t.querySelector(".e-file-container").appendChild(e)},e.prototype.updateProgressbar=function(t,e){if(!isNaN(Math.round(t.loaded/t.total*100))&&!h(e.querySelector("."+bg)))if(h(this.progressInterval)||""===this.progressInterval)this.changeProgressValue(e,Math.round(t.loaded/t.total*100).toString()+"%");else{var i=Math.round(t.loaded/t.total*100)%parseInt(this.progressInterval,10);0!==i&&100!==i||this.changeProgressValue(e,Math.round(t.loaded/t.total*100).toString()+"%")}},e.prototype.changeProgressValue=function(t,e){t.querySelector("."+bg).setAttribute("style","width:"+e),t.querySelector(".e-progress-bar-text").textContent=e},e.prototype.uploadInProgress=function(t,e,i,n){var o=this,r=this.getLiElement(e);if(!h(r)||i&&!h(i)){if(!h(r)){if("5"===e.statusCode){var s={event:t,fileData:e,cancel:!1};if(this.trigger("canceling",s),s.cancel){e.statusCode="3";var a=r.querySelector("."+fg);return void(h(r)||h(a)||(ci(a),L(r.querySelector(".e-spinner-pane"))))}n.emitError=!1,n.httpRequest.abort();var l=new FormData;if("5"===e.statusCode){var c=this.element.getAttribute("name");l.append(c,e.name),l.append("cancel-uploading",e.name);var d=new la(this.asyncSettings.removeUrl,"POST",!0,null);d.onLoad=function(t){return o.removecanceledFile(t,e),{}},d.send(l)}}r.querySelectorAll("."+yg).length>0||!r.querySelector("."+ug)||(r.querySelector("."+ug).classList.add("e-upload-progress"),this.createProgressBar(r),this.updateProgressBarClasses(r,"e-upload-progress"),r.querySelector("."+ug).classList.remove(xg)),this.updateProgressbar(t,r);var p=r.querySelector("."+gg);h(p)||(p.classList.add(fg,"e-upload-progress"),p.setAttribute("title",this.localizedTexts("abort")),p.classList.remove(gg))}var u={e:t,operation:"upload",file:this.updateStatus(e,this.localizedTexts("inProgress"),"3")};this.trigger("progress",u)}},e.prototype.removecanceledFile=function(t,e){var i=this.getLiElement(e);if(!i.querySelector("."+vg)&&!h(i.querySelector("."+fg))){this.updateStatus(e,this.localizedTexts("fileUploadCancel"),"5"),this.renderFailureState(t,e,i);var n=i.querySelector("."+gg);h(i)||(ci(n),L(i.querySelector(".e-spinner-pane")));var o={event:t,operation:"cancel",file:e};this.trigger("success",o)}},e.prototype.renderFailureState=function(t,e,i){var n=this;this.updateProgressBarClasses(i,xg),this.removeProgressbar(i,"failure"),h(i.querySelector(".e-file-status"))||i.querySelector(".e-file-status").classList.add(xg);var o=i.querySelector("."+fg);h(o)||(o.classList.remove(fg,"e-upload-progress"),o.classList.add(gg),o.setAttribute("title",this.localizedTexts("remove")),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:"-1"}}),i.insertBefore(this.pauseButton,o),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),i.querySelector("."+vg).addEventListener("click",function(t){n.reloadcanceledFile(t,e,i)},!1))},e.prototype.reloadcanceledFile=function(t,e,i){e.statusCode="1",e.status=this.localizedTexts("readyToUploadMessage"),i.querySelector("."+ug).classList.remove(xg),h(i.querySelector("."+vg))||L(i.querySelector("."+vg)),this.pauseButton=null,this.upload([e])},e.prototype.uploadComplete=function(t,e,i){var n=t.target;if(4===n.readyState&&n.status>=200&&n.status<=299){var o=this.getLiElement(e);if(h(o)&&(!i||h(i)))return;if(!h(o)){this.updateProgressBarClasses(o,wg),this.removeProgressbar(o,"success");var r=o.querySelector("."+fg);h(r)||(r.classList.add(mg),r.setAttribute("title",this.localizedTexts("delete")),r.classList.remove(fg),r.classList.remove("e-upload-progress"))}this.raiseSuccessEvent(t,e)}else this.uploadFailed(t,e)},e.prototype.raiseSuccessEvent=function(t,e){var i={e:t,operation:"upload",file:this.updateStatus(e,this.localizedTexts("uploadSuccessMessage"),"2")};this.trigger("success",i),this.uploadedFilesData.push(e),this.trigger("change",{file:this.uploadedFilesData}),this.checkActionButtonStatus()},e.prototype.uploadFailed=function(t,e){var i=this.getLiElement(e),n={e:t,operation:"upload",file:this.updateStatus(e,this.localizedTexts("uploadFailedMessage"),"0")};h(i)||this.renderFailureState(t,e,i),this.trigger("failure",n),this.checkActionButtonStatus()},e.prototype.updateProgressBarClasses=function(t,e){var i=t.querySelector("."+bg);h(i)||i.classList.add(e)},e.prototype.removeProgressbar=function(t,e){var i=this;h(t.querySelector("."+yg))||(this.progressAnimation=new ya({duration:1250}),this.progressAnimation.animate(t.querySelector("."+yg),{name:"FadeOut"}),this.progressAnimation.animate(t.querySelector(".e-progress-bar-text"),{name:"FadeOut"}),setTimeout(function(){i.animateProgressBar(t,e)},750))},e.prototype.animateProgressBar=function(t,e){"success"===e?(t.classList.add(wg),h(t.querySelector("."+ug))||(t.querySelector("."+ug).classList.remove("e-upload-progress"),this.progressAnimation.animate(t.querySelector("."+ug),{name:"FadeIn"}),t.querySelector("."+ug).classList.add(wg))):h(t.querySelector("."+ug))||(t.querySelector("."+ug).classList.remove("e-upload-progress"),this.progressAnimation.animate(t.querySelector("."+ug),{name:"FadeIn"}),t.querySelector("."+ug).classList.add(xg)),t.querySelector("."+yg)&&L(t.querySelector("."+yg))},e.prototype.setExtensions=function(t){this.element.setAttribute("accept",t)},e.prototype.templateComplier=function(t){if(t)try{if(document.querySelectorAll(t).length)return pt(document.querySelector(t).innerHTML.trim())}catch(e){return pt(t)}},e.prototype.setRTL=function(){this.enableRtl?w([this.uploadWrapper],"e-rtl"):x([this.uploadWrapper],"e-rtl")},e.prototype.localizedTexts=function(t){return this.l10n.setLocale(this.locale),this.l10n.getConstant(t)},e.prototype.setControlStatus=function(){this.enabled?(this.uploadWrapper.classList.contains("e-disabled")&&this.uploadWrapper.classList.remove("e-disabled"),!h(this.browseButton)&&this.element.hasAttribute("disabled")&&(this.element.removeAttribute("disabled"),this.browseButton.removeAttribute("disabled")),!h(this.clearButton)&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled"),!h(this.uploadButton)&&this.uploadButton.hasAttribute("disabled")&&this.uploadButton.hasAttribute("disabled")):(this.uploadWrapper.classList.add("e-disabled"),this.element.setAttribute("disabled","disabled"),this.browseButton.setAttribute("disabled","disabled"),h(this.clearButton)||this.clearButton.setAttribute("disabled","disabled"),h(this.uploadButton)||this.uploadButton.setAttribute("disabled","disabled"))},e.prototype.checkHTMLAttributes=function(){this.element.hasAttribute("accept")&&(this.allowedExtensions=this.element.getAttribute("accept"),this.initialAttr.accept=this.allowedExtensions),this.element.hasAttribute("multiple")&&(this.multiple=!0,this.initialAttr.multiple=!0),this.element.hasAttribute("disabled")&&(this.enabled=!1,this.initialAttr.disabled=!0)},e.prototype.chunkUpload=function(t,e){var i=Math.min(this.asyncSettings.chunkSize,t.size),n={chunkIndex:0,blob:t.rawFile.slice(0,i),file:t,start:0,end:i,retryCount:0,request:null};this.sendRequest(t,n,e)},e.prototype.sendRequest=function(t,e,i){var n=this,o=new FormData,r=t.rawFile.slice(e.start,e.end);o.append("chunkFile",r,t.name),o.append("chunk-index",e.chunkIndex.toString());var s=Math.max(Math.ceil(t.size/this.asyncSettings.chunkSize),1);o.append("total-chunk",s.toString());var a=new la({url:this.asyncSettings.saveUrl,type:"POST",async:!0,contentType:null});a.onLoad=function(t){return n.chunkUploadComplete(t,e,i),{}},a.onUploadProgress=function(t){return n.chunkUploadInProgress(t,e,i),{}};var l={fileData:t,customFormData:[],cancel:!1,chunkSize:0===this.asyncSettings.chunkSize?null:this.asyncSettings.chunkSize};a.beforeSend=function(i){0===e.chunkIndex&&(l.currentRequest=a.httpRequest,n.trigger("uploading",l),l.cancel?n.eventCancelByArgs(i,l,t):n.updateFormData(o,l.customFormData))},a.onError=function(t){return n.chunkUploadFailed(t,e,i),{}},a.send(o),e.request=a},e.prototype.eventCancelByArgs=function(t,e,i){var n=this;if(t.cancel=!0,"5"!==e.fileData.statusCode){var o=this.getLiElement(e.fileData);o.querySelector("."+ug).innerHTML=this.localizedTexts("fileUploadCancel"),o.querySelector("."+ug).classList.add(xg),e.fileData.statusCode="5",e.fileData.status=this.localizedTexts("fileUploadCancel"),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:"-1"}}),o.insertBefore(this.pauseButton,o.querySelector("."+gg)),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.addEventListener("click",function(t){n.reloadcanceledFile(t,i,o)},!1),this.checkActionButtonStatus()}},e.prototype.checkChunkUpload=function(){return!(this.asyncSettings.chunkSize<=0||h(this.asyncSettings.chunkSize))},e.prototype.chunkUploadComplete=function(t,e,i){var n,o=this,r=t.target;if(4===r.readyState&&r.status>=200&&r.status<300){var s=Math.max(Math.ceil(e.file.size/this.asyncSettings.chunkSize),1),a={event:t,file:e.file,chunkIndex:e.chunkIndex,totalChunk:s,chunkSize:this.asyncSettings.chunkSize};if(this.trigger("chunkSuccess",a),!h(i)&&i||(n=this.getLiElement(e.file)),this.updateMetaData(e),e.end===e.file.size&&(e.file.statusCode="3"),"5"===e.file.statusCode){var l={event:t,fileData:e.file,cancel:!1};if(this.trigger("canceling",l),l.cancel){e.file.statusCode="3";var c=n.querySelector("."+fg);return h(n)||h(c)||(ci(c),L(n.querySelector(".e-spinner-pane"))),void this.sendNextRequest(e)}e.request.emitError=!1,r.abort();var d=new FormData,p=this.element.getAttribute("name");d.append(p,e.file.name),d.append("cancel-uploading",e.file.name);var u=new la(this.asyncSettings.removeUrl,"POST",!0,null);u.onLoad=function(t){return o.removeChunkFile(t,e,i),{}},u.send(d)}else{if(s-1===e.chunkIndex&&s>e.chunkIndex){var g=this.pausedData.indexOf(e);return g>=0&&this.pausedData.splice(g,1),h(this.template)&&(h(i)||!i)&&n&&(n&&L(n.querySelector("."+Sg)),this.removeChunkProgressBar(e)),void this.raiseSuccessEvent(t,e.file)}this.sendNextRequest(e)}}else this.chunkUploadFailed(t,e)},e.prototype.sendNextRequest=function(t){t.start=t.end,t.end+=this.asyncSettings.chunkSize,t.end=Math.min(t.end,t.file.size),t.chunkIndex+=1,this.sendRequest(t.file,t)},e.prototype.removeChunkFile=function(t,e,i){if(h(this.template)&&h(i)&&!i){var n=this.getLiElement(e.file),o=n.querySelector("."+fg),r=o;this.updateStatus(e.file,this.localizedTexts("fileUploadCancel"),"5"),this.updateProgressBarClasses(n,xg),this.removeProgressbar(n,"failure"),o.classList.remove(fg),o.classList.add(gg),o.setAttribute("title",this.localizedTexts("remove"));var s=n.querySelector("."+Sg);s.classList.add(vg),s.classList.remove(Sg),s.setAttribute("title",this.localizedTexts("retry")),h(n)||h(o)||(ci(r),L(n.querySelector(".e-spinner-pane")))}},e.prototype.pauseUpload=function(t,e,i){t.file.statusCode="4",t.file.status=this.localizedTexts("pause"),this.updateMetaData(t);var n={event:e||null,file:t.file,chunkIndex:t.chunkIndex,chunkCount:Math.round(t.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.abortUpload(t,i,n)},e.prototype.abortUpload=function(t,e,i){t.request.emitError=!1,t.request.httpRequest.abort();var n=this.getLiElement(t.file);if(h(this.template)&&(h(e)||!e)){var o=n.querySelector("."+Sg);o.classList.remove(Sg),o.classList.add("e-file-play-btn"),o.setAttribute("title",this.localizedTexts("resume"))}for(var r=0;r<this.pausedData.length;r++)this.pausedData[r].file.name===t.file.name&&this.pausedData.splice(r,1);this.pausedData.push(t),this.trigger("pausing",i)},e.prototype.resumeUpload=function(t,e,i){var n,o=this.getLiElement(t.file);h(o)||(n=o.querySelector(".e-file-play-btn")),h(n)||!h(i)&&i||(n.classList.remove("e-file-play-btn"),n.classList.add(Sg),n.setAttribute("title",this.localizedTexts("pause"))),t.file.status=this.localizedTexts("inProgress"),t.file.statusCode="3",this.updateMetaData(t);var r={event:e||null,file:t.file,chunkIndex:t.chunkIndex,chunkCount:Math.round(t.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.trigger("resuming",r);for(var s=0;s<this.pausedData.length;s++)this.pausedData[s].end===this.pausedData[s].file.size?this.chunkUploadComplete(e,t,i):this.pausedData[s].file.name===t.file.name&&(this.pausedData[s].start=this.pausedData[s].end,this.pausedData[s].end=this.pausedData[s].end+this.asyncSettings.chunkSize,this.pausedData[s].end=Math.min(this.pausedData[s].end,this.pausedData[s].file.size),this.pausedData[s].chunkIndex=this.pausedData[s].chunkIndex+1,this.sendRequest(this.pausedData[s].file,this.pausedData[s],i))},e.prototype.updateMetaData=function(t){-1===this.uploadMetaData.indexOf(t)?this.uploadMetaData.push(t):(this.uploadMetaData.splice(this.uploadMetaData.indexOf(t),1),this.uploadMetaData.push(t))},e.prototype.removeChunkProgressBar=function(t){var e=this.getLiElement(t.file);if(!h(e)){this.updateProgressBarClasses(e,wg),this.removeProgressbar(e,"success");var i=e.querySelector("."+fg);h(i)||(i.classList.add(mg),i.setAttribute("title",this.localizedTexts("delete")),i.classList.remove(fg,"e-upload-progress"))}},e.prototype.chunkUploadFailed=function(t,e,i){var n,o=this,r=Math.max(Math.ceil(e.file.size/this.asyncSettings.chunkSize),1);!h(this.template)||!h(i)&&i||(n=this.getLiElement(e.file));var s={event:t,file:e.file,chunkIndex:e.chunkIndex,totalChunk:r,chunkSize:this.asyncSettings.chunkSize};if(this.trigger("chunkFailure",s),e.retryCount<this.asyncSettings.retryCount)setTimeout(function(){o.retryRequest(n,e,i)},this.asyncSettings.retryAfterDelay);else{if(!h(n)){var a=n.querySelector("."+Sg)?n.querySelector("."+Sg):n.querySelector(".e-file-play-btn");h(a)||(a.classList.add(vg),a.classList.remove(Sg,"e-file-play-btn")),this.updateProgressBarClasses(n,xg),this.removeProgressbar(n,"failure"),n.querySelector(".e-icons").classList.remove("e-upload-progress");var l=n.querySelector("."+fg);l.classList.remove(fg),h(n.querySelector("."+Sg))||L(n.querySelector("."+Sg)),e.start>0?(l.classList.add(mg),l.setAttribute("title",this.localizedTexts("delete"))):(l.classList.add(gg),l.setAttribute("title",this.localizedTexts("remove")))}e.retryCount=0;var c=e.file,d={e:t,operation:"upload",file:this.updateStatus(c,this.localizedTexts("uploadFailedMessage"),"0")};this.trigger("failure",d)}},e.prototype.retryRequest=function(t,e,i){h(this.template)&&(h(i)||!i)&&t&&this.updateProgressBarClasses(t,xg),e.retryCount+=1,this.sendRequest(e.file,e)},e.prototype.checkPausePlayAction=function(t){var e=t.target,i=t.target.parentElement,n=this.fileList.indexOf(i),o=this.filesData[n],r=this.getCurrentMetaData(o);e.classList.contains(Sg)?(this.pauseUpload(r,t),e.nextElementSibling.classList.add("e-disabled")):e.classList.contains("e-file-play-btn")?(this.resumeUpload(r,t),e.nextElementSibling.classList.remove("e-disabled")):e.classList.contains(vg)&&(r.file.status===this.localizedTexts("fileUploadCancel")?this.retryUpload(r,!1):this.retryUpload(r,!0))},e.prototype.retryUpload=function(t,e){e?(t.end=t.end+this.asyncSettings.chunkSize,t.start=t.start+this.asyncSettings.chunkSize,this.sendRequest(t.file,t)):(t.file.statusCode="1",t.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(t.file))},e.prototype.chunkUploadInProgress=function(t,e,i){var n=this;if("4"!==e.file.statusCode){"4"!==e.file.statusCode&&"5"!==e.file.statusCode&&(e.file.statusCode="3",e.file.status=this.localizedTexts("inProgress")),this.updateMetaData(e);var o=this.getLiElement(e.file);if(!h(o)){var r=o.querySelector("."+vg);if(h(r)||(r.classList.add(Sg),r.setAttribute("title",this.localizedTexts("pause")),r.classList.remove(vg)),!h(o)){if(!(o.querySelectorAll("."+yg).length>0)){var s=o.querySelector("."+ug);h(this.template)&&(s.classList.add("e-upload-progress"),s.classList.remove(xg),this.createProgressBar(o),this.updateProgressBarClasses(o,"e-upload-progress"));var a=o.querySelector("."+gg)?o.querySelector("."+gg):o.querySelector("."+mg);h(a)||(a.classList.add(fg),a.setAttribute("title",this.localizedTexts("abort")),a.classList.remove(gg))}if(!isNaN(Math.round(t.loaded/t.total*100))&&h(this.template)&&"4"!==e.file.statusCode){var l=e.chunkIndex*this.asyncSettings.chunkSize,c=Math.min((l+t.loaded)/e.file.size*100,100);this.changeProgressValue(o,Math.round(c).toString()+"%")}0===e.chunkIndex&&this.checkActionButtonStatus()}h(o.querySelector("."+Sg))&&h(this.template)&&(this.pauseButton=this.createElement("span",{className:"e-icons e-file-pause-btn",attrs:{tabindex:"-1"}}),"msie"===ma.info.name&&this.pauseButton.classList.add("e-msie"),o.insertBefore(this.pauseButton,o.querySelector("."+fg)),this.pauseButton.setAttribute("title",this.localizedTexts("pause")),this.pauseButton.addEventListener("click",function(t){n.checkPausePlayAction(t)},!1))}}},e.prototype.bytesToSize=function(t){var e=-1;if(!t)return"0.0 KB";do{t/=1024,e++}while(t>99);return e>=2&&(t*=1024,e=1),Math.max(t,0).toFixed(1)+" "+["KB","MB"][e]},e.prototype.sortFileList=function(t){for(var e=t,i=[],n=0;n<e.length;n++)i.push(e[n].name);for(var o=[],r=0,s=i.sort();r<s.length;r++)for(var a=s[r],n=0;n<e.length;n++)a===e[n].name&&o.push(e[n]);return o},e.prototype.destroy=function(){this.element.value=null,this.clearAll(),this.unWireEvents(),this.unBindDropEvents(),this.multiple&&this.element.removeAttribute("multiple"),this.enabled||this.element.removeAttribute("disabled"),this.element.removeAttribute("accept"),this.setInitialAttributes(),this.uploadWrapper.parentElement.appendChild(this.cloneElement),this.cloneElement.classList.remove("e-control","e-uploader"),L(this.uploadWrapper),this.uploadWrapper=null,t.prototype.destroy.call(this)},e.prototype.upload=function(t,e){var i=this.validateFileType(t);this.uploadFiles(i,e)},e.prototype.validateFileType=function(t){var e=[];return t instanceof Array?e=t:e.push(t),e},e.prototype.uploadFiles=function(t,e){var i=this,n=[];if(""!==this.asyncSettings.saveUrl&&!h(this.asyncSettings.saveUrl)){if(!e||h(e))if(this.multiple)n=this.filterfileList(t);else{var o=[];o.push(t[0]),n=this.filterfileList(o)}else n=t;for(var r=this.checkChunkUpload(),s=this,a=0;a<n.length;a++)!function(t){var o=new la(s.asyncSettings.saveUrl,"POST",!0,null),a={fileData:n[t],customFormData:[],cancel:!1},l=new FormData;if(o.beforeSend=function(e){a.currentRequest=o.httpRequest,i.trigger("uploading",a),a.cancel&&i.eventCancelByArgs(e,a,n[t]),i.updateFormData(l,a.customFormData)},"1"===n[t].statusCode){var h=s.element.getAttribute("name");l.append(h,n[t].rawFile,n[t].name),r&&n[t].size>s.asyncSettings.chunkSize?s.chunkUpload(n[t],e):(o.onLoad=function(o){return i.uploadComplete(o,n[t],e),{}},o.onUploadProgress=function(r){return i.uploadInProgress(r,n[t],e,o),{}},o.onError=function(e){return i.uploadFailed(e,n[t]),{}},o.send(l))}}(a)}},e.prototype.remove=function(t,e,i,n){var o=[];(t=h(t)?this.filesData:t)instanceof Array?o=t:o.push(t);for(var r={event:n,cancel:!1,filesData:o,customFormData:[],postRawFile:!0},s=this.asyncSettings.removeUrl,a=""!==s&&!h(s),l=0,c=o;l<c.length;l++){var d=c[l];if("2"===d.statusCode&&a)this.removeUploadedFile(d,r,i,e);else{if(i||this.trigger("removing",r),r.cancel)return;this.removeFilesData(d,e)}}},e.prototype.clearAll=function(){if(h(this.listParent))return"msie"!==ma.info.name&&(this.element.value=""),void(this.filesData=[]);var t={cancel:!1,filesData:this.filesData};this.trigger("clearing",t),t.cancel||this.clearData()},e.prototype.getFilesData=function(){return this.filesData},e.prototype.pause=function(t,e){var i=this.validateFileType(t);this.pauseUploading(i,e)},e.prototype.pauseUploading=function(t,e){for(var i=this.getFiles(t),n=0;n<i.length;n++)"3"===i[n].statusCode&&this.pauseUpload(this.getCurrentMetaData(i[n],null),null,e)},e.prototype.getFiles=function(t){var e=[];return h(t)||t instanceof Array?e=t:e.push(t),e},e.prototype.resume=function(t,e){var i=this.validateFileType(t);this.resumeFiles(i,e)},e.prototype.resumeFiles=function(t,e){for(var i=this.getFiles(t),n=0;n<i.length;n++)"4"===i[n].statusCode&&this.resumeUpload(this.getCurrentMetaData(i[n],null),null,e)},e.prototype.retry=function(t,e){var i=this.validateFileType(t);this.retryFailedFiles(i,e)},e.prototype.retryFailedFiles=function(t,e){for(var i=this.getFiles(t),n=0;n<i.length;n++)if("5"===i[n].statusCode||"0"===i[n].statusCode)if(this.asyncSettings.chunkSize>0)this.retryUpload(this.getCurrentMetaData(i[n],null),e);else{var o=this.fileList[this.filesData.indexOf(i[n])];this.reloadcanceledFile(null,i[n],o)}},e.prototype.cancel=function(t){var e=this.validateFileType(t);this.cancelUpload(e)},e.prototype.cancelUpload=function(t){for(var e=this.getFiles(t),i=0;i<e.length;i++)if("3"===e[i].statusCode){var n=this.getCurrentMetaData(e[i],null);n.file.statusCode="5",n.file.status=this.localizedTexts("fileUploadCancel"),this.updateMetaData(n);var o=this.getLiElement(e[i]);if(!h(o)&&h(this.template)){var r=o.querySelector("."+fg);Ae({target:r,width:"20px"}),li(r)}}},dg([G({saveUrl:"",removeUrl:""},Lg)],e.prototype,"asyncSettings",void 0),dg([Y(!1)],e.prototype,"enableRtl",void 0),dg([Y(!0)],e.prototype,"enabled",void 0),dg([Y(null)],e.prototype,"template",void 0),dg([Y(!0)],e.prototype,"multiple",void 0),dg([Y(!0)],e.prototype,"autoUpload",void 0),dg([G({},Pg)],e.prototype,"buttons",void 0),dg([Y("")],e.prototype,"allowedExtensions",void 0),dg([Y(0)],e.prototype,"minFileSize",void 0),dg([Y(3e7)],e.prototype,"maxFileSize",void 0),dg([Y(null)],e.prototype,"dropArea",void 0),dg([K([{}],Eg)],e.prototype,"files",void 0),dg([Y(!0)],e.prototype,"showFileList",void 0),dg([J()],e.prototype,"created",void 0),dg([J()],e.prototype,"selected",void 0),dg([J()],e.prototype,"uploading",void 0),dg([J()],e.prototype,"success",void 0),dg([J()],e.prototype,"failure",void 0),dg([J()],e.prototype,"removing",void 0),dg([J()],e.prototype,"clearing",void 0),dg([J()],e.prototype,"progress",void 0),dg([J()],e.prototype,"change",void 0),dg([J()],e.prototype,"chunkSuccess",void 0),dg([J()],e.prototype,"chunkFailure",void 0),dg([J()],e.prototype,"canceling",void 0),dg([J()],e.prototype,"pausing",void 0),dg([J()],e.prototype,"resuming",void 0),e=dg([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),kg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Og=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Tg(e,t),kg([Y("")],e.prototype,"iconCss",void 0),kg([Y("")],e.prototype,"id",void 0),kg([Y(!1)],e.prototype,"separator",void 0),kg([Y("")],e.prototype,"text",void 0),kg([Y("")],e.prototype,"url",void 0),e}(xa),Ag=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Mg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Ig={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical"},Dg=function(t){function e(e,i){return t.call(this,e,i)||this}return Ag(e,t),e.prototype.preRender=function(){},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.closePopup()},e.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents()},e.prototype.createPopup=function(){var t=this.createElement("div",{className:Ig.POPUP,id:this.element.id+"-popup"});document.body.appendChild(t),this.dropDown=new Hh(t,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),"fixed"===this.dropDown.element.style.position&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),k(this.element,(e={},e.role="menu",e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e["aria-owns"]=this.getPopUpElement().id,e.type="button",e)),this.cssClass&&w([t],this.cssClass.split(" "));var e},e.prototype.getTargetElement=function(){return"string"==typeof this.target?O(this.target):this.target},e.prototype.createItems=function(t){for(var e,i,n,o,r=this.hasIcon(t,"iconCss"),s=this.createElement("ul",{attrs:{tabindex:"0"}}),a=0;a<t.length;a++)i=t[a],n=this.createElement("li",{innerHTML:i.url?"":i.text,className:i.separator?Ig.ITEM+" "+Ig.SEPARATOR:Ig.ITEM,attrs:{role:"menuItem",tabindex:"-1"},id:i.id?i.id:d("e-"+this.getModuleName()+"-item")}),i.iconCss?(e=this.createElement("span",{className:Ig.ICON+" "+i.iconCss}),n.insertBefore(e,n.childNodes[0])):r&&!i.separator&&n.classList.add("e-blank-icon"),i.url&&n.appendChild(this.createAnchor(i)),o={item:i,element:n},this.trigger("beforeItemRender",o),s.appendChild(n);return s},e.prototype.hasIcon=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i][e])return!0;return!1},e.prototype.createAnchor=function(t){return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:t.text,attrs:{href:t.url}})},e.prototype.initialize=function(){this.button=new Vh({iconCss:this.iconCss,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.appendTo(this.element),this.element.id||(this.element.id=d("e-"+this.getModuleName())),this.setIconPositionTop(),this.appendArrowSpan(),this.createPopup(),this.setActiveElem([this.element])},e.prototype.setIconPositionTop=function(){var t=this.element.querySelector(".e-icon-left");t&&"Top"===this.iconPosition&&(w([this.element],"e-top-icon-btn"),x([t],"e-icon-left"),w([t],"e-icon-top"))},e.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(Ig.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},e.prototype.setActiveElem=function(t){this.activeElem=t},e.prototype.getModuleName=function(){return"dropdown-btn"},e.prototype.canOpen=function(){return this.getPopUpElement().classList.contains("e-popup-close")},e.prototype.destroy=function(){var e=this;this.element.querySelector("span.e-caret")&&L(this.element.querySelector("span.e-caret")),t.prototype.destroy.call(this),this.button.destroy(),["role","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(t){e.element.removeAttribute(t)}),x([this.element],["e-btn"]),x(this.activeElem,["e-active"]),this.dropDown.destroy();var i=document.getElementById(this.getPopUpElement().id);i&&(x([i],["e-popup-open","e-popup-close"]),L(i)),this.disabled||this.unWireEvents()},e.prototype.getPopUpElement=function(){return this.dropDown.element},e.prototype.getULElement=function(){return this.getPopUpElement().children[0]},e.prototype.wireEvents=function(){var t=this.getPopUpElement();this.delegateMousedownHandler=this.mousedownHandler.bind(this),ha.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),ha.add(this.element,"click",this.clickHandler,this),ha.add(t,"click",this.clickHandler,this),ha.add(this.element,"keydown",this.keyBoardHandler,this),ha.add(t,"keydown",this.keyBoardHandler,this),this.rippleFn=it(t,{selector:"."+Ig.ITEM})},e.prototype.keyBoardHandler=function(t){if(t.target!==this.element||9!==t.keyCode&&(t.altKey||40!==t.keyCode)&&38!==t.keyCode)switch(t.keyCode){case 38:case 40:!t.altKey||38!==t.keyCode&&40!==t.keyCode?this.upDownKeyHandler(t):this.keyEventHandler(t);break;case 9:case 13:case 27:case 32:this.keyEventHandler(t)}},e.prototype.upDownKeyHandler=function(t){if(!this.target||38!==t.keyCode&&40!==t.keyCode){t.preventDefault();var e=this.getULElement(),i=40===t.keyCode?0:e.childElementCount-1,n=i,o=null;this.removeCustomSelection();for(var r=0,s=e.children.length;r<s;r++)e.children[r].classList.contains(Ig.FOCUS)&&(n=r,(o=e.children[r]).classList.remove(Ig.FOCUS),40===t.keyCode?n++:n--,n===(40===t.keyCode?e.childElementCount:-1)&&(n=i));o=e.children[n],-1!==(n=this.isValidLI(o,n,t.keyCode))&&(w([e.children[n]],Ig.FOCUS),e.children[n].focus())}},e.prototype.removeCustomSelection=function(){var t=this.getULElement().querySelector(".e-selected");t&&t.classList.remove("e-selected")},e.prototype.isValidLI=function(t,e,i,n){if(void 0===n&&(n=0),(t.classList.contains(Ig.SEPARATOR)||t.classList.contains(Ig.DISABLED))&&(e===(40===i?this.items.length-1:0)?e=40===i?0:this.items.length-1:40===i?e++:e--),(t=this.getULElement().children[e]).classList.contains(Ig.SEPARATOR)||t.classList.contains(Ig.DISABLED)){if(++n===this.items.length)return e=-1;e=this.isValidLI(t,e,i,n)}return e},e.prototype.keyEventHandler=function(t){(!this.target||13!==t.keyCode&&9!==t.keyCode)&&(9!==t.keyCode&&t.preventDefault(),27===t.keyCode||38===t.keyCode||9===t.keyCode?this.canOpen()||this.closePopup(t,this.element):this.clickHandler(t))},e.prototype.getLI=function(t){return"LI"===t.tagName?t:M(t,"li")},e.prototype.mousedownHandler=function(t){var e=t.target;this.canOpen()||M(e,"#"+this.getPopUpElement().id)||M(e,"#"+this.element.id)||this.closePopup(t)},e.prototype.clickHandler=function(t){var e=t.target,i=this.canOpen();if(M(e,"#"+this.element.id))i?this.openPopUp(t):this.closePopup(t,this.activeElem[0]);else if(M(e,"#"+this.getPopUpElement().id)){var n=void 0,o=void 0,r=void 0,s=this.getLI(e);s&&(o=Array.prototype.indexOf.call(this.getULElement().children,s),(r=this.items[o])&&(n={element:s,item:r},this.trigger("select",n)),this.closePopup(t,this.activeElem[0]))}},e.prototype.openPopUp=function(t){void 0===t&&(t=null),this.target||this.getPopUpElement().appendChild(this.createItems(this.items));var e=this.getULElement(),i={element:e,items:this.items,event:t,cancel:!1};if(this.trigger("beforeOpen",i),!i.cancel){this.dropDown.show(null,this.element),w([this.element],"e-active"),this.element.setAttribute("aria-expanded","true"),e.focus();var n={element:e,items:this.items};this.trigger("open",n)}},e.prototype.closePopup=function(t,e){void 0===t&&(t=null);var i=this.getULElement(),n={element:i,items:this.items,event:t,cancel:!1};if(this.trigger("beforeClose",n),!n.cancel){this.removeCustomSelection(),this.dropDown.hide(),x(this.activeElem,"e-active"),this.element.setAttribute("aria-expanded","false"),e&&e.focus();var o={element:i,items:this.items};this.trigger("close",o),!this.target&&i&&L(i)}},e.prototype.unWireEvents=function(){ha.remove(document,"mousedown touchstart",this.delegateMousedownHandler),ha.remove(this.element,"click",this.clickHandler),ha.remove(this.getPopUpElement(),"click",this.clickHandler),ha.remove(this.element,"keydown",this.keyBoardHandler),ha.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.rippleFn()},e.prototype.onPropertyChanged=function(t,e){var i=["content","cssClass","iconCss","disabled","enableRtl"];"Left"===t.iconPosition&&i.push("iconPosition"),this.button.setProperties(Ks(t,i));for(var n=this.getPopUpElement(),o=0,r=Object.keys(t);o<r.length;o++)switch(r[o]){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":t.disabled?(this.unWireEvents(),this.canOpen()||this.closePopup()):this.wireEvents();break;case"cssClass":t.cssClass.indexOf(Ig.VERTICAL)>-1&&D(this.element.querySelector("span.e-caret"),["e-icon-bottom"],["e-icon-right"]),e.cssClass&&x([n],e.cssClass.split(" ")),t.cssClass&&w([n],t.cssClass.split(" "));break;case"iconPosition":this.setIconPositionTop();break;case"enableRtl":n.classList.toggle(Ig.RTL);break;case"target":this.target=t.target,L(this.getULElement()),n.appendChild(this.getTargetElement()),this.dropDown.content=this.getTargetElement();break;case"items":this.dropDown.refresh(),n.classList.contains("e-popup-open")&&D(n,["e-popup-close"],["e-popup-open"])}},Mg([Y("")],e.prototype,"content",void 0),Mg([Y("")],e.prototype,"cssClass",void 0),Mg([Y(!1)],e.prototype,"disabled",void 0),Mg([Y("")],e.prototype,"iconCss",void 0),Mg([Y("Left")],e.prototype,"iconPosition",void 0),Mg([K([],Og)],e.prototype,"items",void 0),Mg([Y("")],e.prototype,"target",void 0),Mg([J()],e.prototype,"beforeItemRender",void 0),Mg([J()],e.prototype,"beforeOpen",void 0),Mg([J()],e.prototype,"beforeClose",void 0),Mg([J()],e.prototype,"close",void 0),Mg([J()],e.prototype,"open",void 0),Mg([J()],e.prototype,"select",void 0),e=Mg([$],e)}(Ka),Rg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ng=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Bg="EJS-SPLITBUTTON",Hg=function(t){function e(e,i){return t.call(this,e,i)||this}return Rg(e,t),e.prototype.preRender=function(){var t=this.element;if(t.tagName===Bg){for(var e=n("ej2_instances",t),i=this.createElement("button",{attrs:{type:"button"}}),r=this.createElement(Bg,{className:"e-"+this.getModuleName()+"-wrapper"}),s=0,a=t.attributes.length;s<a;s++)i.setAttribute(t.attributes[s].nodeName,t.attributes[s].nodeValue);t.parentNode.insertBefore(r,t),L(t),t=i,r.appendChild(t),o("ej2_instances",e,t),this.wrapper=r,this.element=t}this.element.id||(this.element.id=d("e-"+this.getModuleName()))},e.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents()},e.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add("e-rtl"),this.cssClass&&w([this.wrapper],this.cssClass.split(" "))},e.prototype.createPrimaryButton=function(){var t={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,content:this.content,disabled:this.disabled};this.primaryBtnObj=new Vh(t,this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element),this.setIconPositionTop()},e.prototype.createSecondaryButton=function(){var t=this,e=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(e);var i={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,beforeItemRender:function(e){t.trigger("beforeItemRender",e)},beforeOpen:function(e){t.trigger("beforeOpen",e)},beforeClose:function(e){t.trigger("beforeClose",e)},open:function(e){t.trigger("open",e)},close:function(e){t.trigger("close",e)},select:function(e){t.trigger("select",e)}};this.secondaryBtnObj=new Dg(i,e),this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],ha.remove(this.getPopUpElement(),"keydown",this.secondaryBtnObj.keyBoardHandler),this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")},e.prototype.setAria=function(){k(this.element,{role:"listbox","aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.secondaryBtnObj.dropDown.element.id})},e.prototype.getModuleName=function(){return"split-btn"},e.prototype.toggle=function(){this.secondaryBtnObj.toggle()},e.prototype.destroy=function(){var t=this;this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy();var e=document.getElementById(this.element.id);e&&e.parentElement===this.wrapper&&(this.wrapper.tagName===Bg?(this.wrapper.innerHTML="",x([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),x([this.wrapper],this.cssClass.split(" "))):(x([this.element],["e-"+this.getModuleName(),"e-rtl"]),["role","aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(e){t.element.removeAttribute(e)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),T(this.wrapper)),this.unWireEvents())},e.prototype.wireEvents=function(){ha.add(this.element,"click",this.primaryBtnClickHandler,this),ha.add(this.getPopUpElement(),"keydown",this.keyBoardHandler,this),new ll(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})},e.prototype.unWireEvents=function(){ha.remove(this.element,"click",this.primaryBtnClickHandler),f(this.element,ll).destroy()},e.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},e.prototype.btnKeyBoardHandler=function(t){switch(t.action){case"altdownarrow":this.clickHandler(t)}},e.prototype.onPropertyChanged=function(t,e){var i=["content","iconCss","cssClass","disabled","enableRtl"];"Left"===t.iconPosition&&i.push("iconPosition"),this.primaryBtnObj.setProperties(Ks(t,i)),i=["items","beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl"],this.secondaryBtnObj.setProperties(Ks(t,i));for(var n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"cssClass":e.cssClass&&x([this.wrapper],e.cssClass.split(" ")),w([this.wrapper],t.cssClass.split(" "));break;case"iconPosition":this.setIconPositionTop();break;case"enableRtl":t.enableRtl?w([this.wrapper],"e-rtl"):x([this.wrapper],"e-rtl")}},Ng([Y("")],e.prototype,"content",void 0),Ng([Y("")],e.prototype,"cssClass",void 0),Ng([Y(!1)],e.prototype,"disabled",void 0),Ng([Y("")],e.prototype,"iconCss",void 0),Ng([Y("Left")],e.prototype,"iconPosition",void 0),Ng([K([],Og)],e.prototype,"items",void 0),Ng([Y("")],e.prototype,"target",void 0),Ng([J()],e.prototype,"beforeItemRender",void 0),Ng([J()],e.prototype,"beforeOpen",void 0),Ng([J()],e.prototype,"beforeClose",void 0),Ng([J()],e.prototype,"click",void 0),Ng([J()],e.prototype,"close",void 0),Ng([J()],e.prototype,"open",void 0),Ng([J()],e.prototype,"select",void 0),e=Ng([$],e)}(Dg),zg=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),jg=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Fg="e-switch-ctrl-btn",Vg="e-value-switch-btn",_g="e-hex",Wg="e-hsv-color",Ug="e-selected-value",qg="e-mode-switch-btn",Xg="e-nocolor-item",Yg="e-preview-container",Gg="e-selected",Zg="e-tile",Kg="e-to-hsv",Qg={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},Jg=(function(t){function e(e,i){return t.call(this,e,i)||this}zg(e,t),e.prototype.preRender=function(){var t={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"};this.l10n=new hl("colorpicker",t,this.locale)},e.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn()},e.prototype.initWrapper=function(){var t=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(t,this.element),t.appendChild(this.element),k(this.element,{tabindex:"-1",spellcheck:"false"}),this.container=this.createElement("div",{className:"e-container"}),this.getWrapper().appendChild(this.container);var e=this.value?this.value:"#008000";this.element.value=e.slice(0,7),"Picker"===this.mode&&(e=this.roundValue(e)),this.setProperties({value:e},!0),this.enableRtl&&t.classList.add("e-rtl"),this.cssClass&&w([t],this.cssClass.split(" ")),this.tileRipple=it(this.container,{selector:"."+Zg}),this.ctrlBtnRipple=it(this.container,{selector:".e-btn"})},e.prototype.getWrapper=function(){return this.element.parentElement},e.prototype.createWidget=function(){"Palette"===this.mode?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus());var t=this.getWrapper();(this.isPicker()&&!t.classList.contains("e-hide-value")||t.classList.contains("e-show-value"))&&this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),ma.isDevice&&this.refreshPopupPos()},e.prototype.createSplitBtn=function(){var t=this,e=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(e),this.splitBtn=new Hg({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,beforeOpen:this.beforeOpenFn.bind(this),open:this.onOpen.bind(this),beforeClose:this.popupClose.bind(this),click:function(e){t.trigger("change",{currentValue:{hex:t.value.slice(0,7),rgba:t.convertToRgbString(t.hexToRgb(t.value))},previousValue:{hex:null,rgba:null}})}},e);var i=this.createElement("span",{className:"e-split-preview"});O(".e-selected-color",e).appendChild(i),i.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if(w([n],"e-colorpicker-popup"),this.cssClass&&w([n],this.cssClass.split(" ")),ma.isDevice){var o=this.getPopupInst();o.relateTo=document.body,o.position={X:"center",Y:"center"},o.targetType="container",o.collision={X:"fit",Y:"fit"},o.offsetY=4}},e.prototype.onOpen=function(t){this.trigger("open",{element:this.container})},e.prototype.getPopupInst=function(){return f(this.getPopupEle(),Hh)},e.prototype.beforeOpenFn=function(t){var e={element:this.container,event:t.event,cancel:!1};if(this.trigger("beforeOpen",e),t.cancel=e.cancel,!e.cancel){var i=this.getPopupEle();i.style.display="block",this.createWidget(),i.style.display="",ma.isDevice&&(this.modal=this.createElement("div"),this.modal.className="e-"+this.getModuleName()+" e-modal",this.modal.style.display="none",document.body.insertBefore(this.modal,i),document.body.className+=" e-colorpicker-overflow",this.modal.style.display="block")}},e.prototype.popupClose=function(t){var e={element:this.container,event:t.event,cancel:!1};this.trigger("beforeClose",e),t.cancel=e.cancel,e.cancel||(t.event&&ma.isDevice&&t.event.target===this.modal?t.cancel=!0:(this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",O(".e-split-preview",this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",x([this.container],["e-color-picker","e-color-palette"]),ma.isDevice&&this.modal&&(x([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)))},e.prototype.createPalette=function(){if(D(this.container,["e-color-palette"],["e-color-picker"]),this.presetColors){var t=this.createElement("div",{className:"e-custom-palette"});this.appendElement(t);var e=Object.keys(this.presetColors);if(1===e.length)this.appendPalette(this.presetColors[e[0]],e[0],t);else for(var i=0,n=e.length;i<n;i++)this.appendPalette(this.presetColors[e[i]],e[i],t);A(".e-row",t).length>10&&w([t],"e-palette-group")}else this.appendPalette(Qg.default,"default");"Palette"===this.mode&&!this.modeSwitcher&&this.noColor&&this.setNoColor();var o=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=m(this.container.children[0].offsetWidth+o+o),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},e.prototype.firstPaletteFocus=function(){O("."+Gg,this.container.children[0])||A(".e-palette",this.container)[0].focus()},e.prototype.appendPalette=function(t,e,i){var n=this.createElement("div",{className:"e-palette",attrs:{tabindex:"0"}});i?i.appendChild(n):this.appendElement(n);for(var o,r,s=0,a=t.length;s<a;s++)0!==s&&s%this.columns!=0||(o=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),n.appendChild(o)),r=this.createElement("span",{className:Zg,attrs:{role:"gridcell","aria-label":t[s],"aria-selected":"false"}}),this.trigger("beforeTileRender",{element:r,presetName:e,value:t[s]}),o.appendChild(r),this.value.slice(0,t[s].length).toLowerCase()===t[s].toLowerCase()&&(this.addTileSelection(r),n.focus()),r.style.backgroundColor=t[s]},e.prototype.setNoColor=function(){var t=A(".e-row")[0].children[0];t.classList.add(Xg),this.value||(t.classList.add(Gg),M(t,".e-palette").focus()),["aria-selected","aria-label"].forEach(function(e){t.removeAttribute(e)}),t.style.backgroundColor=""},e.prototype.appendElement=function(t,e){void 0===e&&(e=0);var i=this.container.children[e];i?this.container.insertBefore(t,i):this.container.appendChild(t)},e.prototype.addTileSelection=function(t){t.classList.add(Gg),t.setAttribute("aria-selected","true")},e.prototype.createPicker=function(){D(this.container,["e-color-picker"],["e-color-palette"]);var t=this.createElement("div",{className:"e-hsv-container"});this.appendElement(t),t.appendChild(this.createElement("div",{className:Wg}));var e=this.createElement("span",{className:"e-handler",attrs:{tabindex:"0"}});t.appendChild(e),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},e.prototype.setHsvContainerBg=function(t){void 0===t&&(t=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(t,100,100,1))},e.prototype.getHsvContainer=function(){return O(".e-hsv-container",this.container)},e.prototype.setHandlerPosition=function(){var t=this.getDragHandler(),e=O("."+Wg,this.container);this.enableRtl?t.style.left=m(e.offsetWidth*Math.abs(100-this.hsv[1])/100):t.style.left=m(e.offsetWidth*this.hsv[1]/100),t.style.top=m(e.offsetHeight*(100-this.hsv[2])/100)},e.prototype.createSlider=function(){var t=this.createElement("div",{className:"e-slider-preview"});this.appendElement(t,1),this.createPreview(t);var e=this.createElement("div",{className:"e-colorpicker-slider"});t.insertBefore(e,t.children[0]);var i=this.createElement("div",{className:"e-hue-slider"});e.appendChild(i),this.hueSlider=new eg({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)},i),i=this.createElement("div",{className:"e-opacity-slider"}),e.appendChild(i),this.opacitySlider=new eg({value:100*this.rgb[3],min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)},i);var n=this.createElement("div",{className:"e-opacity-empty-track"});i.appendChild(n),this.updateOpacitySliderBg()},e.prototype.updateOpacitySliderBg=function(){var t=this.enableRtl?"to left":"to right";O(".e-slider-track",this.opacitySlider.element).style.background="linear-gradient("+t+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)"},e.prototype.hueChange=function(t){this.hsv[0]=t.value,this.setHsvContainerBg(),this.convertToOtherFormat()},e.prototype.opacityChange=function(t){var e=t.value,i=this.rgbToHex(this.rgb);this.hsv[3]=e/100,this.rgb[3]=e/100;var n=this.rgbToHex(this.rgb);this.getWrapper().classList.contains("e-hide-value")||(f(O(".e-opacity-value",this.container),Fu).value=e);var o=this.convertToRgbString(this.rgb);this.updatePreview(o),this.triggerEvent(n,i,o)},e.prototype.createPreview=function(t){var e=this.createElement("div",{className:Yg});t.appendChild(e);var i=this.createElement("span",{className:"e-preview e-current"});e.appendChild(i);var n=this.convertToRgbString(this.rgb);i.style.backgroundColor=n,i=this.createElement("span",{className:"e-preview e-previous"}),e.appendChild(i),i.style.backgroundColor=n},e.prototype.isPicker=function(){return!this.container.classList.contains("e-color-palette")},e.prototype.getPopupEle=function(){return this.container.parentElement},e.prototype.getNumericTextBoxModel=function(t,e,i){var n=this;return{value:t,placeholder:e,min:0,max:i,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(t){t.event&&n.inputHandler(t.event)}}},e.prototype.createInput=function(t){void 0===t&&(t=2);var e=this.createElement("div",{className:Ug});this.appendElement(e,t);var i=this.createElement("div",{className:"e-input-container"});e.appendChild(i),e.appendChild(this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+Vg+" "+Kg}));var n=this.createElement("input",{className:_g,attrs:{maxlength:"7",spellcheck:"false"}});this.isPicker()||lu.setReadonly(!0,n),i.appendChild(n),lu.createInput({element:n,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled}},this.createElement),lu.setValue(this.value.slice(0,7),n);for(var o=["rh","gs","bv"],r=0;r<3;r++)new Fu(this.getNumericTextBoxModel(this.rgb[r],"RGB"[r],255),i.appendChild(this.createElement("input",{className:"e-"+o[r]+"-value"})));new Fu(this.getNumericTextBoxModel(100*this.rgb[3],"A",100),i.appendChild(this.createElement("input",{className:"e-opacity-value"})))},e.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var t=this.createElement("div",{className:Fg});if(this.container.appendChild(t),this.showButtons){var e=this.createElement("div",{className:"e-ctrl-btn"});t.appendChild(e);var i=this.l10n.getConstant("Apply");e.appendChild(this.createElement("button",{innerHTML:i,className:"e-btn e-flat e-primary e-small e-apply",attrs:{title:i}}));var n=this.l10n.getConstant("Cancel");e.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-flat e-small e-cancel",attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},e.prototype.appendModeSwitchBtn=function(){var t=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+qg,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});O("."+Fg,this.container).insertBefore(t,O(".e-ctrl-btn",this.container))},e.prototype.createDragTooltip=function(){var t=this,e=new rc({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",beforeOpen:function(e){t.tooltipEle=e.element},animation:{open:{effect:"None"},close:{effect:"None"}}});e.appendTo(this.container),e.open(this.container),this.tooltipEle.style.zIndex=Se(this.tooltipEle).toString(),O(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},e.prototype.getTooltipInst=function(){return f(this.container,rc)},e.prototype.setTooltipOffset=function(t){this.getTooltipInst().offsetY=t},e.prototype.toggleDisabled=function(t){t?this.getWrapper().classList.add("e-disabled"):this.getWrapper().classList.remove("e-disabled"),this.showButtons&&[].slice.call(A(".e-btn",this.container)).forEach(function(e){t?k(e,{disabled:""}):e.removeAttribute("disabled")})},e.prototype.convertToRgbString=function(t){return t.length?4===t.length?"rgba("+t.join()+")":"rgb("+t.join()+")":""},e.prototype.convertToHsvString=function(t){return 4===t.length?"hsva("+t.join()+")":"hsv("+t.join()+")"},e.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},e.prototype.convertToOtherFormat=function(t){void 0===t&&(t=!1);var e=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var i=this.rgbToHex(this.rgb),n=this.convertToRgbString(this.rgb);this.updatePreview(n),this.updateInput(i),this.triggerEvent(i,e,n,t)},e.prototype.updateInput=function(t){this.getWrapper().classList.contains("e-hide-value")||(lu.setValue(t.substr(0,7),O("."+_g,this.container)),O("."+Vg,this.container).classList.contains(Kg)?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1))},e.prototype.updatePreview=function(t){this.updateOpacitySliderBg(),O(".e-tip-transparent",this.tooltipEle).style.backgroundColor=t,O("."+Yg+" .e-current",this.container).style.backgroundColor=t,O("."+Yg+" .e-previous",this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},e.prototype.getDragHandler=function(){return O(".e-handler",this.container)},e.prototype.removeTileSelection=function(){[].slice.call(A("."+Gg,this.container.children[0])).forEach(function(t){t.classList.remove(Gg),t.setAttribute("aria-selected","false")})},e.prototype.convertRgbToNumberArray=function(t){return t.slice(t.indexOf("(")+1,t.indexOf(")")).split(",").map(function(t,e){return 3!==e?parseInt(t,10):parseFloat(t)})},e.prototype.getValue=function(t,e){if(t||(t=this.value),e=e?e.toLowerCase():"hex","r"===t[0]){i=this.convertRgbToNumberArray(t);if("hex"===e||"hexa"===e){n=this.rgbToHex(i);return"hex"===e?n.slice(0,7):n}return"hsv"===e?this.convertToHsvString(this.rgbToHsv.apply(this,i.slice(0,3))):"hsva"===e?this.convertToHsvString(this.rgbToHsv.apply(this,i)):"null"}if("h"===t[0]){var i=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(t));if("rgba"===e)return this.convertToRgbString(i);if("hex"===e||"hexa"===e){var n=this.rgbToHex(i);return"hex"===e?n.slice(0,7):n}return"rgb"===e?this.convertToRgbString(i.slice(0,3)):"null"}t=this.roundValue(t);var o=this.hexToRgb(t);return"rgb"!==e&&"hsv"!==e||(o=o.slice(0,3)),"rgba"===e||"rgb"===e?this.convertToRgbString(o):"hsva"===e||"hsv"===e?this.convertToHsvString(this.rgbToHsv.apply(this,o)):"hex"===e?t.slice(0,7):"a"===e?o[3].toString():"null"},e.prototype.toggle=function(){this.splitBtn.toggle()},e.prototype.getModuleName=function(){return"colorpicker"},e.prototype.getPersistData=function(){return this.addOnPersist(["value"])},e.prototype.wireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();ha.add(t,"keydown",this.pickerKeyDown,this),ha.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),this.getWrapper().classList.contains("e-hide-value")||this.addvalueEventHandler(),ha.add(O(".e-previous",this.container),"click",this.previewHandler,this)}else ha.add(this.container,"click",this.paletteClickHandler,this),ha.add(this.container,"keydown",this.paletteKeyDown,this)},e.prototype.addCtrlSwitchEvent=function(){ha.add(O("."+Fg,this.container),"click",this.btnClickHandler,this)},e.prototype.addInputEvent=function(){ha.add(O("."+_g,this.container),"input",this.inputHandler,this)},e.prototype.addvalueEventHandler=function(){this.addInputEvent(),ha.add(O("."+Vg,this.container),"click",this.formatSwitchHandler,this)},e.prototype.pickerKeyDown=function(t){switch(t.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,t);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,t);break;case 38:this.handlerDragPosition(2,1,t);break;case 40:this.handlerDragPosition(2,-1,t);break;case 13:t.preventDefault();var e=this.rgbToHex(this.rgb);this.enterKeyHandler(e)}},e.prototype.enterKeyHandler=function(t){this.triggerChangeEvent(t),this.inline||(this.toggle(),this.splitBtn.element.focus())},e.prototype.triggerChangeEvent=function(t){var e=t.slice(0,7);this.trigger("change",{currentValue:{hex:e,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))}}),this.setProperties({value:t},!0),this.element.value=e||"#000000"},e.prototype.handlerDragPosition=function(t,e,i){i.preventDefault(),this.hsv[t]+=e*(i.ctrlKey?1:3),this.hsv[t]<0&&(this.hsv[t]=0),this.updateHsv(),this.convertToOtherFormat(!0)},e.prototype.handlerDown=function(t){t.preventDefault(),"mousedown"===t.type?(this.clientX=Math.abs(t.pageX-pageXOffset),this.clientY=Math.abs(t.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(t.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(t.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),ha.add(document,"mousemove touchmove",this.handlerMove,this),ha.add(document,"mouseup touchend",this.handlerEnd,this)},e.prototype.handlerMove=function(t){"touchmove"!==t.type&&t.preventDefault();var e,i;"mousemove"===t.type?(e=Math.abs(t.pageX-pageXOffset),i=Math.abs(t.pageY-pageYOffset)):(e=Math.abs(t.changedTouches[0].pageX-pageXOffset),i=Math.abs(t.changedTouches[0].pageY-pageYOffset)),this.setHsv(e,i);var n=this.getDragHandler();parseInt(n.style.left,10),parseInt(n.style.top,10);this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-e)>8||Math.abs(this.clientY-i)>8)&&(O("."+Wg,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},e.prototype.setHsv=function(t,e){var i=O("."+Wg,this.container),n=i.getBoundingClientRect();t=this.enableRtl?t>n.right?0:Math.abs(t-n.right):t>n.left?Math.abs(t-n.left):0,e=e>n.top?Math.abs(e-n.top):0,this.hsv[2]=Math.round(10*Number(100*(i.offsetHeight-Math.max(0,Math.min(i.offsetHeight,e-i.offsetTop)))/i.offsetHeight))/10,this.hsv[1]=Math.round(10*Number(100*Math.max(0,Math.min(i.offsetWidth,t-i.offsetLeft))/i.offsetWidth))/10},e.prototype.handlerEnd=function(t){"touchend"!==t.type&&t.preventDefault(),ha.remove(document,"mousemove touchmove",this.handlerMove),ha.remove(document,"mouseup touchend",this.handlerEnd);var e=this.getDragHandler();O("."+Wg,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",e.classList.remove("e-hide-handler")),this.inline||this.showButtons||this.toggle()},e.prototype.btnClickHandler=function(t){var e=t.target;M(e,"."+qg)?(t.stopPropagation(),this.switchToPalette()):(e.classList.contains("e-apply")||e.classList.contains("e-cancel"))&&this.ctrlBtnClick(e)},e.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),L(O(".e-slider-preview",this.container)),this.getWrapper().classList.contains("e-hide-value")||L(O("."+Ug,this.container)),L(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.getWrapper().classList.contains("e-show-value")&&this.createInput(1),this.refreshPopupPos(),this.wireEvents()},e.prototype.refreshPopupPos=function(){if(!this.inline){var t=this.getPopupEle();t.style.left="0px",t.style.top="0px",this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},e.prototype.formatSwitchHandler=function(t){var e=t.target;e.classList.contains(Kg)?(this.updateValue(this.hsv,!0,3,[360,100,100]),e.classList.remove(Kg)):(this.updateValue(this.rgb,!0,2),e.classList.add(Kg))},e.prototype.updateValue=function(t,e,i,n){for(var o,r=["e-rh-value","e-gs-value","e-bv-value"],s=0,a=r.length;s<a;s++)(o=f(O("."+r[s],this.container),Fu)).value=Math.round(t[s]),e&&(o.placeholder=r[s].substr(i,1).toUpperCase(),o.max=n?n[s]:255),o.dataBind()},e.prototype.previewHandler=function(t){var e=t.target,i=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(e.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),o=this.rgbToHsv.apply(this,this.rgb);o[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:o[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(o[0]),o[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:100*o[3]},!0),this.opacitySlider.refresh()),this.updateOpacitySliderBg(),this.hsv=o,this.setHandlerPosition(),this.updateInput(n),O("."+Yg+" .e-current",this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,i,this.convertToRgbString(this.rgb))},e.prototype.paletteClickHandler=function(t){t.preventDefault();var e=t.target;if(e.classList.contains(Zg)){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(Xg))this.noColorTile();else{var i=e.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(i)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains("e-show-value")&&this.updateInput(i),this.triggerEvent(i,n,this.convertToRgbString(this.rgb))}this.inline||this.showButtons||this.toggle()}else M(e,"."+qg)?this.switchToPicker():e.classList.contains("e-apply")||e.classList.contains("e-cancel")?this.ctrlBtnClick(e):this.getWrapper().classList.contains("e-show-value")&&M(e,"."+Vg)&&this.formatSwitchHandler(t)},e.prototype.noColorTile=function(t){void 0===t&&(t=!1);var e=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",e,"",t)},e.prototype.switchToPicker=function(){var t=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(A(".e-palette",this.container)).forEach(function(t){L(t)}),t.classList.contains("e-show-value")&&L(O("."+Ug,this.container)),this.container.style.width="";var e=O(".e-custom-palette",this.container);this.presetColors&&T(e),this.createPicker(),this.getDragHandler().focus(),t.classList.contains("e-hide-value")||this.createInput(),this.refreshPopupPos(),this.wireEvents()},e.prototype.ctrlBtnClick=function(t){if(t.classList.contains("e-apply")){var e=this.rgbToHex(this.rgb);this.triggerChangeEvent(e)}this.inline||(this.toggle(),this.splitBtn.element.focus())},e.prototype.paletteKeyDown=function(t){var e=t.target;if(e.classList.contains("e-palette")){var i,n,o=[].slice.call(A("."+Zg,e)),r=o.filter(function(t){return t.classList.contains("e-selected")}).pop();switch(!t.altKey&&t.keyCode){case 39:t.preventDefault(),i=r?o[this.tilePosition(o,r,this.enableRtl?-1:1)]:o[this.enableRtl?o.length-1:0],this.keySelectionChanges(i);break;case 37:t.preventDefault(),i=r?o[this.tilePosition(o,r,this.enableRtl?1:-1)]:o[this.enableRtl?0:o.length-1],this.keySelectionChanges(i);break;case 38:t.preventDefault(),i=o[n=r?this.tilePosition(o,r,-this.columns):0]?o[n]:o[n-this.columns],this.keySelectionChanges(i);break;case 40:t.preventDefault(),o[n=r?this.tilePosition(o,r,this.columns):o.length-1]?i=o[n]:(n%=o.length,i=o[n+=o[o.length-1].parentElement.childElementCount]),this.keySelectionChanges(i);break;case 13:if(t.preventDefault(),r){var s=r.getAttribute("aria-label");this.enterKeyHandler(s||"")}}}},e.prototype.keySelectionChanges=function(t){if(this.removeTileSelection(),this.addTileSelection(t),t.classList.contains(Xg))this.noColorTile(!0);else{var e=t.getAttribute("aria-label"),i=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains("e-show-value")&&this.updateInput(e),this.triggerEvent(e,i,this.convertToRgbString(this.rgb),!0)}},e.prototype.tilePosition=function(t,e,i){var n=(t=Array.prototype.slice.call(t)).length,o=this.columns-t[n-1].parentElement.childElementCount,r=t.indexOf(e);return r+=i,r<0?r+=n+o:r%=n+o,r},e.prototype.inputHandler=function(t){var e=t.target;if(e.value.length){var i,n;switch(O(".e-float-text",e.parentElement).textContent){case"HEX":var o="";if(("#"===e.value[0]&&5!==e.value.length||"#"!==e.value[0]&&4!==e.value.length)&&(o=this.roundValue(e.value)),9!==o.length)return;n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(o+o.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,e.value);break;case"R":this.rgb[0]!==Number(e.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(e.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"G":this.rgb[1]!==Number(e.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(e.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"B":this.rgb[2]!==Number(e.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(e.value),i=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(i,n));break;case"H":this.hueSlider.value=Number(e.value);break;case"S":this.hsv[1]!==Number(e.value)&&(this.hsv[1]=Number(e.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(e.value)&&(this.hsv[2]=Number(e.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(e.value)}}},e.prototype.inputValueChange=function(t,e,i){t[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:t[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(t[0])),this.hsv=t;var n=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(i||n);var o=this.convertToRgbString(this.rgb);this.updatePreview(o),this.triggerEvent(n,e,o)},e.prototype.triggerEvent=function(t,e,i,n){void 0===n&&(n=!1);var o=t.slice(0,7),r={currentValue:{hex:o,rgba:i},previousValue:{hex:e.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(e))}};this.showButtons||n?this.trigger("select",r):(r.previousValue={hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},this.trigger("change",r),this.setProperties({value:t},!0),this.element.value=o||"#000000")},e.prototype.destroy=function(){var e=this,i=this.getWrapper();t.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(t){e.element.removeAttribute(t)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,L(this.element.nextElementSibling),i.parentElement.insertBefore(this.element,i),L(i),this.container=null},e.prototype.destroyOtherComp=function(){if(this.isPicker()){this.hueSlider.destroy(),this.opacitySlider.destroy(),this.hueSlider=null,this.opacitySlider=null;var t=this.getTooltipInst();t.close(),t.destroy(),this.tooltipEle=null}},e.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},e.prototype.unWireEvents=function(){if(this.isPicker()){var t=this.getDragHandler();ha.remove(t,"keydown",this.pickerKeyDown),ha.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&ha.remove(O("."+Fg,this.container),"click",this.btnClickHandler),this.getWrapper().classList.contains("e-hide-value")||(ha.remove(O("."+Vg,this.container),"click",this.formatSwitchHandler),ha.remove(O("."+_g,this.container),"input",this.inputHandler)),ha.remove(O(".e-previous",this.container),"click",this.previewHandler)}else ha.remove(this.container,"click",this.paletteClickHandler),ha.remove(this.container,"keydown",this.paletteKeyDown)},e.prototype.roundValue=function(t){if(!t)return"";"#"!==t[0]&&(t="#"+t);var e=t.length;if(4===e&&(t+="f",e=5),5===e){for(var i="",n=1,o=t.length;n<o;n++)i+=t.charAt(n)+t.charAt(n);t="#"+i,e=9}return 7===e&&(t+="ff"),t},e.prototype.hexToRgb=function(t){if(!t)return[];9!==(t=t.trim()).length&&(t=this.roundValue(t));var e=Number((parseInt(t.slice(-2),16)/255).toFixed(2));t=t.slice(1,7);var i=parseInt(t,16),n=[];return n.push(i>>16&255),n.push(i>>8&255),n.push(255&i),n.push(e),n},e.prototype.rgbToHsv=function(t,e,i,n){if(this.rgb&&!this.rgb.length)return[];t/=255,e/=255,i/=255;var o,r,s=Math.max(t,e,i),a=Math.min(t,e,i),l=s,c=s-a;if(r=0===s?0:c/s,s===a)o=0;else{switch(s){case t:o=(e-i)/c+(e<i?6:0);break;case e:o=(i-t)/c+2;break;case i:o=(t-e)/c+4}o/=6}var d=[Math.round(360*o),Math.round(1e3*r)/10,Math.round(1e3*l)/10];return h(n)||d.push(n),d},e.prototype.hsvToRgb=function(t,e,i,n){var o,r,s,a,l,c,d,p;if(e/=100,i/=100,0===e)return o=r=s=i,[Math.round(255*o),Math.round(255*r),Math.round(255*s),n];switch(t/=60,a=Math.floor(t),l=t-a,c=i*(1-e),d=i*(1-e*l),p=i*(1-e*(1-l)),a){case 0:o=i,r=p,s=c;break;case 1:o=d,r=i,s=c;break;case 2:o=c,r=i,s=p;break;case 3:o=c,r=d,s=i;break;case 4:o=p,r=c,s=i;break;default:o=i,r=c,s=d}var u=[Math.round(255*o),Math.round(255*r),Math.round(255*s)];return h(n)||u.push(n),u},e.prototype.rgbToHex=function(t){return t.length?"#"+this.hex(t[0])+this.hex(t[1])+this.hex(t[2])+(h(t[3])?"":0!==t[3]?(Math.round(255*t[3])+65536).toString(16).substr(-2):"00"):""},e.prototype.hex=function(t){return("0"+t.toString(16)).slice(-2)},e.prototype.changeModeSwitcherProp=function(t){var e=O("."+Fg,this.container);t?e?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):e&&(this.showButtons?L(O("."+qg,e)):T(e))},e.prototype.changeShowBtnProps=function(t){var e=O("."+Fg,this.container);t?(e&&T(e),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?L(O(".e-ctrl-btn",e)):T(e)},e.prototype.changeValueProp=function(t){this.isPicker()?(this.rgb=this.hexToRgb(t),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),L(M(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateOpacitySliderBg(),this.updateInput(t)):(this.removeTileSelection(),this.addTileSelection(O('span[aria-label="'+t+'"]',this.container))),this.element.value=t.slice(0,7)},e.prototype.setInputEleProps=function(t){T(O("."+Ug,this.container)),this.createInput()},e.prototype.changeDisabledProp=function(t){this.isPicker()&&(this.hueSlider.enabled=!t,this.opacitySlider.enabled=!t,this.setInputEleProps(t)),t?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},e.prototype.changeCssClassProps=function(t,e){var i=this.getWrapper(),n=this.getPopupEle();e&&x([i,n],e.split(" ")),t&&w([i,n],t.split(" "))},e.prototype.changeRtlProps=function(t){t?w([this.getWrapper()],"e-rtl"):x([this.getWrapper()],"e-rtl")},e.prototype.changePaletteProps=function(){L(this.container.children[0]),this.container.style.width="",this.createPalette()},e.prototype.onPropertyChanged=function(t,e){var i=this,n=this.getWrapper();if(!this.inline&&h(t.inline)){var o=["disabled","enableRtl"];if(this.splitBtn.setProperties(Ks(t,o)),!this.isPopupOpen())return t.value&&(O(".e-split-preview",this.splitBtn.element).style.backgroundColor=t.value),this.changeCssClassProps(t.cssClass,e.cssClass),void this.changeRtlProps(t.enableRtl)}for(var r=0,s=Object.keys(t);r<s.length;r++)switch(s[r]){case"inline":t.inline?(this.getWrapper().appendChild(this.container),this.splitBtn.destroy(),L(this.element.nextElementSibling),this.container.children.length||this.createWidget()):(this.destroyOtherComp(),this.unWireEvents(),this.container.innerHTML="",this.createSplitBtn());break;case"cssClass":this.isPicker()?(n.classList.contains("e-hide-value")&&(this.createInput(),this.addvalueEventHandler()),t.cssClass.split(" ").forEach(function(t){"e-hide-value"===t&&T(O("."+Ug,i.container))})):(n.classList.contains("e-show-value")&&T(O("."+Ug,this.container)),t.cssClass.split(" ").forEach(function(t){"e-show-value"===t&&(i.createInput(1),i.addInputEvent())})),this.changeCssClassProps(t.cssClass,e.cssClass);break;case"enableRtl":this.isPicker()&&(this.hueSlider.enableRtl=t.enableRtl,this.opacitySlider.enableRtl=t.enableRtl,this.setInputEleProps(t.enableRtl)),this.changeRtlProps(t.enableRtl);break;case"disabled":this.changeDisabledProp(t.disabled);break;case"value":this.changeValueProp(t.value);break;case"showButtons":this.changeShowBtnProps(t.showButtons);break;case"mode":"Picker"===t.mode?this.switchToPicker():this.switchToPalette();break;case"modeSwitcher":this.changeModeSwitcherProp(t.modeSwitcher);break;case"columns":case"presetColors":this.isPicker()||this.changePaletteProps();break;case"noColor":t.noColor?"Palette"!==this.mode||this.modeSwitcher||this.setNoColor():this.changePaletteProps()}},jg([Y("#008000")],e.prototype,"value",void 0),jg([Y("")],e.prototype,"cssClass",void 0),jg([Y(!1)],e.prototype,"disabled",void 0),jg([Y(!1)],e.prototype,"enableRtl",void 0),jg([Y("Picker")],e.prototype,"mode",void 0),jg([Y(!0)],e.prototype,"modeSwitcher",void 0),jg([Y(null)],e.prototype,"presetColors",void 0),jg([Y(!0)],e.prototype,"showButtons",void 0),jg([Y(10)],e.prototype,"columns",void 0),jg([Y(!1)],e.prototype,"inline",void 0),jg([Y(!1)],e.prototype,"noColor",void 0),jg([Y(!1)],e.prototype,"enablePersistence",void 0),jg([J()],e.prototype,"select",void 0),jg([J()],e.prototype,"change",void 0),jg([J()],e.prototype,"beforeTileRender",void 0),jg([J()],e.prototype,"beforeOpen",void 0),jg([J()],e.prototype,"open",void 0),jg([J()],e.prototype,"beforeClose",void 0),jg([J()],e.prototype,"beforeModeSwitch",void 0),e=jg([$],e)}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),$g=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},tm="e-treeview",em="e-icon-collapsible",im="e-icon-expandable",nm="e-list-item",om="e-list-text",rm="e-list-parent",sm="e-hover",am="e-active",lm="e-icons-spinner",hm="e-process",cm="e-icons",dm="e-text-content",pm="e-sibling",um="e-drop-next",gm="e-check",mm="e-checkbox-wrapper",fm="e-node-focus",vm={treeRole:"tree",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},ym=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jg(e,t),$g([Y("child")],e.prototype,"child",void 0),$g([Y([])],e.prototype,"dataSource",void 0),$g([Y("expanded")],e.prototype,"expanded",void 0),$g([Y("hasChildren")],e.prototype,"hasChildren",void 0),$g([Y("htmlAttributes")],e.prototype,"htmlAttributes",void 0),$g([Y("iconCss")],e.prototype,"iconCss",void 0),$g([Y("id")],e.prototype,"id",void 0),$g([Y("imageUrl")],e.prototype,"imageUrl",void 0),$g([Y("isChecked")],e.prototype,"isChecked",void 0),$g([Y("parentID")],e.prototype,"parentID",void 0),$g([Y(null)],e.prototype,"query",void 0),$g([Y("selected")],e.prototype,"selected",void 0),$g([Y(null)],e.prototype,"tableName",void 0),$g([Y("text")],e.prototype,"text",void 0),$g([Y("tooltip")],e.prototype,"tooltip",void 0),$g([Y("navigateUrl")],e.prototype,"navigateUrl",void 0),e}(xa),bm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jg(e,t),$g([Y("SlideDown")],e.prototype,"effect",void 0),$g([Y(400)],e.prototype,"duration",void 0),$g([Y("linear")],e.prototype,"easing",void 0),e}(xa),wm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jg(e,t),$g([G({effect:"SlideUp",duration:400,easing:"linear"},bm)],e.prototype,"collapse",void 0),$g([G({effect:"SlideDown",duration:400,easing:"linear"},bm)],e.prototype,"expand",void 0),e}(xa),xm=(function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mouseDownStatus=!1,n}return Jg(e,t),i=e,e.prototype.getModuleName=function(){return"treeview"},e.prototype.preRender=function(){var t=this;this.checkActionNodes=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:im,ariaAttributes:vm,expandIconPosition:"Left",itemCreated:function(e){t.beforeNodeCreate(e)}},this.updateListProp(this.fields),this.aniObj=new ya({}),this.treeList=[],this.isLoaded=!1,this.setTouchClass(),h(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),h(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0)},e.prototype.getPersistData=function(){var t=["selectedNodes","checkedNodes"];return this.addOnPersist(t)},e.prototype.render=function(){this.isAnimate=!0,this.initialize(),this.setDataBinding(),this.setExpandOnType(),this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.wireEvents()},e.prototype.initialize=function(){this.element.setAttribute("role","tree"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},e.prototype.setEnableRtl=function(){this.enableRtl?w([this.element],"e-rtl"):x([this.element],"e-rtl")},e.prototype.setRipple=function(){var t={selector:".e-fullrow,.e-text-content",ignore:".e-text-content > .e-icons,.e-input-group,.e-input, ."+mm};this.rippleFn=it(this.element,t);var e={selector:"."+dm+" > ."+cm,isCenterRipple:!0};this.rippleIconFn=it(this.element,e)},e.prototype.setFullRow=function(t){t?w([this.element],"e-fullrow-wrap"):x([this.element],"e-fullrow-wrap")},e.prototype.setMultiSelect=function(t){var e=O("."+rm,this.element);t?e.setAttribute("aria-multiselectable","true"):e.removeAttribute("aria-multiselectable")},e.prototype.templateComplier=function(t){if(t)try{if(document.querySelectorAll(t).length)return pt(document.querySelector(t).innerHTML.trim())}catch(e){return pt(t)}},e.prototype.setDataBinding=function(){var t=this;this.treeList.push("false"),this.fields.dataSource instanceof jp?this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(e){t.treeList.pop(),t.treeData=e.result,t.isNumberTypeId=t.getType(),t.setRootData(),t.renderItems(!0),0!==t.treeList.length||t.isLoaded||t.finalize()}):(this.treeList.pop(),h(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=this.fields.dataSource,this.setRootData()),this.renderItems(!1)),0!==this.treeList.length||this.isLoaded||this.finalize()},e.prototype.getQuery=function(t,e){void 0===e&&(e=null);var i,n=[];if(t.query)i=t.query.clone();else{i=new kp;for(var o=this.getActualProperties(t),r=0,s=Object.keys(o);r<s.length;r++){var a=s[r];"dataSource"!==a&&"tableName"!==a&&"child"!==a&&t[a]&&-1===n.indexOf(t[a])&&n.push(t[a])}i.select(n),o.hasOwnProperty("tableName")&&i.from(t.tableName)}return _l.addSorting(this.sortOrder,t.text,i),h(e)||h(t.parentID)||i.where(t.parentID,"equal",this.isNumberTypeId?parseFloat(e):e),i},e.prototype.getType=function(){return!!this.treeData[0]&&"number"==typeof n(this.fields.id,this.treeData[0])},e.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),1===this.dataType){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var t=this.getChildNodes(this.treeData,void 0,!0);h(t)?this.rootData=[]:this.rootData=t}else this.rootData=this.treeData},e.prototype.renderItems=function(t){this.listBaseOption.ariaAttributes.level=1,this.ulElement=_l.createList(this.createElement,t?this.rootData:this.getSortedData(this.rootData),this.listBaseOption),this.element.appendChild(this.ulElement),this.finalizeNode(this.element)},e.prototype.beforeNodeCreate=function(t){if(this.showCheckBox){var e=ke(!0,{cssClass:this.touchClass}),i=O("div.e-icons",t.item),o=t.item.getAttribute("data-uid");t.item.childNodes[0].insertBefore(e,t.item.childNodes[0].childNodes[h(i)?0:1]);var r=n(t.fields.isChecked,t.curData);this.checkedNodes.indexOf(o)>-1?(O(".e-frame",e).classList.add(gm),e.setAttribute("aria-checked","true"),this.addCheck(t.item)):h(r)||"true"!==r.toString()?e.setAttribute("aria-checked","false"):(O(".e-frame",e).classList.add(gm),e.setAttribute("aria-checked","true"),this.addCheck(t.item));var s=O(".e-frame",e);ha.add(s,"mousedown",this.frameMouseHandler,this),ha.add(s,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(t.item),this.allowMultiSelection&&!t.item.classList.contains("e-selected")&&t.item.setAttribute("aria-selected","false");var a=t.fields;if(this.addActionClass(t,a.selected,"e-selected"),this.addActionClass(t,a.expanded,"e-expanded"),!h(this.nodeTemplateFn)){var l=t.item.querySelector("."+om);l.innerHTML="",P(this.nodeTemplateFn(t.curData),l)}var c={node:t.item,nodeData:t.curData,text:t.text};this.trigger("drawNode",c)},e.prototype.frameMouseHandler=function(t){Oe(t,O(".e-ripple-container",t.target.parentElement))},e.prototype.addActionClass=function(t,e,i){var o=n(e,t.curData);h(o)||"false"===o.toString()||t.item.classList.add(i)},e.prototype.getDataType=function(t,e){if(this.fields.dataSource instanceof jp){for(i=0;i<t.length;i++)if("string"==typeof e.child&&h(n(e.child,t[i])))return 1;return 2}for(var i=0,o=t.length;i<o;i++){if("string"==typeof e.child&&!h(n(e.child,t[i])))return 2;if(!h(n(e.parentID,t[i]))||!h(n(e.hasChildren,t[i])))return 1}return 1},e.prototype.getGroupedData=function(t,e){for(var i=(new kp).group(e),n=_l.getDataSource(t,i),o=[],r=0;r<n.length;r++){var s=n[r].items;o.push(s)}return o},e.prototype.getSortedData=function(t){return t&&"None"!==this.sortOrder&&(t=_l.getDataSource(t,_l.addSorting(this.sortOrder,this.fields.text))),t},e.prototype.finalizeNode=function(t){for(var e=A(".e-list-img",t),i=0;i<e.length;i++)e[i].setAttribute("alt","e-list-img");if(this.isLoaded){for(var n=A(".e-selected",t),o=0;o<n.length;o++){this.selectNode(n[o],null);break}x(n,"e-selected")}for(var r=A(".e-list-item:not(.e-expanded)",t),s=0;s<r.length;s++){var a=O("div.e-icons",r[s]);a&&a.classList.contains(im)&&(r[s].setAttribute("aria-expanded","false"),w([r[s]],"e-node-collapsed"))}for(var l=A(".e-expanded",t),o=0;o<l.length;o++)this.renderChildNodes(l[o]);x(l,"e-expanded"),this.updateList(),this.isLoaded&&this.updateCheckedProp()},e.prototype.updateCheckedProp=function(){var t=this;if(this.showCheckBox){var e=[].concat([],this.checkedNodes);this.checkedNodes.forEach(function(i,n){h(t.element.querySelector('[data-uid="'+i+'"]'))&&(e=e.filter(function(t){return t!==i}))}),this.setProperties({checkedNodes:e},!0)}},e.prototype.ensureParentCheckState=function(t){if(!h(t)){if(t.classList.contains(tm))return;var e=t;t.classList.contains(nm)&&(e=O("."+rm,t));var i=A(".e-check",e),n=A("."+nm,e),o=t.getElementsByClassName(mm)[0];n.length===i.length?this.changeState(o,"check",null,!0,!0):i.length>0?this.changeState(o,"indeterminate",null,!0,!0):0===i.length&&this.changeState(o,"uncheck",null,!0,!0);var r=M(t,"."+rm);if(!h(r)){var s=M(r,"."+nm);this.ensureParentCheckState(s)}}},e.prototype.ensureChildCheckState=function(t,e){if(!h(t)){var i=O("."+rm,t),o=void 0;if(!h(i)){o=A("."+mm,i);for(var r=t.getElementsByClassName("e-frame")[0].classList.contains(gm),s=void 0,a=0;a<o.length;a++){if(h(this.currentLoadData)||h(n(this.fields.isChecked,this.currentLoadData[a]))){var l=o[a].getElementsByClassName("e-frame")[0].classList.contains(gm);s=!this.isLoaded&&l?"check":r?"check":"uncheck"}else s=n(this.fields.isChecked,this.currentLoadData[a])?"check":"uncheck";this.changeState(o[a],s,e,!0,!0)}}}},e.prototype.doCheckBoxAction=function(t,e){if(h(t))for(var i=A("."+mm,this.element),n=0;n<i.length;n++)this.changeState(i[n],e?"check":"uncheck");else for(var o=0,r=t.length;o<r;o++){var s=this.getElement(t[o]);if(!h(s)){var a=O(".e-list-parent ."+mm,s);this.validateCheckNode(a,!e,s,null)}}},e.prototype.changeState=function(t,e,i,n,o){var r,s,a=M(t,"."+nm);if(n||(this.checkActionNodes=[],s=this.getCheckEvent(a,e,i),this.trigger("nodeChecking",s),!s.cancel)){var l=t.getElementsByClassName("e-frame")[0];if("check"!==e||l.classList.contains(gm)?"uncheck"===e&&(l.classList.contains(gm)||l.classList.contains("e-stop"))?(x([l],[gm,"e-stop"]),this.removeCheck(a),r="false"):"indeterminate"!==e||l.classList.contains("e-stop")||(l.classList.remove(gm),l.classList.add("e-stop"),this.removeCheck(a),r="mixed"):(l.classList.remove("e-stop"),l.classList.add(gm),this.addCheck(a),r="true"),r="check"===e?"true":"uncheck"===e?"false":r,h(r)||t.setAttribute("aria-checked",r),o){var d=[].concat([],this.checkActionNodes);s=this.getCheckEvent(a,e,i),c(n)&&(s.data=d)}n||h(r)||(t.setAttribute("aria-checked",r),s.data[0].checked=r,this.trigger("nodeChecked",s),this.checkActionNodes=[])}},e.prototype.addCheck=function(t){var e=t.getAttribute("data-uid");h(e)||-1!==this.checkedNodes.indexOf(e)||this.checkedNodes.push(e)},e.prototype.removeCheck=function(t){var e=this.checkedNodes.indexOf(t.getAttribute("data-uid"));e>-1&&this.checkedNodes.splice(e,1)},e.prototype.getCheckEvent=function(t,e,i){this.checkActionNodes.push(this.getNodeData(t));var n=this.checkActionNodes;return{action:e,cancel:!1,isInteracted:!h(i),node:t,data:n}},e.prototype.finalize=function(){O("."+rm,this.element).setAttribute("role",vm.treeRole),this.setMultiSelect(this.allowMultiSelection);var t=O("."+nm,this.element);t&&(w([t],fm),this.updateIdAttr(null,t)),this.doSelectionAction(),this.updateCheckedProp(),this.isLoaded=!0,this.isAnimate=!1;var e={data:this.treeData};this.trigger("dataBound",e)},e.prototype.doSelectionAction=function(){var t=A(".e-selected",this.element),e=this.selectedNodes;if(e.length>0){this.setProperties({selectedNodes:[]},!0);for(var i=0;i<e.length;i++){var n=O('[data-uid="'+e[i]+'"]',this.element);if(this.selectNode(n,null,!0),!this.allowMultiSelection)break}}else this.selectGivenNodes(t);x(t,"e-selected")},e.prototype.selectGivenNodes=function(t){for(var e=0;e<t.length&&(t[e].classList.contains("e-disable")||this.selectNode(t[e],null,!0),this.allowMultiSelection);e++);},e.prototype.clickHandler=function(t){var e=t.originalEvent.target;if(ha.remove(this.element,"contextmenu",this.preventContextMenu),e&&!this.dragStartAction){var i=e.classList,n=M(e,"."+nm);if(n){if(this.removeHover(),this.setFocusElement(n),this.showCheckBox&&!n.classList.contains("e-disable")){var o=M(e,"."+mm);if(!h(o)){var r=O(".e-frame",o);return this.validateCheckNode(o,r.classList.contains(gm),n,t.originalEvent),void this.triggerClickEvent(t.originalEvent,n)}}i.contains(im)?this.expandAction(n,e,t):i.contains(em)?this.collapseNode(n,e,t):i.contains(rm)||i.contains(nm)||this.toggleSelect(n,t.originalEvent,!1),this.triggerClickEvent(t.originalEvent,n)}}},e.prototype.nodeCheckingEvent=function(t,e,i){var n=M(t,"."+nm);this.checkActionNodes=[];var o=e?"false":"true";h(o)||t.setAttribute("aria-checked",o);var r=this.getCheckEvent(n,e?"uncheck":"check",i);return this.trigger("nodeChecking",r),r},e.prototype.nodeCheckedEvent=function(t,e,i){M(t,"."+nm);var n=this.getCheckEvent(t,e?"uncheck":"check",i);n.data=n.data.splice(0,n.data.length-1),this.trigger("nodeChecked",n)},e.prototype.triggerClickEvent=function(t,e){var i={event:t,node:e};this.trigger("nodeClicked",i)},e.prototype.expandNode=function(t,e){var i=this;e.classList.contains(lm)&&this.hideSpinner(e),x([e],im),w([e],em);var n=0,o=0,r=this,s=O("."+rm,t),a=t;this.setHeight(a,s),this.isAnimate?this.expandedNode(a,s,e):this.aniObj.animate(s,{name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(e){a.style.overflow="hidden",n=a.offsetHeight,o=O("."+dm,t).offsetHeight},progress:function(t){t.element.style.display="block",r.animateHeight(t,n,o)},end:function(t){t.element.style.display="block",i.expandedNode(a,s,e)}})},e.prototype.expandedNode=function(t,e,i){e.style.display="block",t.style.display="block",t.style.overflow="",t.style.height="",x([i],hm),t.setAttribute("aria-expanded","true"),x([t],"e-node-collapsed"),this.isLoaded&&this.expandArgs&&(this.expandArgs=this.getExpandEvent(t,null),this.trigger("nodeExpanded",this.expandArgs))},e.prototype.collapseNode=function(t,e,i){var n=this;if(!e.classList.contains(hm)){w([e],hm);var o;if(this.isLoaded&&(o=this.getExpandEvent(t,i),this.trigger("nodeCollapsing",o),o.cancel))return void x([e],hm);x([e],em),w([e],im);var r=0,s=0,a=this,l=O("."+rm,t),h=t;w([t],"e-node-collapsed"),this.aniObj.animate(l,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(e){h.style.overflow="hidden",r=O("."+dm,t).offsetHeight,s=h.offsetHeight},progress:function(t){a.animateHeight(t,r,s)},end:function(i){h.style.overflow="",i.element.style.display="none",h.style.height="",x([e],hm),t.setAttribute("aria-expanded","false"),n.isLoaded&&n.trigger("nodeCollapsed",o)}})}},e.prototype.setHeight=function(t,e){e.style.display="block",e.style.visibility="hidden",t.style.height=t.offsetHeight+"px",e.style.display="none",e.style.visibility=""},e.prototype.animateHeight=function(t,e,i){var n=(i-e)*((t.duration-t.timeStamp)/t.duration)+e;t.element.parentElement.style.height=n+"px"},e.prototype.renderChildNodes=function(t,e){var i=this,n=O("div.e-icons",t);if(!h(n)){this.showSpinner(n);var r;if(this.fields.dataSource instanceof jp){var s=this.parents(t,"."+rm).length,a=this.getChildFields(this.fields,s,1);if(h(a)||h(a.dataSource))return L(n),void t.removeAttribute("aria-expanded");this.treeList.push("false"),a.dataSource.executeQuery(this.getQuery(a,t.getAttribute("data-uid"))).then(function(s){if(i.treeList.pop(),r=s.result,i.currentLoadData=r,h(r)||0===r.length)L(n),t.removeAttribute("aria-expanded");else{i.updateListProp(a);var l=t.getAttribute("data-uid"),c=i.getNodeObject(l);o("child",r,c),i.listBaseOption.ariaAttributes.level=parseFloat(t.getAttribute("aria-level"))+1,t.appendChild(_l.createList(i.createElement,r,i.listBaseOption)),i.expandNode(t,n),i.ensureCheckNode(t),i.finalizeNode(t),i.renderSubChild(t,e)}0!==i.treeList.length||i.isLoaded||i.finalize()})}else{if(r=this.getChildNodes(this.treeData,t.getAttribute("data-uid")),this.currentLoadData=r,h(r)||0===r.length)return L(n),void t.removeAttribute("aria-expanded");this.listBaseOption.ariaAttributes.level=parseFloat(t.getAttribute("aria-level"))+1,t.appendChild(_l.createList(this.createElement,this.getSortedData(r),this.listBaseOption)),this.expandNode(t,n),this.ensureCheckNode(t),this.finalizeNode(t),this.renderSubChild(t,e)}}},e.prototype.ensureCheckNode=function(t){this.showCheckBox&&(this.ensureChildCheckState(t),this.ensureParentCheckState(t)),this.currentLoadData=null},e.prototype.getFields=function(t,e,i){return e===i?t:this.getFields(this.getChildMapper(t),e,i+1)},e.prototype.getChildFields=function(t,e,i){return e===i?this.getChildMapper(t):this.getChildFields(this.getChildMapper(t),e,i+1)},e.prototype.getChildMapper=function(t){return"string"==typeof t.child||h(t.child)?t:t.child},e.prototype.getChildNodes=function(t,e,i){void 0===i&&(i=!1);var o;if(h(t))return o;if(1===this.dataType)return this.getChildGroup(this.groupedData,e,i);if("string"==typeof this.fields.child)for(var r=0,s=t.length;r<s;r++){var a=n(this.fields.id,t[r]);if(a&&a.toString()===e)return n(this.fields.child,t[r]);if(!h(n(this.fields.child,t[r]))&&void 0!==(o=this.getChildNodes(n(this.fields.child,t[r]),e)))break}return o},e.prototype.getChildGroup=function(t,e,i){if(!h(t))for(var o=0,r=t.length;o<r;o++){if(h(t[o][0])||h(n(this.fields.parentID,t[o][0])))return i?t[o]:[];if(n(this.fields.parentID,t[o][0]).toString()===e)return t[o]}},e.prototype.renderSubChild=function(t,e){if(e)for(var i=A("."+im,t),n=0,o=i.length;n<o;n++){var r=M(i[n],"."+nm);this.expandArgs=this.getExpandEvent(r,null),this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(r,e)}},e.prototype.toggleSelect=function(t,e,i){t.classList.contains("e-disable")||(this.allowMultiSelection&&(e&&e.ctrlKey||i)&&this.isActive(t)?this.unselectNode(t,e):this.selectNode(t,e,i))},e.prototype.isActive=function(t){return!!t.classList.contains(am)},e.prototype.selectNode=function(t,e,i){if(h(t)||!this.allowMultiSelection&&this.isActive(t)&&!h(e))return void this.setFocusElement(t);var n;if(!this.isLoaded||(n=this.getSelectEvent(t,"select",e),this.trigger("nodeSelecting",n),!n.cancel)){if(this.allowMultiSelection&&(i||e&&(!e||e.ctrlKey))||this.removeSelectAll(),this.allowMultiSelection&&e&&e.shiftKey){this.startNode||(this.startNode=t);var o=this.liList.indexOf(this.startNode),r=this.liList.indexOf(t);if(o>r){var s=o;o=r,r=s}for(var a=o;a<=r;a++){var l=this.liList[a];S(l)&&!l.classList.contains("e-disable")&&this.addSelect(l)}}else this.startNode=t,this.addSelect(t);this.setFocusElement(t),this.isLoaded&&this.trigger("nodeSelected",n)}},e.prototype.unselectNode=function(t,e){var i;this.isLoaded&&(i=this.getSelectEvent(t,"un-select",e),this.trigger("nodeSelecting",i),i.cancel)||(this.removeSelect(t),this.setFocusElement(t),this.isLoaded&&this.trigger("nodeSelected",i))},e.prototype.setFocusElement=function(t){if(!h(t)){var e=this.getFocusedNode();e&&x([e],fm),w([t],fm),this.updateIdAttr(e,t)}},e.prototype.addSelect=function(t){t.setAttribute("aria-selected","true"),w([t],am);var e=t.getAttribute("data-uid");h(e)||-1!==this.selectedNodes.indexOf(e)||this.selectedNodes.push(e)},e.prototype.removeSelect=function(t){this.allowMultiSelection?t.setAttribute("aria-selected","false"):t.removeAttribute("aria-selected"),x([t],am);var e=this.selectedNodes.indexOf(t.getAttribute("data-uid"));e>-1&&this.selectedNodes.splice(e,1)},e.prototype.removeSelectAll=function(){for(var t=this.element.querySelectorAll(".e-active"),e=0,i=t;e<i.length;e++){var n=i[e];this.allowMultiSelection?n.setAttribute("aria-selected","false"):n.removeAttribute("aria-selected")}x(t,am),this.setProperties({selectedNodes:[]},!0)},e.prototype.getSelectEvent=function(t,e,i){var n=this.getNodeData(t);return{action:e,cancel:!1,isInteracted:!h(i),node:t,nodeData:n}},e.prototype.setExpandOnType=function(){this.expandOnType="Auto"===this.expandOn?ma.isDevice?"Click":"DblClick":this.expandOn},e.prototype.expandHandler=function(t){var e=t.originalEvent.target;!e||e.classList.contains("e-input")||e.classList.contains(tm)||e.classList.contains(rm)||e.classList.contains(nm)||e.classList.contains(cm)||this.showCheckBox&&M(e,"."+mm)||this.expandCollapseAction(M(e,"."+nm),t)},e.prototype.expandCollapseAction=function(t,e){var i=O("div.e-icons",t);i&&!i.classList.contains(hm)&&(i.classList.contains(im)?this.expandAction(t,i,e):this.collapseNode(t,i,e))},e.prototype.expandAction=function(t,e,i,n){if(!e.classList.contains(hm)){if(w([e],hm),this.isLoaded&&(this.expandArgs=this.getExpandEvent(t,i),this.trigger("nodeExpanding",this.expandArgs),this.expandArgs.cancel))return void x([e],hm);var o=O("."+rm,t);o&&"UL"===o.nodeName?this.expandNode(t,e):this.renderChildNodes(t,n)}},e.prototype.keyActionHandler=function(t){var e=t.target,i=this.getFocusedNode();if(e&&e.classList.contains("e-input")){var n=e;return void("enter"===t.action?(n.blur(),this.element.focus(),w([i],sm)):"escape"===t.action&&(n.value=this.oldText,n.blur(),this.element.focus(),w([i],sm)))}t.preventDefault();var o={cancel:!1,event:t,node:i};if(this.trigger("keyPress",o),!o.cancel)switch(t.action){case"space":this.showCheckBox&&this.checkNode(t);break;case"moveRight":this.openNode(!this.enableRtl,t);break;case"moveLeft":this.openNode(!!this.enableRtl,t);break;case"shiftDown":this.shiftKeySelect(!0,t);break;case"moveDown":case"ctrlDown":case"csDown":this.navigateNode(!0);break;case"shiftUp":this.shiftKeySelect(!1,t);break;case"moveUp":case"ctrlUp":case"csUp":this.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":this.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":this.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":this.toggleSelect(i,t);break;case"f2":this.allowEditing&&!i.classList.contains("e-disable")&&this.createTextbox(i,t);break;case"ctrlA":if(this.allowMultiSelection){var r=A(".e-list-item:not(.e-active)",this.element);this.selectGivenNodes(r)}}},e.prototype.navigateToFocus=function(t){var e=this.getFocusedNode().querySelector("."+dm),i=e.getBoundingClientRect(),n=this.getScrollParent(this.element);if(!h(n)){var o=n.getBoundingClientRect();i.bottom>o.bottom?n.scrollTop+=i.bottom-o.bottom:i.top<o.top&&(n.scrollTop-=o.top-i.top)}this.isVisibleInViewport(e)||e.scrollIntoView(t)},e.prototype.isVisibleInViewport=function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},e.prototype.getScrollParent=function(t){return h(t)?null:t.scrollHeight>t.clientHeight?t:this.getScrollParent(t.parentElement)},e.prototype.shiftKeySelect=function(t,e){if(this.allowMultiSelection){var i=this.getFocusedNode(),n=t?this.getNextNode(i):this.getPrevNode(i);this.removeHover(),this.setFocusElement(n),this.toggleSelect(n,e,!1),this.navigateToFocus(!t)}else this.navigateNode(t)},e.prototype.checkNode=function(t){var e=this.getFocusedNode(),i=O("."+mm,e),n=O(" .e-frame",i).classList.contains(gm);e.classList.contains("e-disable")||this.validateCheckNode(i,n,e,t)},e.prototype.validateCheckNode=function(t,e,i,n){this.nodeCheckingEvent(t,e,n).cancel||(this.changeState(t,e?"uncheck":"check",n,!0),this.ensureChildCheckState(i),this.ensureParentCheckState(M(M(i,"."+rm),"."+nm)),this.nodeCheckedEvent(t,e,n))},e.prototype.openNode=function(t,e){var i=this.getFocusedNode(),n=O("div.e-icons",i);if(t){if(!n)return;n.classList.contains(im)?this.expandAction(i,n,e):this.focusNextNode(i,!0)}else if(n&&n.classList.contains(em))this.collapseNode(i,n,e);else{var o=M(M(i,"."+rm),"."+nm);if(!o)return;o.classList.contains("e-disable")||(this.setFocus(i,o),this.navigateToFocus(!0))}},e.prototype.navigateNode=function(t){var e=this.getFocusedNode();this.focusNextNode(e,t)},e.prototype.navigateRootNode=function(t){var e=this.getFocusedNode(),i=t?this.getRootNode():this.getEndNode();i.classList.contains("e-disable")||(this.setFocus(e,i),this.navigateToFocus(t))},e.prototype.getFocusedNode=function(){var t=O(".e-list-item."+fm,this.element);return h(t)?O("."+nm,this.element):t},e.prototype.focusNextNode=function(t,e){var i=e?this.getNextNode(t):this.getPrevNode(t);if(this.setFocus(t,i),this.navigateToFocus(!e),i.classList.contains("e-disable")){var n=i.lastChild;null==i.previousSibling&&i.classList.contains("e-level-1")?this.focusNextNode(i,!0):null==i.nextSibling&&i.classList.contains("e-node-collapsed")?this.focusNextNode(i,!1):null==i.nextSibling&&n.classList.contains("e-text-content")?this.focusNextNode(i,!1):this.focusNextNode(i,e)}},e.prototype.getNextNode=function(t){var e,i=this.liList.indexOf(t);do{if(i++,e=this.liList[i],h(e))return t}while(!S(e));return e},e.prototype.getPrevNode=function(t){var e,i=this.liList.indexOf(t);do{if(i--,e=this.liList[i],h(e))return t}while(!S(e));return e},e.prototype.getRootNode=function(){var t,e=0;do{t=this.liList[e],e++}while(!S(t));return t},e.prototype.getEndNode=function(){var t,e=this.liList.length-1;do{t=this.liList[e],e--}while(!S(t));return t},e.prototype.setFocus=function(t,e){x([t],[sm,fm]),e.classList.contains("e-disable")||(w([e],[sm,fm]),this.updateIdAttr(t,e))},e.prototype.updateIdAttr=function(t,e){this.element.removeAttribute("aria-activedescendant"),t&&t.removeAttribute("id"),e.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},e.prototype.focusIn=function(){this.mouseDownStatus||w([this.getFocusedNode()],sm),this.mouseDownStatus=!1},e.prototype.focusOut=function(){x([this.getFocusedNode()],sm)},e.prototype.onMouseOver=function(t){var e=t.target,i=e.classList,n=M(e,"."+nm);if(!n||i.contains(rm)||i.contains(nm))return void this.removeHover();n&&!n.classList.contains("e-disable")&&this.setHover(n)},e.prototype.setHover=function(t){t.classList.contains(sm)||(this.removeHover(),w([t],sm))},e.prototype.onMouseLeave=function(t){this.removeHover()},e.prototype.removeHover=function(){var t=A("."+sm,this.element);t&&t.length&&x(t,sm)},e.prototype.getNodeData=function(t,e){if(!h(t)&&t.classList.contains(nm)&&M(t,".e-control").classList.contains(tm)){var i=t.getAttribute("data-uid"),n=this.getText(t,e),o=M(t.parentNode,"."+nm),r=o?o.getAttribute("data-uid"):null,s=t.classList.contains(am),a="true"===t.getAttribute("aria-expanded"),l=null;return this.showCheckBox&&(l=O("."+mm,t).getAttribute("aria-checked")),{id:i,text:n,parentID:r,selected:s,expanded:a,isChecked:l}}return{id:"",text:"",parentID:"",selected:"",expanded:"",isChecked:""}},e.prototype.getText=function(t,e){if(e){var i=this.getNodeObject(t.getAttribute("data-uid")),o=parseFloat(t.getAttribute("aria-level"));return n(this.getFields(this.fields,o,1).text,i)}return O("."+om,t).textContent},e.prototype.getExpandEvent=function(t,e){var i=this.getNodeData(t);return{cancel:!1,isInteracted:!h(e),node:t,nodeData:i,event:e}},e.prototype.reRenderNodes=function(){this.element.innerHTML="",this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[]},!0),this.isLoaded=!1,this.setDataBinding()},e.prototype.setCssClass=function(t,e){h(t)||""===t||x([this.element],t.split(" ")),h(e)||""===e||w([this.element],e.split(" "))},e.prototype.editingHandler=function(t){var e=t.target;if(!(!e||e.classList.contains(tm)||e.classList.contains(rm)||e.classList.contains(nm)||e.classList.contains(cm)||e.classList.contains("e-input")||e.classList.contains("e-input-group"))){var i=M(e,"."+nm);this.createTextbox(i,t)}},e.prototype.createTextbox=function(t,e){var i=O(".e-tree-input",this.element);i&&i.blur();var n=O("."+om,t);this.updateOldText(t);var o=this.createElement("input",{className:"e-tree-input",attrs:{value:this.oldText}}),r=this.getEditEvent(t,null,o.outerHTML);if(this.trigger("nodeEditing",r),!r.cancel){var s="width:"+(n.offsetWidth+5)+"px";w([t],"e-editing"),n.innerHTML=r.innerHtml;var a=O(".e-tree-input",n);this.inputObj=lu.createInput({element:a,properties:{enableRtl:this.enableRtl}}),this.inputObj.container.setAttribute("style",s),a.focus();var l=a;l.setSelectionRange(0,l.value.length),this.wireInputEvents(a)}},e.prototype.updateOldText=function(t){var e=t.getAttribute("data-uid");this.editData=this.getNodeObject(e);var i=parseFloat(t.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,i,1),this.oldText=n(this.editFields.text,this.editData)},e.prototype.inputFocusOut=function(t){if(O(".e-tree-input",this.element)){var e=t.target,i=e.value,n=M(e,"."+om),o=M(e,"."+nm);L(this.inputObj.container),this.appendNewText(o,n,i,!0)}},e.prototype.appendNewText=function(t,e,i,n){var r=this.getEditEvent(t,i,null);this.trigger("nodeEdited",r),i=r.cancel?r.oldText:r.newText;var s=o(this.editFields.text,i,this.editData);h(this.nodeTemplateFn)?e.innerHTML=i:(e.innerHTML="",P(this.nodeTemplateFn(s),e)),n&&(x([t],"e-editing"),e.focus())},e.prototype.getElement=function(t){return h(t)?null:"string"==typeof t?this.element.querySelector('[data-uid="'+t+'"]'):"object"==typeof t?t:null},e.prototype.getEditEvent=function(t,e,i){return{cancel:!1,newText:e,node:t,nodeData:this.getNodeData(t),oldText:this.oldText,innerHtml:i}},e.prototype.getNodeObject=function(t){if(!h(t)){if(1!==this.dataType)return this.getChildNodeObject(this.treeData,this.fields,t);for(var e=0,i=this.treeData.length;e<i;e++){var o=n(this.fields.id,this.treeData[e]);if(!h(this.treeData[e])&&!h(o)&&o.toString()===t)return this.treeData[e]}}},e.prototype.getChildNodeObject=function(t,e,i){var o;if(h(t))return o;for(var r=0,s=t.length;r<s;r++){var a=n(e.id,t[r]);if(t[r]&&a&&a.toString()===i)return t[r];if("string"!=typeof e.child||h(n(e.child,t[r]))){if(this.fields.dataSource instanceof jp&&!h(n("child",t[r]))){if(void 0!==(o=this.getChildNodeObject(n("child",t[r]),this.getChildMapper(e),i)))break}}else{var l=n(e.child,t[r]);if(void 0!==(o=this.getChildNodeObject(l,this.getChildMapper(e),i)))break}}return o},e.prototype.setDragAndDrop=function(t){t?this.initializeDrag():this.destroyDrag()},e.prototype.initializeDrag=function(){var t,e=this,i=this;this.dragObj=new el(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragTarget:"."+dm,helper:function(n){e.dragTarget=n.sender.target;var o=M(e.dragTarget,"."+tm),r=M(e.dragTarget,"."+dm);if(e.dragLi=M(e.dragTarget,"."+nm),e.fullRowSelect&&!r&&e.dragTarget.classList.contains("e-fullrow")&&(r=e.dragTarget.nextElementSibling),!e.dragTarget||!n.element.isSameNode(o)||!r||e.dragTarget.classList.contains(tm)||e.dragTarget.classList.contains(rm)||e.dragTarget.classList.contains(nm)||e.dragLi.classList.contains("e-disable"))return!1;var s=r.cloneNode(!0);if(h(O("div.e-icons",s))){var a=i.createElement("div",{className:"e-icons "+im});s.insertBefore(a,s.children[0])}var l="e-drag-item e-treeview "+e.cssClass+" "+(e.enableRtl?"e-rtl":"");(t=i.createElement("div",{className:l})).appendChild(s);var c=e.selectedNodes.length;if(c>1&&e.allowMultiSelection&&e.dragLi.classList.contains(am)){var d=i.createElement("span",{className:"e-drop-count",innerHTML:""+c});t.appendChild(d)}return document.body.appendChild(t),document.body.style.cursor="",e.dragData=e.getNodeData(e.dragLi),t},dragStart:function(i){w([e.element],"e-dragging");var n=e.getDragEvent(i.event,e,null,i.target);n.draggedNode.classList.contains("e-editing")?n.cancel=!0:e.trigger("nodeDragStart",n),n.cancel?(L(t),x([e.element],"e-dragging"),e.dragStartAction=!1):e.dragStartAction=!0},drag:function(i){e.dragObj.setProperties({cursorAt:{top:!h(i.event.targetTouches)||ma.isDevice?60:-20}}),e.dragAction(i,t)},dragStop:function(t){x([e.element],"e-dragging"),e.removeVirtualEle();var i=t.target,n=M(i,".e-droppable");i&&n&&!i.classList.contains(tm)||(L(t.helper),document.body.style.cursor="");var o=e.getDragEvent(t.event,e,i,i);e.trigger("nodeDragStop",o),o.cancel&&(t.helper.parentNode&&L(t.helper),document.body.style.cursor=""),e.dragStartAction=!1}}),this.dropObj=new ol(this.element,{out:function(t){h(t)||t.target.classList.contains(pm)||(document.body.style.cursor="not-allowed")},over:function(t){document.body.style.cursor=""},drop:function(t){e.dropAction(t)}})},e.prototype.dragAction=function(t,e){var i=M(t.target,".e-droppable"),n=M(t.target,"."+dm),o=O("div.e-icons",e);x([o],["e-drop-in",um,"e-drop-out","e-no-drop"]),this.removeVirtualEle(),document.body.style.cursor="";var r=t.target.classList;if(this.fullRowSelect&&!n&&!h(r)&&r.contains("e-fullrow")&&(n=t.target.nextElementSibling),i){var s=M(t.target,"."+nm);if(!i.classList.contains(tm)||n&&!s.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,s))if(s&&t&&t.event.offsetY<7){w([o],um);var a=this.createElement("div",{className:pm}),l=this.fullRowSelect?1:0;s.insertBefore(a,s.children[l])}else if(s&&t&&t.target.offsetHeight>0&&t.event.offsetY>t.target.offsetHeight-10){w([o],um);var a=this.createElement("div",{className:pm}),l=this.fullRowSelect?2:1;s.insertBefore(a,s.children[l])}else w([o],"e-drop-in");else"LI"!==t.target.nodeName||s.isSameNode(this.dragLi)||this.isDescendant(this.dragLi,s)?t.target.classList.contains(pm)?w([o],um):w([o],"e-drop-out"):(w([o],um),this.renderVirtualEle(t))}else w([o],"e-no-drop"),document.body.style.cursor="not-allowed";this.trigger("nodeDragging",this.getDragEvent(t.event,this,t.target,t.target))},e.prototype.dropAction=function(t){for(var e,n=t.event.offsetY,o=t.target,r=t.dragData.draggable,s=0;s<r.ej2_instances.length;s++)if(r.ej2_instances[s]instanceof i){e=r.ej2_instances[s];break}if(e&&e.dragTarget){var a=M(e.dragTarget,"."+nm),l=M(o,"."+nm);if(L(t.droppedElement),document.body.style.cursor="",!l||l.isSameNode(a)||this.isDescendant(a,l))return;if(e.allowMultiSelection&&(a.classList.contains(am)||n<7||t.target.offsetHeight>0&&n>t.target.offsetHeight-10))for(var h=A(".e-active",e.element),s=0;s<h.length;s++)l.isSameNode(h[s])||this.isDescendant(h[s],l)||this.appendNode(o,h[s],l,t,e,n);else this.appendNode(o,a,l,t,e,n)}this.trigger("nodeDropped",this.getDragEvent(t.event,e,o,t.target,t.dragData.draggedElement))},e.prototype.appendNode=function(t,e,i,n,o,r){e.classList.contains("e-disable")||i.classList.contains("e-disable")||("LI"===t.nodeName?this.dropAsSiblingNode(e,i,n,o):this.dropAsChildNode(e,i,o,null,n,r))},e.prototype.dropAsSiblingNode=function(t,e,i,n){var o,r=M(e,"."+rm),s=M(t,"."+rm),a=M(s,"."+nm);i.target.offsetHeight>0&&i.event.offsetY>i.target.offsetHeight-2?o=!1:i.event.offsetY<2&&(o=!0),r.insertBefore(t,o?i.target:i.target.nextElementSibling),this.updateElement(s,a),this.updateAriaLevel(t),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},e.prototype.dropAsChildNode=function(t,e,i,n,o,r){var s=M(t,"."+rm),a=M(s,"."+nm),l=M(e,"."+rm);if(o&&r<7)l.insertBefore(t,e);else if(o&&o.target.offsetHeight>0&&r>o.target.offsetHeight-10)l.insertBefore(t,e.nextElementSibling);else{var h=this.expandParent(e);h.insertBefore(t,h.childNodes[n])}this.updateElement(s,a),this.updateAriaLevel(t),i.element.id===this.element.id?this.updateList():(i.updateInstance(),this.updateInstance())},e.prototype.expandParent=function(t){var e=O("div.e-icons",t);e&&e.classList.contains(im)&&this.expandAction(t,e,null);var i=O("."+rm,t);return h(i)&&(this.trigger("nodeExpanding",this.getExpandEvent(t,null)),h(e)&&_l.generateIcon(this.createElement,t,em,this.listBaseOption),x([O("div.e-icons",t)],im),i=_l.generateUL(this.createElement,[],null,this.listBaseOption),t.appendChild(i),t.setAttribute("aria-expanded","true"),x([t],"e-node-collapsed"),this.trigger("nodeExpanded",this.getExpandEvent(t,null))),i},e.prototype.updateElement=function(t,e){if(e&&0===t.childElementCount){var i=O("div.e-icons",e);L(t),L(i),e.removeAttribute("aria-expanded")}},e.prototype.updateAriaLevel=function(t){var e=this.parents(t,"."+rm).length;t.setAttribute("aria-level",""+e),this.updateChildAriaLevel(O("."+rm,t),e+1)},e.prototype.updateChildAriaLevel=function(t,e){if(!h(t))for(var i=t.childNodes,n=0,o=i.length;n<o;n++){var r=i[n];r.setAttribute("aria-level",""+e),this.updateChildAriaLevel(O("."+rm,r),e+1)}},e.prototype.renderVirtualEle=function(t){var e;t.event.offsetY>t.target.offsetHeight-2?e=!1:t.event.offsetY<2&&(e=!0);var i=this.createElement("div",{className:pm}),n=this.fullRowSelect?e?1:2:e?0:1;t.target.insertBefore(i,t.target.children[n])},e.prototype.removeVirtualEle=function(){var t=O("."+pm);t&&L(t)},e.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},e.prototype.getDragEvent=function(t,e,i,n,o){var r=i?M(i,"."+nm):null,s=r?this.getNodeData(r):null,a=e?e.dragLi:o,l=e?e.dragData:null,h=i?this.parents(i,".e-list-item"):null,c=null;return i&&(c=0===h.length?null:i.classList.contains("e-list-item")?h[0]:h[1]),i&&M(i,".e-treeview")&&(t.offsetY<=5||n.offsetHeight<=32&&t.offsetY<n.offsetHeight-10&&(c=M(i,".e-list-item"))),{cancel:!1,event:t,draggedNode:a,draggedNodeData:l,droppedNode:r,droppedNodeData:s,target:n,dropTarget:c}},e.prototype.addFullRow=function(t){var e=this.liList.length;if(t)for(i=0;i<e;i++)this.createFullRow(this.liList[i]);else for(var i=0;i<e;i++)L(O(".e-fullrow",this.liList[i]))},e.prototype.createFullRow=function(t){var e=this.createElement("div",{className:"e-fullrow"});t.insertBefore(e,t.childNodes[0])},e.prototype.addMultiSelect=function(t){if(t)for(var e=0,i=n=A('.e-list-item:not([aria-selected="true"])',this.element);e<i.length;e++)(s=i[e]).setAttribute("aria-selected","false");else for(var n=A('.e-list-item[aria-selected="false"]',this.element),o=0,r=n;o<r.length;o++){var s=r[o];s.removeAttribute("aria-selected")}},e.prototype.collapseByLevel=function(t,e,i){if(e>0&&!h(t))for(var n=this.getVisibleNodes(i,t.childNodes),o=0,r=n.length;o<r;o++){var s=n[o],a=O("."+em,O("."+dm,s));h(a)||this.collapseNode(s,a,null),this.collapseByLevel(O("."+rm,s),e-1,i)}},e.prototype.collapseAllNodes=function(t){for(var e=this.getVisibleNodes(t,A("."+em,this.element)),i=0,n=e.length;i<n;i++){var o=e[i],r=M(o,"."+nm);this.collapseNode(r,o,null)}},e.prototype.expandByLevel=function(t,e,i){if(e>0&&!h(t))for(var n=this.getVisibleNodes(i,t.childNodes),o=0,r=n.length;o<r;o++){var s=n[o],a=O("."+im,O("."+dm,s));h(a)||this.expandAction(s,a,null),this.expandByLevel(O("."+rm,s),e-1,i)}},e.prototype.expandAllNodes=function(t){for(var e=this.getVisibleNodes(t,A("."+im,this.element)),i=0,n=e.length;i<n;i++){var o=e[i],r=M(o,"."+nm);this.expandAction(r,o,null,!0)}},e.prototype.getVisibleNodes=function(t,e){var i=Array.prototype.slice.call(e);if(t)for(var n=0;n<i.length;n++)S(i[n])||(i.splice(n,1),n--);return i},e.prototype.removeNode=function(t){var e=M(t,"."+rm),i=M(e,"."+nm);L(t),this.updateElement(e,i),this.updateInstance()},e.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes()},e.prototype.updateList=function(){this.liList=Array.prototype.slice.call(A("."+nm,this.element))},e.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var t=A(".e-active",this.element);this.selectGivenNodes(t)},e.prototype.doGivenAction=function(t,e,i){for(var n=0,o=t.length;n<o;n++){var r=this.getElement(t[n]);if(!h(r)){var s=O("."+e,O("."+dm,r));h(s)||(i?this.expandAction(r,s,null):this.collapseNode(r,s,null))}}},e.prototype.addGivenNodes=function(t,e,i,n){var o=e?parseFloat(e.getAttribute("aria-level"))+1:1;n&&this.updateMapper(o);for(var r=_l.createListItemFromJson(this.createElement,t,this.listBaseOption,o),s=e?this.expandParent(e):O("."+rm,this.element),a=s.childNodes[i],l=0;l<r.length;l++)s.insertBefore(r[l],a);this.finalizeNode(s)},e.prototype.updateMapper=function(t){var e=1===t?this.fields:this.getChildFields(this.fields,t-1,1);this.updateListProp(e)},e.prototype.updateListProp=function(t){var e=this.getActualProperties(t);this.listBaseOption.fields=e,this.listBaseOption.fields.url=e.hasOwnProperty("navigateUrl")?e.navigateUrl:"navigateUrl"},e.prototype.doDisableAction=function(t){for(var e=0,i=t.length;e<i;e++){var n=this.getElement(t[e]);h(n)||(n.setAttribute("aria-disabled","true"),w([n],"e-disable"))}},e.prototype.doEnableAction=function(t){for(var e=0,i=t.length;e<i;e++){var n=this.getElement(t[e]);h(n)||(n.removeAttribute("aria-disabled"),x([n],"e-disable"))}},e.prototype.setTouchClass=function(){var t=M(this.element,".e-bigger");this.touchClass=h(t)?"":"e-small"},e.prototype.wireInputEvents=function(t){ha.add(t,"blur",this.inputFocusOut,this)},e.prototype.wireEditingEvents=function(t){if(t){var e=this;this.touchEditObj=new gl(this.element,{tap:function(t){2===t.tapCount&&(t.originalEvent.preventDefault(),e.editingHandler(t.originalEvent))}})}else this.touchEditObj&&this.touchEditObj.destroy()},e.prototype.wireClickEvent=function(t){if(t){var e=this;this.touchClickObj=new gl(this.element,{tap:function(t){t.originalEvent.preventDefault(),e.clickHandler(t)}})}else this.touchClickObj&&this.touchClickObj.destroy()},e.prototype.wireExpandOnEvent=function(t){var e=this;if(t){var i=this;this.touchExpandObj=new gl(this.element,{tap:function(t){("Click"===e.expandOnType||"DblClick"===e.expandOnType&&2===t.tapCount)&&i.expandHandler(t)}})}else this.touchExpandObj&&this.touchExpandObj.destroy()},e.prototype.mouseDownHandler=function(t){this.mouseDownStatus=!0,(t.shiftKey||t.ctrlKey)&&t.preventDefault(),t.ctrlKey&&this.allowMultiSelection&&ha.add(this.element,"contextmenu",this.preventContextMenu,this)},e.prototype.preventContextMenu=function(t){t.preventDefault()},e.prototype.wireEvents=function(){ha.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.wireExpandOnEvent(!0),ha.add(this.element,"focus",this.focusIn,this),ha.add(this.element,"blur",this.focusOut,this),ha.add(this.element,"mouseover",this.onMouseOver,this),ha.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new ll(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},e.prototype.unWireEvents=function(){ha.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),ha.remove(this.element,"focus",this.focusIn),ha.remove(this.element,"blur",this.focusOut),ha.remove(this.element,"mouseover",this.onMouseOver),ha.remove(this.element,"mouseout",this.onMouseLeave),this.keyboardModule.destroy()},e.prototype.parents=function(t,e){for(var i=[],n=t.parentNode;!h(n);)R(n,e)&&i.push(n),n=n.parentNode;return i},e.prototype.isDescendant=function(t,e){for(var i=e.parentNode;!h(i);){if(i===t)return!0;i=i.parentNode}return!1},e.prototype.showSpinner=function(t){w([t],lm),Ae({target:t,width:ma.isDevice?16:14}),li(t)},e.prototype.hideSpinner=function(t){ci(t),t.innerHTML="",x([t],lm)},e.prototype.setCheckedNodes=function(t){t=JSON.parse(JSON.stringify(t)),this.uncheckAll(this.checkedNodes),t.length>0&&this.checkAll(t)},e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var o=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(o,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"checkedNodes":this.showCheckBox&&(this.checkedNodes=e.checkedNodes,this.setCheckedNodes(t.checkedNodes));break;case"cssClass":this.setCssClass(e.cssClass,t.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.wireExpandOnEvent(!0);break;case"fields":this.updateListProp(this.fields),this.reRenderNodes();break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect);break;case"nodeTemplate":this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:t.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":case"sortOrder":this.reRenderNodes()}},e.prototype.destroy=function(){this.element.removeAttribute("aria-activedescendant"),this.element.removeAttribute("tabindex"),this.unWireEvents(),this.wireEditingEvents(!1),this.rippleFn(),this.rippleIconFn(),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.element.innerHTML="",t.prototype.destroy.call(this)},e.prototype.addNodes=function(t,e,i){if(!h(t)){var o=this.getElement(e);if(t=this.getSortedData(t),this.fields.dataSource instanceof jp)this.addGivenNodes(t,o,i,!0);else if(2===this.dataType)this.addGivenNodes(t,o,i);else if(o)this.addGivenNodes(t,o,i);else for(var r=0;r<t.length;r++){var s=n(this.fields.parentID,t[r]);o=s?this.getElement(s.toString()):s,this.addGivenNodes([t[r]],o,i)}}},e.prototype.beginEdit=function(t){var e=this.getElement(t);h(e)||this.createTextbox(e,null)},e.prototype.checkAll=function(t){this.showCheckBox&&this.doCheckBoxAction(t,!0)},e.prototype.collapseAll=function(t,e,i){h(t)?e>0?this.collapseByLevel(O("."+rm,this.element),e,i):this.collapseAllNodes(i):this.doGivenAction(t,em,!1)},e.prototype.disableNodes=function(t){h(t)||this.doDisableAction(t)},e.prototype.enableNodes=function(t){h(t)||this.doEnableAction(t)},e.prototype.ensureVisible=function(t){var e=this.getElement(t);if(!h(e)){var i=this.parents(e,"."+nm);this.expandAll(i),setTimeout(function(){e.scrollIntoView(!0)},450)}},e.prototype.expandAll=function(t,e,i){h(t)?e>0?this.expandByLevel(O("."+rm,this.element),e,i):this.expandAllNodes(i):this.doGivenAction(t,im,!0)},e.prototype.getNode=function(t){var e=this.getElement(t);return this.getNodeData(e,!0)},e.prototype.moveNodes=function(t,e,i){var n=this.getElement(e);if(!h(n))for(var o=0;o<t.length;o++){var r=this.getElement(t[o]);h(r)||n.isSameNode(r)||this.isDescendant(r,n)||this.dropAsChildNode(r,n,this,i)}},e.prototype.removeNodes=function(t){if(!h(t))for(var e=0,i=t.length;e<i;e++){var n=this.getElement(t[e]);h(n)||this.removeNode(n)}},e.prototype.updateNode=function(t,e){if(!h(t)&&!h(e)&&this.allowEditing){var i=this.getElement(t);if(!h(i)){var n=O("."+om,i);this.updateOldText(i);var o=this.getEditEvent(i,null,null);this.trigger("nodeEditing",o),o.cancel||this.appendNewText(i,n,e,!1)}}},e.prototype.uncheckAll=function(t){this.showCheckBox&&this.doCheckBoxAction(t,!1)},$g([Y(!1)],e.prototype,"allowDragAndDrop",void 0),$g([Y(!1)],e.prototype,"allowEditing",void 0),$g([Y(!1)],e.prototype,"allowMultiSelection",void 0),$g([G({},wm)],e.prototype,"animation",void 0),$g([Y()],e.prototype,"checkedNodes",void 0),$g([Y("")],e.prototype,"cssClass",void 0),$g([Y(!1)],e.prototype,"enablePersistence",void 0),$g([Y(!1)],e.prototype,"enableRtl",void 0),$g([Y("Auto")],e.prototype,"expandOn",void 0),$g([G({},ym)],e.prototype,"fields",void 0),$g([Y(!0)],e.prototype,"fullRowSelect",void 0),$g([Y()],e.prototype,"nodeTemplate",void 0),$g([Y()],e.prototype,"selectedNodes",void 0),$g([Y("None")],e.prototype,"sortOrder",void 0),$g([Y(!1)],e.prototype,"showCheckBox",void 0),$g([J()],e.prototype,"created",void 0),$g([J()],e.prototype,"dataBound",void 0),$g([J()],e.prototype,"drawNode",void 0),$g([J()],e.prototype,"destroyed",void 0),$g([J()],e.prototype,"keyPress",void 0),$g([J()],e.prototype,"nodeChecked",void 0),$g([J()],e.prototype,"nodeChecking",void 0),$g([J()],e.prototype,"nodeClicked",void 0),$g([J()],e.prototype,"nodeCollapsed",void 0),$g([J()],e.prototype,"nodeCollapsing",void 0),$g([J()],e.prototype,"nodeDragging",void 0),$g([J()],e.prototype,"nodeDragStart",void 0),$g([J()],e.prototype,"nodeDragStop",void 0),$g([J()],e.prototype,"nodeDropped",void 0),$g([J()],e.prototype,"nodeEdited",void 0),$g([J()],e.prototype,"nodeEditing",void 0),$g([J()],e.prototype,"nodeExpanded",void 0),$g([J()],e.prototype,"nodeExpanding",void 0),$g([J()],e.prototype,"nodeSelected",void 0),$g([J()],e.prototype,"nodeSelecting",void 0),e=i=$g([$],e);var i}(Ka),function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),Cm=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},Sm="e-open",Em="e-right",Pm="e-left",Lm="e-over",Tm="e-push",km="e-sidebar-context",Om=(function(t){function e(e,i){return t.call(this,e,i)||this}xm(e,t),e.prototype.preRender=function(){this.setWidth()},e.prototype.render=function(){this.initialize(),this.wireEvents()},e.prototype.initialize=function(){this.setTarget(),this.addClass(),this.setZindex(),this.enableDock&&this.setDock(),this.isOpen?this.show():this.setMediaQuery(),this.setType(this.type),this.setCloseOnDocumentClick(),this.setEnableRTL()},e.prototype.setEnableRTL=function(){this.enableRtl?w([this.element],"e-rtl"):x([this.element],"e-rtl")},e.prototype.setTarget=function(){this.targetParentElement=this.element.previousElementSibling||this.element.parentElement,"string"==typeof this.target&&this.setProperties({target:document.querySelector(this.target)},!0),this.target&&(this.target.insertBefore(this.element,this.target.children[0]),w([this.element],"e-sidebar-absolute"),w([this.target],km))},e.prototype.setCloseOnDocumentClick=function(){this.closeOnDocumentClick?ha.add(document,"mousedown touchstart",this.documentclickHandler,this):ha.remove(document,"mousedown touchstart",this.documentclickHandler)},e.prototype.setWidth=function(){this.enableDock&&"Left"===this.position?I(this.element,{width:this.setDimension(this.dockSize)}):this.enableDock&&"Right"===this.position?I(this.element,{width:this.setDimension(this.dockSize)}):this.enableDock||I(this.element,{width:this.setDimension(this.width)})},e.prototype.setDimension=function(t){return t="number"==typeof t?m(t):"string"==typeof t?t.match(/px|%|em/)?t:m(t):"100%"},e.prototype.setZindex=function(){I(this.element,{"z-index":""+this.zIndex})},e.prototype.addClass=function(){var t=document.querySelector(".e-main-content");h(t||this.element.nextElementSibling)||w([t||this.element.nextElementSibling],["e-content-animation"]),this.enableDock||"Auto"===this.type||w([this.element],["e-visibility"]),x([this.element],[Sm,"e-close",Em,Pm,"e-slide",Tm,Lm]),this.element.classList.add("e-sidebar"),w([this.element],"Right"===this.position?Em:Pm),"Auto"!==this.type||ma.isDevice||this.enableDock?w([this.element],"e-close"):w([this.element],Sm)},e.prototype.destroyBackDrop=function(){var t=document.querySelector(".e-main-content")||this.element.nextElementSibling;this.target&&this.showBackdrop&&t?x([t],"e-backdrop"):this.showBackdrop&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},e.prototype.hide=function(){var t={model:this,element:this.element,cancel:!1};if(this.trigger("close",t),!t.cancel){if(this.element.classList.contains("e-close"))return;if(this.element.classList.contains(Sm)){var e={name:"change",element:this.element};this.trigger("change",e)}w([this.element],"e-close"),x([this.element],Sm),this.enableDock?I(this.element,{width:m(this.dockSize)}):I(this.element,{width:m(this.width)}),this.setDock(),this.setType(this.type);var i=document.querySelector(".e-main-content")||this.element.nextElementSibling;!this.enableDock&&i&&(i.style.transform="translateX(0px)","Left"===this.position?i.style.marginLeft="0px":i.style.marginRight="0px"),this.destroyBackDrop(),this.setCloseOnDocumentClick(),this.setAnimation(),"Slide"===this.type&&document.body.classList.remove("e-sidebar-overflow"),this.setProperties({isOpen:!1},!0)}},e.prototype.show=function(){var t={model:this,element:this.element,cancel:!1};if(this.trigger("open",t),!t.cancel){if(x([this.element],"e-visibility"),this.element.classList.contains(Sm))return;if(this.element.classList.contains("e-close")){var e={name:"change",element:this.element};this.trigger("change",e)}w([this.element],[Sm,"e-transition"]),I(this.element,{transform:""}),x([this.element],"e-close"),I(this.element,{width:m(this.width)});this.element.getBoundingClientRect().width;this.setType(this.type),this.createBackDrop(),this.setCloseOnDocumentClick(),this.setAnimation(),"Slide"===this.type&&document.body.classList.add("e-sidebar-overflow"),this.setProperties({isOpen:!0},!0)}},e.prototype.setAnimation=function(){this.animate?x([this.element],"e-disable-animation"):w([this.element],"e-disable-animation")},e.prototype.setDock=function(){this.enableDock&&"Left"===this.position&&!this.getState()?I(this.element,{transform:"translateX(-100%) translateX("+this.setDimension(this.dockSize)+")"}):this.enableDock&&"Right"===this.position&&!this.getState()&&I(this.element,{transform:"translateX(100%) translateX(-"+this.setDimension(this.dockSize)+")"}),this.element.classList.contains("e-close")&&this.enableDock&&I(this.element,{width:this.setDimension(this.dockSize)})},e.prototype.createBackDrop=function(){this.target&&this.showBackdrop?w([document.querySelector(".e-main-content")||this.element.nextElementSibling],"e-backdrop"):this.showBackdrop&&!this.modal&&this.getState()&&(this.modal=this.createElement("div"),this.modal.className="e-sidebar-overlay",this.modal.style.display="block",document.body.appendChild(this.modal))},e.prototype.getPersistData=function(){return this.addOnPersist(["type","position","isOpen"])},e.prototype.getModuleName=function(){return"sidebar"},e.prototype.toggle=function(t){this.element.classList.contains(Sm)?this.hide():this.show()},e.prototype.getState=function(){return!!this.element.classList.contains(Sm)},e.prototype.setMediaQuery=function(){this.mediaQuery&&this.mediaQuery.matches?this.show():this.mediaQuery&&this.getState()&&this.hide()},e.prototype.resize=function(t){"Auto"===this.type&&(ma.isDevice?w([this.element],Lm):w([this.element],Tm)),this.setMediaQuery()},e.prototype.documentclickHandler=function(t){M(t.target,".e-control.e-sidebar")||this.hide()},e.prototype.enableGestureHandler=function(t){"Left"===this.position&&"Right"===t.swipeDirection&&t.startX<=20&&t.distanceX>=50&&t.velocity>=.5?this.show():"Left"===this.position&&"Left"===t.swipeDirection?this.hide():"Right"===this.position&&"Right"===t.swipeDirection?this.hide():"Right"===this.position&&"Left"===t.swipeDirection&&window.innerWidth-t.startX<=20&&t.distanceX>=50&&t.velocity>=.5&&this.show()},e.prototype.setEnableGestures=function(){this.enableGestures?(this.mainContentEle=new gl(document.body,{swipe:this.enableGestureHandler.bind(this)}),this.sidebarEle=new gl(this.element,{swipe:this.enableGestureHandler.bind(this)})):this.mainContentEle&&this.sidebarEle&&(this.mainContentEle.destroy(),this.sidebarEle.destroy())},e.prototype.wireEvents=function(){this.setEnableGestures(),window.addEventListener("resize",this.resize.bind(this))},e.prototype.unWireEvents=function(){window.removeEventListener("resize",this.resize.bind(this)),ha.remove(document,"mousedown touchstart",this.documentclickHandler),this.mainContentEle&&this.mainContentEle.destroy(),this.sidebarEle&&this.sidebarEle.destroy()},e.prototype.onPropertyChanged=function(e,i){for(var n=document.querySelector(".e-main-content")||this.element.nextElementSibling,o=0,r=Object.keys(e);o<r.length;o++)switch(r[o]){case"isOpen":this.isOpen?this.show():this.hide();break;case"width":this.setWidth(),this.getState()||this.setDock();break;case"animate":this.setAnimation();break;case"type":x([this.element],["e-visibility"]),this.addClass(),this.setType(this.type);break;case"position":this.element.style.transform="",this.setDock(),n&&("Left"===this.position?n.style.marginRight="0px":n.style.marginLeft="0px"),"Right"===this.position?(x([this.element],Pm),w([this.element],Em)):(x([this.element],Em),w([this.element],Pm)),this.setType(this.type);break;case"showBackdrop":this.showBackdrop?this.createBackDrop():this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null);break;case"target":"string"==typeof this.target&&this.setProperties({target:document.querySelector(this.target)},!0),h(this.target)?(x([this.element],"e-sidebar-absolute"),x([i.target],km),I(n,{"margin-left":0,"margin-right":0}),document.body.insertAdjacentElement("afterbegin",this.element)):t.prototype.refresh.call(this);break;case"closeOnDocumentClick":this.setCloseOnDocumentClick();break;case"enableDock":this.getState()||this.setDock();break;case"zIndex":this.setZindex();break;case"mediaQuery":this.setMediaQuery();break;case"enableGestures":this.setEnableGestures();break;case"enableRtl":this.setEnableRTL()}},e.prototype.setType=function(t){var e=this.element.getBoundingClientRect().width;this.setZindex(),this.enableDock&&w([this.element],"e-dock");var i=document.querySelector(".e-main-content")||this.element.nextElementSibling;i&&(i.style.transform="translateX(0px)",ma.isDevice||"Auto"===this.type||("Left"===this.position?i.style.marginLeft="0px":i.style.marginRight="0px"));var n=(this.position,e+"px"),o="Left"===this.position?e:-e;switch(x([this.element],[Tm,Lm,"e-slide"]),t){case"Push":w([this.element],[Tm]),i&&(this.enableDock||this.element.classList.contains(Sm))&&("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n);break;case"Slide":w([this.element],["e-slide"]),i&&(this.enableDock||this.element.classList.contains(Sm))&&(i.style.transform="translateX("+o+"px)");break;case"Over":w([this.element],[Lm]),this.enableDock&&this.element.classList.contains("e-close")&&i&&("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n);break;case"Auto":w([this.element],["e-transition"]),ma.isDevice?i&&this.enableDock&&!this.getState()?("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n,w([this.element],Tm)):w([this.element],Lm):(w([this.element],Tm),i&&(this.enableDock||this.element.classList.contains(Sm))&&("Left"===this.position?i.style.marginLeft=n:i.style.marginRight=n),this.setProperties({isOpen:!0},!0)),this.createBackDrop()}},e.prototype.destroy=function(){t.prototype.destroy.call(this),x([this.element],[Sm,"e-close",Tm,"e-slide",Lm,Pm,Em,"e-transition","e-disable-animation","e-backdrop","e-content-animation","e-visibility"]),this.destroyBackDrop(),this.element.style.width="",this.element.style.zIndex="",this.element.style.transform="";var e=document.querySelector(".e-main-content")||this.element.nextElementSibling;h(e)||(e.style.margin="",e.style.transform=""),this.target&&(x([this.element],"e-sidebar-absolute"),x([this.target],km),"HTML"!==this.targetParentElement.parentElement.tagName&&this.targetParentElement.parentNode.insertBefore(this.element,this.targetParentElement.nextSibling)),this.unWireEvents()},Cm([Y("auto")],e.prototype,"dockSize",void 0),Cm([Y(null)],e.prototype,"mediaQuery",void 0),Cm([Y(!1)],e.prototype,"enableDock",void 0),Cm([Y(!0)],e.prototype,"enableGestures",void 0),Cm([Y(!1)],e.prototype,"isOpen",void 0),Cm([Y(!1)],e.prototype,"enableRtl",void 0),Cm([Y(!0)],e.prototype,"animate",void 0),Cm([Y("auto")],e.prototype,"height",void 0),Cm([Y(!1)],e.prototype,"closeOnDocumentClick",void 0),Cm([Y("Left")],e.prototype,"position",void 0),Cm([Y(null)],e.prototype,"target",void 0),Cm([Y(!1)],e.prototype,"showBackdrop",void 0),Cm([Y("Auto")],e.prototype,"type",void 0),Cm([Y("auto")],e.prototype,"width",void 0),Cm([Y(1e3)],e.prototype,"zIndex",void 0),Cm([J()],e.prototype,"created",void 0),Cm([J()],e.prototype,"close",void 0),Cm([J()],e.prototype,"open",void 0),Cm([J()],e.prototype,"change",void 0),Cm([J()],e.prototype,"destroyed",void 0),e=Cm([$],e)}(Ka),{content:".e-diagramcontent",copy:"e-copy",paste:"e-paste",undo:"e-undo",redo:"e-redo",cut:"e-cut",selectAll:"e-selectall",grouping:"e-grouping",group:"e-group",unGroup:"e-ungroup",bringToFront:"e-bringfront",sendToBack:"e-sendback",moveForward:"e-bringforward",sendBackward:"e-sendbackward",order:"e-order"}),Am=function(){function t(t,e){this.defaultItems={},this.disableItems=[],this.hiddenItems=[],this.localeText=this.setLocaleKey(),this.parent=t,this.serviceLocator=e,this.addEventListener()}return t.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("initial-load",this.render,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("initial-load",this.render)},t.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization"),this.element=b("ul",{id:this.parent.element.id+"_contextMenu"}),this.parent.element.appendChild(this.element);var t="#"+this.parent.element.id;this.contextMenu=new Su({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:t,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-diagram-menu"}),this.contextMenu.appendTo(this.element)},t.prototype.getMenuItems=function(){var t=[],e=[],i=[];if(!this.parent.contextMenuSettings.showCustomMenuOnly){for(var n=0,o=this.getDefaultItems();n<o.length;n++){var r=o[n];-1!==r.toLocaleLowerCase().indexOf("group")?"grouping"!==r.toLocaleLowerCase()&&i.push(this.buildDefaultItems(r)):-1!==r.toLocaleLowerCase().indexOf("order")?"order"!==r.toLocaleLowerCase()&&e.push(this.buildDefaultItems(r)):t.push(this.buildDefaultItems(r))}if(i.length>0&&((s=this.buildDefaultItems("grouping")).items=i,t.push(s)),e.length>0){var s=this.buildDefaultItems("order");s.items=e,t.push(s)}}if(this.parent.contextMenuSettings.items)for(var a=0,l=this.parent.contextMenuSettings.items;a<l.length;a++){var h=l[a];t.push(h)}return t},t.prototype.contextMenuOpen=function(){this.isOpen=!0},t.prototype.contextMenuItemClick=function(t){switch(this.getKeyFromId(t.item.id)){case"cut":this.parent.cut();break;case"copy":this.parent.copy();break;case"undo":this.parent.undo();break;case"redo":this.parent.redo();break;case"paste":this.parent.paste();break;case"selectAll":this.parent.selectAll();break;case"group":this.parent.group();break;case"unGroup":this.parent.unGroup();break;case"bringToFrontOrder":this.parent.bringToFront();break;case"moveForwardOrder":this.parent.moveForward();break;case"sendToBackOrder":this.parent.sendToBack();break;case"sendBackwardOrder":this.parent.sendBackward()}document.getElementById(this.parent.element.id+"content").focus(),this.parent.trigger("contextMenuClick",t)},t.prototype.contextMenuOnClose=function(t){t.items.length>0&&t.items[0].parentObj instanceof Su&&this.updateItemStatus()},t.prototype.getLocaleText=function(t){return this.l10n.getConstant(this.localeText[t])},t.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems,!0),this.contextMenu.enableItems(this.disableItems,!1,!0),this.hiddenItems=[],this.disableItems=[],this.isOpen=!1},t.prototype.ensureItems=function(t,e){var i=this.getKeyFromId(t.id);this.defaultItems[i];-1!==this.getDefaultItems().indexOf(i)&&t.target&&e&&!this.ensureTarget(t)&&this.hiddenItems.push(t.id)},t.prototype.contextMenuBeforeOpen=function(t){var e=t;e.hiddenItems=[];for(var i=0,n=t.items;i<n.length;i++){var o=n[i];if(this.ensureItems(o,t.event),o.items.length)for(var r=0,s=o.items;r<s.length;r++){var a=s[r];this.ensureItems(a,t.event)}}this.eventArgs=t.event,this.parent.trigger("contextMenuOpen",e),e.items.length===e.hiddenItems.length?(e.cancel=!0,e.hiddenItems=[]):(this.hiddenItems=this.hiddenItems.concat(e.hiddenItems),this.contextMenu.enableItems(this.disableItems,!1,!0),this.contextMenu.hideItems(this.hiddenItems,!0))},t.prototype.ensureTarget=function(t){var e=this.parent.selectedItems.nodes.length+this.parent.selectedItems.connectors.length,i=!1;switch(this.getKeyFromId(t.id)){case"undo":i=!(!this.parent.historyList||!this.parent.historyList.canUndo);break;case"redo":i=!(!this.parent.historyList||!this.parent.historyList.canRedo);break;case"paste":i=!!this.parent.commandHandler.clipboardData.clipObject;break;case"selectAll":i=!!(this.parent.nodes.length+this.parent.connectors.length);break;case"grouping":i=!!(e>1||this.parent.selectedItems.nodes[0]&&this.parent.selectedItems.nodes[0].children&&this.parent.selectedItems.nodes[0].children.length>1);break;case"group":i=e>1;break;case"unGroup":i=!!(this.parent.selectedItems.nodes[0]&&this.parent.selectedItems.nodes[0].children&&this.parent.selectedItems.nodes[0].children.length>1);break;case"cut":case"copy":case"order":case"bringToFrontOrder":case"moveForwardOrder":case"sendToBackOrder":case"sendBackwardOrder":i=!!e}return i},t.prototype.destroy=function(){this.contextMenu.destroy(),T(this.element),this.removeEventListener()},t.prototype.getModuleName=function(){return"contextMenu"},t.prototype.generateID=function(t){return this.parent.element.id+"_contextMenu_"+t},t.prototype.getKeyFromId=function(t){return t.replace(this.parent.element.id+"_contextMenu_","")},t.prototype.buildDefaultItems=function(t){var e;switch(t){case"copy":e={target:Om.content,iconCss:Om.copy};break;case"cut":e={target:Om.content,iconCss:Om.cut};break;case"paste":e={target:Om.content,iconCss:Om.paste};break;case"undo":e={target:Om.content,iconCss:Om.undo};break;case"redo":e={target:Om.content,iconCss:Om.redo};break;case"grouping":e={target:Om.content};break;case"group":e={target:Om.content,iconCss:Om.group};break;case"unGroup":e={target:Om.content,iconCss:Om.unGroup};break;case"order":e={target:Om.content,iconCss:Om.order};break;case"bringToFrontOrder":e={target:Om.content,iconCss:Om.bringToFront};break;case"moveForwardOrder":e={target:Om.content,iconCss:Om.moveForward};break;case"sendToBackOrder":e={target:Om.content,iconCss:Om.sendToBack};break;case"sendBackwardOrder":e={target:Om.content,iconCss:Om.sendBackward};break;case"selectAll":e={target:Om.content}}return this.defaultItems[t]={text:this.getLocaleText(t),id:this.generateID(t),target:e.target,iconCss:e.iconCss?"e-icons "+e.iconCss:""},this.defaultItems[t]},t.prototype.getDefaultItems=function(){return["copy","cut","paste","undo","redo","selectAll","grouping","group","unGroup","order","bringToFrontOrder","moveForwardOrder","sendToBackOrder","sendBackwardOrder"]},t.prototype.setLocaleKey=function(){return{copy:"Copy",cut:"Cut",paste:"Paste",undo:"Undo",redo:"Redo",selectAll:"SelectAll",grouping:"Grouping",group:"Group",unGroup:"UnGroup",order:"Order",bringToFrontOrder:"BringToFront",moveForwardOrder:"MoveForward",sendToBackOrder:"SendToBack",sendBackwardOrder:"SendBackward"}},t}(),Mm=function(){function e(){this.annotationObjects={}}return Object.defineProperty(e.prototype,"textAnnotationConnectors",{get:function(){for(var t=[],e=0,i=Object.keys(this.annotationObjects);e<i.length;e++)for(var n=i[e],o=this.annotationObjects[n],r=0,s=Object.keys(o);r<s.length;r++){var a=s[r];t.push(o[a].connector)}return t},enumerable:!0,configurable:!0}),e.prototype.getTextAnnotationConn=function(t){var e=[];if("Bpmn"===t.shape.type&&0!==t.shape.annotations.length)for(var i=this.annotationObjects[t.id],n=0,o=Object.keys(i);n<o.length;n++){var r=o[n];e.push(i[r].connector)}return e},e.prototype.getSize=function(t,e){var i=new Al(t.width,t.height);if(void 0===i.width||void 0===i.height){if(e instanceof sh||(i.width=i.width||50,i.height=i.height||50),e.actualSize.width&&e.actualSize.height)return e.actualSize;e.measure(new Al),i.width=i.width||e.desiredSize.width,i.height=i.height||e.desiredSize.height,void 0!==t.maxWidth&&(i.width=Math.min(i.width,t.maxWidth)),void 0!==t.maxHeight&&(i.height=Math.min(i.height,t.maxHeight)),void 0!==t.minWidth&&(i.width=Math.max(i.width,t.minWidth)),void 0!==t.minHeight&&(i.height=Math.max(i.height,t.minHeight))}return i},e.prototype.initBPMNContent=function(t,e,i){var n=e.shape;if("Event"===n.shape&&(t=this.getBPMNEventShape(e,n.event)),"Gateway"===n.shape&&(t=this.getBPMNGatewayShape(e)),"DataObject"===n.shape&&(t=this.getBPMNDataObjectShape(e)),"Message"!==n.shape&&"DataSource"!==n.shape||(t=this.getBPMNShapes(e)),"Activity"===n.shape&&(t=this.getBPMNActivityShape(e)),n.annotations.length>0)for(var o=0;o<n.annotations.length&&n.annotations[o].text;o++)t.children.push(this.getBPMNTextAnnotation(e,i,n.annotations[o],t));return t.style.strokeDashArray="2 2 6 2",t},e.prototype.getBPMNShapes=function(e){var i=new sh;this.setStyle(i,e),0!=(e.constraints&t.NodeConstraints.Shadow)&&(i.shadow=e.shadow);var n=Qs(e.shape.shape);return i.data=n,i.id=e.id+"_"+e.shape.shape,void 0!==e.width&&void 0!==e.height&&(i.width=e.width,i.height=e.height),i},e.prototype.getBPMNGatewayShape=function(t){var e=new gh,i=new sh;i.id=t.id+"_0_gateway",i.offsetX=t.offsetX,i.offsetY=t.offsetY,i.data="M 40 20 L 20 40 L 0 20 L 20 0 L 40 20 Z",this.setStyle(i,t);var n=new sh;n.id=t.id+"_1_gatewayType",n.style.opacity=t.style.opacity,n.horizontalAlignment="Center",n.verticalAlignment="Center",n.relativeMode="Object";var o,r=t.shape.gateway;o=$s(r.type),"EventBased"===r.type||"ExclusiveEventBased"===r.type||"ParallelEventBased"===r.type?n.style.fill="white":n.style.fill="black",n.data=o,e.style.fill="transparent",e.style.strokeColor="transparent",e.style.strokeWidth=0,e.children=[i,n];var s=this.getSize(t,i);return this.setSizeForBPMNGateway(t.shape.gateway,e,s.width,s.height),e},e.prototype.getBPMNDataObjectShape=function(t){var e=new gh,i=t.shape.dataObject,n=new sh;n.id=t.id+"_0_dataobj",n.data="M29.904,5 L7.853,5 L7.853,45 L42.147,45 L42.147,17.242,L29.932,5,L29.932,17.242,L42.147,17.242";var o=this.getSize(t,n);n.width=o.width,n.height=o.height,this.setStyle(n,t);var r=new sh;r.id=t.id+"_1_type",r.width=25,r.height=20,r.margin.left=5,r.margin.top=5,r.data="M 3 9.4 l 6 0 v 2.4 l 3.6 -4 L 9 4 v 2.5 H 3 V 9.4 Z",r.style.opacity=t.style.opacity;var s=new sh;switch(s.id=t.id+"_2_collection",s.width=7.5,s.height=15,s.style.fill="black",s.visible=!0,s.horizontalAlignment="Center",s.verticalAlignment="Bottom",s.relativeMode="Object",s.style.opacity=t.style.opacity,s.data="M 0 0 L 0.1 0 L 0.1 2 L 0 2 Z M 0.4 0 L 0.6 0 L 0.6 2 L0.4 2 Z M 0.9 0 L 1 0 L 1 2 L 0.9 2 Z",i.type){case"None":r.visible=!1;break;case"Input":r.style.fill="white";break;case"Output":r.style.fill="black"}return!1===i.collection&&(s.visible=!1),e.style.fill="transparent",e.style.strokeColor="transparent",e.style.strokeWidth=0,e.children=[n,r,s],e},e.prototype.getBPMNTaskShape=function(t){var e=t.shape.activity.task,i=new gh,n=new Wl;n.cornerRadius=10;var o=this.getSize(t,n);n.id=t.id+"_0_task",n.width=o.width,n.height=o.height,this.setStyle(n,t),void 0!==e.call&&!0===e.call&&(n.style.strokeWidth=4),i.width=o.width,i.height=o.height;var r,s=this.getTaskChildCount(t),a=12*s,l=o.width/2-a;r=1===s?l+8:l+8*(s-1);var h,c=new sh;"Receive"===e.type||"Send"===e.type?(c.width=18,c.height=16):(c.width=20,c.height=20),c.id=t.id+"_1_tasktType",c.margin.left=5,c.margin.top=5,h=ta(e.type),c.data=h,c.style.fill="transparent",c.style.opacity=t.style.opacity,i.style.fill="transparent",i.style.strokeColor="transparent",i.style.strokeWidth=0,i.children=[n,c];var d,p=e.loop,u=new sh;d=ea(p),u.data=d,u.style.fill="black",u.visible="None"!==p,1===s&&(r=l+9),u.margin.left=r,!0===u.visible&&(r+=20),u.width=12,u.height=12,u.margin.bottom=5,u.id=t.id+"_2_loop",u.horizontalAlignment="Left",u.verticalAlignment="Bottom",u.setOffsetWithRespectToBounds(0,1,"Fraction"),u.relativeMode="Point",u.style.fill="transparent",c.style.opacity=t.style.opacity,i.children.push(u);var g=new sh;return g=this.getBPMNCompensationShape(t,g),!0===e.compensation?g.visible=!0:g.visible=!1,1===s&&(r=l+9),g.margin.left=r-3,r+=18,i.children.push(g),i},e.prototype.getBPMNEventShape=function(t,e,i,n){var o,r,s,a,l=new gh;n=n||t.id;var h="M164.1884,84.6909000000001C156.2414,84.6909000000001,149.7764,78.2259000000001,149.7764,70.2769000000001C149.7764,62.3279000000001,156.2414,55.8629000000001,164.1884,55.8629000000001C172.1354,55.8629000000001,178.6024,62.3279000000001,178.6024,70.2769000000001C178.6024,78.2259000000001,172.1354,84.6909000000001,164.1884,84.6909000000001",c=t.shape.event;if("Event"===t.shape.shape&&(o=c.event,r=c.trigger),s=e.width,a=e.height,i)s=s||20,a=a||20;else if(void 0===e.width||void 0===e.height){var d=new sh;d.data=h;var p=this.getSize(t,d);s=p.width,a=p.height}var u=t.shape.activity;if("Activity"===t.shape.shape){u.subProcess;o=e.event,r=e.trigger}var g=new sh;g.data=h,g.id=n+"_0_event",g.width=s,g.height=a,g.horizontalAlignment="Center",g.verticalAlignment="Center",g.relativeMode="Object",this.setStyle(g,t);var m=new sh;m.data=h,m.id=n+"_1_event",m.style.gradient=t.style.gradient,m.horizontalAlignment="Center",m.verticalAlignment="Center",m.relativeMode="Object",m.style.strokeColor=t.style.strokeColor,m.style.opacity=t.style.opacity;var f=new sh,v=Js(r);switch(f.data=v,f.id=n+"_2_trigger",f.horizontalAlignment="Center",f.verticalAlignment="Center",f.relativeMode="Object",f.style.strokeColor=t.style.strokeColor,f.style.opacity=t.style.opacity,o){case"Start":m.visible=!1;break;case"NonInterruptingStart":g.style.strokeDashArray="2 3",m.visible=!1;break;case"Intermediate":g.style.fill="white",g.style.gradient=null;break;case"NonInterruptingIntermediate":g.style.fill="white",g.style.gradient=null,g.style.strokeDashArray="2 3",m.style.strokeDashArray="2 3";break;case"ThrowingIntermediate":case"End":g.style.fill="End"!==o?"white":"black",g.style.gradient=null,f.style.fill="black",f.style.strokeColor=t.style.fill}return l.style.fill="transparent",l.style.strokeColor="transparent",l.style.strokeWidth=0,l.children=[g,m,f],this.setSizeForBPMNEvents(c,l,s,a),l},e.prototype.setEventVisibility=function(t,e){var i=t.shape.event.event,n=e[0],o=e[1];e[2];switch(i){case"Start":o.visible=!1;break;case"NonInterruptingStart":n.style.strokeDashArray="2 3",o.visible=!1}},e.prototype.setSubProcessVisibility=function(t){if(t.shape.activity.subProcess){var e=t.shape.activity.subProcess,i=e.events.length,n="Transaction"===t.shape.activity.subProcess.type?2:0,o=t.wrapper.children[0].children[0];if(!1===e.adhoc&&(o.children[3+n+i].visible=!1),!1===e.compensation&&(o.children[4+n+i].visible=!1),i>0)for(var r=0;r<i;r++)this.setEventVisibility(t,o.children[2+r].children)}},e.prototype.getBPMNSubProcessShape=function(e){var i,n,o,r=new gh,s=new sh,a=(new gh,new sh),l=e.shape.activity,h=l.subProcess,c=this.getSubprocessChildCount(e),d=new Wl;d.id=e.id+"_0_Subprocess",d.style.fill="transparent",d.cornerRadius=10;var p=this.getSize(e,d);d.width=p.width,d.height=p.height,r.children=[d],"Transaction"===l.subProcess.type&&this.getBPMNSubProcessTransaction(e,e.shape,r);var u=12*c,g=p.width/2;o=1===c?g-6:g-u/2-4*(c-1)/2,this.setStyle(d,e),0!=(e.constraints&t.NodeConstraints.Shadow)&&(r.shadow=e.shadow);var m=new sh;if(m.id=e.id+"_0_collapsed",m.width=12,m.height=12,m.style.fill="black",m.margin.bottom=5,m.horizontalAlignment="Left",m.verticalAlignment="Bottom",m.setOffsetWithRespectToBounds(0,1,"Fraction"),m.relativeMode="Point",m.data=Qs("collapsedShape"),m.margin.left=o,!0!==h.collapsed||h.processes?m.visible=!1:m.visible=!0,!0===m.visible&&(o+=18),r.children.push(m),"Event"===h.type){d.style.strokeWidth=1,d.style.strokeDashArray="2 2",i=h.events;for(var f=0;f<i.length;f++)n=i[f],this.getBPMNSubEvent(n,e,r)}a=this.getBPMNSubProcessLoopShape(e),1===c&&(o=g+8),a.margin.left=o,!0===a.visible&&(o+=16),r.children.push(a),d.id=e.id+"_boundary","Default"===h.boundary&&(d.style.strokeWidth=1,d.style.strokeDashArray="1 0"),"Call"===h.boundary&&(d.style.strokeWidth=4,d.style.strokeDashArray="1 0"),"Event"===h.boundary&&(d.style.strokeWidth=1,d.style.strokeDashArray="2 2"),s=this.getBPMNAdhocShape(e,s,h),1===c&&(o=g+8),s.margin.left=o,!0===s.visible&&(o+=16),r.children.push(s);var v=new sh;return!0===h.compensation?v.visible=!0:v.visible=!1,v=this.getBPMNCompensationShape(e,v),1===c&&(o=g+8),v.margin.left=o,!0===v.visible&&(o+=16),r.children.push(v),r.style.strokeColor="transparent",r.style.strokeWidth=0,r.style.fill="transparent",r},e.prototype.getBPMNSubEvent=function(t,e,i,n){i.children=i.children||[];var o;o=this.getBPMNEventShape(e,t,!0,n),this.getBPMNSubprocessEvent(e,o,t),o.id=n||e.id+"_subprocessEvents",o.width=t.width||20,o.height=t.height||20,o.setOffsetWithRespectToBounds(t.offset.x,t.offset.y,"Fraction"),o.relativeMode="Point",o.margin=t.margin,o.horizontalAlignment=t.horizontalAlignment,o.verticalAlignment=t.verticalAlignment,o.style.fill="transparent",o.style.strokeColor="transparent",o.style.strokeWidth=0,i.children.push(o)},e.prototype.getBPMNSubProcessTransaction=function(t,e,i){var n=i.children[0].width,o=i.children[0].height,r=new Wl;r.margin={left:3,right:0,top:3,bottom:0},r.id=t.id+"_0_Subprocess_innnerRect",r.cornerRadius=10,r.width=n-6,r.height=o-6,i.children.push(r);var s=new gh;s.id=t.id+"_transaction_events",s.style.gradient=t.style.gradient;var a=e.activity.subProcess.transaction;this.getBPMNSubEvent(a.success,t,s,t.id+"_success"),this.getBPMNSubEvent(a.cancel,t,s,t.id+"_cancel"),this.getBPMNSubEvent(a.failure,t,s,t.id+"_failure"),this.updateDiagramContainerVisibility(s.children[0],a.success.visible),this.updateDiagramContainerVisibility(s.children[1],a.cancel.visible),this.updateDiagramContainerVisibility(s.children[2],a.failure.visible),s.float=!0,s.width=n,s.height=o,s.style.fill=s.style.strokeColor="transparent",i.children.push(s)},e.prototype.getBPMNSubProcessLoopShape=function(t){var e,i,n=t.shape.activity,o=new sh;return e=n.subProcess.loop,i=ea(e),o.visible="None"!==e,o.id=t.id+"_loop",o.data=i,o.style.fill="black",o.width=12,o.height=12,o.horizontalAlignment="Left",o.verticalAlignment="Bottom",o.setOffsetWithRespectToBounds(0,1,"Fraction"),o.relativeMode="Point",o.margin.bottom=5,o.style.fill="transparent",o},e.prototype.drag=function(t,e,i,n){var o=n.nameTable[t.processId];t.margin.top+i>=0&&n.nodePropertyChange(t,{},{margin:{top:t.margin.top+i}}),t.margin.left+e>=0&&n.nodePropertyChange(t,{},{margin:{left:t.margin.left+e}});var r=this.getChildrenBound(o,t.id,n);this.updateSubProcessess(r,t,n),o.wrapper.measure(new Al(void 0,void 0)),o.wrapper.arrange(o.wrapper.desiredSize),n.refreshCanvasLayers(),n.updateSelector(),this.updateDocks(t,n)},e.prototype.dropBPMNchild=function(t,e,i){if(e&&"Bpmn"===e.shape.type){var n=i.nameTable[t.id].shape.activity.subProcess;if(i.currentSymbol&&"Bpmn"===t.shape.type&&!n.collapsed)return void(e.processId=t.id);if(n.processes=n.processes||[],n.processes&&-1===n.processes.indexOf(e.id)&&!n.collapsed){n.processes.push(e.id);var o=Yr(e),r=i.nameTable[e.id].wrapper,s=i.nameTable[t.id].wrapper;r.margin.top=r.offsetY-r.actualSize.height/2-(t.offsetY-t.actualSize.height/2),r.margin.left=r.offsetX-r.actualSize.width/2-(t.offsetX-t.actualSize.width/2),r.margin.top=r.margin.top<0?0:r.margin.top,r.margin.left=r.margin.left<0?0:r.margin.left,i.nameTable[e.id].processId=t.id,s.children.push(i.nameTable[e.id].wrapper);var a=this.getChildrenBound(t,e.id,i);this.updateSubProcessess(a,e,i),s.measure(new Al(void 0,void 0)),s.arrange(s.desiredSize),i.refreshCanvasLayers(),i.updateSelector();for(var l=[],h=(l=l.concat(e.outEdges,e.inEdges)).length-1;h>=0;h--)i.remove(i.nameTable[l[h]]);var c={type:"PositionChanged",undoObject:{nodes:[o]},redoObject:{nodes:[Yr(e)]},category:"Internal"};i.addHistoryEntry(c),"SVG"===i.mode&&e.zIndex<t.zIndex&&i.updateProcesses(e),this.updateDocks(e,i)}}},e.prototype.updateDocks=function(t,e){if("Bpmn"===t.shape.type&&t.shape.activity.subProcess.processes&&!t.shape.activity.subProcess.collapsed)for(var i=0,n=t.shape.activity.subProcess.processes;i<n.length;i++){var o=n[i],r=e.nameTable[o];r&&(e.updateConnectorEdges(r),r.wrapper.measure(new Al(r.wrapper.width,r.wrapper.height)),r.wrapper.arrange(r.wrapper.desiredSize),r.shape.activity.subProcess.processes&&r.shape.activity.subProcess.processes.length&&this.updateDocks(r,e))}},e.prototype.removeBpmnProcesses=function(t,e){var i=e.nameTable[t.processId];if("Bpmn"===t.shape.type&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0)for(var n=(o=t.shape.activity.subProcess.processes).length-1;n>=0;n--)e.remove(e.nameTable[o[n]]);if(i){e.removeDependentConnector(t);var o=i.shape.activity.subProcess.processes;this.removeChildFromBPMN(i.wrapper,t.id);var r=o.indexOf(t.id);o.splice(r,1)}},e.prototype.removeChildFromBPMN=function(t,e){for(var i=0,n=t.children;i<n.length;i++){var o=n[i];o.id===e?t.children.splice(t.children.indexOf(o),1):o.children&&this.removeChildFromBPMN(o,e)}},e.prototype.removeProcess=function(t,e){var i=e.nameTable[t];if(i){var n=e.nameTable[i.processId];if(n&&"Bpmn"===n.shape.type){var o=n.shape.activity.subProcess.processes;e.removeDependentConnector(i),this.removeChildFromBPMN(n.wrapper,t);var r=o.indexOf(t);o.splice(r,1),i.processId="",e.refreshDiagramLayer(),e.updateSelector()}}},e.prototype.addProcess=function(t,e,i){var n;t.id=t.id||qr(),n=t.id;var o=i.nameTable[n];o||i.add(t),t.processId=e;var r=i.nameTable[e],s=r.shape.activity.subProcess;if(o&&r&&"Bpmn"===r.shape.type&&"Bpmn"===o.shape.type&&s.processes&&!s.collapsed){o.processId=e;var a=r.shape.activity.subProcess.processes;a.indexOf(n)<0&&a.push(n),r.wrapper.children.push(o.wrapper),r.wrapper.measure(new Al),r.wrapper.arrange(r.wrapper.desiredSize),i.bpmnModule.updateDocks(r,i),i.refreshDiagramLayer(),"SVG"===i.mode&&o.shape&&o.shape.activity&&!o.shape.activity.subProcess.processes&&yr(e+"_groupElement").appendChild(yr(t.id+"_groupElement"))}},e.prototype.getChildrenBound=function(t,e,i){var n,o=t.shape.activity.subProcess.processes;if(o&&o.length)for(var r=0,s=o;r<s.length;r++){var a=s[r];e!==a&&(n=n?i.nameTable[a].wrapper.bounds.uniteRect(n):i.nameTable[a].wrapper.bounds)}return n||i.nameTable[e].wrapper.bounds},e.prototype.updateSubProcessess=function(t,e,i){var n,o,r,s,a=i.nameTable[e.processId],l={x:.5,y:.5};a.wrapper.bounds.left+e.margin.left+e.width>a.wrapper.bounds.right&&(r=!0),a.wrapper.bounds.top+e.margin.top+e.height>a.wrapper.bounds.bottom&&(s=!0),r&&(l.x=0),s&&(l.y=0);var h=a.wrapper.actualSize;r&&(n=(e.wrapper.margin.left+e.wrapper.bounds.width)/h.width),s&&(o=(e.wrapper.margin.top+e.wrapper.bounds.height)/h.height),(n>0||o>0)&&i.commandHandler.scale(i.nameTable[e.processId],n||1,o||1,l)},e.prototype.getBPMNCompensationShape=function(t,e){return e.id=t.id+"_0_compensation",e.width=12,e.height=12,e.margin.bottom=5,e.style.fill="transparent",e.horizontalAlignment="Left",e.verticalAlignment="Bottom",e.relativeMode="Object",e.data="M 22.462 18.754 l -6.79 3.92 l 6.79 3.92 V 22.89 l 6.415 3.705 v -7.841 l -6.415 3.705 V 18.754 Z M 28.331 19.701 v 5.947 l -5.149 -2.973 L 28.331 19.701 Z M 21.916 25.647 l -5.15 -2.973 l 5.15 -2.973 V 25.647 Z M 22.275 12.674 c -5.513 0 -9.999 4.486 -9.999 9.999 c 0 5.514 4.486 10.001 9.999 10.001 c 5.514 0 9.999 -4.486 9.999 -10.001 C 32.274 17.16 27.789 12.674 22.275 12.674 Z M 22.275 32.127  c -5.212 0 -9.453 -4.241 -9.453 -9.454 c 0 -5.212 4.241 -9.453 9.453 -9.453 c 5.212 0 9.453 4.241 9.453 9.453 C 31.728 27.887 27.487 32.127 22.275 32.127 Z",e},e.prototype.getBPMNActivityShape=function(t){var e,i=new gh,n=t.shape.activity,o=n.activity,r=n.subProcess;n.activity;return"Task"===o&&(e=this.getBPMNTaskShape(t)),"SubProcess"===o&&r&&(e=this.getBPMNSubProcessShape(t)),i.children=[e],i.style.fill="transparent",i.style.strokeColor="transparent",i.style.strokeWidth=0,i},e.prototype.getBPMNSubprocessEvent=function(t,e,i){var n,o;if(0!==i.annotations.length)for(s=0;s<i.annotations.length;s++){var r=i.annotations[s];(n=t.initAnnotationWrapper(r)).width=i.width,n.height=i.height,e.children.push(n)}if(0!==i.ports.length)for(var s=0;s<i.ports.length;s++){var a=i.ports[s];o=t.initPortWrapper(a),e.children.push(o)}},e.prototype.getBPMNAdhocShape=function(t,e,i){return e.id=t.id+"_0_adhoc",e.width=12,e.height=8,e.style.fill="black",e.margin.bottom=5,e.horizontalAlignment="Left",e.verticalAlignment="Bottom",e.relativeMode="Object",e.data="M 49.832 76.811 v -2.906 c 0 0 0.466 -1.469 1.931 -1.5 c 1.465 -0.031 2.331 1.219 2.897 1.688 s 1.06 0.75 1.526 0.75 c 0.466 0 1.548 -0.521 1.682 -1.208 s 0.083 3.083 0.083 3.083 s -0.76 0.969 -1.859 0.969 c -1.066 0 -1.865 -0.625 -2.464 -1.438 s -1.359 -0.998 -2.064 -0.906 C 50.598 75.467 49.832 76.811 49.832 76.811 Z",i&&!0===i.adhoc?e.visible=!0:e.visible=!1,e},e.prototype.getBPMNTextAnnotation=function(e,i,n,o){n.id=n.id||qr();var r=new gh,s=new sh,a=new ch;s.id=e.id+"_"+n.id+"_path",s.width=n.width,s.height=n.height,s.relativeMode="Object",a.id=e.id+"_"+n.id+"_text",a.content=n.text;var l=e.style;a.style={fontSize:l.fontSize,italic:l.italic,gradient:null,opacity:l.opacity,bold:l.bold,textWrapping:l.textWrapping,color:l.color,fill:"white",fontFamily:l.fontFamily,whiteSpace:l.whiteSpace,textOverflow:"Wrap",strokeColor:"none",strokeWidth:0,strokeDashArray:l.strokeDashArray,textAlign:l.textAlign,textDecoration:l.textDecoration},a.horizontalAlignment="Center",a.verticalAlignment="Center",a.relativeMode="Object",a.margin={left:5,right:5,top:5,bottom:5},r.offsetX=e.offsetX+n.length*Math.cos(n.angle*(Math.PI/180)),r.offsetY=e.offsetY+n.length*Math.sin(n.angle*(Math.PI/180)),r.float=!0,r.transform=t.Transform.Self,r.id=e.id+"_textannotation_"+n.id,r.style.strokeColor="transparent",r.margin={left:10,right:10,top:10,bottom:10},r.relativeMode="Object",r.rotateAngle=0,r.children=[s,a];var h=new fd(e.shape,"annotations",{id:r.id,shape:{type:"Bpmn",shape:"TextAnnotation"}},!0);h.ports=[{id:s.id+"_port",shape:"Square",offset:{x:0,y:.5}}],h.offsetX=r.offsetX,h.offsetY=r.offsetY,h.wrapper=r,r.children.push(h.initPortWrapper(h.ports[0]));var c=new Rl(0,0,0,0);void 0!==e.width&&void 0!==e.height&&(c=new Rl(e.offsetX-e.width/2,e.offsetY-e.height/2,e.width,e.height)),this.setAnnotationPath(c,r,{x:h.offsetX,y:h.offsetY},h,n.length,n.angle);var d={id:e.id+"_"+n.id+"_connector",constraints:t.ConnectorConstraints.Default&~t.ConnectorConstraints.DragTargetEnd,sourceID:e.id,targetID:r.id,targetDecorator:{shape:"None"}},p=new _c(e.shape,"annotations",d,!0);p.targetPortID=h.ports[0].id,p.init(i),p.wrapper.float=!1,p.wrapper.transform=t.Transform.Self,o.children.push(p.wrapper),p.zIndex=1e4;var u=this.annotationObjects[e.id];u||(u={}),u[n.id]||(u[n.id]={});return u[n.id].node=h,u[n.id].connector=p,this.annotationObjects[e.id]=u,i.initObject(h,void 0,!1),h.zIndex=1e4,r},e.prototype.getTextAnnotationWrapper=function(t,e){if(t&&"Bpmn"===t.shape.type){if("TextAnnotation"===t.shape.shape)return t.wrapper.children[1];if(this.annotationObjects[t.id]&&this.annotationObjects[t.id][e]){var i=this.annotationObjects[t.id][e].node;return this.getTextAnnotationWrapper(i,e)}}return null},e.prototype.addAnnotation=function(t,e,i){var n=t.wrapper.children[0],o=t.shape,r=new gd(o,"annotations",e,!0);return o.annotations.push(r),n.children.push(this.getBPMNTextAnnotation(t,i,e,n)),t.wrapper.measure(new Al),t.wrapper.arrange(t.wrapper.desiredSize),this.annotationObjects[t.id][e.id].connector},e.prototype.clearAnnotations=function(t,e){var i=t.shape;if(i.annotations.length)for(var n=0,o=i.annotations;n<o.length;n++){var r=o[n];this.removeAnnotationObjects(t,r,e)}delete this.annotationObjects[t.id]},e.prototype.checkAndRemoveAnnotations=function(t,e){if("Bpmn"===t.shape.type)if("TextAnnotation"===t.shape.shape)for(var i=t.id.split("_"),n=i[i.length-1],o=i[i.length-3],r=e.nameTable[o],s=r.shape,a=0,l=s.annotations;a<l.length;a++){var h=l[a];if(h.id===n&&-1!==s.annotations.indexOf(h))return e.removeDependentConnector(t),this.removeAnnotationObjects(r,h,e),!0}else t.shape.annotations&&t.shape.annotations.length&&this.clearAnnotations(t,e);return!1},e.prototype.removeAnnotationObjects=function(t,e,i){var n=t.shape,o=n.annotations.indexOf(e);if(-1!==o){n.annotations.splice(o,1);var r=this.annotationObjects[t.id];if(r&&r[e.id]){var s=r[e.id].node,a=r[e.id].connector;i.removeElements(s),i.removeElements(a);var l=t.wrapper.children[0];o=l.children.indexOf(s.wrapper),l.children.splice(o,1),o=l.children.indexOf(a.wrapper),l.children.splice(o,1),i.removeFromAQuad(s),i.removeFromAQuad(a),delete i.nameTable[s.id],delete i.nameTable[a.id],delete r[e.id]}}},e.prototype.setAnnotationPath=function(t,e,i,n,o,r){var s=this.getAnnotationPathAngle(i,t),a="",l=e.children[0],h=e.children[2],c=e.children[1];l.horizontalAlignment="Stretch",l.verticalAlignment="Stretch",c.margin.left=c.margin.right=5,c.margin.top=c.margin.bottom=5;var d,p;0===s?(a="M10,20 L0,20 L0,0 L10,0",l.width=10,l.horizontalAlignment="Left",h.setOffsetWithRespectToBounds(0,.5,"Fraction"),c.margin.top=c.margin.bottom=10,d=t.middleRight,p={X1:t.right,Y1:t.top,X2:t.right,Y2:t.bottom}):180===s?(a="M0,0 L10,0 L10,20 L0,20",l.width=10,l.horizontalAlignment="Right",h.setOffsetWithRespectToBounds(1,.5,"Fraction"),c.margin.top=c.margin.bottom=10,d=t.middleLeft,p={X1:t.left,Y1:t.top,X2:t.left,Y2:t.bottom}):90===s?(a="M20,10 L20,0 L0,0 L0,10",l.height=10,l.verticalAlignment="Top",h.setOffsetWithRespectToBounds(.5,0,"Fraction"),c.margin.left=c.margin.right=10,d=t.bottomCenter,p={X1:t.right,Y1:t.bottom,X2:t.left,Y2:t.bottom}):(a="M0,0 L0,10 L20,10 L20,0",l.height=10,l.verticalAlignment="Bottom",h.setOffsetWithRespectToBounds(.5,1,"Fraction"),c.margin.left=c.margin.right=10,d=t.topCenter,p={X1:t.right,Y1:t.top,X2:t.left,Y2:t.top});var u=t.center;d=Ki(p,[u,Dl.transform(i,r,Math.max(t.width,t.height))],!1,u),l.data=a,void 0!==o&&void 0!==r&&(d=Dl.transform(d,r,o),e.offsetX=n.offsetX=d.x,e.offsetY=n.offsetY=d.y)},e.prototype.isBpmnTextAnnotation=function(t,e){if(this.annotationObjects){var i=t.parentId,n=t.id,o=e.nameTable[i];return o&&"Bpmn"===o.shape.type&&this.annotationObjects[i]&&this.annotationObjects[i][n]?o:null}return null},e.prototype.updateTextAnnotationContent=function(t,e,i,n){var o=e.parentId,r=e.id;if(this.annotationObjects[o]&&this.annotationObjects[o][r])for(var s=0,a=t.shape.annotations;s<a.length;s++){var l=a[s];if(l.id===r){l.text=i;var h=this.annotationObjects[o][r].node.wrapper.children[1];h.content=i,h.visible=!0,t.wrapper.measure(new Al),t.wrapper.arrange(t.wrapper.desiredSize)}}},e.prototype.updateQuad=function(t,e){var i,n=t.shape.annotations;if(n&&n.length>0)for(var o=0;o<n.length;o++)i=this.annotationObjects[t.id][n[o].id].node,e.updateQuad(i)},e.prototype.updateTextAnnotationProp=function(t,e,i){if("Bpmn"===t.shape.type){var n=t.shape.annotations;if(n&&n.length>0)for(var o=0;o<t.wrapper.children[0].children.length;o++)for(var r=0;r<n.length;r++){var s=t.wrapper.children[0].children[o].id.split("_");if(s[s.length-1]===n[r].id){var a=this.annotationObjects[t.id][n[r].id].node,l=this.annotationObjects[t.id][n[r].id].connector,h=(Sn(l.targetPoint,t.wrapper.bounds,t.wrapper.bounds,!1),l.sourcePoint);h={x:l.sourcePoint.x+t.offsetX-e.offsetX,y:l.sourcePoint.y+t.offsetY-e.offsetY},h=Dl.transform(h,n[r].angle,n[r].length),t.wrapper.children[0].children[o].offsetX=a.offsetX=h.x,t.wrapper.children[0].children[o].offsetY=a.offsetY=h.y,i.updateQuad(a)}}}},e.prototype.findInteractableObject=function(t,e){if(t.targetID){var i=e.nameTable[t.targetID];if("Bpmn"===i.shape.type&&"TextAnnotation"===i.shape.shape)return i}return t},e.prototype.canAdd=function(t){return!t.shape||"Bpmn"!==t.shape.type||"TextAnnotation"!==t.shape.shape},e.prototype.getSubprocessChildCount=function(t){var e,i=0,n=t.shape.activity.subProcess;return void 0!==(e=n.loop)&&"None"!==e&&i++,void 0!==n.compensation&&!0===n.compensation&&i++,void 0!==n.collapsed&&!0===n.collapsed&&i++,void 0!==n.adhoc&&!0===n.adhoc&&i++,i},e.prototype.getTaskChildCount=function(t){var e=0,i=t.shape.activity.task;return void 0!==i.compensation&&!0===i.compensation&&e++,void 0!==i.loop&&"None"!==i.loop&&e++,e},e.prototype.setStyle=function(e,i){e.style.fill=i.style.fill,e.style.strokeColor=i.style.strokeColor,e.style.strokeWidth=i.style.strokeWidth,e.style.strokeDashArray=i.style.strokeDashArray,e.style.opacity=i.style.opacity,e.style.gradient=i.style.gradient,0!=(i.constraints&t.NodeConstraints.Shadow)&&(e.shadow=i.shadow)},e.prototype.updateBPMN=function(t,e,i,n){var o=t.shape||{},r=i.wrapper.children[0],s=i.shape.shape,a=void 0!==t.width||void 0!==t.height;if("Gateway"===o.shape&&o.gateway)i.wrapper.children[0]=this.getBPMNGatewayShape(i);else if("DataObject"===o.shape&&o.dataObject)i.wrapper.children[0]=this.getBPMNDataObjectShape(i);else if("Activity"===o.shape&&o.activity)i.wrapper.children[0]=this.getBPMNActivityShape(i);else if("Event"===o.shape&&o.event){var l=o.event;i.wrapper.children[0]=this.getBPMNEventShape(i,l)}else"Message"===o.shape||"DataSource"===o.shape?i.wrapper.children[0]=this.getBPMNShapes(i):void 0!==o.gateway||"Gateway"===s&&a?this.updateBPMNGateway(i,t):void 0!==o.dataObject||"DataObject"===s&&a?this.updateBPMNDataObject(i,t,e):void 0!==o.activity||"Activity"===s&&a?this.updateBPMNActivity(i,t,e,n):(void 0!==o.event||"Event"===s&&a)&&this.updateBPMNEvent(i,t,e);t.style&&jo(t.style,r instanceof oh?"Activity"===i.shape.shape?r.children[0].children[0]:r.children[0]:r)},e.prototype.updateBPMNGateway=function(t,e){var i=t.shape,n=t.wrapper.children[0];if(i){jo(t.style,n.children[0]);var o=$s(i.gateway.type);n.children[1].data=o}void 0===e.width&&void 0===e.height||this.setSizeForBPMNGateway(t.shape.gateway,n,e.width||t.width,e.height||t.height)},e.prototype.updateBPMNDataObject=function(t,e,i){var n=e.shape,o=t.wrapper.children[0];if(n){var r=o.children[1],s=o.children[2];if(void 0!==e.style&&(jo(e.style,o.children[0]),r.style.opacity=t.style.opacity,s.style.opacity=t.style.opacity),n.dataObject){switch(n.dataObject.type){case"None":r.visible=!1;break;case"Input":r.style.fill="white";break;case"Output":r.style.fill="black"}"None"===i.shape.dataObject.type&&(r.visible=!0),void 0!==e.shape.dataObject.collection&&(s.visible=n.dataObject.collection)}}void 0===e.width&&void 0===e.height||this.setSizeForBPMNDataObjects(t.shape.dataObject,o,e.width||t.width,e.height||t.height)},e.prototype.getEvent=function(t,e,i,n,o,r){switch(i){case"Start":o.visible=!1,n.style.strokeDashArray="",r.style.fill="white",r.style.strokeColor="black",n.style.fill="white";break;case"NonInterruptingStart":n.style.strokeDashArray="2 3",r.style.fill="white",n.style.fill="white",r.style.strokeColor="black",o.visible=!1;break;case"Intermediate":n.style.strokeDashArray="",n.style.fill="white",o.style.strokeDashArray="",n.style.gradient=null,r.style.fill="white",r.style.strokeColor="black",this.updateEventVisibility(e,o);break;case"NonInterruptingIntermediate":n.style.fill="white",n.style.gradient=null,r.style.fill="white",r.style.strokeColor="black",n.style.strokeDashArray="2 3",o.style.strokeDashArray="2 3",this.updateEventVisibility(e,o);break;case"ThrowingIntermediate":case"End":n.style.fill="End"!==i?"white":"black",n.style.strokeDashArray="",o.style.strokeDashArray="",n.style.gradient=null,r.style.fill="black",this.updateEventVisibility(e,o),r.style.strokeColor=t.style.fill}},e.prototype.updateEventVisibility=function(t,e){t.shape.activity&&t.shape.activity.subProcess&&t.shape.activity.subProcess.events&&void 0!==t.shape.activity.subProcess.events[0]&&void 0!==t.shape.activity.subProcess.events[0].event?"NonInterruptingStart"!==t.shape.activity.subProcess.events[0].event&&"Start"!==t.shape.activity.subProcess.events[0].event||(e.visible=!0):void 0!==t.shape.event&&("NonInterruptingStart"!==t.shape.event.event&&"Start"!==t.shape.event.event||(e.visible=!0))},e.prototype.updateBPMNEvent=function(t,e,i){var n=e.shape,o=t.wrapper.children[0];if(n){var r,s=o.children[0],a=o.children[1],l=o.children[2],h=void 0;void 0!==e.style&&(jo(t.style,o.children[0]),void 0===e.style.opacity&&void 0===e.style.strokeColor||(a.style.opacity=t.style.opacity,a.style.strokeColor=t.style.strokeColor)),r=n.event.event,h=n.event.trigger,void 0!==r&&this.getEvent(t,i,r,s,a,l),void 0!==h&&this.updateBPMNEventTrigger(t,e)}void 0===e.width&&void 0===e.height||this.setSizeForBPMNEvents(t.shape.event,o,e.width||t.width,e.height||t.height)},e.prototype.updateBPMNEventTrigger=function(t,e){var i=t.shape,n=t.wrapper.children[0].children[2];!e.style||void 0===e.style.strokeColor&&void 0===e.style.opacity||jo(t.style,n);var o=Js(i.event.trigger);i.event.trigger&&(n.height=.8*n.height),n.data=o},e.prototype.updateBPMNActivity=function(t,e,i,n){var o=e.shape,r=t.wrapper.children[0],s=this.getSize(t,r.children[0].children[0]);if(o){var a=i.shape.activity.activity,l=t.shape.activity.activity;if("SubProcess"!==a&&"Task"!==a||"SubProcess"!==l&&"Task"!==l){if("Task"===l&&void 0!==o.activity.task){this.updateBPMNActivityTask(t,e);var h=this.getTaskChildCount(t),c=void 0,d=12*h,p=s.width/2-d;c=1===h?p+8:p+8*(h-1),void 0!==o.activity.task.loop&&this.updateBPMNActivityTaskLoop(t,e,c,h,p,2)}"SubProcess"===l&&void 0!==o.activity.subProcess&&this.updateBPMNActivitySubProcess(t,e,i,n)}else n.removeElements(t),t.wrapper.children[0]=this.getBPMNActivityShape(t);this.setSizeForBPMNActivity(t.shape.activity,r,e.width||s.width,e.height||s.height,t)}void 0===e.width&&void 0===e.height||this.setSizeForBPMNActivity(t.shape.activity,r,e.width||s.width,e.height||s.height,t)},e.prototype.updateBPMNActivityTask=function(t,e){var i=e.shape,n=t.wrapper.children[0].children[0],o=i.activity.task;if("Receive"===o.type||"Send"===o.type?n.children[1].height=14:n.children[1].height=20,void 0!==o.type){var r=ta(o.type);n.children[1].data=r}void 0!==i.activity.task.call&&(!1!==i.activity.task.call?n.children[0].style.strokeWidth=4:n.children[0].style.strokeWidth=1),void 0!==i.activity.task.compensation&&(!0===i.activity.task.compensation?n.children[3].visible=!0:n.children[3].visible=!1)},e.prototype.updateBPMNActivityTaskLoop=function(t,e,i,n,o,r){var s,a,l=e.shape,h=t.wrapper.children[0].children[0],c=l.activity,d=0;if(void 0!==c.subProcess){var p=c.subProcess;d="Transaction"===c.subProcess.type?2:0,a=ea(s=p.loop),h.children[2+d].data=a,h.children[2+d].visible="None"!==s}else void 0!==c.task&&void 0!==c.task.loop&&(a=ea(c.task.loop),h.children[2].data=a,h.children[2].visible="None"!==c.task.loop);this.updateChildMargin(h,n,o,i,r+d)},e.prototype.updateChildMargin=function(t,e,i,n,o){if(1===e)for(r=o;r<t.children.length;r++)2!==r&&!0===t.children[r].visible&&(t.children[r].margin.left=n,n=i+8);else{n=i+8*(e-1);for(var r=o;r<t.children.length;r++)2!==r&&!0===t.children[r].visible&&(t.children[r].margin.left=n,n+=20)}},e.prototype.updateBPMNActivitySubProcess=function(t,e,i,n){var o,r=e.shape,s=t.wrapper.children[0],a=this.getSize(t,s.children[0].children[0]),l=r.activity.subProcess,h=this.getSubprocessChildCount(t),c=12*h,d=a.width/2-c;o=1===h?d+8:d+8*(h-1),jo(t.style,s.children[0].children[0]),void 0!==l.events&&this.updateBPMNSubProcessEvent(t,e,i,n),void 0!==l.adhoc&&this.updateBPMNSubProcessAdhoc(t,i,l,o,h,d),void 0!==l.boundary&&this.updateBPMNSubProcessBoundary(t,l),void 0!==l.collapsed&&this.updateBPMNSubProcessCollapsed(t,i,l,o,h,d,n),void 0!==l.compensation&&this.updateBPMNSubProcessCompensation(t,i,l,o,h,d),void 0!==l.loop&&this.updateBPMNSubProcessLoop(t,i,l,o,h,d),void 0!==l.transaction&&this.updateBPMNSubProcessTransaction(t,e,i,n)},e.prototype.updateBPMNSubProcessEvent=function(t,e,i,n){for(var o=e.shape,r=t.wrapper.children[0],s=r.children[0],a=(r.children[0].children.length,o.activity.subProcess),l=0,h=Object.keys(a.events);l<h.length;l++){var c=h[l],d=Number(c),p=s.children[d+2],u=t.shape.activity.subProcess.events[d];this.updateBPMNSubEvent(t,a.events[d],u,p,e,i,n)}},e.prototype.updateBPMNSubEvent=function(t,e,i,n,o,r,s){var a,l,h=t.wrapper.children[0],c=o.shape,d=n.children[0],p=n.children[1],u=n.children[2];if(o.style&&(void 0===o.style.strokeColor&&void 0===o.style.opacity||(h.children[0].children[1].style.strokeColor=o.style.strokeColor,h.children[0].children[1].style.opacity=o.style.opacity)),void 0!==c.activity.subProcess&&(a=e.event,l=e.trigger),void 0!==a&&this.getEvent(o,r,a,d,p,u),void 0!==l){o.style&&jo(o.style,h.children[0]);var g=Js(l);n.children[2].data=g}if(void 0===e.height&&void 0===e.width||this.getEventSize(e,n),void 0!==e.id&&(n.id=e.id),void 0!==e.margin&&(n.margin=e.margin),void 0!==e.horizontalAlignment&&(n.horizontalAlignment=e.horizontalAlignment),void 0!==e.verticalAlignment&&(n.verticalAlignment=e.verticalAlignment),void 0!==e.offset&&(n.setOffsetWithRespectToBounds(i.offset.x,i.offset.y,"Fraction"),n.relativeMode="Point"),void 0!==e.annotations){var m=void 0,f=h.children[0].children[2];n.children[3]&&n.children.length>3&&(m=n.children[3],s.updateAnnotation(e.annotations[0],m,f))}if(void 0!==e.ports){var v=void 0,y=h.children[0].children[2];n.children[4]&&n.children.length>4&&(v=n.children[4],s.updatePort(e.ports[0],v,y))}void 0!==e.visible&&this.updateDiagramContainerVisibility(n,e.visible)},e.prototype.updateBPMNSubProcessTransaction=function(t,e,i,n){var o,r=e.shape.activity.subProcess.transaction,s=t.wrapper.children[0].children[0].children[2];void 0!==r.success&&(o=t.shape.activity.subProcess.transaction.success,this.updateBPMNSubEvent(t,r.success,o,s.children[0],e,i,n)),void 0!==r.cancel&&(o=t.shape.activity.subProcess.transaction.cancel,this.updateBPMNSubEvent(t,r.cancel,o,s.children[1],e,i,n)),void 0!==r.failure&&(o=t.shape.activity.subProcess.transaction.failure,this.updateBPMNSubEvent(t,r.failure,o,s.children[2],e,i,n));for(var a=0,l=t.outEdges;a<l.length;a++){var h=l[a],c=n.nameTable[h];switch(c.sourcePortID){case"success":r.success&&void 0!==r.success.visible&&n.connectorPropertyChange(c,{},{sourcePortID:"success"});break;case"cancel":r.cancel&&void 0!==r.cancel.visible&&n.connectorPropertyChange(c,{},{sourcePortID:"cancel"});break;case"failure":r.failure&&void 0!==r.failure.visible&&n.connectorPropertyChange(c,{},{sourcePortID:"failure"})}}},e.prototype.getEventSize=function(t,e){void 0!==t.height&&(e.height=t.height,e.children[0].height=t.height,e.children[1].height=.85*t.height,e.children[2].height=.54*t.height),void 0!==t.width&&(e.width=t.width,e.children[0].width=t.width,e.children[1].width=.85*t.width,e.children[2].width=.54*t.width)},e.prototype.updateBPMNSubProcessAdhoc=function(t,e,i,n,o,r){t.shape;var s=t.wrapper.children[0].children[0],a="Transaction"===t.shape.activity.subProcess.type?2:0;!1===i.adhoc?s.children[3+a].visible=!1:s.children[3+a].visible=!0,this.updateChildMargin(s,o,r,n,3+a)},e.prototype.updateBPMNSubProcessBoundary=function(t,e){t.shape;var i=t.wrapper.children[0].children[0].children[0];"Default"===e.boundary&&(i.style.strokeWidth=1,i.style.strokeDashArray="1 0"),"Call"===e.boundary&&(i.style.strokeWidth=4,i.style.strokeDashArray="1 0"),"Event"===e.boundary&&(i.style.strokeWidth=1,i.style.strokeDashArray="2 2")},e.prototype.updateElementVisibility=function(t,e,i){if(t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length>0)for(var n=t.shape.activity.subProcess.processes,o=n.length-1;o>=0;o--){var r=i.nameTable[n[o]];r.visible=e,i.updateElementVisibility(r.wrapper,r,e),e&&("Event"===r.shape.shape&&this.setEventVisibility(r,r.wrapper.children[0].children),"SubProcess"===r.shape.activity.activity&&this.setSubProcessVisibility(r));for(var s=r.inEdges.concat(r.outEdges),a=s.length-1;a>=0;a--){var l=i.nameTable[s[a]];l.visible=e,i.updateElementVisibility(l.wrapper,l,e)}}e&&("Event"===t.shape.shape&&this.setEventVisibility(t,t.wrapper.children[0].children),"SubProcess"===t.shape.activity.activity&&this.setSubProcessVisibility(t),"Task"===t.shape.activity.activity&&"Activity"===t.shape.shape&&"None"===t.shape.activity.subProcess.loop&&(t.wrapper.children[0].children[0].children[3].visible=!1))},e.prototype.updateBPMNSubProcessCollapsed=function(t,e,i,n,o,r,s){var a=t.shape.activity.subProcess.events.length,l=t.wrapper.children[0].children[0],h="Transaction"===t.shape.activity.subProcess.type?3:1;!1===i.collapsed?(this.updateElementVisibility(t,!0,s),l.children[h+a].visible=!1):(this.updateElementVisibility(t,!1,s),l.children[h+a].visible=!0),this.updateChildMargin(l,o,r,n,3+a)},e.prototype.updateBPMNSubProcessCompensation=function(t,e,i,n,o,r){var s=t.wrapper.children[0].children[0],a="Transaction"===t.shape.activity.subProcess.type?2:0;!1===i.compensation?s.children[4+a].visible=!1:s.children[4+a].visible=!0,this.updateChildMargin(s,o,r,n,4+a)},e.prototype.updateBPMNSubProcessLoop=function(t,e,i,n,o,r){this.updateBPMNActivityTaskLoop(t,t,n,o,r,1)},e.prototype.updateBPMNConnector=function(t,e,i,n){var o=i.shape;return void 0!==o.sequence&&(t=this.getSequence(t,e,i,n)),void 0!==o.association&&(t=this.getAssociation(t,e,i,n)),void 0!==o.message&&(t=this.getMessage(t,e,i,n)),t},e.prototype.getSequence=function(e,i,n,o){if("Normal"===n.shape.sequence&&(o.connectorPropertyChange(e,i,{type:"Straight",targetDecorator:{shape:"Arrow",style:{fill:"black"}}}),e.wrapper.children[3].visible=!1),"Default"===n.shape.sequence){o.connectorPropertyChange(e,i,{type:"Straight",targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"None"}});var r=new sh,s=(new sh,void 0);r=e.getSegmentElement(e,r);for(var a=e.intermediatePoints,l=0;l<a.length-1;l++)length+=e.distance(a[l],a[l+1]),s=e.findPath(a[l],a[l+1]);e.wrapper.children[3].data=s[0],e.wrapper.children[3].id=e.id+"_"+n.shape.sequence,e.wrapper.children[3].offsetX=s[1].x,e.wrapper.children[3].offsetY=s[1].y,e.wrapper.children[3].rotateAngle=45,e.wrapper.children[3].transform=t.Transform.Self}return"Conditional"===n.shape.sequence&&(o.connectorPropertyChange(e,i,{type:"Straight",targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"Diamond",width:20,height:10,style:{fill:"white"}}}),e.wrapper.children[3].visible=!1),e},e.prototype.getAssociation=function(t,e,i,n){return"Default"===i.shape.association&&n.connectorPropertyChange(t,e,{type:"Straight",style:{strokeDashArray:"None"},targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"None"}}),"Directional"===i.shape.association&&n.connectorPropertyChange(t,e,{type:"Straight",style:{strokeDashArray:"2 2"},targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"None"}}),"BiDirectional"===i.shape.association&&n.connectorPropertyChange(t,e,{type:"Straight",style:{strokeDashArray:"2 2"},targetDecorator:{shape:"Arrow",style:{fill:"black"}},sourceDecorator:{shape:"Arrow",width:5,height:10,style:{fill:"white"}}}),t},e.prototype.getMessage=function(e,i,n,o){var r,s;if("Default"===i.shape.message){if(void 0!==n.shape.message){if("InitiatingMessage"===n.shape.message||"NonInitiatingMessage"===n.shape.message){var a=new sh;a=e.getSegmentElement(e,a);for(var l=e.intermediatePoints,h=0;h<l.length-1;h++){length+=e.distance(l[h],l[h+1]);var c=.5*length;length>=c&&(r=Ui(l[h],l[h+1]),s=Dl.transform(l[h],r,c))}}e.wrapper.children[3].id=e.id+"_"+n.shape.message,e.wrapper.children[3].width=25,e.wrapper.children[3].height=15,e.wrapper.children[3].data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",e.wrapper.children[3].horizontalAlignment="Center",e.wrapper.children[3].verticalAlignment="Center",e.wrapper.children[3].transform=t.Transform.Self,e.wrapper.children[3].style.fill="NonInitiatingMessage"===n.shape.message?"lightgrey":"white",e.wrapper.children[3].offsetX=s.x,e.wrapper.children[3].offsetY=s.y}}else"NonInitiatingMessage"===i.shape.message&&"InitiatingMessage"===i.shape.message||("Default"!==n.shape.message?e.wrapper.children[3].style.fill="NonInitiatingMessage"===n.shape.message?"lightgrey":"white":e.wrapper.children[3].visible=!1);return e},e.prototype.setSizeForBPMNEvents=function(t,e,i,n){e.children[0].width=i,e.children[0].height=n;var o=e.children[1];o.width=.85*i,o.height=.85*n;var r=e.children[2];"Message"===t.trigger?(r.width=.54*i,r.height=.4*n):(r.width=.5*i,r.height=.5*n)},e.prototype.updateAnnotationDrag=function(t,e,i,n){var o=t.id.split("_");if("textannotation"===o[1])for(var r=void 0,s=0;s<t.inEdges.length;s++){var a=e.nameTable[t.inEdges[s]];a&&(r=e.nameTable[a.sourceID]);var l={x:t.offsetX+i,y:t.offsetY+n},h=a.sourcePoint,c=Dl.findLength(l,h),d=Dl.findAngle(h,l);if(r.shape.annotations)for(var p=0;p<r.shape.annotations.length;p++)if(r.shape.annotations[p].id===o[o.length-1])return r.shape.annotations[p].length=c,r.shape.annotations[p].angle=d,this.setAnnotationPath(r.wrapper.bounds,t.wrapper,l,t),!1}return!!t.processId&&(this.drag(t,i,n,e),!0)},e.prototype.getAnnotationPathAngle=function(t,e){var i=0;switch(Sn(t,e,e,!1)){case"Right":i=0;break;case"Left":i=180;break;case"Bottom":i=90;break;case"Top":i=270}return i},e.prototype.setSizeForBPMNGateway=function(t,e,i,n){e.children[0].width=i,e.children[0].height=n,e.children[1].width=.45*i,e.children[1].height=.45*n},e.prototype.setSizeForBPMNDataObjects=function(t,e,i,n){e.children[0].width=i,e.children[0].height=n},e.prototype.setSizeForBPMNActivity=function(t,e,i,n,o){e.children[0].width=i,e.children[0].height=n,e.children[0].children[0].width=i,e.children[0].children[0].height=n,"Transaction"===t.subProcess.type&&(e.children[0].children[1].width=Math.max(i-6,1),e.children[0].children[1].height=Math.max(n-6,1),e.children[0].children[2].width=i,e.children[0].children[2].height=n);var r,s,a=new Wl,l=this.getSize(o,a),h=12*(s="Task"===t.activity?this.getTaskChildCount(o):this.getSubprocessChildCount(o)),c=(i||l.width)/2;r=1===s?c-6:c-h/2-4*(s-1)/2;for(var d=0;d<e.children[0].children.length;d++)e.children[0].children[d].visible&&(e.children[0].children[d].id.indexOf("_loop")>-1||e.children[0].children[d].id.indexOf("_0_compensation")>-1||e.children[0].children[d].id.indexOf("_0_adhoc")>-1||e.children[0].children[d].id.indexOf("_0_collapsed")>-1)&&(e.children[0].children[d].margin.left=r,r+=e.children[0].children[d].actualSize.width+4)},e.prototype.updateDiagramContainerVisibility=function(t,e){if(t instanceof oh)for(var i=0;i<t.children.length;i++)this.updateDiagramContainerVisibility(t.children[i],e);t.visible=e},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"Bpmn"},e}(),Im={Event:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Message:"M0,0L19.8,12.8L40,0L0,0L0,25.5L40,25.5L40,0z",DataSource:"M 0 10.6 c 0 5.9 16.8 10.6 37.5 10.6 S 75 16.4 75 10.6 v 0 v 68.9 v -0.1 C 75 85.3 58.2 90 37.5 90 S 0 85.3 0 79.4 l 0 0.1 V 56 V 40.6 L 0 10.6 C 0 4.7 16.8 0 37.5 0 S 75 4.7 75 10.6 S 58.2 21.2 37.5 21.2S 0 16.5 0 10.6 l 0 6.7 v -0.2 c 0 5.9 16.8 10.6 37.5 10.6 S 75 22.9 75 17.1 v 6.8 v -0.1 c 0 5.9 -16.8 10.6 -37.5 10.6 S 0 29.6 0 23.8",SubProcess:"M100,100 h200 a20,20 0 0 1 20,20 v200 a20,20 0 0 1 -20,20 h-200 a20,20 0 0 1 -20,-20 v-200 a20,20 0 0 1 20,-20 z",collapsedShape:"M 8.13789 15 H 0 V 0 H 8.13789 V 15 Z M 0.625991 13.75 H 7.51189 V 1.25 H 0.625991 V 13.75 Z M 2.18095 7.03125 L 5.95631 7.03125 L 5.95631 7.46875 L 2.18095 7.46875 Z M 3.8342 3.73 L 4.30369 3.73 L 4.30369 11.2687 L 3.8342 11.2687 Z"},Dm={Message:"M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",Timer:"M40,20c0,8.654-5.496,16.024-13.189,18.81C24.685,39.58,22.392,40,20,40C8.954,40,0,31.046,0,20S8.954,0,20,0S40,8.954,40,20z M20,0 L20,2.583 L20,5.283 M10.027,2.681L11.659,5.507 L12.669,7.257 M2.731,9.989 L6.014,11.885 L7.307,12.631 M0.067,19.967 L2.667,19.967 L5.35,19.967M2.748,29.939 L5.731,28.217 L7.323,27.298 M10.056,37.236 L11.292,35.095 L12.698,32.66 M20.033,39.9 L20.033,36.417 L20.033,34.617M30.006,37.219 L28.893,35.292 L27.364,32.643 M37.302,29.911 L34.608,28.355 L32.727,27.269M39.967,19.933 L37.417,19.933 L34.683,19.933 M37.286,9.961 L34.583,11.521 L32.71,12.602 M29.977,2.664 L28.653,4.957 L27.336,7.24 M22.104,8.5 L19.688,20 L24.75,20 L31.604,20 L24.75,20 L19.688,20z",Error:"M 23.77 18.527 l -7.107 27.396 l 8.507 -17.247 L 36.94 40.073 l 6.394 -25.997 l -8.497 15.754 L 23.77 18.527 Z",Escalation:"M 30.001 8.098 L 11.842 43.543 l 18.159 -18.882 l 18.162 18.882 L 30.001 8.098 Z ",Cancel:"M 3.5 16 L 0 12.6 L 4.6 8 L 0 3.5 L 3.4 0 L 8 4.6 l 4.5 -4.5 L 16 3.5 L 11.5 8 l 4.5 4.5 l -3.4 3.5 L 8 11.4 L 3.5 16 Z",Compensation:"M 25.7086 0 L 0 25 L 25.7086 50 V 26.3752 L 50 50 V 0 L 25.7086 23.6248 V 0 Z ",Conditional:"M 0 0 H 16 V 16 H 0 z M 1.14 3.2 H 14.85 M 1.14 6.4 H 14.85 M 1.14 9.6 H 14.85 M 1.14 12.8 H 14.85",Link:"M 32.014 19.258 v 5.992 H 9.373 v 9.504 h 22.641 v 5.988 L 50.622 30 L 32.014 19.258 Z",Signal:"M 50 50 H 0 L 25.0025 0 L 50 50 Z",Terminate:"M 25 50 C 11.21 50 0 38.79 0 25 C 0 11.21 11.21 0 25 0 C 38.78 0 50 11.21 50 25 C 50 38.79 38.78 50 25 50",Multiple:"M 17.784 48.889 H 42.21 l 7.548 -23.23 L 29.997 11.303 L 10.236 25.658 L 17.784 48.889 Z",Parallel:"M 27.276 49.986 h 5.58 v -17.15 h 17.146 V 27.17 h -17.15 l 0.004 -17.15 h -5.58 l -0.004 17.15 H 9.994 v 5.666 h 17.278 L 27.276 49.986 Z"},Rm={None:"",Exclusive:"M 11.196 29.009 l 6.36 -9.712 l -5.764 -8.899 h 4.393 l 3.732 5.979 l 3.656 -5.979 h 4.354 l -5.789 9.039l 6.36 9.572 h -4.532 l -4.126 -6.437 l -4.139 6.437 H 11.196 Z",Inclusive:"M 20.323 31.333 c -6.625 0 -12.015 -5.39 -12.015 -12.015 s 5.39 -12.015 12.015 -12.015 s 12.016 5.39 12.016 12.015 S 26.948 31.333 20.323 31.333 Z M 20.323 9.303 c -5.522 0 -10.015 4.493 -10.015 10.015 s 4.492 10.015 10.015 10.015 s 10.016 -4.493 10.016 -10.015 S 25.846 9.303 20.323 9.303 Z",Parallel:"M 18.394 29.542 v -8.833 H 9.626 v -3.691 h 8.768 V 8.251 h 3.734 v 8.767 h 8.768 v 3.691 h -8.768 v 8.833 H 18.394 Z",Complex:"M29.198,19.063L23.089,19.063L27.794,14.358L26.38,12.944L21.223,18.101L21.223,10.443L19.223,10.443L19.223,17.976L14.022,12.776L12.608,14.19L17.48,19.063L10.365,19.063L10.365,21.063L18.261,21.063L12.392,26.932L13.806,28.346L19.223,22.929L19.223,30.225L21.223,30.225L21.223,22.805L25.925,27.507L27.339,26.093L22.309,21.063L29.198,21.063z",EventBased:"M 20.322 29.874 c -5.444 0 -9.873 -4.43 -9.873 -9.874 s 4.429 -9.874 9.873 -9.874 s 9.874 4.429 9.874 9.874 S 25.767 29.874 20.322 29.874 Z M 20.322 32.891 c -7.107 0 -12.89 -5.783 -12.89 -12.891 c 0 -7.107 5.782 -12.89 12.89 -12.89 c 7.108 0 12.891 5.783 12.891 12.89 C 33.213 27.108 27.431 32.891 20.322 32.891 Z M 24.191 25.386 h -7.984 l -2.469 -7.595 l 6.461 -4.693 l 6.461 4.693 L 24.191 25.386 Z",ExclusiveEventBased:"M 30 15 C 30 23.28 23.28 30 15 30 S 0 23.28 0 15 S 6.72 0 15 0 S 30 6.72 30 15 z M 15 5 L 5 12.5 L 8 22.5 H 22 L 25 12.5 z",ParallelEventBased:"M 35 17.5 C 35 27.16 27.16 35 17.5 35 S 0 27.16 0 17.5 S 7.84 0 17.5 0 S 35 7.84 35 17.5 z M 14.58 5.83 V 14.58 H 5.83 V 20.42 H 14.58 V 29.17 H 20.42 V 20.42 H 29.17 V 14.58 H 20.42 V 5.83 z"},Nm={None:"",Service:"M 32.699 20.187 v -4.005 h -3.32 c -0.125 -0.43 -0.292 -0.83 -0.488 -1.21 l 2.373 -2.375 l -2.833 -2.83 l -2.333 2.333 c -0.44 -0.253 -0.9 -0.448 -1.387 -0.595 v -3.32 h -4.003 v 3.32 c -0.46 0.137 -0.890.322 -1.3 0.537 l -2.285 -2.275 l -2.833 2.83 l 2.285 2.278 c -0.235 0.42 -0.41 0.847 -0.547 1.307 h -3.33 v 4.005 h 3.33 c 0.148 0.488 0.343 0.955 0.588 1.395 l -2.325 2.325 l 2.822 2.832 l 2.373 -2.382 c 0.392 0.205 0.792 0.37 1.212 0.497 v 3.33 h 4.003 v -3.33 c 0.46 -0.138 0.89 -0.323 1.3 -0.547 l 2.43 2.432 l 2.822 -2.832 l -2.42 -2.422 c 0.222 -0.41 0.4 -0.85 0.535-1.297 H 32.699 Z M 22.699 21.987 c -2.1 0 -3.803 -1.703 -3.803 -3.803 c 0 -2.1 1.703 -3.803 3.803 -3.803 c 2.1 0 3.803 1.703 3.803 3.803 C 26.502 20.285 24.8 21.987 22.699 21.987 Z",Receive:"M 12.217 12.134 v 13.334 h 20 V 12.134 H 12.217 Z M 30.44 13.007 l -8.223 5.35 l -8.223 -5.35 H 30.44 Z M 13.09 24.594 V 13.459 l 9.127 5.94 l 9.127 -5.94 v 11.135 H 13.09 Z",Send:"M 45.7256 3.16055 L 25 23.4017 L 4.27442 3.16055 H 45.7256 Z M 47.8963 46.8413 H 2.10375 V 4.80813 L 25 27.1709 L 47.8963 4.80813 V 46.8413 Z",InstantiatingReceive:"M 16.306 17.39 v 8.79 h 13.198 v -8.79 H 16.306 Z M 28.375 17.946 l -5.47 3.558 l -5.47 -3.558 H 28.375 Z M 28.948 25.625 H 16.861 v -7.389 l 6.043 3.931 l 6.043 -3.931 V 25.625 Z M 22.905 11.785c -5.514 0 -9.999 4.486 -9.999 10 c 0 5.514 4.485 10 9.999 10 s 9.999 -4.486 9.999 -10 C 32.904 16.272 28.419 11.785 22.905 11.785 Z M 22.905 31.239 c -5.212 0 -9.453 -4.241 -9.453 -9.454c 0 -5.212 4.241 -9.453 9.453 -9.453 s 9.452 4.241 9.452 9.453 C 32.357 26.998 28.117 31.239 22.905 31.239 Z",Manual:"M 13.183 15.325 h 2.911 c 0.105 0 0.207 -0.043 0.281 -0.117 c 0.078 -0.074 0.117 -0.176 0.117 -0.281c 0 -0.753 0.718 -1.362 1.596 -1.362 h 2.579 c -0.117 0.227 -0.191 0.48 -0.195 0.757 c 0 0.433 0.168 0.851 0.46 1.144 c 0.008 0.004 0.015 0.011 0.019 0.015 c -0.289 0.285 -0.475 0.691 -0.479 1.148 c 0 0.433 0.168 0.846 0.46 1.139 c 0.011 0.012 0.023 0.02 0.035 0.032 c -0.301 0.281 -0.491 0.694 -0.495 1.155 c 0 0.432 0.168 0.847 0.46 1.143c 0.265 0.266 0.612 0.414 0.975 0.414 h 0.839 c 0.027 0.004 0.051 0.012 0.074 0.012 h 8.443 c 0.352 0 0.636 0.344 0.636 0.761 c 0 0.414 -0.285 0.753 -0.636 0.753 h -6.687 c -0.019 0 -0.035 -0.008 -0.051 -0.008h -2.27 c -0.121 -0.835 -0.667 -1.187 -1.795 -1.187 h -2.158 c -0.223 0 -0.402 0.18 -0.402 0.403c 0 0.219 0.179 0.398 0.402 0.398 h 2.158 c 0.972 0 1.019 0.203 1.019 0.784 c 0 0.219 0.179 0.399 0.402 0.399 c 0.008 0 0.016 -0.004 0.027 -0.004 c 0.028 0.004 0.055 0.016 0.082 0.016 h 2.56 c 0.34 0.015 0.616 0.343 0.616 0.752c 0 0.418 -0.285 0.757 -0.636 0.761 h -0.004 h -6.442 c -0.878 0 -1.595 -0.639 -1.595 -1.427 v -0.683 c 0 -0.109 -0.043 -0.211 -0.114 -0.285 c -0.078 -0.074 -0.179 -0.117 -0.285 -0.117 h -0.004 l -2.989 0.027 c -0.223 0 -0.398 0.184 -0.398 0.402 c 0 0.219 0.179 0.395 0.398 0.395 h 0.004 l 2.591 -0.02 v 0.282 c 0 1.229 1.073 2.223 2.391 2.223 h 3.895 c 0.004 0 0.007 0.004 0.011 0.004 h 2.536 c 0.792 0 1.436 -0.698 1.436 -1.561 c 0 -0.273 -0.07 -0.53 -0.188 -0.752 h 5.49 c 0.792 0 1.436 -0.695 1.436 -1.553 c 0 -0.858 -0.644 -1.557 -1.436 -1.557h -3.566 c 0.121 -0.226 0.199 -0.487 0.199 -0.768 c 0 -0.468 -0.195 -0.882 -0.495 -1.167c 0.301 -0.285 0.495 -0.698 0.495 -1.163 c 0 -0.456 -0.191 -0.866 -0.483 -1.152 c 0.293 -0.285 0.483 -0.694 0.483 -1.151c 0 -0.858 -0.647 -1.557 -1.439 -1.557 h -8.373 c -1.167 0 -2.142 0.757 -2.352 1.76 l -2.548 -0.004 c -0.219 0 -0.399 0.18 -0.399 0.403 C 12.784 15.145 12.964 15.325 13.183 15.325 L 13.183 15.325 Z M 21.907 19.707 c -0.191 0 -0.328 -0.094 -0.41 -0.176 c -0.144 -0.145 -0.226 -0.355 -0.226 -0.577 c 0.003 -0.418 0.289 -0.753 0.643 -0.753 h 4.468 c 0.008 0 0.015 -0.004 0.027 -0.008 h 0.051 c 0.351 0 0.636 0.344 0.636 0.761 c 0 0.414 -0.286 0.753 -0.636 0.753 H 21.907 Z M 27.097 16.629 c 0 0.414 -0.286 0.753 -0.64 0.753 h -4.464 c -0.004 0 -0.004 0 -0.004 0 h -0.082c -0.191 0 -0.328 -0.098 -0.414 -0.18 c -0.14 -0.145 -0.222 -0.352 -0.222 -0.573 c 0 -0.413 0.285 -0.749 0.631 -0.753h 3.434 c 0 0 0 0 0.004 0 h 1.116 c 0.008 0 0.012 -0.004 0.02 -0.004 C 26.819 15.887 27.097 16.215 27.097 16.629L 27.097 16.629 Z M 27.097 14.322 c 0 0.41 -0.278 0.737 -0.62 0.749 c -0.008 0 -0.012 0 -0.016 0 h -3.637 c -0.008 0 -0.015 0.004 -0.023 0.004 h -0.886 c -0.004 0 -0.008 0 -0.012 0 c -0.187 0 -0.324 -0.094 -0.406 -0.176c -0.144 -0.144 -0.226 -0.355 -0.226 -0.577 c 0.003 -0.414 0.293 -0.753 0.643 -0.753 h 4.468 c 0.008 0 0.015 -0.004 0.027 -0.004 h 0.051 C 26.811 13.565 27.097 13.905 27.097 14.322 L 27.097 14.322 Z M 27.097 14.322",BusinessRule:"M 32.844 13.245 h -0.089 v 0 H 13.764 v -0.015 h -1.009 v 16.989 h 0.095 v 0.011 h 19.716 v -0.011 h 0.278 V 13.245 Z M 31.844 14.229 v 4.185 h -18.08 v -4.185 H 31.844 Z M 18.168 25.306 v 3.938 h -4.404 v -3.938 H 18.168 Z M 13.764 24.322 v -4.923 h 4.404 v 4.923 H 13.764 Z M 19.177 25.306 h 12.667 v 3.938 H 19.177 V 25.306 Z M 19.177 24.322v -4.923 h 12.667 v 4.923 H 19.177 Z",User:"M 21.762 21.935 c 2.584 0 4.687 -2.561 4.687 -5.703 c 0 -3.147 -2.103 -5.703 -4.687 -5.703 c -1.279 0 -2.475 0.61-3.363 1.721 c -0.855 1.071 -1.327 2.484 -1.324 3.983 C 17.075 19.374 19.178 21.935 21.762 21.935 L 21.762 21.935 ZM 21.762 11.779 c 1.894 0 3.436 1.995 3.436 4.452 c 0 2.453 -1.541 4.452 -3.436 4.452 c -1.895 0 -3.44 -1.999 -3.44 -4.452C 18.323 13.774 19.864 11.779 21.762 11.779 L 21.762 11.779 Z M 25.699 21.309 c -0.348 0 -0.626 0.277 -0.626 0.626 c 0 0.344 0.277 0.622 0.626 0.622 c 2.136 0 3.875 1.74 3.875 3.879 c 0 0.272 -0.227 0.498 -0.501 0.498 H 14.447 c -0.274 0 -0.497 -0.223 -0.497 -0.498 c 0 -2.139 1.736 -3.879 3.872 -3.879 c 0.344 0 0.625 -0.277 0.625 -0.622 c 0 -0.348 -0.28 -0.626-0.625 -0.626 c -2.826 0 -5.124 2.297 -5.124 5.126 c 0 0.965 0.784 1.749 1.748 1.749 h 14.626 c 0.964 0 1.748 -0.7841.748 -1.749 C 30.822 23.606 28.524 21.309 25.699 21.309 L 25.699 21.309 Z M 22.217 9.832 c 0.448 -0.263 0.924 -0.396 1.419 -0.396 c 1.895 0 3.436 1.995 3.436 4.452 c 0 0.439 -0.048 0.873 -0.143 1.284 c -0.08 0.336 0.128 0.672 0.464 0.751 c 0.048 0.012 0.098 0.019 0.143 0.019 c 0.284 0 0.541 -0.195 0.608 -0.483 c 0.119 -0.506 0.18 -1.034 0.18 -1.571c 0 -3.147 -2.102 -5.703 -4.687 -5.703 c -0.711 0 -1.419 0.198 -2.054 0.573 c -0.296 0.174 -0.397 0.559 -0.219 0.855C 21.536 9.911 21.921 10.009 22.217 9.832 L 22.217 9.832 Z M 27.697 18.81 c -0.345 0 -0.626 0.277 -0.626 0.622 c 0 0.348 0.281 0.626 0.626 0.626 c 2.137 0 3.75 1.782 3.75 3.918 c 0 0.07 -0.013 0.141 -0.043 0.205 c -0.14 0.314 0.0030.684 0.318 0.823 c 0.082 0.037 0.167 0.055 0.253 0.055 c 0.241 0 0.466 -0.141 0.57 -0.373 c 0.101 -0.226 0.153 -0.464 0.153-0.714 C 32.699 21.15 30.523 18.81 27.697 18.81 L 27.697 18.81 Z M 27.697 18.81",Script:"M 22.453 15.04 c 0 0 -1.194 -3.741 2.548 -3.774 c 0 0 2.497 0.126 1.766 4.321 c -0.008 0.043 -0.015 0.086 -0.024 0.13c -0.806 4.323 -2.516 8.42 -3.193 10.581 h 3.904 c 0 0 0.983 4.581 -2.549 4.968 H 13.292 c 0 0 -3.097 -1.42 -1.517 -5.323 l 3 -10.839 H 11.84 c 0 0 -1.129 -2.902 1.709 -3.806 l 11.425 -0.032 l -0.73 0.355 l -1.193 1.726 L 22.453 15.04 Z M 22.409 12.597 c 0 0 -0.242 0.483 -0.278 0.98 h -9.098 c 0 0 -0.06 -0.871 0.714 -1.041 L 22.409 12.597 Z M 26.341 27.734c 0 0 -0.13 2.678 -2.226 1.871 c 0 0 -0.823 -0.565 -0.758 -1.855 L 26.341 27.734 Z M 22.905 15.008 c 0 0 0.653 -0.258 0.709-1.501 c 0 0 0.145 -1.144 1.483 -0.693 c 0 0 0.808 0.355 0.259 2.404 c 0 0 -2.226 8.5 -3.032 10.339 c 0 0 -1.064 2.646 0.096 4.226 h -8.581 c 0 0 -1.806 -0.452 -0.741 -3.613 c 0 0 2.935 -9.549 3.193 -11.162 L 22.905 15.008 Z"},Bm={None:"",Standard:"M 52.002 73.379 c -2.494 -2.536 -6.55 -2.534 -9.043 0 c -1.208 1.228 -1.874 2.861 -1.874 4.598 c 0 1.225 0.337 2.395 0.957 3.411 l -1.167 1.186 l 2.071 0.458 l 2.071 0.458 l -0.45 -2.106 l -0.45 -2.106 l -1.292 1.314c -1.119 -2.065 -0.842 -4.709 0.877 -6.458 c 2.084 -2.119 5.475 -2.117 7.557 0 c 2.083 2.119 2.083 5.565 0 7.685c -0.976 0.992 -2.272 1.557 -3.65 1.59 l 0.025 1.068 c 1.65 -0.041 3.2 -0.716 4.368 -1.903 c 1.208 -1.228 1.874 -2.861 1.874 -4.597 C 53.875 76.24 53.209 74.607 52.002 73.379 Z",ParallelMultiInstance:"M 51.5,69.5 L52.5,69.5 L52.5,84.5 L51.5 84.5 Z M 46.5,69.5 L47.5,69.5 L47.5,84.5 L46.5 84.5 Z M 41.5,69.5 L42.5,69.5 L42.5,84.5 L41.5 84.5 Z  ",SequenceMultiInstance:"M 40.375,71.5 L 55.375,71.5 L 55.375,72.5 L 40.375,72.5 Z M 40.375,76.5 L 55.375,76.5 L 55.375,77.5 L 40.375,77.5 Z M 40.375,76.5 L 55.375,76.5 L 55.375,77.5 L 40.375,77.5 Z M 40.375,81.5 L 55.375,81.5L 55.375,82.5 L 40.375,82.5 Z"},Hm=function(){function t(){}return t.prototype.updateBridging=function(t,e){var i,n=[];if(t.bridges=[],Nn(t,e)){var o=this.getPoints(t);i=Rl.toBounds(o);for(var r=t.bridgeSpace,s=e.bridgeDirection,a=-1,l=e.connectors,h=0;h<l.length;h++){var c=l[h];if(t&&c&&t.id!==c.id){var d=this.getPoints(c),p=Rl.toBounds(d);if(this.intersectsRect(i,p)){var u=this.intersect(o,d,!1,s,!0);if(u.length>0)for(var g=0;g<u.length;g++){var m=0,f=0,v=0,y=this.getLengthAtFractionPoint(t,u[g]);if(-1!==y.pointIndex){m=y.lengthFractionIndex,y.fullLength,f=y.segmentIndex,v=y.pointIndex;var b=this.getPointAtLength(m-r/2,o),w=this.getPointAtLength(m+r/2,o);this.isEmptyPoint(w)&&(w=b);var x=void 0,C=void 0;x=t.sourcePoint,C="Straight"===t.type?t.targetPoint:t.intermediatePoints[v];var S=this.angleCalculation(x,C);if(n.length){var E=void 0;E=t.sourcePoint;var P=Math.abs(this.lengthCalculation(E,w)),L=0,T=-1;a=-1;for(var k=0;k<n[f].bridges.length;k++){a++;var O=n[f].bridges[k];if(L=Math.abs(this.lengthCalculation(E,O.endPoint)),P<L){T=a;break}}if(T>=0){A=void 0;(A=this.createSegment(b,w,S,s,v,t,e)).target=c.id,n[f].bridges.splice(T,0,A),n[f].bridges.join(),n[f].bridgeStartPoint.splice(T,0,b),n[f].bridgeStartPoint.join(),n[f].segmentIndex=f}else{var A=void 0;(A=this.createSegment(b,w,S,s,v,t,e)).target=c.id,n[f].bridges.push(A),n[f].bridgeStartPoint.push(b),n[f].segmentIndex=f}}else if(!isNaN(b.x)&&!isNaN(b.y)&&!this.isEmptyPoint(w)){var M=void 0,I={bridges:[],bridgeStartPoint:[],segmentIndex:f};(M=this.createSegment(b,w,S,s,v,t,e)).target=c.id;var D=[],R=[];D.push(b),R.push(w),n[f]=I,n[f].bridges.push(M),n[f].bridgeStartPoint=D,n[f].segmentIndex=f}}}}}}0!==n.length&&this.firstBridge(n,t,r)}},t.prototype.firstBridge=function(t,e,i){for(var n=0;n<t.length;n++){for(var o=t[n],r=1;r<o.bridges.length;r++)if(Dl.findLength(o.bridges[r].endPoint,o.bridges[r-1].endPoint)<i){o.bridges[r-1].endPoint=o.bridges[r].endPoint;var s=o.bridges[r-1],a=this.createBridgeSegment(s.startPoint,s.endPoint,s.angle,i,s.sweep);o.bridges[r-1].path=a,o.bridges.splice(r,1),o.bridgeStartPoint.splice(r,1),r--}e.sourcePoint;for(var l=0;l<o.bridges.length;l++)(s=o.bridges[l]).endPoint,e.bridges.push(s)}},t.prototype.createSegment=function(t,e,i,n,o,r,s){var a,l,h={angle:0,endPoint:{x:0,y:0},target:"",path:"",segmentPointIndex:-1,startPoint:{x:0,y:0},sweep:1,rendered:!1};return l=this.sweepDirection(i,n,r,s),a=this.createBridgeSegment(t,e,i,r.bridgeSpace,l),h.path=a,h.startPoint=t,h.endPoint=e,h.angle=i,h.segmentPointIndex=o,h.sweep=l,h},t.prototype.createBridgeSegment=function(t,e,i,n,o){return"A "+n/2+" "+n/2+" "+i+" , 1 "+o+" "+e.x+","+e.y},t.prototype.sweepDirection=function(t,e,i,n){var o,r=Math.abs(t);switch(e){case"Top":case"Bottom":o=1,r>=0&&r<=90&&(o=0);break;case"Left":case"Right":o=1,t<0&&t>=-180&&(o=0)}return"Right"!==e&&"Bottom"!==e||(o=0===o?1:0),o},t.prototype.getPointAtLength=function(t,e){for(var i,n=0,o={x:0,y:0},r=0;r<e.length;r++){var s=e[r];if(i){var a=this.lengthCalculation(i,s);if(n+a>t){var l=t-n,h=Dl.findAngle(i,s),c=l*Math.cos(h*Math.PI/180),d=l*Math.sin(h*Math.PI/180);o={x:i.x+c,y:i.y+d};break}n+=a,i=s}else i=s}return o},t.prototype.getPoints=function(t){var e=[];if(t.intermediatePoints&&("Straight"===t.type||"Orthogonal"===t.type))for(var i=0;i<t.intermediatePoints.length;i++)e.push(t.intermediatePoints[i]);return e},t.prototype.intersectsRect=function(t,e){return e.x<t.x+t.width&&t.x<e.x+e.width&&e.y<t.y+t.height&&t.y<e.y+e.height},t.prototype.intersect=function(t,e,i,n,o){i&&e.length>=2&&(e.splice(0,1),e.splice(0,1));for(var r=[],s=0;s<t.length-1;s++){var a=this.inter1(t[s],t[s+1],e,o,n);if(a.length>0)for(var l=0;l<a.length;l++)r.push(a[l]);i&&e.length>=1&&e.splice(0,1)}return r},t.prototype.inter1=function(t,e,i,n,o){for(var r=[],s=0;s<i.length-1;s++){var a=this.intersect2(t,e,i[s],i[s+1]);if(!this.isEmptyPoint(a)){var l=this.angleCalculation(t,e),h=this.angleCalculation(i[s],i[s+1]);switch(l=this.checkForHorizontalLine(l),h=this.checkForHorizontalLine(h),o){case"Left":case"Right":l>h&&r.push(a);break;case"Top":case"Bottom":l<h&&r.push(a)}l===h&&n&&r.push(a)}}return r},t.prototype.checkForHorizontalLine=function(t){var e=Math.abs(t);return e>90?180-e:e},t.prototype.intersect2=function(t,e,i,n){var o={x:0,y:0},r=Po(this.getLineSegment(t.x,t.y,e.x,e.y),this.getLineSegment(i.x,i.y,n.x,n.y));return r.enabled?r.intersectPt:o},t.prototype.getLineSegment=function(t,e,i,n){return{X1:Number(t)||0,Y1:Number(e)||0,X2:Number(i)||0,Y2:Number(n)||0}},t.prototype.isEmptyPoint=function(t){return 0===t.x&&0===t.y},t.prototype.getLengthAtFractionPoint=function(t,e){for(var i=100,n=-1,o=0,r=-1,s=0,a=0,l=t.sourcePoint,h=l,c=[],d=0;d<t.intermediatePoints.length;d++){var p=t.intermediatePoints[d];c.push(p)}for(var u=0;u<c.length;u++){var g=c[u],m=this.getSlope(g,l,e,t);m<i&&(i=m,a=o+this.lengthCalculation(e,h),r=s,n=u),o+=Dl.findLength(g,l),l=g,h=g}return s++,{lengthFractionIndex:a,fullLength:o,segmentIndex:r,pointIndex:n}},t.prototype.getSlope=function(t,e,i,n){var o=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y),s=(i.y-t.y)/(e.y-t.y),a=(i.x-t.x)/(e.x-t.x);if(!isFinite(s)||!isFinite(a)||isNaN(s)||isNaN(a)){if(t.x===e.x){if(t.y===e.y)return 1e4;if(t.y>i.y&&i.y>e.y||t.y<i.y&&i.y<e.y)return Math.abs(t.x-i.x)}else if(t.y===e.y&&(t.x>i.x&&i.x>e.x||t.x<i.x&&i.x<e.x))return Math.abs(t.y-i.y)}else if((t.x>=i.x&&i.x>=e.x||t.x<=i.x&&i.x<=e.x||o<3)&&(t.y>=i.y&&i.y>=e.y||t.y<=i.y&&i.y<=e.y||r<3))return Math.abs(s-a);return 1e4},t.prototype.angleCalculation=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.atan2(n,i)*(180/Math.PI)},t.prototype.lengthCalculation=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Bridging"},t}(),zm=function(){function e(t){this.line=[],this.diagram=t}return e.prototype.canSnap=function(){return 0!=(this.diagram.snapSettings.constraints&(t.SnapConstraints.SnapToObject|t.SnapConstraints.SnapToLines))},e.prototype.snapPoint=function(e,i,n,o,r,s,a){var l=this.diagram.snapSettings,h={x:0,y:0},c=Xr(i.wrapper),d={snapped:!1,offset:0},p={snapped:!1,offset:0};if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject){var u=void 0;(u=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id","_SnappingLines"),u.setAttribute("shapeRendering","crispEdges"),br(this.diagram.element.id).appendChild(u),this.snapObject(e,i,u,d,p,r,s===a)}var g=c.x+r.x,m=c.y+r.y,f=c.x+c.width+r.x,v=c.y+c.height+r.y,y=l.verticalGridlines.scaledIntervals,b=this.round(f,y,1),w=this.round(g,y,1);y=l.horizontalGridlines.scaledIntervals;var x=this.round(m,y,1),C=this.round(v,y,1),S=c.x+c.width,E=c.y+c.height;return d.snapped?this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject?h.x=d.offset:h.x=a.x-s.x:this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToVerticalLines?Math.abs(r.x)>=1&&(n?Math.abs(b-S)>Math.abs(w-c.x)?h.x+=w-c.x:h.x+=b-S:Math.abs(b-S)<Math.abs(w-c.x)?h.x+=b-S:h.x+=w-c.x):h.x=a.x-s.x,p.snapped?h.y=p.offset:this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToHorizontalLines?Math.abs(r.y)>=1&&(o?Math.abs(C-E)>Math.abs(x-c.y)?h.y+=x-c.y:h.y+=C-E:Math.abs(C-E)<Math.abs(x-c.y)?h.y+=C-E:h.y+=x-c.y):h.y=a.y-s.y,h},e.prototype.round=function(t,e,i){i=i>1?Math.pow(2,Math.floor(Math.log(i)/Math.log(2))):Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)));var n=0,o=0;for(o=0;o<e.length;o++)n+=e[o];var r=t%(n/=i),s=Math.floor(Math.abs(t)/n)*n;if(s!==t)if(t>=0)for(o=0;o<e.length;o++){if(r<=e[o]/i)return s+(r<e[o]/(2*i)?0:e[o]/i);s+=e[o]/i,r-=e[o]/i}else for(s*=-1,o=e.length-1;o>=0;o--){if(Math.abs(r)<=e[o]/i)return s-(Math.abs(r)<e[o]/(2*i)?0:e[o]/i);s-=e[o]/i,r+=e[o]/i}return t},e.prototype.snapObject=function(t,e,i,n,o,r,s){var a,l,h,c=null,d=this.diagram.scroller,p=this.diagram.snapSettings,u=[],g=[],m=[],f=[],v=Xr(e.wrapper),y=t.scroller.currentZoom,b=-d.horizontalOffset,w=-d.verticalOffset,x=p.snapObjectDistance/y,C=new Rl(0,0,d.viewPortWidth,d.viewPortHeight),S=new Rl(b/y,v.y-x-5,C.width/y,v.height+2*x+10),E=new Rl(v.x-x-5,w/y,v.width+2*x+10,C.height/y);C=new Rl(b/y,w/y,C.width/y,C.height/y);var P,L,T,k=this.findNodes(t.spatialSearch,e,E,C),O=t.nameTable;for(P=0;P<k.length;P++)L=k[P],this.canBeTarget(t,L)&&(this.diagram.nameTable[L.id]instanceof _c||!this.canConsider(O,e,L)||((T=L.bounds).height+T.y<r.y+v.y?m.push({obj:L,distance:Math.abs(v.y+r.y-T.y-T.height)}):T.y>v.y+r.y+v.height&&f.push({obj:L,distance:Math.abs(v.y+r.y+v.height-T.y)}),(null==c||c>Math.abs(T.y-v.y-r.y))&&(Math.abs(T.x+T.width/2-(v.x+v.width/2+r.x))<=x?(l=this.createSnapObject(T,v,"centerX"),c=Math.abs(T.y-v.y)):Math.abs(T.x+T.width-(v.x+v.width+r.x))<=x?(l=this.createSnapObject(T,v,"right"),c=Math.abs(T.y-v.y)):Math.abs(T.x-(v.x+r.x))<=x?(l=this.createSnapObject(T,v,"left"),c=Math.abs(T.y-v.y)):Math.abs(T.x-(v.x+v.width+r.x))<=x?(l=this.createSnapObject(T,v,"rightLeft"),c=Math.abs(T.y-v.y)):Math.abs(T.x+T.width-(v.x+r.x))<=x&&(l=this.createSnapObject(T,v,"leftRight"),c=Math.abs(T.y-v.y)))));k=this.findNodes(t.spatialSearch,e,S,C);for(var A=0;A<k.length;A++)L=k[A],this.canBeTarget(t,L)&&(this.diagram.nameTable[L.id]instanceof _c||!this.canConsider(O,e,L)||((T=L.bounds).x+T.width<v.x+r.x&&(u[u.length]={obj:L,distance:Math.abs(v.x+r.x-T.x-T.width)}),T.x>v.x+r.x+v.width&&(g[g.length]={obj:L,distance:Math.abs(v.x+r.x+v.width-T.x)}),(null==a||a>Math.abs(T.x-v.x-r.x))&&(Math.abs(T.y+T.height/2-(v.y+v.height/2+r.y))<=x?(h=this.createSnapObject(T,v,"centerY"),a=Math.abs(T.x-v.x)):Math.abs(T.y-v.y-r.y)<=x?(h=this.createSnapObject(T,v,"top"),a=Math.abs(T.x-v.x)):Math.abs(T.y+T.height-(v.y+v.height+r.y))<=x?(h=this.createSnapObject(T,v,"bottom"),a=Math.abs(T.x-v.x)):Math.abs(T.y+T.height-v.y-r.y)<=x?(h=this.createSnapObject(T,v,"topBottom"),a=Math.abs(T.x-v.x)):Math.abs(T.y-(v.y+v.height+r.y))<=x&&(h=this.createSnapObject(T,v,"bottomTop"),a=Math.abs(T.x-v.x)))));this.createGuidelines(t,l,h,i,n,o,s),n.snapped||this.createHSpacingLines(t,i,e,u,g,n,o,s,r,x),o.snapped||this.createVSpacingLines(t,i,e,m,f,n,o,s,r,x)},e.prototype.snapConnectorEnd=function(e){var i=this.diagram.snapSettings;return i.constraints&t.SnapConstraints.SnapToLines&&(e.x=this.round(e.x,i.verticalGridlines.scaledIntervals,1),e.y=this.round(e.y,i.horizontalGridlines.scaledIntervals,1)),e},e.prototype.canBeTarget=function(t,e){return e=this.diagram.nameTable[e.id],!ms(this.diagram,e,!1)},e.prototype.snapSize=function(t,e,i,n,o,r,s,a){var l,h,c,d,p=this.diagram.snapSettings,u=this.diagram.scroller,g=Xr(s.wrapper),m=t.nameTable,f=[],v=[],y=t.scroller.currentZoom,b=-u.horizontalOffset,w=-u.verticalOffset,x=p.snapObjectDistance/y,C=new Rl(0,0,u.viewPortWidth,u.viewPortHeight),S=new Rl(b/y,(g.y-5)/y,C.width/y,(g.height+10)/y),E=new Rl((g.x-5)/y,w/y,(g.width+10)/y,C.height/y);C=new Rl(b/y,w/y,C.width/y,C.height/y);var P,L,T,k=[],O=this.findNodes(t.spatialSearch,s,E,C,k);for(P=0;P<O.length;P++)L=O[P],!this.canConsider(m,s,L)||this.diagram.nameTable[L.id]instanceof _c||(T=L.bounds,(null==l||l>Math.abs(T.y-g.y))&&(e.left?Math.abs(g.x+o-T.x)<=x?(c=this.createSnapObject(T,g,"left"),l=Math.abs(T.y-g.y)):Math.abs(g.x+o-T.x-T.width)<=x&&(c=this.createSnapObject(T,g,"leftRight"),l=Math.abs(T.y-g.y)):e.right&&(Math.abs(g.x+o+g.width-T.x-T.width)<=x?(c=this.createSnapObject(T,g,"right"),l=Math.abs(T.y-g.y)):Math.abs(g.x+o+g.width-T.x)<=x&&(c=this.createSnapObject(T,g,"rightLeft"),l=Math.abs(T.y-g.y)))));O=this.findNodes(t.spatialSearch,s,S,C);for(var A=0;A<O.length;A++){var M=O[A];if(this.canConsider(m,s,M)&&!(this.diagram.nameTable[M.id]instanceof _c)){var I=M.bounds;(null==h||h>Math.abs(I.x-g.x))&&(i.top?Math.abs(g.y+r-I.y)<=x?(d=this.createSnapObject(I,g,"top"),h=Math.abs(I.x-g.x)):Math.abs(g.y+r-I.y-I.height)<=x&&(d=this.createSnapObject(I,g,"topBottom"),h=Math.abs(I.x-g.x)):i.bottom&&(Math.abs(g.y+g.height+r-I.y-I.height)<=x?(d=this.createSnapObject(I,g,"bottom"),h=Math.abs(I.x-g.x)):Math.abs(g.y+g.height+r-I.y)<=x&&(d=this.createSnapObject(I,g,"bottomTop"),h=Math.abs(I.x-g.x))))}}for(P=0;P<k.length;P++)if(L=k[P],this.canConsider(m,s,L)){var D=L.bounds,R=e.left?-o:o,N=Math.abs(g.width+R-D.width),B=void 0;N<=x&&(B=e.left?-D.width+g.width:D.width-g.width,f[f.length]={source:L,difference:N,offset:B}),R=i.top?-r:r;var H=Math.abs(g.height+R-D.height);H<=x&&(B=i.top?-D.height+g.height:D.height-g.height,v[v.length]={source:L,difference:H,offset:B})}if(!t.getTool)this.createGuidelines(t,c,d,n,e,i,a);!e.snapped&&f.length>0&&(e.left||e.right)&&this.addSameWidthLines(t,n,f,e,a,s),!i.snapped&&v.length>0&&(i.top||i.bottom)&&this.addSameHeightLines(t,n,v,i,a,s)},e.prototype.snapTop=function(e,i,n,o,r,s,a,l){var h=r;i.top=!0;var c;e.left=e.right=!1;if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject&&!s.rotateAngle&&(c=l.y-l.height*s.pivot.y+r-(s.offsetY-s.height*s.pivot.y),this.snapSize(this.diagram,e,i,n,o,c,this.diagram.selectedItems,a)),i.snapped)h=r-c+i.offset;else if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToHorizontalLines){var d=l.y-l.height*s.pivot.y,p=d+r;h=this.round(p,this.diagram.snapSettings.horizontalGridlines.scaledIntervals,1)-d}return h},e.prototype.snapRight=function(e,i,n,o,r,s,a,l){var h,c=o;e.right=!0,i.top=i.bottom=!1;if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject&&!s.rotateAngle&&(h=l.x+l.width*(1-s.pivot.x)+o-(s.offsetX+s.width*(1-s.pivot.x)),this.snapSize(this.diagram,e,i,n,h,r,this.diagram.selectedItems,a)),e.snapped)c=o-h+e.offset;else if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToVerticalLines){var d=l.x+l.width*(1-s.pivot.x),p=d+o;c=this.round(p,this.diagram.snapSettings.verticalGridlines.scaledIntervals,1)-d}return c},e.prototype.snapLeft=function(e,i,n,o,r,s,a,l){var h=o,c=0;e.left=!0,i.top=i.bottom=!1;if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject&&!s.rotateAngle&&(c=l.x-l.width*s.pivot.x+o-(s.offsetX-s.width*s.pivot.x),this.snapSize(this.diagram,e,i,n,c,r,this.diagram.selectedItems,a)),e.snapped)h=o-c+e.offset;else if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToVerticalLines){var d=l.x-l.width*s.pivot.x,p=d+o;h=this.round(p,this.diagram.snapSettings.horizontalGridlines.scaledIntervals,1)-d}return h},e.prototype.snapBottom=function(e,i,n,o,r,s,a,l){var h=r;i.bottom=!0,e.left=e.right=!1;var c=0;this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject&&!s.rotateAngle&&(c=l.y+l.height*(1-s.pivot.y)+r-(s.offsetY+s.height*(1-s.pivot.y)),this.snapSize(this.diagram,e,i,n,o,c,this.diagram.selectedItems,a));Xr(s.wrapper);if(i.snapped)h=r-c+i.offset;else if(this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToHorizontalLines){var d=l.y+l.height*(1-s.pivot.y),p=d+r;h=this.round(p,this.diagram.snapSettings.horizontalGridlines.scaledIntervals,1)-d}return h},e.prototype.createGuidelines=function(t,e,i,n,o,r,s){return e&&(o.offset=e.offsetX,o.snapped=!0,s||(e.type,this.renderAlignmentLines(e.start,e.end,n,t.scroller.transform))),i&&(r.offset=i.offsetY,r.snapped=!0,s||(i.type,this.renderAlignmentLines(i.start,i.end,n,t.scroller.transform))),n},e.prototype.renderAlignmentLines=function(t,e,i,n){t={x:(t.x+n.tx)*n.scale,y:(t.y+n.ty)*n.scale},e={x:(e.x+n.tx)*n.scale,y:(e.y+n.ty)*n.scale};var o={stroke:"#07EDE1",strokeWidth:1,startPoint:{x:t.x,y:t.y},endPoint:{x:e.x,y:e.y},fill:"#07EDE1",dashArray:"",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:qr()},r=0;for(this.line.push(o),r=0;r<this.line.length;r++)this.diagram.diagramRenderer.drawLine(i,this.line.pop())},e.prototype.createHSpacingLines=function(t,e,i,n,o,r,s,a,l,h){var c=0;this.sortByDistance(n,"distance",!0),this.sortByDistance(o,"distance",!0);var d,p,u,g,m=[],f=Xr(i.wrapper);if(n.length>0&&(m[m.length]=n[0],c=(d=n[0].obj.bounds).y,n.length>1?(u=n[1].obj.bounds,g=d.x-u.x-u.width,Math.abs(g-n[0].distance)<=h?c=this.findEquallySpacedNodesAtLeft(n,g,c,m):g=n[0].distance):g=n[0].distance),this.sortByDistance(m,"distance"),m[m.length]={obj:i,distance:0},c=f.y<c||!c?f.y:c,o.length>0){var v=void 0;if(p=o[0].obj.bounds,c=p.y<c?p.y:c,o.length>1&&(v=(u=o[1].obj.bounds).x-p.x-p.width),n.length>0)if(Math.abs(o[0].distance-n[0].distance)<=h){var y=Math.abs(o[0].distance-n[0].distance)/2;o[0].distance<n[0].distance?g-=y:g+=y,m[m.length]=o[0]}else 1===n.length&&(d=void 0,m.splice(0,1),m[m.length]=o[0],g=v);else g=v,m[m.length]=o[0];o.length>1&&p.x+p.width<u.x&&(c=this.findEquallySpacedNodesAtRight(o,v,c,m,h))}if(m.length>2){this.addHSpacingLines(t,e,m,a,c);var b=0;a&&(b=l.x),d?r.offset=g-Math.abs(f.x+b-d.x-d.width)+b:p&&(r.offset=Math.abs(f.x+f.width+b-p.x)-g+b),r.snapped=!0}},e.prototype.createVSpacingLines=function(t,e,i,n,o,r,s,a,l,h){var c=0;this.sortByDistance(n,"distance",!0),this.sortByDistance(o,"distance",!0);var d,p,u,g,m=[],f=Xr(i.wrapper);n.length>0&&(m[m.length]=n[0],c=(d=n[0].obj.bounds).x+d.width,n.length>1?(u=n[1].obj.bounds,g=d.y-u.y-u.height,Math.abs(g-n[0].distance)<=h?c=this.findEquallySpacedNodesAtTop(n,g,c,m):g=n[0].distance):g=n[0].distance),this.sortByDistance(m,"distance"),m[m.length]={obj:i,distance:0},c=f.x+f.width>c||!c?f.x+f.width:c;var v;if(o.length>0){if(p=o[0].obj.bounds,c=p.x+p.width>c?p.x+p.width:c,o.length>1&&(v=(u=o[1].obj.bounds).y-p.y-p.height),n.length>0)if(Math.abs(o[0].distance-n[0].distance)<=h){var y=Math.abs(o[0].distance-n[0].distance)/2;o[0].distance<n[0].distance?g-=y:g+=y,m[m.length]=o[0]}else 1===n.length&&(d=void 0,m.splice(0,1),m[m.length]=o[0],g=v);else g=v,m[m.length]=o[0];o.length>1&&u.y>p.y+p.height&&(c=this.findEquallySpacedNodesAtBottom(o,v,c,m,h))}if(m.length>2){this.addVSpacingLines(t,e,m,a,c);var b=0;a&&(b=l.y),d?s.offset=g-Math.abs(f.y+b-d.y-d.height)+b:p&&(s.offset=Math.abs(f.y+f.height+b-p.y)-g+b),s.snapped=!0}},e.prototype.addHSpacingLines=function(t,e,i,n,o){var r,s,a;if(!n)for(r=0;r<i.length-1;r++){var l=i[r].obj instanceof Xc?Xr(i[r].obj.wrapper):i[r].obj.bounds,h=i[r+1].obj instanceof Xc?Xr(i[r+1].obj.wrapper):i[r+1].obj.bounds;s={x:l.x+l.width,y:o-15},a={x:h.x,y:o-15},this.renderSpacingLines(s,a,e,br(this.diagram.element.id),t.scroller.transform)}},e.prototype.addVSpacingLines=function(t,e,i,n,o){var r,s;if(!n)for(var a=0;a<i.length-1;a++){var l=i[a].obj instanceof Xc?Xr(i[a].obj.wrapper):i[a].obj.bounds,h=i[a+1].obj instanceof Xc?Xr(i[a+1].obj.wrapper):i[a+1].obj.bounds;r={x:o+15,y:l.y+l.height},s={x:o+15,y:h.y},this.renderSpacingLines(r,s,e,br(this.diagram.element.id),t.scroller.transform)}},e.prototype.addSameWidthLines=function(t,e,i,n,o,r){this.sortByDistance(i,"offset");var s,a,l=Xr(r.wrapper),h=i[0],c=h.source.bounds,d=[];d.push(i[0]);var p;for(p=1;p<i.length;p++)i[p].source.bounds.width===c.width&&d.push(i[p]);if(!o)for(s={x:l.x+h.offset,y:l.y-15},a={x:l.x+l.width+h.offset,y:l.y-15},this.renderSpacingLines(s,a,e,br(this.diagram.element.id),t.scroller.transform),p=0;p<d.length;p++)s={x:(l=d[p].source.bounds).x,y:l.y-15},a={x:l.x+l.width,y:l.y-15},this.renderSpacingLines(s,a,e,br(this.diagram.element.id),t.scroller.transform);n.offset=h.offset,n.snapped=!0},e.prototype.addSameHeightLines=function(t,e,i,n,o,r){this.sortByDistance(i,"offset");var s,a,l=Xr(r.wrapper),h=i[0],c=h.source.bounds,d=[];d.push(i[0]);var p;for(p=0;p<i.length;p++)i[p].source.bounds.height===c.height&&d.push(i[p]);if(!o)for(s={x:l.x+l.width+15,y:l.y+h.offset},a={x:l.x+l.width+15,y:l.y+h.offset+l.height},this.renderSpacingLines(s,a,e,br(this.diagram.element.id),t.scroller.transform),p=0;p<d.length;p++)s={x:(l=d[p].source.bounds).x+l.width+15,y:l.y},a={x:l.x+l.width+15,y:l.y+l.height},this.renderSpacingLines(s,a,e,br(this.diagram.element.id),t.scroller.transform);n.offset=h.offset,n.snapped=!0},e.prototype.renderSpacingLines=function(t,e,i,n,o){var r,s,a=new sh,l={};t={x:(t.x+o.tx)*o.scale,y:(t.y+o.ty)*o.scale},e={x:(e.x+o.tx)*o.scale,y:(e.y+o.ty)*o.scale},t.x===e.x?(r="M"+(t.x-5)+" "+(t.y+5)+"L"+t.x+" "+t.y+"L"+(t.x+5)+" "+(t.y+5)+"zM"+(e.x-5)+" "+(e.y-5)+" L"+e.x+" "+e.y+" L"+(e.x+5)+" "+(e.y-5)+"z",s={startPoint:{x:t.x-8,y:t.y-1},endPoint:{x:t.x+8,y:t.y-1},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:qr()},a.data=r,l.data=a.data,l.angle=0,l.pivotX=0,l.pivotY=0,l.x=0,l.y=0,l.height=0,l.width=1,l.id=qr(),this.diagram.diagramRenderer.drawPath(i,l),this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop()),s={startPoint:{x:e.x-8,y:e.y+1},endPoint:{x:e.x+8,y:e.y+1},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:br(this.diagram.element.id).id+"spacing"},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop())):(r="M"+(t.x+5)+" "+(t.y+5)+" L"+t.x+" "+t.y+" L"+(t.x+5)+" "+(t.y-5)+"zM"+(e.x-5)+" "+(e.y-5)+" L"+e.x+" "+e.y+" L"+(e.x-5)+" "+(e.y+5)+"z",a.data=r,l.data=r,l.angle=0,l.pivotX=0,l.pivotY=0,l.x=0,l.y=0,l.height=0,l.width=1,l.id=qr(),this.diagram.diagramRenderer.drawPath(i,l),s={visible:!0,opacity:1,id:qr(),startPoint:{x:t.x-1,y:t.y-8},endPoint:{x:t.x-1,y:t.y+8},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"0",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop()),s={width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:qr(),startPoint:{x:e.x+1,y:e.y-8},endPoint:{x:e.x+1,y:e.y+8},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"0"},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop())),s={startPoint:{x:t.x,y:t.y},endPoint:{x:e.x,y:e.y},stroke:"#07EDE1",strokeWidth:1,fill:"#07EDE1",dashArray:"0",width:1,x:0,y:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,opacity:1,id:qr()},this.line.push(s),this.diagram.diagramRenderer.drawLine(i,this.line.pop())},e.prototype.createSnapObject=function(t,e,i){var n;switch(i){case"left":n={start:{x:t.x,y:Math.min(t.y,e.y)},end:{x:t.x,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x-e.x,offsetY:0,type:"sideAlign"};break;case"right":n={type:"sideAlign",start:{x:t.x+t.width,y:Math.min(t.y,e.y)},offsetX:t.x+t.width-e.x-e.width,offsetY:0,end:{x:t.x+t.width,y:Math.max(t.y+t.height,e.y+e.height)}};break;case"top":n={offsetY:t.y-e.y,offsetX:0,type:"sideAlign",start:{x:Math.min(t.x,e.x),y:t.y},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y}};break;case"bottom":n={type:"sideAlign",offsetY:t.y+t.height-e.y-e.height,offsetX:0,end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y+t.height},start:{x:Math.min(t.x,e.x),y:t.y+t.height}};break;case"topBottom":n={start:{x:Math.min(t.x,e.x),y:t.y+t.height},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y+t.height},offsetY:t.y+t.height-e.y,offsetX:0,type:"sideAlign"};break;case"bottomTop":n={start:{x:Math.min(t.x,e.x),y:t.y},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y},offsetY:t.y-e.y-e.height,offsetX:0,type:"sideAlign"};break;case"leftRight":n={start:{x:t.x+t.width,y:Math.min(t.y,e.y)},end:{x:t.x+t.width,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x+t.width-e.x,offsetY:0,type:"sideAlign"};break;case"rightLeft":n={start:{x:t.x,y:Math.min(t.y,e.y)},end:{x:t.x,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x-e.x-e.width,offsetY:0,type:"sideAlign"};break;case"centerX":n={start:{x:t.x+t.width/2,y:Math.min(t.y,e.y)},end:{x:t.x+t.width/2,y:Math.max(t.y+t.height,e.y+e.height)},offsetX:t.x+t.width/2-(e.x+e.width/2),offsetY:0,type:"centerAlign"};break;case"centerY":n={start:{x:Math.min(t.x,e.x),y:t.y+t.height/2},end:{x:Math.max(t.x+t.width,e.x+e.width),y:t.y+t.height/2},offsetY:t.y+t.height/2-(e.y+e.height/2),offsetX:0,type:"centerAlign"}}return n},e.prototype.snapAngle=function(t,e){var i=this.diagram.snapSettings.snapAngle,n=e%(i||0);return n>=i/2?e+i-n:e-n},e.prototype.canConsider=function(t,e,i){return!this.diagram.selectedItems.nodes.length||this.diagram.selectedItems.nodes[0].id!==i.id},e.prototype.findNodes=function(t,e,i,n,o){for(var r,s,a=[],l=t.findQuads(o?n:i),h=0;h<l.length;h++){var c=l[h];if(c.objects.length>0)for(var d=0;d<c.objects.length;d++)r=c.objects[d],this.diagram.nameTable[r.id]instanceof _c||!r.visible||(s=Xr(r),-1===a.indexOf(r)&&this.intersectsRect(i,s)&&a.push(r),o&&o.indexOf(r)&&this.intersectsRect(n,s)&&o.push(r))}return a},e.prototype.intersectsRect=function(t,e){return e.x<t.x+t.width&&t.x<e.x+e.width&&e.y<t.y+t.height&&t.y<e.y+e.height},e.prototype.removeGuidelines=function(t){var e=br(this.diagram.element.id).getElementById("_SnappingLines"),i=br(this.diagram.element.id).getElementById("pivotLine");e&&e.parentNode.removeChild(e),i&&i.parentNode.removeChild(i)},e.prototype.sortByDistance=function(t,e,i){var n,o,r;if(i)for(n=0;n<t.length;n++)for(o=n+1;o<t.length;o++)t[n][e]>t[o][e]&&(r=t[n],t[n]=t[o],t[o]=r);else for(n=0;n<t.length;n++)for(o=n+1;o<t.length;o++)t[n][e]<t[o][e]&&(r=t[n],t[n]=t[o],t[o]=r)},e.prototype.findEquallySpacedNodesAtLeft=function(t,e,i,n){var o,r,s,a;for(a=1;a<t.length&&(o=t[a-1].obj.bounds,r=t[a].obj.bounds,s=o.x-r.x-r.width,Math.abs(s-e)<=1);a++)n[n.length]=t[a],r.y<i&&(i=r.y);return i},e.prototype.findEquallySpacedNodesAtRight=function(t,e,i,n,o){var r,s,a,l,h=t[0].distance;if(Math.abs(e-h)<=o)for(var c=0;c<t.length-1&&(r=t[c].obj,s=t[c+1].obj.bounds,a=r.bounds,l=s.x-a.x-a.width,Math.abs(l-e)<=1);c++)n[n.length]=t[c+1],a.y<i&&(i=a.y);return i},e.prototype.findEquallySpacedNodesAtTop=function(t,e,i,n){for(var o,r,s,a=1;a<t.length&&(o=t[a-1].obj.bounds,r=t[a].obj.bounds,s=o.y-r.y-r.height,Math.abs(s-e)<=1);a++)n[n.length]=t[a],r.x+r.width>i&&(i=r.x+r.width);return i},e.prototype.findEquallySpacedNodesAtBottom=function(t,e,i,n,o){var r,s,a,l,h=t[0].distance;if(Math.abs(e-h)<=o)for(var c=0;c<t.length-1&&(r=t[c].obj,s=t[c+1].obj.bounds,a=r.bounds,l=s.y-a.y-a.height,Math.abs(l-e)<=1);c++)n[n.length]=t[c+1],a.x+a.width>i&&(i=a.x+a.width);return i},e.prototype.getLayer=function(){var e;return this.diagram.snapSettings.constraints&t.SnapConstraints.SnapToObject&&((e=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttribute("id","_SnappingLines"),e.setAttribute("shapeRendering","crispEdges"),br(this.diagram.element.id).appendChild(e)),e},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"Snapping"},e}(),jm=function(){function e(){this.groupUndo=!1,this.childTable=[]}return e.prototype.initHistory=function(t){t.historyList={canRedo:!1,canUndo:!1,currentEntry:null,push:t.addHistoryEntry.bind(t),undo:Function,redo:Function,startGroupAction:t.startGroupAction.bind(t),endGroupAction:t.endGroupAction.bind(t),canLog:null,undoStack:[],redoStack:[]}},e.prototype.addHistoryEntry=function(t,e){var i=null;e.historyList.canLog&&!0===e.historyList.canLog(t).cancel||(e.historyList&&e.historyList.canUndo&&e.historyList.currentEntry&&((i=e.historyList.currentEntry).next?i.previous&&(i.next.previous=null,i.next=t,t.previous=i):(i.next=t,t.previous=i)),e.historyList.currentEntry=t,this.getHistoryList(e),e.historyList.canUndo=!0,e.historyList.canRedo=!1)},e.prototype.undo=function(t){var e=this.getUndoEntry(t),i=0;e&&("Internal"===e.category?("EndGroup"===e.type?(i++,this.groupUndo=!0):this.undoEntry(e,t),this.groupUndo&&(this.undoGroupAction(e,t,i),this.groupUndo=!1)):t.historyList.undo(e))},e.prototype.getHistoryList=function(t){var e,i,n=[],o=[],r=t.historyList.currentEntry;for(r=t.historyList.currentEntry,t.historyList.canUndo||0===t.historyList.undoStack.length?this.getHistroyObject(n,r):this.getHistroyObject(o,r);r&&r.previous;)e=r.previous,this.getHistroyObject(n,e),r=r.previous;for(r=t.historyList.currentEntry;r&&r.next;)i=r.next,this.getHistroyObject(o,i),r=r.next;t.historyList.undoStack=n,t.historyList.redoStack=o},e.prototype.getHistroyObject=function(t,e){e&&"StartGroup"!==e.type&&"EndGroup"!==e.type&&t.push({redoObject:e.redoObject?e.redoObject:null,undoObject:e.undoObject?e.undoObject:null,type:e.type?e.type:null,category:e.category?e.category:null})},e.prototype.undoGroupAction=function(t,e,i){for(;0!==i;)this.undoEntry(t,e),"StartGroup"===(t=this.getUndoEntry(e)).type?i--:"EndGroup"===t.type&&i++;i=0},e.prototype.undoEntry=function(e,i){var n;if("PropertyChanged"!==e.type&&"CollectionChanged"!==e.type&&"LabelCollectionChanged"!==e.type&&(n=e.undoObject),"StartGroup"!==e.type&&"EndGroup"!==e.type&&i.historyList.undoStack.length>0){var o=i.historyList.undoStack.splice(0,1);i.historyList.redoStack.splice(0,0,o[0])}switch(i.protectPropertyChange(!0),i.diagramActions|=t.DiagramAction.UndoRedo,e.type){case"PositionChanged":case"Align":case"Distribute":this.recordPositionChanged(n,i);break;case"SizeChanged":case"Sizing":this.recordSizeChanged(n,i,e);break;case"RotationChanged":this.recordRotationChanged(n,i,e);break;case"ConnectionChanged":this.recordConnectionChanged(n,i);break;case"PropertyChanged":this.recordPropertyChanged(e,i,!1);break;case"CollectionChanged":e.isUndo=!0,this.recordCollectionChanged(e,i),e.isUndo=!1;break;case"LabelCollectionChanged":e.isUndo=!0,this.recordLabelCollectionChanged(e,i),e.isUndo=!1;break;case"PortCollectionChanged":e.isUndo=!0,this.recordPortCollectionChanged(e,i),e.isUndo=!1;break;case"Group":this.unGroup(e,i);break;case"UnGroup":this.group(e,i);break;case"SegmentChanged":this.recordSegmentChanged(n,i)}i.diagramActions&=~t.DiagramAction.UndoRedo,i.protectPropertyChange(!1),i.historyChangeTrigger(e)},e.prototype.group=function(t,e){e.add(t.undoObject)},e.prototype.unGroup=function(t,e){t.redoObject=Yr(t.undoObject);var i=t.undoObject;e.commandHandler.unGroup(i)},e.prototype.ignoreProperty=function(t){return"zIndex"===t||"wrapper"===t},e.prototype.getProperty=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var o=n[i];this.ignoreProperty(o)||(e[o]instanceof Object?this.getProperty(t[o],e[o]):t[o]=e[o])}},e.prototype.recordPropertyChanged=function(e,i,n){var o=e.redoObject,r=e.undoObject;this.getProperty(i,n?o:r),n?i.onPropertyChanged(o,r):i.onPropertyChanged(r,o),i.diagramActions=i.diagramActions|t.DiagramAction.UndoRedo},e.prototype.recordSegmentChanged=function(t,e){var i,n=0;if(t.connectors&&t.connectors.length>0)for(n=0;n<t.connectors.length;n++)i=t.connectors[n],this.segmentChanged(i,e)},e.prototype.segmentChanged=function(t,e){var i=e.nameTable[t.id];i.segments=t.segments,e.commandHandler.updateEndPoint(i)},e.prototype.recordPositionChanged=function(t,e){var i,n,o=0;if(t.nodes&&t.nodes.length>0)for(o=0;o<t.nodes.length;o++)i=t.nodes[o],this.positionChanged(i,e);if(t.connectors&&t.connectors.length>0)for(o=0;o<t.connectors.length;o++)n=t.connectors[o],this.connectionChanged(n,e)},e.prototype.positionChanged=function(t,e,i){var n=e.nameTable[t.id];if(t.processId&&!n.processId&&e.addProcess(t,t.processId),!t.processId&&n.processId&&e.removeProcess(t.id),n.processId){var o=t.margin.left-n.margin.left,r=t.margin.top-n.margin.top;e.drag(n,o,r)}else{var o=t.offsetX-n.wrapper.offsetX,r=t.offsetY-n.wrapper.offsetY;e.drag(n,o,r)}e.bpmnModule&&e.bpmnModule.updateDocks(n,e)},e.prototype.recordSizeChanged=function(t,e,i){var n,o,r=0;if(t&&t.nodes&&t.nodes.length>0)for(r=0;r<t.nodes.length;r++)if((o=t.nodes[r]).children)for(var s=[],a=e.commandHandler.getAllDescendants(o,s),l=0;l<a.length;l++){var h=i.childTable[a[l].id];wd(h)===fd?(this.sizeChanged(h,e,i),this.positionChanged(h,e,i)):this.connectionChanged(h,e,i)}else this.sizeChanged(o,e),this.positionChanged(o,e);if(t&&t.connectors&&t.connectors.length>0){var c=t.connectors;for(r=0;r<c.length;r++)n=c[r],this.connectionChanged(n,e)}},e.prototype.sizeChanged=function(t,e,i){var n=e.nameTable[t.id],o=t.wrapper.actualSize.width/n.wrapper.actualSize.width,r=t.wrapper.actualSize.height/n.wrapper.actualSize.height;i&&i.childTable&&(i.childTable[t.id]=Yr(n)),e.scale(n,o,r,{x:t.wrapper.offsetX/n.wrapper.offsetX,y:t.wrapper.offsetY/n.wrapper.offsetY})},e.prototype.recordRotationChanged=function(t,e,i){var n,o,r=0,s=e.selectedItems;if(s.rotateAngle=t.rotateAngle,s&&s.wrapper&&(s.wrapper.rotateAngle=t.rotateAngle),t&&t.nodes&&t.nodes.length>0)for(r=0;r<t.nodes.length;r++)n=t.nodes[r],this.rotationChanged(n,e),this.positionChanged(n,e);if(t&&t.connectors&&t.connectors.length>0)for(r=0;r<t.connectors.length;r++)o=t.connectors[r],this.connectionChanged(o,e)},e.prototype.rotationChanged=function(t,e){var i=e.nameTable[t.id];e.rotate(i,t.rotateAngle-i.rotateAngle)},e.prototype.recordConnectionChanged=function(t,e){var i=t.connectors[0];this.connectionChanged(i,e)},e.prototype.connectionChanged=function(t,e,i){var n=e.nameTable[t.id];t.sourcePortID!==n.sourcePortID&&(n.sourcePortID=t.sourcePortID,e.connectorPropertyChange(n,{},{sourcePortID:t.sourcePortID})),t.targetPortID!==n.targetPortID&&(n.targetPortID=t.targetPortID,e.connectorPropertyChange(n,{},{targetPortID:t.targetPortID})),t.sourceID!==n.sourceID&&(""===t.sourceID?Uo(e.nameTable[n.sourceID].outEdges,t.id):e.nameTable[t.sourceID].outEdges.push(t.id),n.sourceID=t.sourceID,e.connectorPropertyChange(n,{},{sourceID:t.sourceID})),t.targetID!==n.targetID&&(""===t.targetID?Uo(e.nameTable[n.targetID].inEdges,t.id):e.nameTable[t.targetID].inEdges.push(t.id),n.targetID=t.targetID,e.connectorPropertyChange(n,{},{targetID:t.targetID})),i&&i.childTable&&(i.childTable[t.id]=Yr(n));var o=t.sourcePoint.x-n.sourcePoint.x,r=t.sourcePoint.y-n.sourcePoint.y;0===o&&0===r||e.dragSourceEnd(n,o,r);var s=t.targetPoint.x-n.targetPoint.x,a=t.targetPoint.y-n.targetPoint.y;0===s&&0===a||e.dragTargetEnd(n,s,a),e.updateSelector(),"SVG"!==e.mode&&e.refreshDiagramLayer()},e.prototype.recordCollectionChanged=function(t,e){var i=t.undoObject;if(t&&t.changeType){if("Remove"===(t.isUndo?"Insert"===t.changeType?"Remove":"Insert":t.changeType))e.remove(i),e.clearSelectorLayer();else{if(e.clearSelectorLayer(),i.parentId){var n=e.nameTable[i.parentId];n?e.addChild(n,i):e.add(i)}else e.add(i);i.processId&&e.nameTable[i.processId]&&e.addProcess(i,i.processId)}"SVG"!==e.mode&&e.refreshDiagramLayer()}},e.prototype.recordLabelCollectionChanged=function(t,e){var i=t.undoObject,n=t.redoObject,o=e.nameTable[n.id];if(t&&t.changeType){"Remove"===(t.isUndo?"Insert"===t.changeType?"Remove":"Insert":t.changeType)?(e.removeLabels(o,[i]),e.clearSelectorLayer()):(e.clearSelectorLayer(),e.addLabels(o,[i])),"SVG"!==e.mode&&e.refreshDiagramLayer()}},e.prototype.recordPortCollectionChanged=function(t,e){var i=t.undoObject,n=t.redoObject,o=e.nameTable[n.id];if(t&&t.changeType){"Remove"===(t.isUndo?"Insert"===t.changeType?"Remove":"Insert":t.changeType)?(e.removePorts(o,[i]),e.clearSelectorLayer()):(e.clearSelectorLayer(),e.addPorts(o,[i])),"SVG"!==e.mode&&e.refreshDiagramLayer()}},e.prototype.redo=function(t){var e=this.getRedoEntry(t),i=0;e&&("Internal"===e.category?("StartGroup"===e.type?(i++,this.groupUndo=!0):this.redoEntry(e,t),this.groupUndo&&(this.redoGroupAction(e,t,i),this.groupUndo=!1)):t.historyList.redo(e))},e.prototype.redoGroupAction=function(t,e,i){for(;0!==i;)this.redoEntry(t,e),"EndGroup"===(t=this.getRedoEntry(e)).type?i--:"StartGroup"===t.type&&i++;i=0},e.prototype.redoEntry=function(e,i){var n;if("PropertyChanged"!==e.type&&"CollectionChanged"!==e.type&&(n=e.redoObject),i.diagramActions|=t.DiagramAction.UndoRedo,"StartGroup"!==e.type&&"EndGroup"!==e.type&&i.historyList.redoStack.length>0){var o=i.historyList.redoStack.splice(0,1);i.historyList.undoStack.splice(0,0,o[0])}switch(i.protectPropertyChange(!0),e.type){case"PositionChanged":case"Align":case"Distribute":this.recordPositionChanged(n,i);break;case"SizeChanged":case"Sizing":this.recordSizeChanged(n,i,e);break;case"RotationChanged":this.recordRotationChanged(n,i,e);break;case"ConnectionChanged":this.recordConnectionChanged(n,i);break;case"PropertyChanged":this.recordPropertyChanged(e,i,!0);break;case"CollectionChanged":this.recordCollectionChanged(e,i);break;case"LabelCollectionChanged":this.recordLabelCollectionChanged(e,i);break;case"PortCollectionChanged":this.recordPortCollectionChanged(e,i);break;case"Group":this.group(e,i);break;case"UnGroup":this.unGroup(e,i);break;case"SegmentChanged":this.recordSegmentChanged(n,i)}i.protectPropertyChange(!1),i.diagramActions&=~t.DiagramAction.UndoRedo,i.historyChangeTrigger(e)},e.prototype.getUndoEntry=function(t){var e,i=null,n=t.historyList;return n.canUndo&&(i=n.currentEntry,(e=n.currentEntry.previous)?(n.currentEntry=e,n.canRedo||(n.canRedo=!0)):(n.canRedo=!0,n.canUndo=!1)),i},e.prototype.getRedoEntry=function(t){var e,i=null,n=t.historyList;return n.canRedo&&((e=n.currentEntry.previous||n.canUndo?n.currentEntry.next:n.currentEntry)&&(n.currentEntry=e,n.canUndo||(n.canUndo=!0),e.next||(n.canRedo=!1,n.canUndo=!0)),i=n.currentEntry),i},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"UndoRedo"},e}(),Fm=function(){function e(){this.protectChange=!1}return e.prototype.expand=function(t,e,i,n){var o=this,r={},s=0;if(r[0]=setInterval(function(){return s++,o.layoutAnimation(e,r,6===s,n)},20),i.isExpanded){var a=.2;this.protectChange=n.isProtectedOnChange,n.protectPropertyChange(!1);var l={};this.updateOpacity(i,a,n),l[0]=setInterval(function(){a<=1?o.updateOpacity(i,a,n):clearInterval(l[0]),a+=.2},20)}},e.prototype.layoutAnimation=function(e,i,n,o){if(!n)for(var r=0;r<e.objects.length;r++){var s=o.nameTable[e.objects[r].id];s.offsetX+=e.objects[r].differenceX/5,s.offsetY+=e.objects[r].differenceY/5}n&&(clearInterval(i[0]),o.protectPropertyChange(this.protectChange),o.triggerEvent(t.DiagramEvent.animationComplete,void 0),this.protectChange=!1,o.organizationalChartModule.isAnimation=!1,o.layout.fixedNode="",o.protectPropertyChange(this.protectChange))},e.prototype.updateOpacity=function(t,e,i){for(var n=0;n<t.outEdges.length;n++){var o=i.nameTable[t.outEdges[n]],r=i.nameTable[o.targetID];o.style.opacity=e,i.updateDiagramObject(t);for(var s=0;s<o.wrapper.children.length;s++)o.wrapper.children[s].style.opacity=e,r.style.opacity=e,r.wrapper instanceof oh&&i.updateNodeProperty(r.wrapper,void 0,e);this.updateOpacity(r,e,i)}},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"LayoutAnimate"},e}(),Vm=function(){function t(){this.isAnimation=!1}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"OrganizationalChart"},t.prototype.updateLayout=function(t,e,i,n,o){var r={type:i.type,nameTable:e,anchorX:0,anchorY:0,firstLevelNodes:[],centerNode:null,levels:[],maxLevel:0,graphNodes:{},orientation:i.orientation,horizontalSpacing:i.horizontalSpacing,verticalSpacing:i.verticalSpacing,verticalAlignment:i.verticalAlignment,horizontalAlignment:i.horizontalAlignment,fixedNode:i.fixedNode,getLayoutInfo:as(i.getLayoutInfo),margin:i.margin,bounds:i.bounds,objects:[],root:i.root};return this.doLayout(r,t,n,o),r},t.prototype.doLayout=function(t,e,i,n){var o,r,s=[];for(t.nameTable[t.root]&&t.firstLevelNodes.push(t.nameTable[t.root]),r=0;r<e.length;r++)(o=e[r]).excludeFromLayout||((t.graphNodes[o.id]=this.setUpLayoutInfo(t,o)).tree.hasSubTree=!1,t.nameTable[t.root]||o.inEdges&&o.inEdges.length||(s.push(o),o.data&&String(o.data[n])===t.root&&t.firstLevelNodes.push(o)));for(0===t.firstLevelNodes.length&&(t.firstLevelNodes=s),r=0;r<t.firstLevelNodes.length;r++)o=t.firstLevelNodes[r],this.updateEdges(t,o,1);if(t.firstLevelNodes.length>0){t.rootNode=t.firstLevelNodes[0];var a=0,l=0,h=void 0,c=void 0,d=void 0,p=void 0,u=void 0;for(r=0;r<t.firstLevelNodes.length;r++){u=this.updateTree(t,a,l,t.firstLevelNodes[r],0,t.firstLevelNodes[r-1]);var g=t.graphNodes[t.firstLevelNodes[r].id];u.y=Math.min(u.y,g.y),u.x=Math.min(u.x,g.x),-1!==t.orientation.indexOf("Left")?l=u.right+t.horizontalSpacing:a=u.right+t.horizontalSpacing,0===r?(h=u.x,p=u.y,d=u.right,c=u.bottom):(h=Math.min(h,u.x),p=Math.min(p,u.y),d=Math.max(d,u.right),c=Math.max(c,u.bottom))}for(this.updateAnchor(t,{x:h,y:p,right:d,bottom:c},i),r=0;r<t.firstLevelNodes.length;r++)this.updateNodes(t,t.firstLevelNodes[r],0);for(r=0;r<t.firstLevelNodes.length;r++)this.updateConnectors(t,t.firstLevelNodes[r],1)}},t.prototype.getBounds=function(t){var e=t.offsetX-t.actualSize.width*t.pivot.x,i=t.offsetY-t.actualSize.height*t.pivot.y;return new Rl(e,i,t.actualSize.width,t.actualSize.height)},t.prototype.updateTree=function(t,e,i,n,o,r,s){var a,l,h,c,d={};if(a=this.getDimensions(t,n,e,i,o),d=t.graphNodes[n.id],t.maxLevel=Math.max(t.maxLevel,o),l=o,(c=this.hasChild(t,n))||d.tree.assistants.length){var p=void 0,u=void 0,g=void 0,m=void 0,f=void 0,v=void 0,y=void 0;y=a.y+a.height+t.verticalSpacing,d.tree.assistants.length&&(l=(h=this.setDepthSpaceForAssitants(t,n,y,a.height,o,t.verticalSpacing)).level,y=h.bottom),d.tree.assistants.length||"Horizontal"===d.tree.orientation||(y=a.y+a.height+t.verticalSpacing/2),d.tree.children.length&&(p="Horizontal"!==d.tree.orientation||"Balanced"===d.tree.type&&1!==d.tree.children.length?"Balanced"===d.tree.type?this.updateHorizontalTreeWithMultipleRows(t,n,r,a.x,y,l):this.updateVerticalTree(t,n,a.x,y,l,s):this.updateHorizontalTree(t,n,r,a.x,y,l)),d.y&&d.y>a.y||(d.y=a.y),e&&e>d.mid||(e=d.mid),d.tree.assistants.length&&(v=void 0!==e?e:a.x,f=this.setBreadthSpaceForAssistants(t,n,a,v,y,o),c||(e=((g=p=f).x+g.right)/2-a.width/2,p=g),m=f?f.canMoveBy:void 0),d.x=e,d.translate||(d.treeWidth=p.right-p.x);var b={layout:t,shape:n,shapeBounds:u={x:e,y:a.y,right:e+a.width,bottom:a.y+a.height},treeBounds:p,dim:a,level:o};return this.translateSubTree(b,m,void 0!==r,s),d.firstChild&&"string"!=typeof d.firstChild&&(d.firstChild.x+=d.subTreeTranslation),n.treeBounds=p,p}return n.treeBounds=this.updateLeafNode(t,n,r,a,o,s),n.treeBounds},t.prototype.updateLeafNode=function(t,e,i,n,o,r){var s,a=t.graphNodes[e.id];a.x=n.x,a.y&&a.y>n.y||(a.y=n.y,a.maxLevel=Math.max(o,a.maxLevel||0)),s={x:n.x,y:n.y,right:n.x+n.width,bottom:n.y+n.height},a.maxLevel=Math.max(a.maxLevel||0,o);var l={layout:t,shape:e,shapeBounds:s,treeBounds:s,dim:n,level:o};return this.translateSubTree(l,void 0,void 0!==i,r),{x:a.x,y:a.y,right:a.x+n.width,bottom:a.y+n.height}},t.prototype.setUpLayoutInfo=function(t,e){var i={};return i.subTreeTranslation=0,"OrganizationalChart"===t.type?i.tree={orientation:"Vertical",type:"Alternate",offset:20,enableRouting:!0}:i.tree={orientation:"Horizontal",type:"Center",enableRouting:!0},i.tree.children=[],i.tree.assistants=[],i.tree.level=0,i.translate=!0,i},t.prototype.translateSubTree=function(t,e,i,n){var o=t.layout,r=t.shape,s=t.shapeBounds,a=t.treeBounds,l=t.level,h=t.dim,c=o.graphNodes[r.id],d=o.nameTable[c.firstChild?c.firstChild.child:c.tree.children[0]],p=d?o.graphNodes[d.id]:null,u=this.hasChild(o,r),g=this.findIntersectingLevels(o,s,l,c.actualLevel),m=this.findIntersectingLevels(o,a,l,c.actualLevel),f=[];g.length&&c.translate?(c.intersect=g,this.spaceLeftFromPrevSubTree(o,r,s),c.canMoveBy=c.diff,void 0!==e&&(c.canMoveBy=Math.min(e,c.canMoveBy)),d&&void 0!==p.canMoveBy&&(p.canMoveBy>=c.canMoveBy&&(c.translated=!0),c.canMoveBy=Math.min(c.canMoveBy,p.canMoveBy)),i&&(c.x-=c.canMoveBy,c.subTreeTranslation-=c.canMoveBy,u&&(this.shiftSubordinates(o,m,c.canMoveBy),a.x=Math.min(a.x,c.x),a.right=Math.max(a.right,c.x+h.width),a.bottom=Math.max(a.bottom,c.y+h.height),a.x-=c.canMoveBy,a.right-=c.canMoveBy),d&&p.canMoveBy>c.canMoveBy?c.canMoveBy=p.canMoveBy-c.canMoveBy:d&&void 0!==c.canMoveBy&&(c.canMoveBy=0))):(u&&(a.x=Math.min(a.x,s.x),a.right=Math.max(a.right,s.x+h.width),a.bottom=Math.max(a.bottom,c.y+h.height)),c.translate||(c.canMoveBy=0,c.subTreeTranslation=0)),n||(s={x:c.x,y:h.y,right:c.x+h.width,bottom:h.y+h.height},f.push({rBounds:s}),this.updateRearBounds(o,r,f,l))},t.prototype.updateRearBounds=function(t,e,i,n,o){var r,s,a,l,h,c,d=!0,p={};if(e&&(o=(p=t.graphNodes[e.id]).intersect,d=!p.tree.children.length&&!p.tree.assistants.length),l=i[0].rBounds,h=i[i.length-1].rBounds,o&&o.length){for(c=(r=t.levels[o[0]].rBounds).bottom,r.y<l.y&&(r.bottom=l.y,i.splice(0,0,{rBounds:r})),c>h.bottom?i.push({rBounds:{x:r.x,right:r.right,y:l.bottom,bottom:c}}):(r=t.levels[o[o.length-1]].rBounds,d&&r.bottom>h.bottom&&(r.y=h.bottom,i.push({rBounds:r}))),s=o[0],a=i.length-1;a>=0;a--)t.levels.splice(s,0,i[a]);s+=i.length,t.levels.splice(s,o.length)}else for(s=this.findLevel(t,i[i.length-1].rBounds,n),a=i.length-1;a>=0;a--)t.levels.splice(s,0,i[a])},t.prototype.shiftSubordinates=function(t,e,i){var n;if(0!==i)for(n=0;n<e.length;n++)t.levels[e[n]].rBounds&&(t.levels[e[n]].rBounds.x-=i,t.levels[e[n]].rBounds.right-=i)},t.prototype.setDepthSpaceForAssitants=function(t,e,i,n,o,r){var s,a,l,h,c=t.graphNodes[e.id],d={};for(h=i,a=0;a<c.tree.assistants.length;a++)(d=t.graphNodes[c.tree.assistants[a]])&&(d.tree.children=d.tree.assistants=[],d.y=i,s=(l=t.nameTable[c.tree.assistants[a]]).actualSize.height,-1!==t.orientation.indexOf("Left")&&(s=l.actualSize.width),h=i+s+r/2,t.maxLevel=o+1,a%2==1&&a!==c.tree.assistants.length-1&&(i=h,o++));return{level:t.maxLevel,bottom:i+s+r}},t.prototype.setBreadthSpaceForAssistants=function(t,e,i,n,o,r){var s,a,l,h,c,d,p,u,g={},m=t.graphNodes[e.id],f=r;for(h=0;h<m.tree.assistants.length;h++)(g=t.graphNodes[m.tree.assistants[h]])&&(s=(l=t.nameTable[m.tree.assistants[h]]).actualSize.width,-1!==t.orientation.indexOf("Left")&&(s=l.actualSize.height),c=h%2==0?n+i.width/2-20-s:n+i.width/2+20,a=this.updateTree(t,c,g.y,t.nameTable[m.tree.assistants[h]],f+1),this.hasChild(t,e)||(0===h?u=a:this.uniteRects(u,a)),h%2==0&&g.prevBounds&&(d=void 0===d?g.canMoveBy:Math.min(d,g.canMoveBy)),h%2!=1&&h!==m.tree.assistants.length-1||(p=this.findIntersectingLevels(t,a,f+1),this.updateRearBounds(t,null,[{rBounds:a}],f+1,p),f++));return u&&(u.canMoveBy=d),u},t.prototype.getDimensions=function(t,e,i,n,o){var r;r=e.actualSize.width;var s;if(s=e.actualSize.height,-1!==t.orientation.indexOf("Left")){if(!o){var a=void 0;a=i,i=n,n=a}s=e.actualSize.width,r=e.actualSize.height}return{x:i,y:n,width:r,height:s}},t.prototype.hasChild=function(t,e){var i=t.graphNodes[e.id];return i.tree.children&&i.tree.children.length},t.prototype.updateHorizontalTree=function(t,e,i,n,o,r){var s;s=this.getDimensions(t,e,n,o,r);var a,l={},h=(l=t.graphNodes[e.id]).tree.type;a=r;var c=0;c=n;var d;d=o;var p,u,g,m,f,v,y,b,w,x,C,S,E,P;if(t.levels.slice(0,t.levels.length),this.hasChild(t,e)){var L=void 0;for(L=-1!==t.orientation.indexOf("Left"),S=0;S<l.tree.children.length;S++){if(g=t.nameTable[l.tree.children[S]],p=g.actualSize.width,u=g.actualSize.height,f=L?u:p,v=L?p:u,t.levels[a+1]?t.levels[a+1].rBounds:null,m=this.updateTree(t,c,d,g,a+1,t.nameTable[l.tree.children[S-1]]),E=t.graphNodes[g.id],l.maxLevel=Math.max(l.maxLevel||0,E.maxLevel||0),b={x:E.x,y:E.y,right:E.x+f,bottom:E.y+v},0===S&&(y={x:Math.min(E.x,m.x),y:Math.min(E.y,m.y),right:m.right,bottom:m.bottom},P=E),C?(C.x=b.x,C.y=b.y,b.right>C.right&&(C.right=b.right),C.bottom=b.bottom):C=b,0===S&&(l.firstChild={x:E.x,canMoveBy:E.canMoveBy,child:g.id}),this.hasChild(t,g))if(!l.firstChild||l.firstChild.x>=E.firstChild.x){E.firstChild&&l.firstChild.canMoveBy<E.canMoveBy&&(l.firstChild.canMoveBy=x,E.canMoveBy=x,x=l.firstChild.canMoveBy,t.graphNodes[l.firstChild.child].canMoveBy=x);var T=void 0!==x?x:E.canMoveBy;l.firstChild={x:E.firstChild.x,canMoveBy:T,child:g.id}}else E.firstChild&&E.translated&&l.firstChild.canMoveBy>E.canMoveBy&&(l.firstChild.canMoveBy=t.graphNodes[l.firstChild.child].canMoveBy=E.canMoveBy);w=w?Math.max(E.maxLevel,w):E.maxLevel,this.uniteRects(y,m),c=0!==S&&!this.hasChild(t,g)&&E.subTreeTranslation<0?m.right-E.subTreeTranslation+t.horizontalSpacing:m.right+t.horizontalSpacing}isNaN(void 0)||(P.canMoveBy=void 0),l.mid=(P.x+C.right)/2-s.width/2,"Left"===h?l.mid=b.right-s.width:"Right"===h&&(l.mid=n)}return y},t.prototype.updateHorizontalTreeWithMultipleRows=function(t,e,i,n,o,r){var s,a,l,h,c,d,p,u,g,m,f,v=this.getDimensions(t,e,n,o,r),y=t.graphNodes[e.id],b=(y.tree.type,r),w=n,x=o,C=(t.levels.slice(0,t.levels.length),0);if(this.hasChild(t,e)){var S=-1!==t.orientation.indexOf("Left"),E=void 0,P=this.splitChildrenInRows(t,e),L=5===y.tree.children.length&&3===P[0].length,T=[],k=[];L?k=P:this.splitRows(P,T,k);var O={leftTree:T,rows:P,rightTree:k,dimensions:v},A=this.updateLeftTree(t,O,e,n,x,b);c=O.bounds;var M=void 0,I=(A||0)+(void 0!==A?t.horizontalSpacing/2:0);void 0!==A&&(y.mid=I-v.width/2,M=A+t.horizontalSpacing),x=o;var D=void 0;for(D=[],g=0;g<k.length;g++)for(w=P[g].length%2==1&&g===k.length-1||L?n:M||n,0!==g&&(x=D[g-1].bottom+t.verticalSpacing),u=0;u<k[g].length;u++)d=(s=t.nameTable[k[g][u]]).actualSize.width,p=s.actualSize.height,h=S?p:d,(a=t.graphNodes[s.id]).actualLevel=b+1+g,0===u&&T[g]&&T[g].length&&(a.translate=!1),L&&1===g&&(0===u&&m+h+t.horizontalSpacing<=f&&(E=!0,w=m-h/2),E&&1===u&&(w=f-h/2)),l=this.updateTree(t,w,x,s,b+1,t.nameTable[k[g][u-1]]),L&&u<=2&&0===g&&1===u&&(m=l.x-t.horizontalSpacing/2,f=l.x+h+t.horizontalSpacing/2),0===u?D[g]={x:l.x,y:l.y,right:l.right,bottom:l.bottom}:this.uniteRects(D[g],l),c||(c={x:D[g].x,y:D[g].y,right:D[g].right,bottom:D[g].bottom}),this.uniteRects(c,D[g]),w=l.right+t.horizontalSpacing,(!y.firstChild||(g===k.length-1&&P[g].length%2==1||L)&&0===u&&void 0!==a.canMoveBy&&C>a.canMoveBy)&&(C=Math.min(C,a.canMoveBy||0),y.firstChild={x:a.x,child:s.id,canMoveBy:a.canMoveBy}),O.leftCenter=m,O.rightCenter=f,O.align=E,O.level=b,O.rightBounds=D,this.alignRowsToCenter(t,g,e,O,M)}return c},t.prototype.updateLeftTree=function(t,e,i,n,o,r){for(var s,a,l,h,c,d=e.leftTree,p=t.graphNodes[i.id],u=[],g=-1!==t.orientation.indexOf("Left"),m=0;m<d.length&&d[m].length;m++){s=n,u[m-1]&&(o=u[m-1].bottom+t.verticalSpacing);for(b=0;b<d[m].length;b++){var f=t.nameTable[d[m][b]],v=(g?f.actualSize.height:f.actualSize.width,g?f.actualSize.width:f.actualSize.height,t.graphNodes[f.id]);v.actualLevel=r+1+m,h=this.updateTree(t,s,o,f,r+1,t.nameTable[d[m][b-1]]),0===b?u[m]={x:h.x,y:h.y,right:h.right,bottom:h.bottom}:this.uniteRects(u[m],h),0===m&&0===b?(a=v.canMoveBy,p.firstChild={x:v.x,child:f.id,canMoveBy:v.canMoveBy}):0===b&&void 0!==v.canMoveBy&&a>v.canMoveBy&&(a=Math.min(a,v.canMoveBy||0),p.firstChild={x:v.x,child:f.id,canMoveBy:v.canMoveBy}),s=h.right+t.horizontalSpacing}l=0===m?u[m].right:Math.max(l,u[m].right)}for(m=0;m<d.length&&d[m].length;m++){if(l!==u[m].right)for(var y=l-u[m].right,b=0;b<d[m].length;b++){t.nameTable[d[m][b]];t.graphNodes[d[m][b]].x+=y}0===m?c={x:u[0].x,y:u[0].y,right:u[0].right,bottom:u[0].bottom}:this.uniteRects(c,u[m])}return e.bounds=c,l},t.prototype.alignRowsToCenter=function(t,e,i,n,o){var r,s,a,l=t.graphNodes[i.id],h=n.rows,c=n.rightTree,d=n.leftCenter,p=n.rightCenter,u=n.align,g=n.rightBounds,m=n.dimensions,f=n.level,v=5===l.tree.children.length&&3===h[0].length;if(v&&1===e&&(r=g[0].right-g[0].x>=g[1].right-g[1].x?0:1),e===h.length-1&&(h[e].length%2==1||v&&1===e)){s=c[e][Math.floor(c[e].length/2)];var y=void 0;y=t.nameTable[s];var b=void 0,w=t.graphNodes[s].x,x=t.graphNodes[s].y;b=this.getDimensions(t,y,w,x,f+1),a=void 0,!u&&v?(1===r&&(e=0),a=(g[r].x+g[r].right)/2-(g[e].x+g[e].right)/2,0===e&&(l.mid+=a)):v||void 0===o||(a=o-t.horizontalSpacing/2-(w+b.width/2)),void 0!==a&&this.updateRearBoundsOfTree(t,c[e],a,m),v&&(l.mid=(p+d)/2+(0===e?a:0)-m.width/2),void 0===l.mid&&t.graphNodes[s]&&(l.mid=w),u=!1,e++}},t.prototype.updateRearBoundsOfTree=function(t,e,i,n){for(var o=0;o<e.length;o++){var r=t.graphNodes[e[o]];t.nameTable[e[o]];if(r.x+=i,r.canMoveBy+=i,o===e.length-1){var s={x:r.x,y:r.y,right:r.x+n.width,bottom:r.y+n.height},a=this.findIntersectingLevels(t,s,r.actualLevel);this.updateRearBounds(t,null,[{rBounds:s}],r.actualLevel,a)}}},t.prototype.splitRows=function(t,e,i){for(var n=0;n<t.length;n++){e[n]=[],i[n]=[];var o=void 0;if(o=t[n].length,t[n].length%2!=1){o=Math.ceil(t[n].length/2);for(var r=0;r<o;r++)e[n].push(t[n][r])}for(var s=e[n].length;s<t[n].length;s++)i[n].push(t[n][s])}},t.prototype.updateVerticalTree=function(t,e,i,n,o,r){this.getDimensions(t,e,i,n,o);var s,a,l,h,c,d,p,u,g,m,f,v=t.graphNodes[e.id],y=t.nameTable[v.tree.children[0]],b=-1!==t.orientation.indexOf("Left"),w="Left"===v.tree.type?-1:0,x=i,C=n;f=o;var S,E,P,L,T=[],k=[];for(S=0;S<v.tree.children.length;S++){if("Alternate"===v.tree.type&&(P=S%2==0&&v.tree.children.length>2?"Left":"Right",w=S%2==0&&v.tree.children.length>2?-1:0),x=i+this.findOffset(t,e,v,P),s=t.nameTable[v.tree.children[S]],h=b?s.actualSize.height:s.actualSize.width,c=b?s.actualSize.width:s.actualSize.height,l=this.updateTree(t,x+w*h,C,s,o+1,void 0,!0),a=t.graphNodes[s.id],u={x:a.x,y:a.y,right:a.x+h,bottom:a.y+c},0===S?(this.uniteRects(l,u),p=l):this.uniteRects(p,l),!a.prevBounds||"Alternate"===v.tree.type&&S%2==1&&v.tree.children.length>2||(L=void 0!==L?Math.min(a.canMoveBy,L):a.canMoveBy),v.maxLevel=Math.max(v.maxLevel||0,a.maxLevel||0),"Alternate"===v.tree.type&&v.tree.children.length>2&&S%2==0?(0!==S&&(C=d.bottom+t.verticalSpacing/2),k.push({rBounds:u}),a.levelBounds&&(k=k.concat(a.levelBounds))):(C="Alternate"===v.tree.type&&v.tree.children.length>2?Math.max(l.bottom,d.bottom)+t.verticalSpacing/2:l.bottom+t.verticalSpacing/2,o=v.maxLevel,T.push({rBounds:u}),m?this.uniteRects(m,u):m={x:a.x,y:a.y,right:a.x+h,bottom:a.y+c},a.levelBounds&&(T=T.concat(a.levelBounds))),0===S&&(v.firstChild={x:a.x,canMoveBy:a.canMoveBy,child:s.id}),this.hasChild(t,s))if(!v.firstChild||v.firstChild.x>=a.firstChild.x){if(a.firstChild&&v.firstChild.canMoveBy<a.canMoveBy){var O=v.firstChild.canMoveBy;a.canMoveBy=O,t.graphNodes[v.firstChild.child].canMoveBy=O,v.firstChild.canMoveBy=O}v.firstChild={x:a.firstChild.x,canMoveBy:void 0!==L?L:a.canMoveBy,child:s.id}}else a.firstChild&&a.translated&&v.firstChild.canMoveBy>a.canMoveBy&&(v.firstChild.canMoveBy=t.graphNodes[v.firstChild.child].canMoveBy=a.canMoveBy);d=u}return r?v.levelBounds=T:("Alternate"===v.tree.type&&v.tree.children.length>2&&(g={x:k[0].rBounds.x,y:k[0].rBounds.y,right:k[k.length-1].rBounds.right,bottom:k[k.length-1].rBounds.bottom},E=this.findIntersectingLevels(t,g,f+1),this.updateRearBounds(t,null,k,f+1,E)),E=this.findIntersectingLevels(t,m||p,f+1),this.updateRearBounds(t,null,m?T:[{rBounds:p}],f+1,E)),isNaN(L)||(t.graphNodes[y.id].canMoveBy=L),v.childBounds=p,v.mid=i,p},t.prototype.splitChildrenInRows=function(t,e){var i,n;n=4;var o,r=[];o=(i=t.graphNodes[e.id]).tree.children.length;var s=this.extend(i.tree.children);if(i.tree.rows){var a=void 0;a=i.tree.children.length;var l=void 0;n=(l=Math.ceil(a/i.tree.rows))%2==0?l:l+1}else 3===i.tree.children.length||4===i.tree.children.length?n=2:5===i.tree.children.length&&(n=3);for(;o>0;)r[r.length]=s.splice(0,n),(o-=n)<n&&(n=o);return r},t.prototype.extend=function(t){var e,i=[];for(e=0;e<t.length;e++)i[e]=t[e];return i},t.prototype.findOffset=function(t,e,i,n){var o=0,r=-1!==t.orientation.indexOf("Left")?e.actualSize.height:e.actualSize.width,s=n||i.tree.type;switch(o=i.tree.offset||20,"Alternate"===i.tree.type&&o>=t.horizontalSpacing&&(o=t.horizontalSpacing/2),s){case"Left":o=r/2-o;break;case"Right":o+=r/2}return o},t.prototype.uniteRects=function(t,e){t.x=Math.min(t.x,e.x),t.right=Math.max(t.right,e.right),t.bottom=Math.max(t.bottom,e.bottom)},t.prototype.spaceLeftFromPrevSubTree=function(t,e,i){var n;n=t.graphNodes[e.id];var o,r,s,a;for(a=t.horizontalSpacing,s=0;s<n.intersect.length;s++)r=t.levels[n.intersect[s]].rBounds,o=i.x-(r.right+a),(void 0===n.diff||o<n.diff)&&(n.diff=o,n.prevBounds=t.levels[n.intersect[s]].rBounds)},t.prototype.findIntersectingLevels=function(t,e,i,n){var o;(o={x:e.x,y:e.y,right:e.right,bottom:e.bottom}).y-=t.verticalSpacing/2,o.bottom+=t.verticalSpacing/2;var r;r=[];var s,a;a=void 0!==n?n:i,s=t.levels[a]?t.levels[a].rBounds:null;do{if(s&&(o.y<s.y&&o.bottom>s.y||o.y<s.bottom&&s.bottom<o.bottom||o.y>=s.y&&o.bottom<=s.bottom||o.y<s.y&&o.bottom>s.bottom)){r.splice(0,0,a)}else if(s&&s.bottom<o.y)break;a--,s=t.levels[a]?t.levels[a].rBounds:null}while(a>=0);a=(void 0!==n?n:i)+1,s=t.levels[a]?t.levels[a].rBounds:null;do{if(s&&(o.y<s.y&&o.bottom>s.y||o.y<s.bottom&&s.bottom<o.bottom||o.y>=s.y&&o.bottom<=s.bottom||o.y<s.y&&o.bottom>s.bottom))r.push(a);else if(s&&s.y>o.bottom)break;a++,s=t.levels[a]?t.levels[a].rBounds:null}while(a<=t.levels.length);return r},t.prototype.findLevel=function(t,e,i){var n;n=e;var o;o=0;var r;for(r=t.levels[o]?t.levels[o].rBounds:null;o<t.levels.length;){if(r&&n.bottom<r.y)return o;o++,r=t.levels[o]?t.levels[o].rBounds:null}return o},t.prototype.getParentNode=function(t,e){return t.nameTable[t.nameTable[e.inEdges[0]].sourceID]},t.prototype.updateEdges=function(t,e,i){var n;n=t.graphNodes[e.id];var o;if(e.outEdges&&e.outEdges.length&&e.isExpanded)for(o=0;o<e.outEdges.length;o++){var r=void 0;(r=t.nameTable[t.nameTable[e.outEdges[o]].targetID]).excludeFromLayout||(-1===n.tree.children.indexOf(r.id)&&n.tree.children.push(r.id),r.outEdges&&r.outEdges.length&&r.isExpanded&&(n.tree.hasSubTree=!0),this.updateEdges(t,r,i+1))}n.tree.level=i,n.tree.hasSubTree&&(n.tree.orientation="Horizontal",n.tree.type="Center"),t.getLayoutInfo&&"OrganizationalChart"===t.type&&(t.getLayoutInfo(e,n.tree),"Balanced"===n.tree.type&&n.tree.hasSubTree&&(n.tree.type="Center",n.tree.orientation="Horizontal")),t.level&&"Alternate"!==n.tree.type&&i>=t.level&&(n.tree.hasSubTree=!1)},t.prototype.updateAnchor=function(t,e,i){var n,o,r,s=0,a=0,l=0,h=new Rl(0,0,i.x,i.y);r=t.bounds?t.bounds:h;var c=t.orientation;if(t.fixedNode){s=(o=t.nameTable[t.fixedNode]).actualSize.width,a=o.actualSize.height,t.anchorX=o.offsetX,t.anchorY=o.offsetY;var d=o.pivot;for(t.anchorX+="RightToLeft"===t.orientation?s*d.x:-s*d.x,t.anchorY+="BottomToTop"===t.orientation?a*d.y:-a*d.y,n=o,l=0;n.inEdges.length;)n=this.getParentNode(t,n),l+=t.graphNodes[n.id].subTreeTranslation||0;-1!==t.orientation.indexOf("Left")?(t.anchorX-=t.graphNodes[o.id].y,t.anchorY-=t.graphNodes[o.id].x+l):(t.anchorX-=t.graphNodes[o.id].x+l,t.anchorY-=t.graphNodes[o.id].y)}else if("TopToBottom"===c||"BottomToTop"===c){switch(t.horizontalAlignment){case"Left":t.anchorX=r.x-e.x+t.margin.left;break;case"Right":t.anchorX=r.x+r.width-t.margin.right-e.right;break;case"Auto":case"Center":t.anchorX=r.x+r.width/2-(e.x+e.right)/2}switch(t.verticalAlignment){case"Auto":case"Top":var p;p=r.y+t.margin.top,t.anchorY="TopToBottom"===c?p:e.bottom+p;break;case"Bottom":var u=void 0;u=r.y+r.height-t.margin.bottom,t.anchorY="TopToBottom"===c?u-e.bottom:u;break;case"Center":f=void 0;f=r.y+r.height/2,t.anchorY="TopToBottom"===t.orientation?f-(e.y+e.bottom)/2:f+(e.y+e.bottom)/2}}else{switch(t.horizontalAlignment){case"Auto":case"Left":var g=void 0;g=r.x+t.margin.left,t.anchorX="LeftToRight"===c?g:e.bottom+g;break;case"Right":var m=void 0;m=r.x+r.width-t.margin.right,t.anchorX="LeftToRight"===c?m-e.bottom:m;break;case"Center":var f=void 0;f=r.width/2+r.x,t.anchorX="LeftToRight"===t.orientation?f-(e.y+e.bottom)/2:f+(e.y+e.bottom)/2}switch(t.verticalAlignment){case"Top":t.anchorY=r.y+t.margin.top-e.x;break;case"Auto":case"Center":t.anchorY=r.y+r.height/2-(e.right+e.x)/2;break;case"Bottom":t.anchorY=r.y+r.height-t.margin.bottom-e.right}}},t.prototype.updateConnectors=function(t,e,i){var n,o,r,s;if(o=t.graphNodes[e.id],e.outEdges.length)for(n=0;n<e.outEdges.length;n++)(s=t.nameTable[e.outEdges[n]]).points=[],r=t.nameTable[s.targetID],s.visible&&(s.visited=!0,t.getConnectorSegments?t.getConnectorSegments(s):o&&-1!==o.tree.children.indexOf(s.targetID)&&(s.segments=[],"OrganizationalChart"===t.type&&"Orthogonal"===s.type&&this.updateSegments(t,s,e,r,n)),r&&(r.isExpanded||this.hasChild(t,r))&&this.updateConnectors(t,r,i+1));if(o&&o.tree.assistants.length)for(n=0;n<o.tree.assistants.length;n++)r=t.nameTable[o.tree.assistants[n]],s=t.nameTable[r.inEdges[0]],this.get3Points(t,e,r,s),(r.isExpanded||this.hasChild(t,r))&&this.updateConnectors(t,r,i+1)},t.prototype.updateSegments=function(t,e,i,n,o){var r=t.graphNodes[i.id];r.tree.assistants.length?this.updateSegmentsForHorizontalOrientation(t,i,n,e):"Horizontal"===r.tree.orientation&&"Balanced"===r.tree.type?this.updateSegmentsForBalancedTree(t,e,i,n,o):"Horizontal"===r.tree.orientation?this.updateSegmentsForHorizontalOrientation(t,i,n,e):r.tree.offset<5?this.get5Points(t,i,n,e):this.get3Points(t,i,n,e)},t.prototype.updateSegmentsForBalancedTree=function(t,e,i,n,o){var r,s=t.graphNodes[i.id];if(5===s.tree.children.length&&o>2){r=s.tree.children[1],isNaN(t.graphNodes[r].treeWidth)&&(t.graphNodes[r].treeWidth=t.nameTable[r].actualSize.width);var a=3!==o?1:-1;-1!==t.orientation.indexOf("Left")?t.nameTable[r].offsetY-t.graphNodes[r].treeWidth/2-t.verticalSpacing*a/2:t.nameTable[r].offsetX+t.graphNodes[r].treeWidth/2+t.horizontalSpacing*a/2,this.getSegmentsForMultipleRows(t,i,n,e)}else s.tree.children.length>5?o<4?this.getSegmentsForMultipleRows(t,i,n,e):this.updateSegmentsForHorizontalOrientation(t,i,n,e):4===s.tree.children.length?o<2?this.getSegmentsForMultipleRows(t,i,n,e):this.updateSegmentsForHorizontalOrientation(t,i,n,e):this.getSegmentsForMultipleRows(t,i,n,e)},t.prototype.get3Points=function(t,e,i,n){var o=[],r=this.getBounds(e),s=this.getBounds(i);if(-1!==t.orientation.indexOf("Top")){var a=0===t.orientation.indexOf("Top")?r.bottomCenter:r.topCenter,l=e.offsetX>i.offsetX?s.middleRight:s.middleLeft;o.push(a,{x:r.bottomCenter.x,y:l.y},l)}else{var a=0===t.orientation.indexOf("Left")?r.middleRight:r.middleLeft,l=e.offsetY>i.offsetY?s.bottomCenter:s.topCenter;o.push(a,{x:s.bottomCenter.x,y:r.middleRight.y},l)}this.getSegmentsFromPoints(o,n)},t.prototype.get5Points=function(t,e,i,n){var o=[],r=this.getBounds(e),s=this.getBounds(i);t.graphNodes[e.id];e.offsetX>i.offsetX?o.push(r.bottomCenter,{x:r.bottomCenter.x,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleRight.x+t.horizontalSpacing/2,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleRight.x+t.horizontalSpacing/2,y:s.middleRight.y},s.middleRight):o.push(r.bottomCenter,{x:r.bottomCenter.x,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleLeft.x-t.horizontalSpacing/2,y:r.bottomCenter.y+t.verticalSpacing/4},{x:s.middleLeft.x-t.horizontalSpacing/2,y:s.middleLeft.y},s.middleLeft),this.getSegmentsFromPoints(o,n)},t.prototype.getSegmentsFromPoints=function(t,e){for(var i,n=[],o=0;o<t.length-2;o++)(i=new Vc(e,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(t[o],t[o+1]),i.length=Dl.distancePoints(t[o],t[o+1]),n.push(i);e.segments=n},t.prototype.getSegmentsForMultipleRows=function(t,e,i,n){var o,r,s=[],a=this.getBounds(i),l=this.getBounds(e);switch(t.orientation){case"TopToBottom":o={x:l.bottomCenter.x,y:l.bottomCenter.y+t.verticalSpacing/4},(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(l.bottomCenter,o),r.length=Dl.distancePoints(l.bottomCenter,o),s.push(r);break;case"BottomToTop":o={x:l.bottomCenter.x,y:l.topCenter.y-t.verticalSpacing/4},(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(l.topCenter,o),r.length=Dl.distancePoints(l.topCenter,o),s.push(r);break;case"LeftToRight":if(o={x:l.middleRight.x+t.verticalSpacing/4,y:l.middleRight.y},r=new Vc(n,"segments",{type:"Orthogonal"},!0),r.direction=Dl.direction(l.middleRight,o),r.length=Dl.distancePoints(l.middleRight,o),s.push(r),a.center.y!==l.center.y){var h={x:l.middleRight.x+t.verticalSpacing/4,y:a.middleLeft.y};(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(o,h),r.length=Dl.distancePoints(o,h),s.push(r)}break;case"RightToLeft":if(o={x:l.middleLeft.x-t.verticalSpacing/4,y:l.middleRight.y},r=new Vc(n,"segments",{type:"Orthogonal"},!0),r.direction=Dl.direction(l.middleLeft,o),r.length=Dl.distancePoints(l.middleLeft,o),s.push(r),a.center.y!==l.center.y){var c={x:l.middleLeft.x-t.verticalSpacing/4,y:a.middleLeft.y};(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(c,c),r.length=Dl.distancePoints(c,c),s.push(r)}}n.segments=s},t.prototype.updateSegmentsForHorizontalOrientation=function(t,e,i,n){var o,r,s=[],a=[],l=this.getBounds(e),h=this.getBounds(i);switch(t.orientation){case"TopToBottom":o={x:l.bottomCenter.x,y:h.topCenter.y-t.verticalSpacing/2},(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(l.bottomCenter,o),r.length=Dl.distancePoints(l.bottomCenter,o),a.push(r);break;case"BottomToTop":o={x:l.topCenter.x,y:h.bottomCenter.y+t.verticalSpacing/2},(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(l.topCenter,o),r.length=Dl.distancePoints(l.topCenter,o),a.push(r);break;case"LeftToRight":if(o={x:h.middleLeft.x-t.verticalSpacing/2,y:l.middleRight.y},r=new Vc(n,"segments",{type:"Orthogonal"},!0),r.direction=Dl.direction(l.middleRight,o),r.length=Dl.distancePoints(l.middleRight,o),a.push(r),h.center.y!==l.center.y){var c={x:h.middleLeft.x-t.verticalSpacing/2,y:h.middleLeft.y};(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(o,c),r.length=Dl.distancePoints(o,c),a.push(r)}break;case"RightToLeft":if(o={x:h.middleRight.x+t.verticalSpacing/2,y:l.middleRight.y},r=new Vc(n,"segments",{type:"Orthogonal"},!0),r.direction=Dl.direction(l.middleLeft,o),r.length=Dl.distancePoints(l.middleLeft,o),a.push(r),h.center.y!==l.center.y){var d={x:h.middleRight.x+t.verticalSpacing/2,y:h.middleLeft.y};(r=new Vc(n,"segments",{type:"Orthogonal"},!0)).direction=Dl.direction(o,d),r.length=Dl.distancePoints(o,d),a.push(r)}}return n.segments=a,s},t.prototype.updateNodes=function(t,e,i,n,o,r){var s,a,l,h,c,d;if(l=e.actualSize.width,h=e.actualSize.height,!e.excludeFromLayout){c=t.anchorX,d=t.anchorY,"LeftToRight"===t.orientation?(c+=t.graphNodes[e.id].y+l/2,d+=t.graphNodes[e.id].x+i+h/2):"RightToLeft"===t.orientation?(c-=t.graphNodes[e.id].y+l/2,d+=t.graphNodes[e.id].x+i+h/2):"TopToBottom"===t.orientation?(c+=t.graphNodes[e.id].x+i+l/2,d+=t.graphNodes[e.id].y+h/2):(c+=t.graphNodes[e.id].x+i+l/2,d-=t.graphNodes[e.id].y+h/2),t.graphNodes&&(c+=o=o||0,d+=r=r||0,this.isAnimation||(e.offsetX=c,e.offsetY=d));var p={id:e.id,differenceX:c-e.offsetX,differenceY:d-e.offsetY};t.objects.push(p);var u=void 0;if(u=[],this.hasChild(t,e))for(s=0;s<t.graphNodes[e.id].tree.children.length;s++)a=t.nameTable[t.graphNodes[e.id].tree.children[s]],this.updateNodes(t,a,i+(t.graphNodes[e.id].subTreeTranslation||0),n,o,r),u.push(a);if(t.graphNodes[e.id].tree.assistants.length)for(s=0;s<t.graphNodes[e.id].tree.assistants.length;s++)a=t.nameTable[t.graphNodes[e.id].tree.assistants[s]],this.updateNodes(t,a,i+(t.graphNodes[e.id].subTreeTranslation||0),null,o,r)}},t}(),_m=function(){function t(){this.isAnimation=!1}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"MindMapChart"},t.prototype.updateLayout=function(t,e,i,n,o,r){var s;if(s=this.checkRoot(t,i,o,r,e))i.fixedNode=s;else for(var a=0,l=t;a<l.length;a++)if(!((f=l[a]).excludeFromLayout||f.inEdges&&f.inEdges.length)){i.fixedNode=f.id;break}var h=e[i.fixedNode],c=this.findFirstLevelNodes(h,i,e),d=[],p=[],u=as(i.getBranch);u=u||as(this.getBranch);for(var g=0,m=c;g<m.length;g++){var f=m[g];"Left"===u(f,c)?d.push(f):p.push(f)}var v=new Rl(0,0,n.x,n.y);e[i.fixedNode].offsetX=v.x+v.width/2,e[i.fixedNode].offsetY=v.y+v.height/2,d.length&&this.updateMindMapBranch(t,p,e,i,n,o,"Left"),p.length&&this.updateMindMapBranch(t,d,e,i,n,o,"Right")},t.prototype.checkRoot=function(t,e,i,n,o){for(var r=0,s=t;r<s.length;r++){var a=s[r];if(!a.excludeFromLayout){if(a.data&&(a.data[i].toString()===n||a.data[i].toString()===e.root))return a.id;if(!a.data&&a.id===e.root)return a.id}}return""},t.prototype.updateMindMapBranch=function(t,e,i,n,o,r,s){var a;(a={type:"HierarchicalTree",horizontalSpacing:n.verticalSpacing,verticalSpacing:n.horizontalSpacing,verticalAlignment:n.verticalAlignment,horizontalAlignment:n.horizontalAlignment,fixedNode:n.fixedNode,getLayoutInfo:as(n.getLayoutInfo),margin:n.margin,root:n.fixedNode}).orientation="Left"===s?"LeftToRight":"RightToLeft",this.excludeFromLayout(e,i,!0),(new Vm).updateLayout(t,i,a,o,r),this.excludeFromLayout(e,i,!1)},t.prototype.getBranch=function(t,e){return e.indexOf(t)%2==0?"Left":"Right"},t.prototype.excludeFromLayout=function(t,e,i){for(var n=0,o=t;n<o.length;n++)e[o[n].id].excludeFromLayout=i},t.prototype.findFirstLevelNodes=function(t,e,i){var n=[];if(t&&t.outEdges.length)for(var o=0,r=t.outEdges;o<r.length;o++){var s=r[o];n.push(i[i[s].targetID])}return n},t}(),Wm=function(){function t(){}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"RadialTree"},t.prototype.updateLayout=function(t,e,i,n){var o={type:i.type,nameTable:e,anchorX:0,anchorY:0,firstLevelNodes:[],centerNode:null,levels:[],maxLevel:0,graphNodes:{},layoutNodes:[],orientation:i.orientation,horizontalSpacing:i.horizontalSpacing,verticalSpacing:i.verticalSpacing,verticalAlignment:i.verticalAlignment,horizontalAlignment:i.horizontalAlignment,fixedNode:i.fixedNode,margin:i.margin,bounds:i.bounds,objects:[],root:i.root};this.doLayout(o,t,e,n)},t.prototype.doLayout=function(t,e,i,n){for(var o,r=0;r<e.length;r++)(o=e[r]).excludeFromLayout||(t.graphNodes[o.id]=this.setUpLayoutInfo(t,o),o.inEdges&&o.inEdges.length||t.firstLevelNodes.push(o));t.root&&i[t.root]?t.centerNode=i[t.root]:t.firstLevelNodes.length&&(t.centerNode=t.firstLevelNodes[0],t.root=t.centerNode.id),t.centerNode&&(this.updateEdges(t,t.centerNode,0,i),this.depthFirstAllignment(t,t.centerNode,0,0),this.populateLevels(t),this.transformToCircleLayout(t),this.updateAnchor(t,n),this.updateNodes(t,t.centerNode,i))},t.prototype.updateEdges=function(t,e,i,n){var o=t.graphNodes[e.id];t.layoutNodes.push(o),o.level=i,o.visited=!0,t.maxLevel=Math.max(t.maxLevel,i);for(var r=0;r<e.outEdges.length;r++){var s=n[n[e.outEdges[r]].targetID];s.excludeFromLayout||s.visited||(o.children.push(s),this.updateEdges(t,s,i+1,n))}},t.prototype.depthFirstAllignment=function(t,e,i,n){var o,r=t.graphNodes[e.id];if(r.children.length){n+=300;for(l=0;l<r.children.length;l++)i=(o=this.depthFirstAllignment(t,r.children[l],i,n)).x,n=o.y;r.children=r.children.sort(function(e,i){return t.graphNodes[e.id].x-t.graphNodes[i.id].x});var s=t.graphNodes[r.children[0].id].min,a=t.graphNodes[r.children[r.children.length-1].id].max;if(r.x=s+(a-s)/2,i=a+t.horizontalSpacing,r.segmentOffset=a+t.horizontalSpacing,r.x-=r.width/2,r.y-=r.height/2,r.min=s,r.max=a,r.x<s&&r.visited){r.x=s,i=r.x+r.width/2-(a-s)/2,r.visited=!1;for(var l=0;l<r.children.length;l++)o=this.depthFirstAllignment(t,r.children[l],i,n);r.visited=!0,i=r.x+r.width+t.horizontalSpacing}i=i<(a=t.graphNodes[r.children[r.children.length-1].id].segmentOffset)?a:i,n-=300,r.y=n}else r.x=i,r.y=n,r.min=i,r.max=i+r.width,i+=r.width+t.horizontalSpacing;return{x:i,y:n}},t.prototype.populateLevels=function(t){var e=[],i=Math.min.apply(Math,t.layoutNodes.map(function(t){return t.x})),n=Math.max.apply(Math,t.layoutNodes.map(function(e){return e.x+e.width+t.horizontalSpacing}))-i;t.levels=[];for(var o=0;o<=t.maxLevel;o++)!function(o){e=t.layoutNodes.filter(function(t){return t.level===o?t:null});var r={};e=e.sort(function(t,e){return t.x-e.x}),r.min=e[0].x,r.max=e[e.length-1].x+e[e.length-1].width+t.horizontalSpacing,r.actualCircumference=0,r.height=0;for(var s=0;s<e.length;s++)e[s].height>r.height&&(r.height=e[s].height),r.actualCircumference+=Math.max(e[s].width,e[s].height),s!==e.length-1&&(r.actualCircumference+=t.horizontalSpacing);r.circumference=r.max-r.min,r.actualCircumference<r.circumference&&(r.circumference=(r.circumference+r.actualCircumference)/2),r.radius=r.circumference/(2*Math.PI)+r.height,r.nodes=[],o>1&&t.levels[o-1].radius+t.levels[o-1].height>=r.radius&&(r.radius=t.levels[o-1].radius+t.levels[o-1].height);for(var a=0;a<e.length;a++)e[a].ratio=Math.abs(e[a].x+e[a].width/2-i)/n,r.nodes.push(e[a]);t.levels.push(r)}(o)},t.prototype.transformToCircleLayout=function(t){var e=t.graphNodes[t.centerNode.id];e.x=0,e.y=0;for(var i=1;i<t.levels.length;i++)for(var n=0;n<t.levels[i].nodes.length;n++){var o=t.levels[i].nodes[n];o.x=Math.cos(360*o.ratio*Math.PI/180)*(t.levels[i].radius+t.verticalSpacing*i),o.y=Math.sin(360*o.ratio*Math.PI/180)*(t.levels[i].radius+t.verticalSpacing*i),t.anchorX=Math.min(t.anchorX,o.x),t.anchorY=Math.min(t.anchorY,o.y)}},t.prototype.updateAnchor=function(t,e){t.anchorX=t.centerNode.offsetX||e.x/2,t.anchorY=t.centerNode.offsetY||e.y/2},t.prototype.updateNodes=function(t,e,i){var n=t.graphNodes[e.id],o=n.x+t.anchorX,r=n.y+t.anchorY;e.offsetX+=o,e.offsetY+=r;for(var s=0;s<n.children.length;s++){var a=n.children[s];this.updateNodes(t,i[a.id],i)}},t.prototype.setUpLayoutInfo=function(t,e){var i={};return i.name=e.id,i.x=0,i.y=0,i.min=0,i.max=0,i.width=e.actualSize.width,i.height=e.actualSize.height,i.children=[],i.level=0,i.ratio=0,i.visited=!1,i},t}(),Um=function(){function t(t){this.velocityX=0,this.velocityY=0,this.nodes=[],this.graphNode=t;var e=ia(this.graphNode);this.location=e.center,this.nodes=[],t.treeInfo.parents||(t.treeInfo.parents=[]),t.treeInfo.children||(t.treeInfo.children=[]),this.nodes=t.treeInfo.parents.concat(t.treeInfo.children)}return t.prototype.applyChanges=function(){this.graphNode.treeInfo.center=this.location},t}(),qm=function(){function t(){this.cdCOEF=.442,this.cfMAXVELOCITY=50,this.cnMAXITERACTION=1e3,this.cnSPRINGLENGTH=100,this.mszMaxForceVelocity={width:this.cfMAXVELOCITY,height:this.cfMAXVELOCITY},this.springLength=0,this.springFactor=this.cdCOEF,this.maxIteration=this.cnMAXITERACTION,this.springLength=this.cnSPRINGLENGTH}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"SymmetricalLayout"},t.prototype.doGraphLayout=function(t){var e=this.selectedNode;e.treeInfo.Bounds=t.getModelBounds(t.nodes);var i=e.treeInfo.GraphNodes,n=this.convertGraphNodes(i),o=n.length;o=Math.min(this.maxIteration,o*o*o),this.preLayoutNodes(n,e.treeInfo.Bounds);for(var r=0,s=o;r<s;r++)this.makeSymmetricLayout(n),this.appendForces(n);this.resetGraphPosition(n,e)},t.prototype.preLayoutNodes=function(t,e){for(var i=Math.max(e?e.width:25,e?e.height:25),n={x:i/2,y:i/2},o=2*Math.PI/t.length,r=o,s=0;s<t.length;s++){var a=t[s];this.getForceNode(a).location={x:n.x+i*Number(Math.cos(r).toFixed(2)),y:n.y+i*Number(Math.sin(r).toFixed(2))},r-=o}},t.prototype.doLayout=function(t){this.selectedNode=t.selectedNode,this.doGraphLayout(t)},t.prototype.makeSymmetricLayout=function(t){for(var e,i,n=0;n<t.length;n++){for(var o=t[n],r=(e=this.getForceNode(o)).nodes,s=0;s<r.length;s++)na((g=r[s]).id,t)&&this.calcNodesForce(e,this.getForceNode(g));for(var a=0,l=r.length;a<l&&!(l<2);a++){var h=this.getForceNode(r[a]),c=a+1>=l?this.getForceNode(r[0]):this.getForceNode(r[a+1]),d=360/r.length/2*Math.PI/180,p=2*this.springLength*Math.sin(d);this.calcRelatesForce(h,c,p)}for(var u=0;u<t.length;u++){var g=t[u];na(g.id,r)||g.id===o.id||(i=this.getForceNode(g),this.updateNeigbour(e,i))}}},t.prototype.appendForces=function(t){for(var e=null,i=0;i<t.length;i++){var n=t[i],o=(e=this.getForceNode(n)).location;o.x+=Math.min(e.velocityX,this.mszMaxForceVelocity.width),o.y+=Math.min(e.velocityY,this.mszMaxForceVelocity.height),e.velocityX=0,e.velocityY=0,e.location=o}},t.prototype.resetGraphPosition=function(t,e){for(var i,n={width:Number.MAX_VALUE,height:Number.MAX_VALUE},o=null,r=0;r<t.length;r++){i=t[r];var s={x:(o=this.getForceNode(i)).location.x-i.actualSize.width/2,y:o.location.y-i.actualSize.height/2};n.width=Math.min(n.width,s.x),n.height=Math.min(n.height,s.y)}for(r=0;r<t.length;r++)i=t[r],(s=(o=this.getForceNode(i)).location).x-=n.width-(e.treeInfo.location?e.treeInfo.location.x:0),s.y-=n.height-(e.treeInfo.location?e.treeInfo.location.y:0),o.location=s,o.applyChanges()},t.prototype.convertGraphNodes=function(t){for(var e=[],i=0,n=Object.keys(t);i<n.length;i++){var o=n[i];if(t[o]){var r=t[o],s=new Um(r);r.treeInfo.tag=s,e.push(r)}}return e},t.prototype.getForceNode=function(t){return t.treeInfo.tag},t.prototype.updateNeigbour=function(t,e){if(null!=e&&null!=t){var i=this.pointDistance(t.location,e.location),n=this.lineAngle(t.location,e.location),o=.9*this.springLength;i<o&&this.calcForce(i,o,n,e)}},t.prototype.lineAngle=function(t,e){var i=0,n=e.x-t.x,o=e.y-t.y;return 0===n?i=o<=0?3*Math.PI/2:Math.PI/2:0===o?i=n<0?Math.PI:0:(i=Math.atan(o/n),n<0&&o>0?i=Math.PI+i:n<0&&o<0?i=Math.PI+i:n>0&&o<0&&(i=2*Math.PI+i)),i},t.prototype.pointDistance=function(t,e){var i=0,n=e.x-t.x,o=e.y-t.y,r=n*n+o*o;return r>0&&(i=Math.sqrt(r)),i},t.prototype.calcRelatesForce=function(t,e,i){var n=this.pointDistance(t.location,e.location),o=this.lineAngle(t.location,e.location);n<i&&this.calcForce(n,i,o,e)},t.prototype.updateLayout=function(t,e,i,n,o,r){(new Xm).updateLayout(t,e,i,n,o,r)},t.prototype.calcNodesForce=function(t,e){var i=this.pointDistance(t.location,e.location),n=this.lineAngle(t.location,e.location);(i>this.springLength||i<this.springLength)&&this.calcForce(i,this.springLength,n,e)},t.prototype.calcForce=function(t,e,i,n){var o=n.nodes.length,r=t-e,s=this.springFactor/(o*o)*Math.sqrt(o);if(0!==r){var a=r*s,l=Math.cos(i)*a,h=Math.sin(i)*a;n.velocityX-=l,n.velocityY-=h}},t}(),Xm=function(){function t(){this.visitedStack=[],this.cycleEdgesCollection=[],this.graphObjects=[],this.passedNodes=[]}return t.prototype.updateLayout=function(t,e,i,n,o,r){this.nameTable=n,this.nodes=t,this.connectors=e;var s=t;s.length>0&&(this.mhelperSelectedNode=Yr(s[0]));for(var a=0,l=t;a<l.length;a++){var h=void 0;(h=m=l[a]).treeInfo={},h.treeInfo.graphType="Node",this.graphObjects.push(h)}for(var c=0,d=e;c<d.length;c++){var p=void 0;(p=d[c]).treeInfo={},p.treeInfo.graphType="Connector",this.graphObjects.push(p)}this.updateLayout1(this.graphObjects,i);for(var u=this.getModelBounds(s),g=0;g<s.length;g++){var m=s[g],f=(r.x-u.width)/2,v=o.margin||{};v.left=v.left||0,v.right=v.right||0,v.top=v.top||0,v.bottom=v.bottom||0,o.margin.left&&(v.left=o.margin.left),o.margin.top&&(v.top=o.margin.top);var y=m.treeInfo.tag.location.x-(m.offsetX-m.actualSize.width/2)-u.x+f+v.left,b=m.treeInfo.tag.location.y-(m.offsetY-m.actualSize.height/2)-u.y+v.top;m.offsetX+=y,m.offsetY+=b,delete m.treeInfo}return!0},t.prototype.getModelBounds=function(t){t=t.slice();for(var e,i=null,n=null,o=0;o<t.length;o++){var r=ia(e=t[o]);i=new Rl(e.treeInfo.tag?e.treeInfo.tag.location.x:r.x,e.treeInfo.tag?e.treeInfo.tag.location.y:r.y,e.actualSize.width,e.actualSize.height),n=n?n.uniteRect(i):i}return n},t.prototype.updateLayout1=function(t,e){this.detectCyclesInGraph(t);var i=t.length;if(i>0){for(var n=[],o=[],r=[],s=0;s<t.length;s++){var a=t[s];void 0===a.treeInfo.isCycleEdge&&(a.treeInfo.isCycleEdge=!1),"Connector"!==a.treeInfo.graphType||a.treeInfo.isCycleEdge?"Connector"===a.treeInfo.graphType?n.push(a):r.push(a):o.push(a)}for(o=o.concat(r),o=n.concat(o);i>this.dictionaryLength(this.passedNodes);)if(this.getNodesToPosition(o),null!=this.selectedNode){e.doLayout(this),this.selectedNode=null,this.visitedStack=[];for(var l=0,h=this.cycleEdgesCollection;l<h.length;l++)h[l].treeInfo.isCycleEdge=!1}this.passedNodes=null,this.selectedNode=null}return!1},t.prototype.getNodesToPosition=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(!na(i.id,this.passedNodes)){i&&this.selectNodes(i);break}}},t.prototype.selectNodes=function(t){var e=t;"Connector"===t.treeInfo.graphType?this.exploreGraphEdge(t):null!=e&&this.addNode(t,"passed")&&(this.addNode(t,"selected"),this.isConnectedToAnotherNode(e)?(this.selectedNode={treeInfo:{}},this.selectedNode.treeInfo.LeftMargin=10,this.selectedNode.treeInfo.TopMargin=10,this.selectConnectedNodes(e)):this.selectedNode=t)},t.prototype.selectConnectedNodes=function(t){var e=this.selectedNode;e.treeInfo.GraphNodes||(e.treeInfo.GraphNodes={});var i=t;if(null!=i&&this.addNode(i,"passed")){var n=i.id;if(this.dictionaryContains(e.treeInfo.GraphNodes,i)){var o=e.treeInfo.GraphNodes[n];o.treeInfo.Added&&(o.treeInfo.Added=!1,this.getConnectedRelatives(o),this.exploreRelatives(t))}else{var r=this.addGraphNode(i);this.getConnectedRelatives(r),this.exploreRelatives(t)}}},t.prototype.exploreRelatives=function(t){this.exploreRelatives1(t,"Parents"),this.exploreRelatives1(t,"Children")},t.prototype.exploreRelatives1=function(t,e){var i=[];"Parents"===e?i=t.inEdges:"Children"===e&&(i=t.outEdges);for(var n=0;n<i.length;n++){var o=this.nameTable[i[n]];if(this.addNode(o,"passed")){var r=this.nameTable[o.sourceID],s=this.nameTable[o.targetID];"Parents"===e&&null!=r&&na(r.id,this.nodes)?this.selectConnectedNodes(this.nameTable[o.sourceID]):"Children"===e&&null!=s&&na(s.id,this.nodes)&&this.selectConnectedNodes(this.nameTable[o.targetID])}}},t.prototype.getConnectedRelatives=function(t){this.getConnectedParents(t),this.getConnectedChildren(t)},t.prototype.dictionaryContains=function(t,e){for(var i=Object.keys(t),n=0;n<i.length;n++)if(i[n]===e.id)return!0;return!1},t.prototype.dictionaryLength=function(t){return Object.keys(t).length},t.prototype.getConnectedChildren=function(t){for(var e=this.selectedNode,i=t,n=0;n<i.outEdges.length;n++){var o=this.nameTable[i.outEdges[n]];if(!o.treeInfo.isCycleEdge){var r=this.nameTable[o.targetID];if(na(r.id,this.nodes)&&null!=r&&r.visible){var s=void 0;this.dictionaryContains(e.treeInfo.GraphNodes,r)?s=e.treeInfo.GraphNodes[r.id]:(s=this.addGraphNode(r)).treeInfo.Added=!0,t.treeInfo.children||(t.treeInfo.children=[]),s.treeInfo.parents||(s.treeInfo.parents=[]),this.setNode(s.treeInfo.parents,t),this.findNode(t.treeInfo.children,s.id)<0&&t.treeInfo.children.push(s)}}}},t.prototype.getConnectedParents=function(t){for(var e=this.selectedNode,i=t,n=0;n<i.inEdges.length;n++){var o=this.nameTable[i.inEdges[n]];if(!o.treeInfo.isCycleEdge){var r=this.nameTable[o.sourceID];if(na(r.id,this.nodes)&&null!=r&&r.visible){var s=void 0;this.dictionaryContains(e.treeInfo.GraphNodes,r)?s=e.treeInfo.GraphNodes[r.id]:(s=this.addGraphNode(r)).treeInfo.Added=!0,t.treeInfo.parents||(t.treeInfo.parents=[]),s.treeInfo.children||(s.treeInfo.children=[]),this.setNode(s.treeInfo.children,t),this.findNode(t.treeInfo.parents,s.id)<0&&t.treeInfo.parents.push(s)}}}},t.prototype.setNode=function(t,e){var i=this.findNode(t,e.id);i>=0&&i<t.length?t[i]=e:t.push(e)},t.prototype.findNode=function(t,e){var i=-1;if(null!=t&&""!==e)for(var n=0,o=t.length;n<o;n++){var r=t[n];if("string"==typeof r&&r===e){i=n;break}if(null!=r&&r.id===e){i=n;break}}return i},t.prototype.addGraphNode=function(t){var e=this.selectedNode;e.treeInfo.GraphNodes||(e.treeInfo.GraphNodes={});var i=t;if(null!=e){e.treeInfo.GraphNodes[i.id]=i;var n=this.mhelperSelectedNode;null!=n&&t.id===n.id&&(this.mhelperSelectedNode=i)}return i},t.prototype.isConnectedToAnotherNode=function(t){var e=!1;return t.inEdges.concat(t.outEdges).length>0&&(null!=t.inEdges&&t.inEdges.length>0&&(e=this.searchEdgeCollection(t.inEdges,"FromNode")),!e&&null!=t.outEdges&&t.outEdges.length>0&&(e=this.searchEdgeCollection(t.outEdges,"ToNode"))),e},t.prototype.searchEdgeCollection=function(t,e){for(var i=!1,n=0;n<t.length-1;n++){var o=this.nameTable[t[n]];if(this.addNode(o,"passed")&&(!o.treeInfo.isCycleEdge&&("FromNode"===e&&null!=this.nameTable[o.sourceID]||"ToNode"===e&&null!=this.nameTable[o.targetID]))){i=!0;break}}return i},t.prototype.exploreGraphEdge=function(t){var e=t;if(null!=e&&!e.treeInfo.isCycleEdge&&this.addNode(t,"passed")){this.addNode(t,"selected");var i=this.nameTable[e.sourceID],n=this.nameTable[e.targetID];null!=i?this.selectNodes(i):null!=n?this.selectNodes(n):this.selectedNode=t}},t.prototype.addNode=function(t,e){var i=t;return"passed"!==e&&i.visible||this.dictionaryContains(this.passedNodes,i)||(this.passedNodes[i.id]=i),!!i.visible},t.prototype.detectCyclesInGraph=function(t){for(var e=[],i=[],n=0;n<t.length;n++)"Connector"!==t[n].treeInfo.graphType&&e.push(t[n]);if(e.length>0)for(i.push(e[0]),this.visitedStack.push(e[0]);i.length>0;){var o=i[i.length-1],r=this.getUnVisitedChildNodes(o);if(r.length>0){var s=r[0],a=r[r.length-1];na(s.id,this.visitedStack)?(a.treeInfo.isCycleEdge=!0,this.cycleEdgesCollection.push(a)):(i.push(s),this.visitedStack.splice(0,0,s))}else i.pop()}},t.prototype.getUnVisitedChildNodes=function(t){var e=[];if(t.outEdges.length>0){for(var i=0;i<t.outEdges.length;i++){var n=this.nameTable[t.outEdges[i]];if(!na(n.id,this.visitedStack)){var o=this.nameTable[n.targetID];return null!=o&&e.push(o),e.push(n),this.visitedStack.splice(0,0,n),e}}return e}return e},t}(),Ym=function(){function t(){}return t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"ComplexHierarchicalTree"},t.prototype.doLayout=function(t,e,i,n){(new Gm).doLayout(t,e,i,n)},t}(),Gm=function(){function t(){this.nameTable={},this.crossReduction=new Km}return t.prototype.createVertex=function(t,e,i,n,o,r){return{value:e,geometry:{x:i,y:n,width:o,height:r},name:e,vertex:!0,inEdges:t.inEdges.slice(),outEdges:t.outEdges.slice()}},t.prototype.getEdges=function(t){var e=[];if(t){for(i=0;t.inEdges.length>0&&i<t.inEdges.length;i++)e.push(this.nameTable[t.inEdges[i]]);for(var i=0;t.outEdges.length>0&&i<t.outEdges.length;i++)e.push(this.nameTable[t.outEdges[i]])}return e},t.prototype.findRoots=function(t){for(var e=[],i=null,n=-1e5,o=0,r=Object.keys(t);o<r.length;o++){for(var s=t[r[o]],a=this.getEdges(s),l=0,h=0,c=0;c<a.length;c++)this.getVisibleTerminal(a[c],!0).name===s.name?l++:h++;0===h&&l>0&&e.push(s);var d=l-h;d>n&&(n=d,i=s)}return 0===e.length&&null!=i&&e.push(i),e},t.prototype.getVisibleTerminal=function(t,e){var i=this.nameTable[t.targetID];e&&(i=this.nameTable[t.sourceID]);for(var n=0;n<this.vertices.length;n++)if(this.vertices[n].name===i.id)return this.vertices[n];return null},t.prototype.traverse=function(t,e,i,n,o,r){if(null!=t){var s=t.name;if(null==r||null!=r[s]){null==n[s]&&(n[s]=t),null!=r&&delete r[s];for(var a=this.getEdges(t),l=[],h=0;h<a.length;h++)l[h]=this.getVisibleTerminal(a[h],!0)===t;for(h=0;h<a.length;h++)if(!e||l[h]){for(var c=this.getVisibleTerminal(a[h],!l[h]),d=1,p=0;p<a.length;p++)if(p!==h){var u=l[p];this.getVisibleTerminal(a[p],!u)===c&&(u?d++:d--)}d>=0&&(n=this.traverse(c,e,a[h],n,o,r))}}else if(null==n[s])for(h=0;h<o.length;h++){var g=o[h];if(null!=g[s]){for(var m=0,f=Object.keys(g);m<f.length;m++){var v=f[m];n[v]=g[v]}return o.splice(h,1),n}}}return n},t.prototype.getModelBounds=function(t){t=t.slice();for(var e=null,i=null,n=0;n<t.length;n++)if(e=t[n].geometry,i){var o=Math.max(i.x+i.width,e.x+e.width),r=Math.max(i.y+i.height,e.y+e.height);i.x=Math.min(i.x,e.x),i.y=Math.min(i.y,e.y),i.width=o-i.x,i.height=r-i.y}else i={x:e.x,y:e.y,width:e.width,height:e.height};return i},t.prototype.doLayout=function(t,e,i,n){this.nameTable=e;var o={horizontalSpacing:i.horizontalSpacing,verticalSpacing:i.verticalSpacing,orientation:i.orientation,marginX:i.margin.left,marginY:i.margin.top};"BottomToTop"===o.orientation?o.marginY=-i.margin.top:"RightToLeft"===o.orientation&&(o.marginX=-i.margin.left),this.vertices=[];for(var r={},s=0;s<t.length;s++){var a=this.createVertex(t[s],t[s].id,0,0,t[s].actualSize.width,t[s].actualSize.height);this.vertices.push(a),r[a.name]=a}var l,h=[];l=this.findRoots(r);for(s=0;s<l.length;s++){d={};h.push(d),this.traverse(l[s],!0,null,d,h,r)}for(var c={marginX:0,marginY:0},s=0;s<h.length;s++){for(var d=h[s],p=[],u=0,g=Object.keys(d);u<g.length;u++){var m=g[u];p.push(d[m])}var f=new Zm(this,p,l,o);this.cycleStage(f),this.layeringStage(f),this.crossingStage(f),c=this.placementStage(f,c.marginX,c.marginY)}for(var v=this.getModelBounds(this.vertices),y=(n.x-v.width)/2,s=0;s<this.vertices.length;s++){var b=this.vertices[s];if(b){var w=this.nameTable[b.name];w.offsetX=0,w.offsetY=0;var x=b.geometry.x-(w.offsetX-w.actualSize.width/2)+o.marginX,C=b.geometry.y-(w.offsetY-w.actualSize.height/2)+o.marginY,S=x,E=C;"BottomToTop"===o.orientation?E=v.height-C:"RightToLeft"===o.orientation&&(S=v.width-x),S+=y,w.offsetX+=S-w.offsetX,w.offsetY+=E-w.offsetY}}},t.prototype.placementStage=function(t,e,i){var n=this.coordinateAssignment(e,i,parent,t);return n.model=t,n.widestRankValue=null,this.placementStageExecute(n),{marginX:n.marginX+t.layout.horizontalSpacing,marginY:n.marginY+t.layout.verticalSpacing}},t.prototype.coordinateAssignment=function(t,e,i,n){var o={};return"TopToBottom"===n.layout.orientation||"BottomToTop"===n.layout.orientation?(o.horizontalSpacing=n.layout.horizontalSpacing,o.verticalSpacing=n.layout.verticalSpacing):(o.horizontalSpacing=n.layout.verticalSpacing,o.verticalSpacing=n.layout.horizontalSpacing),o.orientation="north",o.marginX=o.marginX=t,o.marginY=o.marginY=e,o},t.prototype.calculateWidestRank=function(t,e,i){var n=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(n=!0);var o=-t.verticalSpacing,r=0;t.rankSizes=[],t.rankOffset=[];for(var s=i.maxRank;s>=0;s--){for(var a=0,l=i.ranks[s],h=n?t.marginY:t.marginX,c=0;c<l.length;c++){var d=l[c];if(this.crossReduction.isVertex(d)){var p=d;if(p.cell&&(p.cell.inEdges||p.cell.outEdges)){var u=this.nameTable[p.cell.name];p.width=u.actualSize.width,p.height=u.actualSize.height,a=Math.max(a,n?p.width:p.height)}}else if(d){var g=d,m=1;null!=g.edges&&(m=g.edges.length),d.width=10*(m-1)}n&&(d.height||(d.height=0)),h+=(n?d.height:d.width)/2,this.setXY(d,s,h,!!n),this.setTempVariable(d,s,h),(h+=(n?d.height:d.width)/2+t.horizontalSpacing)>t.widestRankValue&&(t.widestRankValue=h,t.widestRank=s),t.rankSizes[s]=h}t.rankOffset[s]=o;var f=a/2+r/2+t.verticalSpacing;r=a,"north"===t.orientation||"west"===t.orientation?o+=f:o-=f;for(c=0;c<l.length;c++){var v=l[c];this.setXY(v,s,o,!n)}}},t.prototype.setTempVariable=function(t,e,i){this.crossReduction.isVertex(t)?t.temp[0]=i:t.temp[e-t.minRank-1]=i},t.prototype.setXY=function(t,e,i,n){t&&t.cell&&(t.cell.inEdges||t.cell.outEdges?n?t.y[0]=i:t.x[0]=i:n?t.y[e-t.minRank-1]=i:t.x[e-t.minRank-1]=i)},t.prototype.rankCoordinates=function(t,e,i,n){var o=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(o=!0);for(var r=n.ranks[e],s=0,a=(o?t.marginY:t.marginX)+(t.widestRankValue-t.rankSizes[e])/2,l=0;l<r.length;l++){var h=r[l];if(this.crossReduction.isVertex(h)){var c=this.nameTable[h.cell.name];h.width=c.actualSize.width,h.height=c.actualSize.height,s=Math.max(s,h.height)}else{var d=h,p=1;null!=d.edges&&(p=d.edges.length),o?h.height=10*(p-1):h.width=10*(p-1)}var u=(o?h.height:h.width)/2;a+=u,this.setXY(h,e,a,!!o),this.setTempVariable(h,e,a),a+=u+t.horizontalSpacing}},t.prototype.initialCoords=function(t,e,i){this.calculateWidestRank(t,e,i);for(n=t.widestRank;n>=0;n--)n<i.maxRank&&this.rankCoordinates(t,n,e,i);for(var n=t.widestRank+1;n<=i.maxRank;n++)n>0&&this.rankCoordinates(t,n,e,i)},t.prototype.isAncestor=function(t,e){if(null!=e&&null!=t.hashCode&&null!=e.hashCode&&t.hashCode.length<e.hashCode.length){if(t.hashCode===e.hashCode)return!0;if(null==t.hashCode||null==t.hashCode)return!1;for(var i=0;i<t.hashCode.length;i++)if(t.hashCode[i]!==e.hashCode[i])return!1;return!0}return!1},t.prototype.weightedCellSorter=function(t,e){var i={};return i.cell=t||null,i.weightedValue=e||0,i.visited=!1,i.rankIndex=null,i},t.prototype.minNode=function(t,e){for(var i=[],n={map:{}},o=[],r=0;r<=e.maxRank;r++){o[r]=e.ranks[r];for(var s=0;s<o[r].length;s++){var a=o[r][s],l=this.weightedCellSorter(a,r);l.rankIndex=s,l.visited=!0,i.push(l),e.setDictionaryForSorter(n,a,l,!0)}}for(var h=10*i.length,c=0;i.length>0&&c<=h;){var d=i.shift(),p=d.cell,u=d.weightedValue,g=d.rankIndex,m=this.crossReduction.getConnectedCellsOnLayer(p,u),f=this.crossReduction.getConnectedCellsOnLayer(p,u,!0),v=m.length,y=f.length,b=this.medianXValue(t,m,u+1),w=this.medianXValue(t,f,u-1),x=v+y,C=this.crossReduction.getTempVariable(p,u),S=C;x>0&&(S=(b*v+w*y)/x);var E=!1,P=void 0;if(S<C-1)if(0===g)P=S,E=!0;else{var L=o[u][g-1],T=this.crossReduction.getTempVariable(L,u);(T=T+L.width/2+t.intraCellSpacing+p.width/2)<S?(P=S,E=!0):T<this.crossReduction.getTempVariable(p,u)-1&&(P=T,E=!0)}else if(S>C+1)if(g===o[u].length-1)P=S,E=!0;else{var k=o[u][g+1],O=this.crossReduction.getTempVariable(k,u);(O=O-k.width/2-t.intraCellSpacing-p.width/2)>S?(P=S,E=!0):O>this.crossReduction.getTempVariable(p,u)+1&&(P=O,E=!0)}E&&(this.setTempVariable(p,u,P),this.updateNodeList(i,n,m,e),this.updateNodeList(i,n,f,e)),this.crossReduction.isVertex(d.cell)&&(d.visited=!1),c++}},t.prototype.updateNodeList=function(t,e,i,n){for(var o=0;o<i.length;o++){var r=i[o],s=n.getDictionaryForSorter(e,r);null!=s&&!1===s.visited&&(s.visited=!0,t.push(s))}},t.prototype.medianXValue=function(t,e,i){if(0===e.length)return 0;for(var n=[],o=0;o<e.length;o++)n[o]=this.crossReduction.getTempVariable(e[o],i);if(n.sort(function(t,e){return t-e}),e.length%2==1)return n[Math.floor(e.length/2)];var r=e.length/2;return(n[r-1]+n[r])/2},t.prototype.placementStageExecute=function(t){var e=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(e=!0),t.jettyPositions={};var i=t.model;e?t.currentYDelta=0:t.currentXDelta=0,this.initialCoords(t,{model:i},i),this.minNode(t,i);var n=1e8;t.maxIterations||(t.maxIterations=8);for(var o=0;o<t.maxIterations;o++){if((e?t.currentYDelta:t.currentXDelta)<n){for(var r=0;r<i.ranks.length;r++)for(var s=i.ranks[r],a=0;a<s.length;a++){var l=s[a];this.setXY(l,r,this.crossReduction.getTempVariable(l,r),!!e)}n=e?t.currentYDelta:t.currentXDelta}e?t.currentYDelta=0:t.currentXDelta=0}this.setCellLocations(t,i)},t.prototype.setCellLocations=function(t,e){for(var i=this.getValues(e.vertexMapper),n=0;n<i.length;n++)this.setVertexLocation(t,i[n])},t.prototype.garphModelsetVertexLocation=function(t,e,i,n){t.model;var o=e.geometry,r=null;return null!=o&&(r={x:i,y:n,width:o.width,height:o.height},o.x===i&&o.y===n||(e.geometry=r)),r},t.prototype.setVertexLocation=function(t,e){var i=!1;"LeftToRight"!==t.model.layout.orientation&&"RightToLeft"!==t.model.layout.orientation||(i=!0);var n=e.cell,o=e.x[0]-e.width/2,r=e.y[0]-e.height/2;this.garphModelsetVertexLocation(t,n,o,r),i?(t.marginY||(t.marginY=0),t.marginY=Math.max(t.marginY,r+e.height)):(t.marginX||(t.marginX=0),t.marginX=Math.max(t.marginX,o+e.width))},t.prototype.getValues=function(t){var e=[];if(t.map)for(var i=0,n=Object.keys(t.map);i<n.length;i++){var o=n[i];e.push(t.map[o])}return e},t.prototype.crossingStage=function(t){this.crossReduction.execute(t)},t.prototype.layeringStage=function(t){this.initialRank(t),this.fixRanks(t)},t.prototype.initialRank=function(t){for(var e=t.startNodes,i=t.getDictionaryValues(t.vertexMapper),n=e.slice();e.length>0;){for(var o=(c=e[0]).connectsAsTarget,r=c.connectsAsSource,s=!0,a=1e8,l=0;l<o.length;l++){if(5270620!==(u=o[l]).temp[0]){s=!1;break}g=u.source;a=Math.min(a,g.temp[0]-1)}if(s){if(c.temp[0]=a,t.maxRank||(t.maxRank=1e8),t.maxRank=Math.min(t.maxRank,a),null!=r)for(l=0;l<r.length;l++)(u=r[l]).temp[0]=5270620,-1===(g=u.target).temp[0]&&(e.push(g),g.temp[0]=-2);e.shift()}else{var h=e.shift();if(e.push(c),h===c&&1===e.length)break}}for(l=0;l<i.length;l++)i[l].temp[0]-=t.maxRank;for(l=0;l<n.length;l++)for(var c=n[l],d=0,o=c.connectsAsSource,p=0;p<o.length;p++){var u=o[p],g=u.target;c.temp[0]=Math.max(d,g.temp[0]+1),d=c.temp[0]}t.maxRank=1e8-t.maxRank},t.prototype.fixRanks=function(t){t.fixRanks()},t.prototype.cycleStage=function(t){var e={};t.startNodes=[];for(var i=t.getDictionaryValues(t.vertexMapper),n=[],o=0;o<i.length;o++)i[o].temp[0]=-1,n[i[o].id]=i[o];var r=null;if(null!=t.roots){var s=t.roots;r=[];for(o=0;o<s.length;o++)r[o]=t.getDictionary(t.vertexMapper,s[o]),null!=r[o]&&t.startNodes.push(r[o])}t.visit("removeParentConnection",r,!0,null,{seenNodes:e,unseenNodes:n});var a=t.clone(e,null,!0);t.visit("removeNodeConnection",n,!0,a,{seenNodes:e,unseenNodes:n})},t.prototype.remove=function(t,e){var i=e.indexOf(t);return-1!==i&&e.splice(i,1),t},t.prototype.invert=function(t,e){var i=t.source;t.source=t.target,t.target=i,t.isReversed=!t.isReversed},t.prototype.getEdgesBetween=function(t,e,i){i=null!=i&&i;for(var n=this.getEdges(t),o=[],r=0;r<n.length;r++){var s=this.getVisibleTerminal(n[r],!0),a=this.getVisibleTerminal(n[r],!1);(s===t&&a===e||!i&&s===e&&a===t)&&o.push(n[r])}return o},t}(),Zm=function(){function t(t,e,i,n){this.multiObjectIdentityCounter=0,this.dfsCount=0,this.hierarchicalUtil=new Gm,this.roots=i,this.vertexMapper={map:{}};var o=[];this.layout=n,this.maxRank=1e8,this.hierarchicalLayout=t,this.createInternalCells(t,e,o);for(var r=0;r<e.length;r++){for(var s=o[r].connectsAsSource,a=0;a<s.length;a++){var l=s[a],h=l.edges;if(null!=h&&h.length>0){var c=h[0],d=t.getVisibleTerminal(c,!1),p=this.getDictionary(this.vertexMapper,d);o[r]===p&&(d=t.getVisibleTerminal(c,!0),p=this.getDictionary(this.vertexMapper,d)),null!=p&&o[r]!==p&&(l.target=p,0===p.connectsAsTarget.length&&(p.connectsAsTarget=[]),p.connectsAsTarget.indexOf(l)<0&&p.connectsAsTarget.push(l))}}o[r].temp[0]=1}}return t.prototype.createInternalCells=function(t,e,i){for(var n=0;n<e.length;n++){i[n]={x:[],y:[],temp:[],cell:e[n],id:e[n].name,connectsAsTarget:[],connectsAsSource:[]},this.setDictionary(this.vertexMapper,e[n],i[n]);var o=t.getEdges(e[n]);i[n].connectsAsSource=[];for(var r=0;r<o.length;r++){var s=t.getVisibleTerminal(o[r],!1);if(s!==e[n]){var a=t.getEdgesBetween(e[n],s,!1),l=t.getEdgesBetween(e[n],s,!0);if(null!=a&&a.length>0&&2*l.length>=a.length){for(var h={x:[],y:[],temp:[],edges:a,ids:[]},c=0;c<a.length;c++)h.ids.push(a[c].id);h.source=i[n],i[n].connectsAsSource||(i[n].connectsAsSource=[]),i[n].connectsAsSource.indexOf(h)<0&&i[n].connectsAsSource.push(h)}}}i[n].temp[0]=0}},t.prototype.fixRanks=function(){var t=[];this.ranks=[];for(n=0;n<this.maxRank+1;n++)t[n]=[],this.ranks[n]=t[n];var e=null;if(null!=this.roots){var i=this.roots;e=[];for(var n=0;n<i.length;n++){var o=i[n],r=this.getDictionary(this.vertexMapper,o);e[n]=r}}this.visit("updateMinMaxRank",e,!1,null,{seenNodes:null,unseenNodes:null,rankList:t})},t.prototype.updateMinMaxRank=function(t,e,i){i.seenNodes,i.unseenNodes;var n=i.parent,o=i.root,r=i.edge,s=i.rankList;if(o.maxRank||0===o.maxRank||(o.maxRank=-1),o.minRank||0===o.minRank||(o.minRank=-1),0===e&&o.maxRank<0&&o.minRank<0&&(s[o.temp[0]].push(o),o.maxRank=o.temp[0],o.minRank=o.temp[0],o.temp[0]=s[o.maxRank].length-1),null!=n&&null!=r&&n.maxRank-o.maxRank>1){r.maxRank=n.maxRank,r.minRank=o.maxRank,r.temp=[],r.x=[],r.y=[];for(var a=r.minRank+1;a<r.maxRank;a++)s[a].push(r),this.hierarchicalUtil.setTempVariable(r,a,s[a].length-1)}},t.prototype.setDictionary=function(t,e,i){var n=e.name,o=t.map[n];return t.map[n]=i,o},t.prototype.setDictionaryForSorter=function(t,e,i,n){var o=e.id,r=t.map[o];return t.map[o]=i,r},t.prototype.getDictionary=function(t,e){this.multiObjectIdentityCounter||0===this.multiObjectIdentityCounter||(this.multiObjectIdentityCounter=0);var i=e.name;return i?t.map[i]:e.layoutObjectId?t.map[e.layoutObjectId]:(e.layoutObjectId="graphHierarchyNode#"+this.multiObjectIdentityCounter++,e.layoutObjectId)},t.prototype.getDictionaryForSorter=function(t,e){this.multiObjectIdentityCounter||0===this.multiObjectIdentityCounter||(this.multiObjectIdentityCounter=0);var i=e.id;return i?t.map[i]:e.layoutObjectId?t.map[e.layoutObjectId]:(e.layoutObjectId="graphHierarchyNode#"+this.multiObjectIdentityCounter++,e.layoutObjectId)},t.prototype.getDictionaryValues=function(t){for(var e=[],i=0,n=Object.keys(t.map);i<n.length;i++){var o=n[i];e.push(t.map[o])}return e},t.prototype.visit=function(t,e,i,n,o){o.seenNodes,o.unseenNodes,o.rankList;if(null!=e){for(var r=0;r<e.length;r++){var s=e[r];null!=s&&(null==n&&(n=new Object),o.parent=null,o.root=s,o.edge=null,i?(s.hashCode=[],s.hashCode[0]=this.dfsCount,s.hashCode[1]=r,this.extendedDfs(t,n,r,0,o)):this.depthFirstSearch(t,n,0,o))}this.dfsCount++}},t.prototype.depthFirstSearch=function(t,e,i,n){n.seenNodes,n.unseenNodes,n.rankList,n.parent;var o=n.root;n.edge;if(null!=o){var r=o.id;if(null==e[r]){e[r]=o,this.updateConnectionRank(t,i,0,n);for(var s=o.connectsAsSource.slice(),a=0;a<s.length;a++){var l=s[a],h=l.target;n.parent=o,n.root=h,n.edge=l,this.depthFirstSearch(t,e,i+1,n)}}else this.updateConnectionRank(t,i,1,n)}},t.prototype.updateConnectionRank=function(t,e,i,n){var o=n.parent,r=n.root,s=n.edge;if("removeParentConnection"===t||"removeNodeConnection"===t){var a="removeNodeConnection"===t;this.removeConnectionEdge(o,r,s,e,n,a)}"updateMinMaxRank"===t&&this.updateMinMaxRank(e,i,n)},t.prototype.removeConnectionEdge=function(t,e,i,n,o,r){var s=o.seenNodes,a=o.unseenNodes;o.rankList;this.hierarchicalUtil.isAncestor(e,t)&&(this.hierarchicalUtil.invert(i,0),this.hierarchicalUtil.remove(i,t.connectsAsSource),r?(e.connectsAsSource.push(i),t.connectsAsTarget.push(i),this.hierarchicalUtil.remove(i,e.connectsAsTarget)):(t.connectsAsTarget.push(i),this.hierarchicalUtil.remove(i,e.connectsAsTarget),e.connectsAsSource.push(i))),s[e.id]=e,delete a[e.id]},t.prototype.extendedDfs=function(t,e,i,n,o){o.seenNodes,o.unseenNodes,o.rankList;var r=o.parent,s=o.root;o.edge;if(null!=s){if(null!=r&&(null==s.hashCode||s.hashCode[0]!==r.hashCode[0])){var a=r.hashCode.length+1;s.hashCode=r.hashCode.slice(),s.hashCode[a-1]=i}var l=s.id;if(null==e[l]){e[l]=s,this.updateConnectionRank(t,n,0,o);for(var h=s.connectsAsSource.slice(),c=0;c<h.length;c++){var d=h[c],p=d.target;o.parent=s,o.root=p,o.edge=d,this.extendedDfs(t,e,c,n+1,o)}}else this.updateConnectionRank(t,n,1,o)}},t.prototype.clone=function(t,e,i){if(i=null!=i&&i,null!=t&&"function"==typeof t.constructor){for(var n=t.constructor(),o=0,r=Object.keys(t);o<r.length;o++){var s=r[o];"layoutObjectId"!==s&&(null==e||e.indexOf(s)<0)&&(i||"object"!=typeof t[s])&&(n[s]=t[s])}return n}return null},t}(),Km=function(){function t(){}return t.prototype.calculateCrossings=function(t){for(var e=t.ranks.length,i=0,n=1;n<e;n++)i+=this.calculateRankCrossing(n,t);return i},t.prototype.getTempVariable=function(t,e){return t?this.isVertex(t)?t.temp[0]:t.temp[e-t.minRank-1]:0},t.prototype.calculateRankCrossing=function(t,e){for(var i=0,n=e.ranks[t],o=e.ranks[t-1],r=[],s=0;s<n.length;s++){for(var a=n[s],l=this.getTempVariable(a,t),h=this.getConnectedCellsOnLayer(a,t,!0),c=[],d=0;d<h.length;d++){var p=h[d],u=this.getTempVariable(p,t-1);c.push(u)}c.sort(function(t,e){return t-e}),r[l]=c}for(var g=[],s=0;s<r.length;s++)g=g.concat(r[s]);for(var m=1;m<o.length;)m<<=1;var f=2*m-1;m-=1;for(var v=[],s=0;s<f;++s)v[s]=0;for(s=0;s<g.length;s++){var y=g[s]+m;for(++v[y];y>0;)y%2&&(i+=v[y+1]),++v[y=y-1>>1]}return i},t.prototype.execute=function(t){this.nestedBestRanks=[];for(n=0;n<t.ranks.length;n++)this.nestedBestRanks[n]=t.ranks[n].slice();for(var e=0,i=this.calculateCrossings(t),n=0;n<24&&e<2;n++){this.weightedMedian(n,t);var o=this.calculateCrossings(t);if(o<i){i=o,e=0;for(c=0;c<this.nestedBestRanks.length;c++)for(var r=t.ranks[c],s=0;s<r.length;s++){a=r[s];this.nestedBestRanks[c][a.temp[0]]=a}}else{e++;for(c=0;c<this.nestedBestRanks.length;c++)for(var r=t.ranks[c],s=0;s<r.length;s++){var a=r[s];this.setTempVariable(a,c,s)}}if(0===i)break}for(var l=[],h=[],n=0;n<t.maxRank+1;n++)h[n]=[],l[n]=h[n];for(n=0;n<this.nestedBestRanks.length;n++)for(var c=0;c<this.nestedBestRanks[n].length;c++)h[n].push(this.nestedBestRanks[n][c]);t.ranks=l},t.prototype.isVertex=function(t){return!(!t||!t.cell||!t.cell.inEdges&&!t.cell.outEdges)},t.prototype.weightedMedian=function(t,e){var i=t%2==0;if(i)for(n=e.maxRank-1;n>=0;n--)this.medianRank(n,i);else for(var n=1;n<e.maxRank;n++)this.medianRank(n,i)},t.prototype.getConnectedCellsOnLayer=function(t,e,i){void 0===i&&(i=!1);var n="nextLayerConnectedCells",o="connectsAsTarget";if(i&&(n="previousLayerConnectedCells",o="connectsAsSource"),t){if(this.isVertex(t)){if(null==t[n]){t[n]=[],t[n][0]=[];for(s=0;s<t[o].length;s++){var r=t[o][s];void 0===r.maxRank&&(r.maxRank=-1),-1===r.maxRank||(i?r.minRank===e-1:r.maxRank===e+1)?t[n][0].push(i?r.target:r.source):t[n][0].push(r)}}return t[n][0]}if(null==t[n]){t[n]=[];for(var s=0;s<t.temp.length;s++)t[n][s]=[],s===(i?0:t.temp.length-1)?t[n][s].push(i?t.target:t.source):t[n][s].push(t)}return t[n][e-t.minRank-1]}return null},t.prototype.medianValue=function(t,e){for(var i=[],n=0,o=0;o<t.length;o++){var r=t[o];i[n++]=this.getTempVariable(r,e)}if(i.sort(function(t,e){return t-e}),n%2==1)return i[Math.floor(n/2)];if(2===n)return(i[0]+i[1])/2;var s=n/2,a=i[s-1]-i[0],l=i[n-1]-i[s];return(i[s-1]*l+i[s]*a)/(a+l)},t.prototype.setTempVariable=function(t,e,i){t&&(t.temp[0]=i)},t.prototype.medianRank=function(t,e){for(var i=this.nestedBestRanks[t].length,n=[],o=[],r=0;r<i;r++){var s=this.nestedBestRanks[t][r],a={medianValue:0};a.cell=s;var l=void 0;l=e?this.getConnectedCellsOnLayer(s,t):this.getConnectedCellsOnLayer(s,t,!0);var h=void 0;h=e?t+1:t-1,null!=l&&0!==l.length?(a.medianValue=this.medianValue(l,h),n.push(a)):o[this.getTempVariable(s,t)]=!0}n.sort(this.compare);for(r=0;r<i;r++)if(null==o[r]){s=n.shift().cell;this.setTempVariable(s,t,r)}},t.prototype.compare=function(t,e){if(null!=t&&null!=e){if(e.medianValue>t.medianValue)return-1;if(e.medianValue<t.medianValue)return 1}return 0},t}(),Qm=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Jm=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},$m=function(t){var e=t;return e.sourcePoint||e.targetPoint||e.sourceID||e.targetID||e.sourcePortID||e.targetPortID||e.sourceDecorator||e.targetDecorator?_c:(t.shape&&(t.shape instanceof Jc||t.shape.type),fd)},tf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qm(e,t),Jm([Y("")],e.prototype,"id",void 0),Jm([Y()],e.prototype,"height",void 0),Jm([Y(!0)],e.prototype,"expanded",void 0),Jm([Y("")],e.prototype,"iconCss",void 0),Jm([Y("")],e.prototype,"title",void 0),Jm([Q($m)],e.prototype,"symbols",void 0),e}(xa),ef=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Qm(e,t),Jm([Y()],e.prototype,"width",void 0),Jm([Y()],e.prototype,"height",void 0),Jm([G({},Dl)],e.prototype,"offset",void 0),e}(xa),nf=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.symbolTable={},n.info="info",n.helper=function(t){var e,i=t.sender.target.id.split("_container")[0],o=n.symbolTable[i];if(o&&n.selectedSymbol){n.selectedSymbols=n.selectedSymbol.id===o.id?o:n.selectedSymbol;n.getMousePosition(t.sender);(e=n.getSymbolPreview(n.selectedSymbols,t.sender,n.element)).setAttribute("paletteId",n.element.id)}return e},n}return Qm(i,e),i.prototype.onPropertyChanged=function(t,e){for(var i=!1,n=0,o=Object.keys(t);n<o.length;n++)switch(o[n]){case"width":this.element.style.width=this.width.toString();break;case"height":this.element.style.height=this.height.toString();break;case"symbolPreview":break;case"symbolWidth":case"symbolHeight":case"getSymbolInfo":i=!0;break;case"enableSearch":if(t.enableSearch)this.createTextbox();else{var r=document.getElementById(this.element.id+"_search");r&&r.parentNode.removeChild(r)}break;case"palettes":for(var s=0,a=Object.keys(t.palettes);s<a.length;s++){var l=a[s],h=Number(l);void 0!==t.palettes[h].iconCss&&(this.accordionElement.items[h].iconCss=t.palettes[h].iconCss,i=!0),void 0!==t.palettes[h].expanded&&(this.palettes[h].isInteraction?this.palettes[h].isInteraction=!1:(this.accordionElement.items[h].expanded=t.palettes[h].expanded,i=!0))}break;case"enableAnimation":this.enableAnimation?this.accordionElement.animation={expand:{duration:400},collapse:{duration:400}}:this.accordionElement.animation={expand:{duration:0},collapse:{duration:0}};break;case"expandMode":this.accordionElement.expandMode=this.expandMode,i=!0}i&&this.refreshPalettes()},i.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},i.prototype.preRender=function(){var t=this;this.element.style.overflow="auto",this.element.style.height=this.height.toString(),this.element.style.width=this.width.toString(),this.enableSearch&&this.createTextbox();var e=b("div",{id:this.element.id+"_container"});this.accordionElement=new su({expandMode:this.expandMode}),this.enableAnimation||(this.accordionElement.animation={expand:{duration:0},collapse:{duration:0}}),this.accordionElement.expanded=function(e){var i=t.accordionElement.items.indexOf(e.item);t.palettes[i].expanded=e.isExpanded,t.palettes[i].isInteraction=!0},this.element.appendChild(e),Ur(),this.unWireEvents(),this.wireEvents()},i.prototype.render=function(){this.diagramRenderer=new Sd(this.element.id,new Cd,!1),this.svgRenderer=new Sd(this.element.id,new Cd,!0),this.updatePalettes(),this.accordionElement.appendTo("#"+this.element.id+"_container")},i.prototype.getModuleName=function(){return"SymbolPalette"},i.prototype.requiredModules=function(){var t=[];return t.push({member:"Bpmn",args:[]}),t},i.prototype.destroy=function(){if(this.allowDrag){this.draggable.destroy(),this.unWireEvents(),this.notify("destroy",{}),e.prototype.destroy.call(this);var t=document.getElementById(this.element.id+"_container");if(t){this.element.removeChild(t);window.measureElement&&(window.measureElement.usageCount-=1,0===window.measureElement.usageCount&&(window.measureElement.parentNode.removeChild(window.measureElement),window.measureElement=null))}this.element.classList.remove("e-symbolpalette")}},i.prototype.initSymbols=function(t){for(var e=0,i=t.symbols;e<i.length;e++){var n=i[e];if(n instanceof fd){var o=as(this.getNodeDefaults);o&&o(n,this)}else if(n instanceof _c){var r=as(this.getConnectorDefaults);r&&r(n,this)}this.prepareSymbol(n),this.symbolTable[n.id]=n}},i.prototype.renderPalette=function(t){var e=document.createElement("div");e.setAttribute("id",t.id);var i="display:none;overflow:auto;";t.height&&(i+="height:"+t.height+"px"),e.setAttribute("style",i),this.element.appendChild(e);var n={header:t.title,expanded:t.expanded,content:"#"+t.id,iconCss:t.iconCss};this.accordionElement.items.push(n),this.renderSymbols(t,e)},i.prototype.addPaletteItem=function(t,e){for(var i=0;i<this.palettes.length;i++){var n=this.palettes[i];if(-1!==n.id.indexOf(t)){for(var o=[void 0,n,"symbols",{},!0],r=new(Function.prototype.bind.apply($m(e),o)),s=0;s<Object.keys(e).length;s++)r[Object.keys(e)[s]]=e[Object.keys(e)[s]];n.symbols.push(r),this.prepareSymbol(r),this.symbolTable[r.id]=r;var a=document.getElementById(n.id);a.appendChild(this.getSymbolContainer(r,a));break}}},i.prototype.removePaletteItem=function(t,e){for(var i,n=0;n<this.palettes.length;n++){var o=this.palettes[n];if(-1!==o.id.indexOf(t))for(var r=0,s=o.symbols;r<s.length;r++){var a=s[r];if(-1!==a.id.indexOf(e)){var l=o.symbols.indexOf(a);o.symbols.splice(l,1),delete this.symbolTable[a.id];var h=document.getElementById(a.id+"_container");h.parentNode.removeChild(h),i=!0;break}}if(i)break}},i.prototype.prepareSymbol=function(t){var e,i,n,o,r,s=new Tp,a=t,l=new gh,h=as(this.getSymbolTemplate);h&&(r=h(t)),r||(r=t.init(this));var c={width:this.symbolWidth,height:this.symbolHeight},d=as(this.getSymbolInfo);if(d&&(c=d(t)),c=c||{},r.relativeMode="Object",r.horizontalAlignment=r.verticalAlignment="Center",l.style.strokeColor=l.style.fill="none",l.children=[r],r.measure(new Al),r.arrange(r.desiredSize),e=c.width=c.width||(void 0!==a.width?r.actualSize.width:void 0)||this.symbolWidth,n=c.height=c.height||(void 0!==a.height?r.actualSize.height:void 0)||this.symbolHeight,void 0!==e&&void 0!==n){var p=e,u=n;void 0!==this.symbolWidth?p=this.symbolWidth-this.symbolMargin.left-this.symbolMargin.right:e+=a.style.strokeWidth,void 0!==this.symbolHeight?u=this.symbolHeight-this.symbolMargin.top-this.symbolMargin.bottom:n+=a.style.strokeWidth,c.description&&""!==c.description.text&&(u-=20),i=p/(r.width||e),o=u/(r.height||n),c.fit&&(i=p/c.width,o=u/c.height),e=p,n=u,i=o=Math.min(i,o),l.width=e,l.height=n,r.width=c.width,r.height=c.height,this.scaleSymbol(t,l,i,o,e,n)}else{var g=void 0;t instanceof _c&&(g=En(t)),r.width=t.width||g?g.width:r.actualSize.width,r.height=t.height||g?g.height:r.actualSize.height}t.wrapper=s,s.children=[l],r.pivot=s.pivot={x:0,y:0},s.id=r.id+"_symbol",s.style.fill=s.style.strokeColor="transparent",s.offsetX=t.style.strokeWidth/2,s.offsetY=t.style.strokeWidth/2,this.getSymbolDescription(c,e,s),s.measure(new Al),s.arrange(s.desiredSize),c.width=c.width||r.actualSize.width,c.height=c.height||r.actualSize.height,t[this.info]=c},i.prototype.getSymbolDescription=function(t,e,i){if(t&&t.description&&t.description.text){var n=new ch;t.description.overflow=t.description.overflow||"Ellipsis",t.description.wrap=t.description.wrap||"WrapWithOverflow",n.content=t.description.text,n.width=e,n.height=20,n.style.strokeColor="transparent",n.style.fill="transparent",n.style.strokeWidth=0,n.style.textWrapping=t.description.wrap,n.style.textOverflow=t.description.overflow,n.margin={left:0,right:0,top:0,bottom:5},i.children.push(n)}},i.prototype.renderSymbols=function(t,e){for(var i=0,n=t.symbols;i<n.length;i++){var o=n[i];this.getSymbolContainer(o,e)}},i.prototype.getSymbolPreview=function(t,e,i){var n,o,r,s=t.wrapper.children[0].desiredSize.width+t.style.strokeWidth,a=t.wrapper.children[0].desiredSize.height+t.style.strokeWidth,l=t.wrapper.children[0].children[0];if(void 0!==this.symbolPreview.width||void 0!==this.symbolPreview.height){s=(this.symbolPreview.width||s)-t.style.strokeWidth,a=(this.symbolPreview.height||a)-t.style.strokeWidth,o=s/l.actualSize.width,r=a/l.actualSize.height,o=r=Math.min(o,r);var h=l.actualSize.width*o,c=l.actualSize.height*r;t.wrapper.children[0].width=s,t.wrapper.children[0].height=a,this.measureAndArrangeSymbol(l),this.scaleSymbol(t,t.wrapper.children[0],o,r,h,c),s=h,a=c}var d={x:l.offsetX,y:l.offsetY};l.offsetX=l.offsetY=t.style.strokeWidth/2,l.pivot={x:0,y:0},this.measureAndArrangeSymbol(l);var p,u=b("div");u.setAttribute("draggable","true"),u.setAttribute("class","e-dragclone"),u.style.pointerEvents="none",document.body.appendChild(u);var g="margin:5px;";if("Native"===t.shape.type){n=Nr("svg",{id:t.id+"_preview",width:Math.ceil(s)+1,height:Math.ceil(a)+1});var m=Nr("g",{id:t.id+"_g"});n.appendChild(m),u.appendChild(n),this.svgRenderer.renderElement(l,m,void 0,void 0,n)}else"HTML"===t.shape.type?p=this.getHtmlSymbol(t,n,u,a,s,!0):(n=xd.createCanvas(t.id+"_preview",2*(Math.ceil(s)+t.style.strokeWidth+1),2*(Math.ceil(a)+t.style.strokeWidth+1)),u.appendChild(n),g+="transform:scale(0.5);",n.setAttribute("transform-origin","0 0"),n.getContext("2d").setTransform(2,0,0,2,0,0),this.diagramRenderer.renderElement(l,n,void 0));return(p&&"HTML"===t.shape.type?p:n).setAttribute("style",g),l.offsetX=d.x,l.offsetY=d.y,u},i.prototype.measureAndArrangeSymbol=function(e){e.children&&(e.children[0].transform=t.Transform.Self),e.measure(new Al),e.arrange(e.desiredSize),e.children&&(e.children[0].transform=t.Transform.Parent)},i.prototype.updateSymbolSize=function(t,e,i){var n=t.wrapper.children[0].children[0],o=t.style.strokeWidth;n.width=(e||n.width)-(o+1),n.height=(i||n.height)-(o+1),t.wrapper.measure(new Al),t.wrapper.arrange(t.wrapper.desiredSize)},i.prototype.getSymbolContainer=function(t,e,i){var n=this.symbolTable[t.id][this.info],o=this.getSymbolSize(t,n),r=o.width+1,s=o.height+1,a=b("div",{id:t.id+"_container",styles:"width:"+r+"px;height:"+s+"px;float:left;overflow:hidden"});a.setAttribute("title",n.description?n.description.text:t.id),e.appendChild(a);var l,h,c;if("Native"===t.shape.type?(l=Nr("svg",{id:t.id,width:Math.ceil(t.wrapper.actualSize.width)+1,height:Math.ceil(t.wrapper.actualSize.height)+1}),h=Nr("g",{id:t.id+"_g"}),l.appendChild(h),a.appendChild(l),this.updateSymbolSize(t),this.svgRenderer.renderElement(t.wrapper,h,void 0,void 0,l)):"HTML"===t.shape.type?c=this.getHtmlSymbol(t,l,a,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!1):(l=xd.createCanvas(t.id,Math.ceil(2*(t.wrapper.actualSize.width+t.style.strokeWidth))+1,Math.ceil(2*(t.wrapper.actualSize.height+t.style.strokeWidth))+1),a.appendChild(l),l.getContext("2d").setTransform(2,0,0,2,0,0),this.diagramRenderer.renderElement(t.wrapper,h||l,void 0)),!i){var d=t.wrapper.actualSize.width+t.style.strokeWidth,p=t.wrapper.actualSize.height+t.style.strokeWidth,u="margin-left:"+Math.max(this.symbolMargin.left,(r-d)/2)+"px;margin-top:"+Math.max(this.symbolMargin.top,(s-p)/2)+"px;pointer-events:none;transform-origin:0 0;overflow:hidden;";return l instanceof HTMLCanvasElement&&(u+="transform:scale(.5,.5);"),(c&&"HTML"===t.shape.type?c:l).setAttribute("style",u),a.classList.add("e-symbol-draggable"),a}return l},i.prototype.getHtmlSymbol=function(t,e,i,n,o,r){var s=Rr("div",{id:t.id+(r?"_html_div_preview":"_html_div")}),a=Rr("div",{id:t.id+(r?"_htmlLayer_preview":"_htmlLayer"),style:"width:"+Math.ceil(o+1)+"px;height:"+Math.ceil(n+1)+"px;position:absolute",class:"e-html-layer"}),l=Rr("div",{id:t.id+(r?"_htmlLayer_div_preview":"_htmlLayer_div"),style:"width:"+Math.ceil(o+1)+"px;height:"+Math.ceil(n+1)+"px;position:absolute"});return a.appendChild(l),s.appendChild(a),e=xd.createCanvas(r?t.id+"_preview":t.id,Math.ceil(o)+1,Math.ceil(n)+1),s.appendChild(e),i.appendChild(s),this.diagramRenderer.renderElement(t.wrapper.children[0].children[0],e,a),s},i.prototype.getSymbolSize=function(t,e){var i=t.wrapper.actualSize.width,n=t.wrapper.actualSize.height;return this.symbolWidth||this.symbolHeight?(i=this.symbolWidth,n=Math.max(this.symbolHeight,n)):(i+=this.symbolMargin.left+this.symbolMargin.right+t.style.strokeWidth,n+=this.symbolMargin.top+this.symbolMargin.bottom+t.style.strokeWidth),new Al(i,n)},i.prototype.getMousePosition=function(t){var e,i,n;if(-1!==t.type.indexOf("touch")){var o=(n=t).changedTouches[0].clientY,r=n.changedTouches[0].clientX;e=o-this.element.offsetTop,i=r-this.element.offsetLeft}else e=t.clientY-this.element.offsetTop,i=t.clientX-this.element.offsetLeft;return{x:i,y:e}},i.prototype.mouseMove=function(t,e){!this.highlightedSymbol||this.selectedSymbol&&this.selectedSymbol.id+"_container"===this.highlightedSymbol.id||(this.highlightedSymbol.classList.remove("e-symbol-hover"),this.highlightedSymbol.style.backgroundColor="",this.highlightedSymbol=null);var i=t.target.id.split("_container")[0];if(this.symbolTable[i]){var n=document.getElementById(i+"_container");n.classList.add("e-symbol-hover"),this.highlightedSymbol=n}t.preventDefault()},i.prototype.mouseUp=function(t){if(t&&t.target)if("iconSearch"===t.srcElement.id){var e=document.getElementById("iconSearch");e.classList.contains("e-clear-searchtext")&&(e.className="e-input-group-icon e-search e-icons",document.getElementById("textEnter").value="",this.searchPalette(""))}else t.preventDefault()},i.prototype.keyUp=function(t){var e=this;if(this.enableSearch){var i=this;document.getElementById("iconSearch").className="e-input-group-icon e-clear-searchtext e-icons",!t||"Enter"!==t.key&&13!==t.keyCode?(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.target instanceof HTMLInputElement&&(i.searchPalette(t.target.value),e.timer=null)},500)):t.target instanceof HTMLInputElement&&this.searchPalette(t.target.value)}},i.prototype.mouseDown=function(t){var e=t.target.id.split("_container")[0];if(this.selectedSymbol){if(e!==this.selectedSymbol.id){document.getElementById(this.selectedSymbol.id+"_container").classList.remove("e-symbol-selected");var i={oldValue:this.selectedSymbol.id,newValue:e};this.trigger("paletteSelectionChange",i)}(n=document.getElementById(this.selectedSymbol.id+"_container")).style.backgroundColor="",this.selectedSymbol=null}if(this.symbolTable[e]){var n=document.getElementById(e+"_container");n.classList.add("e-symbol-selected"),this.selectedSymbol=this.symbolTable[e],t.preventDefault()}},i.prototype.initDraggable=function(){this.allowDrag&&(this.draggable=new el(this.element,{dragTarget:".e-symbol-draggable",helper:this.helper,dragStart:this.dragStart,dragStop:this.dragStop,drag:function(t){var e=Br(t.target,"e-droppable");if(e&&e.classList.contains("e-diagram")){e.ej2_instances[0].droppable.over(t)}},cursorAt:{left:this.symbolPreview.offset.x,top:this.symbolPreview.offset.y}}))},i.prototype.dragStart=function(t){var e=this.helper[0];e&&e.setAttribute("paletteId",this.element.id)},i.prototype.dragStop=function(t){Br(t.target,"e-diagram")||T(t.helper)},i.prototype.scaleSymbol=function(t,e,i,n,o,r){if(t instanceof _c){p=t.wrapper;t.wrapper=e.children[0];for(var s=t.scale(i,n,o,r,e.children[0]),a=o/2-e.children[0].children[0].offsetX+s.x/2,l=r/2-e.children[0].children[0].offsetY+s.y/2,h=0,c=e.children[0].children;h<c.length;h++){var d=c[h];d.offsetX+=a,d.offsetY+=l,d.staticSize=!1}t.wrapper=p}else if(t.shape instanceof md&&this.bpmnModule){var p=t.wrapper;t.wrapper=e,e.children[0].width=o,e.children[0].height=r,this.bpmnModule.updateBPMN({width:o,height:r},t,t,null),t.wrapper=p}else $o(e.children[0],i,n,e)},i.prototype.refreshPalettes=function(){this.accordionElement.items=[],this.updatePalettes(),this.accordionElement.dataBind()},i.prototype.updatePalettes=function(){for(var t=0;t<this.palettes.length;t++){var e=this.palettes[t];this.initSymbols(e),this.renderPalette(e)}},i.prototype.createTextbox=function(){var t=b("div",{id:this.element.id+"_search"});t.setAttribute("style","backgroundColor:white;height:30px"),t.className="e-input-group",this.element.appendChild(t);var e=document.createElement("input");e.placeholder="Search Shapes",e.id="textEnter",e.setAttribute("style","width:100%;height:auto"),e.className="e-input",t.appendChild(e);var i=b("span",{id:"iconSearch",className:"e-input-group-icon e-search e-icons"});t.appendChild(i)},i.prototype.searchPalette=function(t){var e,i=[],n=document.getElementById("SearchPalette");if(n)for(var o=n.children.length-1;o>=0;o--)n.removeChild(n.children[o]);for(var r=0;r<this.palettes.length;r++)for(var s=this.palettes[r],a=0;a<s.symbols.length;a++){var l=s.symbols[a];""!==t&&-1!==l.id.toLowerCase().indexOf(t.toLowerCase())&&i.push(l)}var h=as(this.filterSymbols);if(h&&(i=h(i)||[]),n||(n=e=this.createSearchPalette(e)),i.length>0)for(var c=0,d=i;c<d.length;c++){var p=d[c];this.getSymbolContainer(p,n)}else if(""!==t){var u=document.createElement("div");u.setAttribute("id","EmptyDiv"),u.innerHTML="No Items To Display",u.setAttribute("style","textAlign:center;fontStyle:italic"),n.appendChild(u)}else document.getElementById("iconSearch").className="e-input-group-icon e-search e-icons",this.accordionElement.removeItem(0)},i.prototype.createSearchPalette=function(t){(t=document.createElement("div")).setAttribute("id","SearchPalette"),t.setAttribute("style","display:none;overflow:auto;"),this.element.appendChild(t);var e={header:"Search Results",expanded:!0,content:"#SearchPalette"};return this.accordionElement.addItem(e,0),t},i.prototype.wireEvents=function(){var t=ma.touchStartEvent,e=ma.touchEndEvent,i=ma.touchMoveEvent;ha.add(this.element,t,this.mouseDown,this),ha.add(this.element,i,this.mouseMove,this),ha.add(this.element,e,this.mouseUp,this),ha.add(this.element,"keyup",this.keyUp,this),this.initDraggable()},i.prototype.unWireEvents=function(){var t=ma.touchStartEvent,e=ma.touchEndEvent,i=ma.touchMoveEvent;ha.remove(this.element,t,this.mouseDown),ha.remove(this.element,i,this.mouseMove),ha.remove(this.element,e,this.mouseUp),ha.remove(this.element,"keyup",this.keyUp)},Jm([Y("S")],i.prototype,"accessKey",void 0),Jm([Y("100%")],i.prototype,"width",void 0),Jm([Y("100%")],i.prototype,"height",void 0),Jm([K([],tf)],i.prototype,"palettes",void 0),Jm([Y()],i.prototype,"getSymbolInfo",void 0),Jm([Y()],i.prototype,"filterSymbols",void 0),Jm([Y()],i.prototype,"getSymbolTemplate",void 0),Jm([Y()],i.prototype,"symbolWidth",void 0),Jm([Y()],i.prototype,"symbolHeight",void 0),Jm([G({left:10,right:10,top:10,bottom:10},Gl)],i.prototype,"symbolMargin",void 0),Jm([Y(!0)],i.prototype,"allowDrag",void 0),Jm([G({},ef)],i.prototype,"symbolPreview",void 0),Jm([Y(!1)],i.prototype,"enableSearch",void 0),Jm([Y(!0)],i.prototype,"enableAnimation",void 0),Jm([Y("Multiple")],i.prototype,"expandMode",void 0),Jm([J()],i.prototype,"paletteSelectionChange",void 0),Jm([Y()],i.prototype,"getNodeDefaults",void 0),Jm([Y()],i.prototype,"getConnectorDefaults",void 0),i}(Ka),of=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),rf=function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},sf=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mode="Canvas",n.id="overview",n.actionName="",n.startPoint=null,n.currentPoint=null,n.prevPoint=null,n.scale=null,n.inAction=!1,n.viewPortRatio=1,n.horizontalOffset=0,n.verticalOffset=0,n.model={},n.event=!0,n.model={width:n.width,height:n.height},n}return of(e,t),e.prototype.onPropertyChanged=function(t,e){for(var i=0,n=Object.keys(t);i<n.length;i++)switch(n[i]){case"sourceID":this.setParent(t.sourceID);break;case"width":case"height":this.renderCanvas(),this.setParent(this.sourceID)}},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){this.element.style.background="transparent",this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.diagramRenderer=new Sd(this.element.id,new Cd,!1),this.renderCanvas(),this.setParent(this.sourceID)},e.prototype.getSizeValue=function(t){return t.toString().indexOf("px")>0||t.toString().indexOf("%")>0?t.toString():t.toString()+"px"},e.prototype.renderCanvas=function(t){var e=document.getElementById(this.element.id+"_canvas");e||(e=document.createElement("div"),this.element.appendChild(e)),Wr(e,{id:this.element.id+"_canvas",class:"drawing",style:"position:relative; height:"+this.getSizeValue(this.model.height)+"; width:"+this.getSizeValue(this.model.width)+";style:-ms-touch-action: none;touch-action: none;"}),this.element.setAttribute("tabindex",String(0)),this.element.style.overflow="hidden",this.element.style.height=String(this.model.height),this.element.style.width=String(this.model.width),this.canvas=e},e.prototype.setParent=function(t){var e=document.getElementById(t);if(this.parent){var i=this.parent;this.parent=null,i.setOverview(null,this.id),this.removeDocument(this)}this.parent=this.getDiagram(e,"ej2_instances"),this.parent&&this.parent.setOverview(this)},e.prototype.getDiagram=function(t,e){for(var i,n=t[e].length,o=0;o<n;o++)if(Hr(t[e][o].element,"e-diagram")){i=t[e][o];break}return i},e.prototype.unWireEvents=function(){var t=ma.touchStartEvent,e=ma.touchMoveEvent,i=ma.isPointer?"pointerleave":"mouseleave",n=ma.isPointer,o=(ma.info.name,ma.touchEndEvent);ha.remove(this.element,t,this.mouseDown),ha.remove(this.element,e,this.mouseMove),ha.remove(this.element,o,this.mouseUp),ha.remove(this.element,i,this.documentMouseUp),ha.remove(window,"resize",this.windowResize);var r=document.getElementById(this.sourceID+"content");r&&ha.remove(r,"scroll",this.scrolled)},e.prototype.wireEvents=function(){var t=ma.touchStartEvent,e=ma.touchEndEvent,i=ma.touchMoveEvent,n=ma.isPointer?"pointerleave":"mouseleave",o=ma.isPointer;ma.info.name;ha.add(this.element,t,this.mouseDown,this),ha.add(this.element,i,this.mouseMove,this),ha.add(this.element,e,this.mouseUp,this),ha.add(this.element,n,this.documentMouseUp,this),ha.add(window,"resize",this.windowResize,this);var r=document.getElementById(this.sourceID+"content");r&&ha.add(r,"scroll",this.scrolled,this)},e.prototype.renderDocument=function(t){t.canvas=this.canvas;var e=document.getElementById(this.canvas.id+"_svg");e&&e.parentNode.removeChild(e);var i=Nr("svg",{id:this.canvas.id+"_svg",version:"1.1",xlink:"http://www.w3.org/1999/xlink",class:"overview_svg"});this.svg=i,t.svg=i,t.canvas.appendChild(i);var n=document.getElementById(this.element.id),o=n.clientWidth,r=n.clientHeight,s=n.getBoundingClientRect(),a=window.screenX<0?-1*window.screenX:window.screenX,l=window.screenY<0?-1*window.screenY:window.screenY;0===o&&(o=Math.floor(window.innerWidth-a-Math.floor(s.left))),0===r&&(r=Math.floor(window.innerHeight-l-Math.floor(s.top))),i.setAttribute("width",String(o)),i.setAttribute("height",String(r)),this.model.width=o,this.model.height=r;var h;if(!t.diagramLayerDiv){t.diagramLayerDiv=document.createElement("div");document.getElementById(this.element.id);t.diagramLayer=xd.createCanvas(this.element.id+"_diagramLayer",this.model.width,this.model.height),t.diagramLayer.setAttribute("style","position:absolute; left:0px;  top:0px "),t.diagramLayerDiv.appendChild(t.diagramLayer),t.canvas.appendChild(t.diagramLayerDiv)}h={id:this.element.id+"_diagramLayer_div",style:"width:"+this.model.width+"px; height:"+this.model.height+"px;position:absolute;top:0px;left:0px"},Wr(t.diagramLayerDiv,h),this.renderHtmlLayer(t.canvas),this.renderNativeLayer(t.canvas,t),this.addOverviewRectPanel(t)},e.prototype.removeDocument=function(t){var e=document.getElementById(this.canvas.id+"_svg");this.canvas.removeChild(e);var i=document.getElementById(this.element.id+"_htmlLayer");this.canvas.removeChild(i);var n=document.getElementById(this.id+"_diagramLayer_div");this.canvas.removeChild(n),t.diagramLayerDiv=null,t.diagramLayer=null},e.prototype.renderHtmlLayer=function(t){var e=document.createElement("div");Wr(e,{id:this.element.id+"_htmlLayer",class:"e-html-layer"});var i=e;e.style.pointerEvents="none",e.style.position="absolute",e.style.left="0px",e.style.top="0px";var n=document.createElement("div");return Wr(n,{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;"}),i.appendChild(n),t.appendChild(i),i},e.prototype.renderNativeLayer=function(t,e){var i=this.parent.createSvg(this.element.id+"_nativeLayer_svg",this.model.width,this.model.height),n=Nr("g",{id:this.element.id+"_nativeLayer"});i.appendChild(n),e.diagramLayerDiv.appendChild(i),_r(i,{class:"e-native-layer"})},e.prototype.addOverviewRectPanel=function(t){var e=document.getElementById(this.canvas.id+"_overviewsvg");e&&e.parentNode.removeChild(e),e=Nr("svg",{id:this.canvas.id+"_overviewsvg",version:"1.1",xlink:"http://www.w3.org/1999/xlink",style:"position:absolute;left:0px;top:0px; aria-label:Specifies overview",width:this.model.width,height:this.model.height}),t.canvas.appendChild(e);var i=Nr("g",{id:this.id+"_overviewlayer",style:"pointer-events:none"});e.appendChild(i);var n=Nr("rect",{fill:"transparent",width:"100%",height:"100%",class:"overviewbackrect",id:this.canvas.id+"overviewbackrect"});n.setAttribute("style"," pointer-events: none; "),i.appendChild(n);var o=Nr("g",{id:this.canvas.id+"overviewhandle",style:"pointer-events:all"});i.appendChild(o);var r=Nr("rect",{id:this.canvas.id+"overviewrect",fill:"transparent"});o.appendChild(r),this.renderOverviewCorner("left",o),this.renderOverviewCorner("right",o),this.renderOverviewCorner("top",o),this.renderOverviewCorner("bottom",o),this.renderOverviewCorner("topleft",o),this.renderOverviewCorner("topright",o),this.renderOverviewCorner("bottomleft",o),this.renderOverviewCorner("bottomright",o)},e.prototype.renderOverviewCorner=function(t,e){this.svg;var i,n=Nr(i="top"===t||"bottom"===t||"right"===t||"left"===t?"rect":"circle",{id:this.canvas.id+"visible"+t});e.appendChild(n);var o=Nr(i,{id:this.canvas.id+t,class:"overviewresizer",fill:"transparent"});e.appendChild(o)},e.prototype.updateOverviewRectangle=function(){var t=this.currentPoint.x-this.prevPoint.x,e=this.currentPoint.y-this.prevPoint.y,i=new Al;i.width=0,i.height=0;var n=0,o=0;switch(this.resizeDirection){case"left":i.width-=t,i.height-=t/this.viewPortRatio,n=t,o=t/this.viewPortRatio,o/=2;break;case"right":i.width+=t,i.height+=t/this.viewPortRatio,o=t/this.viewPortRatio,o/=-2;break;case"top":i.height-=e,i.width-=e*this.viewPortRatio,o=e,n=e*this.viewPortRatio,n/=2;break;case"bottom":i.height+=e,i.width+=e*this.viewPortRatio,n=e*this.viewPortRatio,n/=-2;break;case"topleft":Math.abs(e)>Math.abs(t)?t=e*this.viewPortRatio:e=t/this.viewPortRatio,i.width-=t,i.height-=e,n=t,o=e;break;case"topright":Math.abs(e)>Math.abs(t)?t=-e*this.viewPortRatio:e=-t/this.viewPortRatio,o=e,i.width+=t,i.height-=e;break;case"bottomleft":Math.abs(e)>Math.abs(t)?t=-e*this.viewPortRatio:e=-t/this.viewPortRatio,n=t,i.width-=t,i.height+=e;break;case"bottomright":Math.abs(e)>Math.abs(t)?t=e*this.viewPortRatio:e=t/this.viewPortRatio,i.width+=t,i.height+=e}this.updateHelper(n,o,i,void 0,void 0)},e.prototype.updateHelper=function(t,e,i,n,o){var r,s,a,l=this.element.getElementsByTagName("svg")[2].getElementById("helper");if(i)r=(a=l.getBBox()).x+t,s=a.y+e,n=a.width+i.width,o=a.height+i.height;else{var h;h=this.currentPoint.x>this.startPoint.x?this.currentPoint.x-this.prevPoint.x:this.prevPoint.x-this.currentPoint.x;var c;c=this.currentPoint.y>this.startPoint.y?this.currentPoint.y-this.prevPoint.y:this.prevPoint.y-this.currentPoint.y,Math.abs(c)>Math.abs(h)?h=this.viewPortRatio*c:c=h/this.viewPortRatio,a=l.getBBox(),r=this.startPoint.x>this.currentPoint.x?a.x-h:a.x,s=this.startPoint.y>this.currentPoint.y?a.y-c:a.y,n=a.width+h,o=a.height+c}_r(this.helper,{id:this.helper.id,x:r,y:s,width:Math.max(0,n),height:Math.max(0,o)})},e.prototype.updateOverviewrect=function(t,e,i,n){Wr(document.getElementById(this.canvas.id+"overviewrect"),{x:t,y:e,width:Math.max(1,i),height:Math.max(1,n)}),this.updateOverviewCorner("top",t+8,e-2,Math.max(0,i-16),2),this.updateOverviewCorner("bottom",t+8,e+n,Math.max(0,i-16),2),this.updateOverviewCorner("left",t-2,e+8,2,Math.max(0,n-16)),this.updateOverviewCorner("right",t+i,e+8,2,Math.max(0,n-16)),this.updateOverviewCorner("topleft",t,e,5,5),this.updateOverviewCorner("topright",t+i,e,5,5),this.updateOverviewCorner("bottomleft",t,e+n,5,5),this.updateOverviewCorner("bottomright",t+i,e+n,5,5)},e.prototype.updateOverviewCorner=function(t,e,i,n,o){var r,s,a="visible"+t,l=document.getElementById(this.canvas.id+a);"top"===t||"bottom"===t||"right"===t||"left"===t?(r={x:e,y:i,width:n,height:o,fill:"#ED1C24"},s={x:e-2,y:i-2,width:2===n?4:n,height:2===o?4:o}):(r={cx:e,cy:i,r:4,fill:"#ED1C24"},s={cx:e,cy:i,r:6,fill:"transparent"}),Wr(l,r),Wr(document.getElementById(this.canvas.id+t),s)},e.prototype.translateOverviewRectangle=function(){var t=Number(this.model.width),e=Number(this.model.height),i=this.currentPoint.x-this.prevPoint.x,n=this.currentPoint.y-this.prevPoint.y,o=(Math.min(this.parent.scroller.viewPortWidth/t,this.parent.scroller.viewPortHeight/e),this.element.getElementsByTagName("svg")[2].getElementById(this.canvas.id+"overviewrect").getBBox()),r=o.x+i,s=o.y+n,a=o.width,l=o.height;this.updateOverviewrect(r,s,a,l),this.updateParentView(this.parent.scroller.currentZoom,r,s,a,l,null)},e.prototype.renderOverviewRect=function(t,e,i,n){var o=Number(this.model.width),r=Number(this.model.height),s=i/o*this.contentWidth,a=n/r*this.contentHeight,l=Math.max(this.parent.scroller.viewPortWidth/s,this.parent.scroller.viewPortHeight/a);if(l>=.25&&l<=30){var h={x:0,y:0};this.updateParentView(l,t,e,i,n,h);var c=this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom,!0);if(this.helper){var d=this.element.getElementsByTagName("rect")[10].getBBox();c.x=d.x,c.y=d.y}this.updateOverviewrect(c.x,c.y,c.width,c.height)}},e.prototype.scrollOverviewRect=function(t,e,i,n){if(!this.actionName||n){var o=Number(this.model.width),r=Number(this.model.height),s=Math.min(this.contentWidth/o,this.contentHeight/r),a=new Rl,l=a.x=t/i/s,h=a.y=e/i/s,c=a.width=this.parent.scroller.viewPortWidth/i/s,d=a.height=this.parent.scroller.viewPortHeight/i/s;this.parent.scroller.viewPortWidth,this.parent.scroller.viewPortHeight;if(n){var p=new Rl;return p.x=l,p.y=h,p.width=c,p.height=d,p}this.updateOverviewrect(-l,-h,c,d)}return null},e.prototype.updateParentView=function(t,e,i,n,o,r){var s,a,l=Number(this.model.width),h=Number(this.model.height),c=e*(this.contentWidth/l)*t,d=i*(this.contentHeight/h)*t;this.parent.scroller.getPageBounds();1===t&&"pan"!==this.actionName||(s=-c-this.parent.scroller.horizontalOffset,a=-d-this.parent.scroller.verticalOffset),"scale"===this.actionName||"draw"===this.actionName?this.parent.scroller.zoom(t/this.parent.scroller.currentZoom,s,a,r):this.parent.pan(s,a,r)},e.prototype.updateView=function(t){var e,i,n=this.parent.scroller.getPageBounds();e=n.width,i=n.height;var o,r=Number(this.model.width),s=Number(this.model.height),a=Math.max(e,this.parent.scroller.viewPortWidth),l=Math.max(i,this.parent.scroller.viewPortHeight);this.contentWidth=a=Math.max(a,r/s*l),this.contentHeight=l=Math.max(l,s/r*a),o=Math.min(r/a,s/l);var h=document.getElementById(this.element.id+"_htmlLayer");h.style.webkitTransform="scale("+o+") translate("+-n.x+"px,"+-n.y+"px)",h.style.transform="scale("+o+") translate("+-n.x+"px,"+-n.y+"px)",document.getElementById(this.id+"_overviewlayer").setAttribute("transform","translate("+-n.x*o+","+-n.y*o+")"),this.horizontalOffset=n.x*o,this.verticalOffset=n.y*o;var c=document.getElementById("overview_diagramLayer"),d=Ir(this.element.id),p=c.getContext("2d"),u=Number(this.model.width)/this.contentWidth,g=Number(this.model.height)/this.contentHeight;u=Math.min(u,g),d.setAttribute("transform","translate(0,0),scale("+u+")"),p.setTransform(u,0,0,u,0,0),p.fillStyle="red",this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom)},e.prototype.scrolled=function(t){if(this.event){var e=this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom,!0);this.updateOverviewrect(-e.x,-e.y,e.width,e.height)}},e.prototype.updateCursor=function(t){if(Hr(t.target,"overviewresizer"))switch(t.target.id){case this.canvas.id+"left":this.canvas.style.cursor="w-resize";break;case this.canvas.id+"right":this.canvas.style.cursor="e-resize";break;case this.canvas.id+"top":this.canvas.style.cursor="n-resize";break;case this.canvas.id+"bottom":this.canvas.style.cursor="s-resize";break;case this.canvas.id+"topleft":this.canvas.style.cursor="nw-resize";break;case this.canvas.id+"topright":this.canvas.style.cursor="ne-resize";break;case this.canvas.id+"bottomleft":this.canvas.style.cursor="sw-resize";break;case this.canvas.id+"bottomright":this.canvas.style.cursor="se-resize"}else this.canvas.style.cursor="default"},e.prototype.mouseMove=function(t){if(this.event=!1,this.updateCursor(t),this.currentPoint=this.mousePosition(t),this.actionName)switch(this.actionName){case"draw":this.inAction||this.startPoint.x===this.currentPoint.x&&this.startPoint.y===this.currentPoint.y||(this.initHelper(),this.inAction=!0),this.inAction&&this.updateHelper();break;case"scale":this.inAction||(this.initHelper(),this.inAction=!0),this.updateOverviewRectangle();break;case"pan":(this.startPoint.x!==this.currentPoint.x||this.startPoint.y===this.currentPoint.y||this.inAction)&&(this.inAction=!0,this.translateOverviewRectangle())}this.prevPoint=this.currentPoint},e.prototype.documentMouseUp=function(t){this.inAction=!1,this.actionName="",this.helper&&(this.helper.parentNode.removeChild(this.helper),this.helper=null),this.event=!0,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="all"},e.prototype.windowResize=function(t){var e=this;return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){var t=document.getElementById(e.element.id).getBoundingClientRect();e.model.width=t.width,e.model.height=t.height,e.renderCanvas(),e.setParent(e.sourceID)},10),!1},e.prototype.mouseDown=function(t){if(t.target.id===this.canvas.id+"_overviewsvg"&&(this.actionName="draw"),t.target.id===this.canvas.id+"overviewrect"&&(this.actionName="pan"),Hr(t.target,"overviewresizer"))switch(this.actionName="scale",t.target.id){case this.canvas.id+"left":this.resizeDirection="left";break;case this.canvas.id+"right":this.resizeDirection="right";break;case this.canvas.id+"top":this.resizeDirection="top";break;case this.canvas.id+"bottom":this.resizeDirection="bottom";break;case this.canvas.id+"topleft":this.resizeDirection="topleft";break;case this.canvas.id+"topright":this.resizeDirection="topright";break;case this.canvas.id+"bottomleft":this.resizeDirection="bottomleft";break;case this.canvas.id+"bottomright":this.resizeDirection="bottomright"}this.startPoint=this.prevPoint=this.mousePosition(t),this.viewPortRatio=this.parent.scroller.viewPortWidth/this.parent.scroller.viewPortHeight,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="none"},e.prototype.mouseUp=function(t){this.currentPoint=this.mousePosition(t);Number(this.model.width),Number(this.model.height);if(this.actionName)if(this.startPoint.x!==this.currentPoint.x||this.startPoint.y!==this.currentPoint.y){if("pan"===this.actionName);else if(this.helper){var e=this.element.getElementsByTagName("rect")[10].getBBox();this.resizeDirection=this.resizeDirection||"";var i=e.x,n=e.y,o=e.width,r=e.height;"topleft"===this.resizeDirection||"topright"===this.resizeDirection||"bottomleft"===this.resizeDirection||this.resizeDirection;this.renderOverviewRect(i,n,o,r)}}else if(t.target.id===this.canvas.id+"_overviewsvg"||"helper"===t.target.id){var o=(e=this.element.getElementsByTagName("svg")[2].getElementById(this.canvas.id+"overviewrect").getBBox()).width,r=e.height;this.inAction=!0,this.actionName="pan",this.renderOverviewRect(this.currentPoint.x-o/2,this.currentPoint.y-r/2,o,r),this.inAction=!1}this.helper&&(this.helper.parentNode.removeChild(this.helper),this.helper=null),this.actionName="",this.startPoint=null,this.currentPoint=null,this.prevPoint=null,this.helper=null,this.viewPortRatio=1,this.resizeDirection="",this.inAction=!1,this.event=!0,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="all"},e.prototype.initHelper=function(){var t=this.element.getElementsByTagName("svg")[2],e=(this.parent.scroller.currentZoom,this.startPoint.x),i=this.startPoint.y,n=1,o=1;if("scale"===this.actionName){var r=t.getElementById(this.canvas.id+"overviewrect").getBBox();e=r.x,i=r.y,n=r.width,o=r.height}var s=Nr("rect",{id:"helper",x:e,y:i,width:n,height:o,fill:"transparent",stroke:"gray","stroke-dasharray":"2 2","shape-rendering":"crispEdges"});t.getElementById(this.id+"_overviewlayer").appendChild(s),this.helper=s},e.prototype.mousePosition=function(t){var e,i,n;if(-1!==t.type.indexOf("touch")){var o=(e=t).changedTouches[0].clientX,r=e.changedTouches[0].clientY;i=o-this.element.offsetLeft,n=r-this.element.offsetTop}else i=t.clientX,n=t.clientY;var s=this.element.getBoundingClientRect();return i-=s.left,n-=s.top,{x:i+this.horizontalOffset,y:n+this.verticalOffset}},e.prototype.destroy=function(){if(this.unWireEvents(),this.notify("destroy",{}),t.prototype.destroy.call(this),document.getElementById(this.element.id)){this.element.classList.remove("e-overview");var e=document.getElementById(this.element.id+"_canvas");e&&this.element.removeChild(e)}this.parent.views.splice(this.parent.views.indexOf(this.id),1),this.diagramLayerDiv=null,this.canvas=null,this.parent=null},e.prototype.getModuleName=function(){return"Overview"},rf([Y("100%")],e.prototype,"width",void 0),rf([Y("100%")],e.prototype,"height",void 0),rf([Y("")],e.prototype,"sourceID",void 0),rf([J()],e.prototype,"created",void 0),e}(Ka);return t.Diagram=Ep,t.PrintAndExport=Pp,t.Size=Al,t.Rect=Rl,t.Matrix=Nl,t.identityMatrix=Et,t.transformPointByMatrix=Pt,t.transformPointsByMatrix=Lt,t.rotateMatrix=Tt,t.scaleMatrix=kt,t.translateMatrix=Ot,t.multiplyMatrix=Dt,t.Point=Dl,t.contextMenuClick="contextMenuClick",t.contextMenuOpen="contextMenuOpen",t.Thickness=Yl,t.Margin=Gl,t.Shadow=Zl,t.Stop=Kl,t.Gradient=Ql,t.LinearGradient=Jl,t.RadialGradient=$l,t.ShapeStyle=th,t.StrokeStyle=eh,t.TextStyle=ih,t.DiagramElement=Wl,t.PathElement=sh,t.ImageElement=ph,t.TextElement=ch,t.Container=oh,t.Canvas=gh,t.StackPanel=Tp,t.findConnectorPoints=fi,t.findAngle=Ui,t.getIntersectionPoints=Ki,t.getPortDirection=Sn,t.getOuterBounds=En,t.getOppositeDirection=Pn,t.processPathData=ut,t.parsePathData=gt,t.getRectanglePath=mt,t.getPolygonPath=ft,t.pathSegmentCollection=vt,t.transformPath=yt,t.updatedSegment=bt,t.scalePathData=wt,t.splitArrayCollection=xt,t.getPathString=Ct,t.getString=St,t.randomId=qr,t.getBounds=Xr,t.cloneObject=Yr,t.getInternalProperties=Gr,t.cloneArray=Zr,t.extendObject=Kr,t.extendArray=Qr,t.textAlignToString=Jr,t.wordBreakToString=$r,t.bBoxText=ts,t.middleElement=es,t.overFlow=is,t.whiteSpaceToString=ns,t.rotateSize=os,t.rotatePoint=rs,t.getOffset=ss,t.getFunction=as,t.completeRegion=wo,t.findObjectType=xo,t.findNearestPoint=Co,t.isPointOverConnector=Eo,t.intersect3=Po,t.getPoints=Lo,t.getTooltipOffset=To,t.sort=Ao,t.getAnnotationPosition=Mo,t.getOffsetOfConnector=Io,t.getAlignedPosition=Do,t.alignLabelOnSegments=Ro,t.getBezierDirection=No,t.serialize=Bo,t.deserialize=Ho,t.updateStyle=jo,t.updateHyperlink=Fo,t.updateShapeContent=Vo,t.updateShape=_o,t.updateContent=Wo,t.removeItem=Uo,t.updateConnector=qo,t.getUserHandlePosition=Xo,t.canResizeCorner=Yo,t.canShowCorner=Go,t.checkPortRestriction=Zo,t.findAnnotation=Ko,t.findPortIndex=Qo,t.getObjectFromCollection=Jo,t.scaleElement=$o,t.insertObject=tr,t.getElement=er,t.getObjectType=wd,t.CanvasRenderer=xd,t.DiagramRenderer=Sd,t.DataBinding=Vp,t.getBasicShape=Bt,t.getPortShape=Ht,t.getDecoratorShape=zt,t.getIconShape=jt,t.getFlowShape=Ft,t.Hyperlink=Ch,t.Annotation=Sh,t.ShapeAnnotation=Eh,t.PathAnnotation=Ph,t.Port=yh,t.PointPort=bh,t.menuClass=Om,t.DiagramContextMenu=Am,t.Shape=Jc,t.Path=$c,t.Native=td,t.Html=ed,t.Image=id,t.Text=nd,t.BasicShape=od,t.FlowShape=rd,t.BpmnGateway=sd,t.BpmnDataObject=ad,t.BpmnTask=ld,t.BpmnEvent=hd,t.BpmnSubEvent=cd,t.BpmnTransactionSubProcess=dd,t.BpmnSubProcess=pd,t.BpmnActivity=ud,t.BpmnAnnotation=gd,t.BpmnShape=md,t.Node=fd,t.BpmnDiagrams=Mm,t.getBpmnShapePathData=Qs,t.getBpmnTriggerShapePathData=Js,t.getBpmnGatewayShapePathData=$s,t.getBpmnTaskShapePathData=ta,t.getBpmnLoopShapePathData=ea,t.Decorator=Rc,t.Vector=Nc,t.ConnectorShape=Bc,t.BpmnFlow=Hc,t.ConnectorSegment=zc,t.StraightSegment=jc,t.BezierSegment=Fc,t.OrthogonalSegment=Vc,t.getDirection=Ln,t.isEmptyVector=Tn,t.getBezierPoints=kn,t.getBezierBounds=On,t.bezierPoints=An,t.Connector=_c,t.ConnectorBridging=Hm,t.Snapping=zm,t.UndoRedo=jm,t.DiagramTooltip=Lc,t.initTooltip=di,t.updateTooltip=gi,t.LayoutAnimation=Fm,t.UserHandle=qc,t.Selector=Xc,t.ToolBase=Xd,t.SelectTool=Yd,t.ConnectTool=Gd,t.MoveTool=Zd,t.RotateTool=Kd,t.ResizeTool=Qd,t.NodeDrawingTool=Jd,t.ConnectorDrawingTool=$d,t.TextDrawingTool=tp,t.ZoomPanTool=ep,t.ExpandTool=ip,t.LabelTool=np,t.PolygonDrawingTool=op,t.DiagramEventHandler=ap,t.CommandHandler=pp,t.findToolToActivate=ls,t.findPortToolToActivate=cs,t.contains=ps,t.hasSelection=us,t.hasSingleConnection=gs,t.isSelected=ms,t.getCursor=fs,t.ConnectorEditing=sp,t.DataSource=Fd,t.Gridlines=Id,t.SnapSettings=Dd,t.KeyGesture=yp,t.Command=bp,t.CommandManager=wp,t.ContextMenuSettings=xp,t.Layout=Wd,t.MindMap=_m,t.HierarchicalTree=Vm,t.RadialTree=Wm,t.GraphForceNode=Um,t.SymmetricLayout=qm,t.GraphLayoutManager=Xm,t.ComplexHierarchicalTree=Ym,t.Palette=tf,t.SymbolPreview=ef,t.SymbolPalette=nf,t.Ruler=bd,t.Overview=sf,t}({});
//# sourceMappingURL=ej2-diagrams.min.js.map
